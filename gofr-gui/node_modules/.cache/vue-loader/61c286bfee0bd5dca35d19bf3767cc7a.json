{"remainingRequest":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/facility-recon-gui/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/facility-recon-gui/src/components/Login.vue","mtime":1619257194369},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHJlcXVpcmVkIH0gZnJvbSAndnVlbGlkYXRlL2xpYi92YWxpZGF0b3JzJwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnCmltcG9ydCBWdWVDb29raWVzIGZyb20gJ3Z1ZS1jb29raWVzJwppbXBvcnQgeyB1dWlkIH0gZnJvbSAndnVlLXV1aWQnCmltcG9ydCB7IGV2ZW50QnVzIH0gZnJvbSAnLi4vbWFpbicKCmV4cG9ydCBkZWZhdWx0IHsKICB2YWxpZGF0aW9uczogewogICAgdXNlcm5hbWU6IHsgcmVxdWlyZWQgfSwKICAgIHBhc3N3b3JkOiB7IHJlcXVpcmVkIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcm5hbWU6ICcnLAogICAgICBwYXNzd29yZDogJycsCiAgICAgIGF1dGhTdGF0dXM6IGZhbHNlLAogICAgICBzaWdudXBFbmFibGVkOiBmYWxzZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXV0aGVudGljYXRlICgpIHsKICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCkKICAgICAgZm9ybURhdGEuYXBwZW5kKCd1c2VybmFtZScsIHRoaXMudXNlcm5hbWUpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgncGFzc3dvcmQnLCB0aGlzLnBhc3N3b3JkKQogICAgICBheGlvcwogICAgICAgIC5wb3N0KCcvYXV0aGVudGljYXRlLycsIGZvcm1EYXRhLCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC50aGVuKGF1dGhSZXNwID0+IHsKICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmF1dGgudG9rZW4gPSBhdXRoUmVzcC5kYXRhLnRva2VuCiAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnVzZXJuYW1lID0gdGhpcy51c2VybmFtZQogICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuYXV0aC51c2VySUQgPSBhdXRoUmVzcC5kYXRhLnVzZXJJRAogICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuYXV0aC5yb2xlID0gYXV0aFJlc3AuZGF0YS5yb2xlCiAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnRhc2tzID0gYXV0aFJlc3AuZGF0YS50YXNrcwogICAgICAgICAgVnVlQ29va2llcy5jb25maWcoJzMwZCcpCiAgICAgICAgICBWdWVDb29raWVzLnNldCgndG9rZW4nLCB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnRva2VuLCAnaW5maW5pdHknKQogICAgICAgICAgVnVlQ29va2llcy5zZXQoJ3VzZXJJRCcsIHRoaXMuJHN0b3JlLnN0YXRlLmF1dGgudXNlcklELCAnaW5maW5pdHknKQogICAgICAgICAgVnVlQ29va2llcy5zZXQoJ3JvbGUnLCB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnJvbGUsICdpbmZpbml0eScpCiAgICAgICAgICBWdWVDb29raWVzLnNldCgKICAgICAgICAgICAgJ3Rhc2tzJywKICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkodGhpcy4kc3RvcmUuc3RhdGUuYXV0aC50YXNrcyksCiAgICAgICAgICAgICdpbmZpbml0eScKICAgICAgICAgICkKICAgICAgICAgIFZ1ZUNvb2tpZXMuc2V0KAogICAgICAgICAgICAndXNlcm5hbWUnLAogICAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnVzZXJuYW1lLAogICAgICAgICAgICAnaW5maW5pdHknCiAgICAgICAgICApCiAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnJvbGUgPSBhdXRoUmVzcC5kYXRhLnJvbGUKICAgICAgICAgIGlmIChhdXRoUmVzcC5kYXRhLnRva2VuKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmNsaWVudElkID0gdXVpZC52NCgpCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmluaXRpYWxpemluZ0FwcCA9IHRydWUKICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZGVueUFjY2VzcyA9IGZhbHNlCiAgICAgICAgICAgIGV2ZW50QnVzLiRlbWl0KCdnZXRDb25maWcnKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5hdXRoU3RhdHVzID0gdHJ1ZQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICBpZiAoZXJyLmhhc093blByb3BlcnR5KCdyZXNwb25zZScpKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5yZXNwb25zZS5kYXRhLmVycm9yKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICB9LAogICAgZGlzcGxheVNpZ251cCAoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogJ1NpZ251cCcgfSkKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB1c2VybmFtZUVycm9ycyAoKSB7CiAgICAgIGNvbnN0IGVycm9ycyA9IFtdCiAgICAgIGlmICghdGhpcy4kdi51c2VybmFtZS4kZGlydHkpIHJldHVybiBlcnJvcnMKICAgICAgIXRoaXMuJHYudXNlcm5hbWUucmVxdWlyZWQgJiYgZXJyb3JzLnB1c2goJ1VzZXJuYW1lIGlzIHJlcXVpcmVkJykKICAgICAgcmV0dXJuIGVycm9ycwogICAgfSwKICAgIHBhc3N3b3JkRXJyb3JzICgpIHsKICAgICAgY29uc3QgZXJyb3JzID0gW10KICAgICAgaWYgKCF0aGlzLiR2LnBhc3N3b3JkLiRkaXJ0eSkgcmV0dXJuIGVycm9ycwogICAgICAhdGhpcy4kdi5wYXNzd29yZC5yZXF1aXJlZCAmJiBlcnJvcnMucHVzaCgnUGFzc3dvcmQgaXMgcmVxdWlyZWQnKQogICAgICByZXR1cm4gZXJyb3JzCiAgICB9CiAgfSwKICBjcmVhdGVkICgpIHsKICAgIGF4aW9zLmdldCgnL2dldFNpZ251cENvbmYnKS50aGVuKHJlc3AgPT4gewogICAgICBpZiAocmVzcC5kYXRhKSB7CiAgICAgICAgdGhpcy5zaWdudXBFbmFibGVkID0gdHJ1ZQogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnNpZ251cEZpZWxkcyA9IHJlc3AuZGF0YS5hbGxTaWdudXBGaWVsZHMKICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5jdXN0b21TaWdudXBGaWVsZHMgPSByZXNwLmRhdGEuY3VzdG9tU2lnbnVwRmllbGRzCiAgICAgICAgVnVlQ29va2llcy5zZXQoJ3NpZ251cEZpZWxkcycsIHJlc3AuZGF0YS5hbGxTaWdudXBGaWVsZHMsICdpbmZpbml0eScpCiAgICAgICAgVnVlQ29va2llcy5zZXQoCiAgICAgICAgICAnY3VzdG9tU2lnbnVwRmllbGRzJywKICAgICAgICAgIHJlc3AuZGF0YS5jdXN0b21TaWdudXBGaWVsZHMsCiAgICAgICAgICAnaW5maW5pdHknCiAgICAgICAgKQogICAgICB9CiAgICB9KQogIH0sCiAgYmVmb3JlQ3JlYXRlICgpIHsKICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS5jb25maWcuZ2VuZXJhbENvbmZpZy5hdXRoRGlzYWJsZWQpIHsKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuY2xpZW50SWQgPSB1dWlkLnY0KCkKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuaW5pdGlhbGl6aW5nQXBwID0gdHJ1ZQogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5kZW55QWNjZXNzID0gZmFsc2UKICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAnREhJUzJBdXRoJyB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-container>\n    <center>\n      <v-layout\n        row\n        wrap\n      >\n        <v-flex xs3></v-flex>\n        <v-flex xs6>\n          <v-alert\n            type=\"error\"\n            :value=\"authStatus\"\n          >\n            Authentication Failed\n          </v-alert>\n        </v-flex>\n      </v-layout>\n      <v-card\n        width=\"430px\"\n        hover\n      >\n        <v-card-title primary-title>\n          <v-toolbar\n            color=\"primary\"\n            style=\"color: white\"\n          >\n            <v-layout\n              row\n              wrap\n            >\n              <v-flex\n                xs2\n                text-xs-left\n              >\n                <v-icon\n                  x-large\n                  color=\"white\"\n                >mdi-lock</v-icon>\n              </v-flex>\n              <v-flex\n                xs9\n                text-xs-right\n              >\n                <b>Login</b>\n              </v-flex>\n            </v-layout>\n          </v-toolbar>\n        </v-card-title>\n        <v-card-text>\n          <v-form\n            ref=\"form\"\n            class=\"pa-3 pt-4\"\n          >\n            <v-text-field\n              required\n              v-on:keyup.enter=\"authenticate()\"\n              @blur=\"$v.username.$touch()\"\n              @change=\"$v.username.$touch()\"\n              :error-messages=\"usernameErrors\"\n              v-model=\"username\"\n              filled\n              color=\"deep-purple\"\n              label=\"Username\"\n            />\n            <v-text-field\n              required\n              v-on:keyup.enter=\"authenticate()\"\n              @blur=\"$v.password.$touch()\"\n              @change=\"$v.password.$touch()\"\n              :error-messages=\"passwordErrors\"\n              v-model=\"password\"\n              filled\n              type=\"password\"\n              color=\"deep-purple\"\n              label=\"Password\"\n            />\n          </v-form>\n        </v-card-text>\n        <v-card-actions>\n          <v-toolbar>\n            <v-btn\n              v-if=\"$store.state.config.generalConfig.selfRegistration.enabled\"\n              color=\"primary\"\n              @click=\"displaySignup\"\n            >Signup</v-btn>\n            <v-spacer></v-spacer>\n            <v-btn\n              @click=\"authenticate()\"\n              :disabled=\"$v.$invalid\"\n              class=\"white--text\"\n              color=\"primary\"\n              depressed\n            >Login</v-btn>\n          </v-toolbar>\n        </v-card-actions>\n      </v-card>\n    </center>\n  </v-container>\n</template>\n<script>\nimport { required } from 'vuelidate/lib/validators'\nimport axios from 'axios'\nimport VueCookies from 'vue-cookies'\nimport { uuid } from 'vue-uuid'\nimport { eventBus } from '../main'\n\nexport default {\n  validations: {\n    username: { required },\n    password: { required }\n  },\n  data () {\n    return {\n      username: '',\n      password: '',\n      authStatus: false,\n      signupEnabled: false\n    }\n  },\n  methods: {\n    authenticate () {\n      let formData = new FormData()\n      formData.append('username', this.username)\n      formData.append('password', this.password)\n      axios\n        .post('/authenticate/', formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        })\n        .then(authResp => {\n          this.$store.state.auth.token = authResp.data.token\n          this.$store.state.auth.username = this.username\n          this.$store.state.auth.userID = authResp.data.userID\n          this.$store.state.auth.role = authResp.data.role\n          this.$store.state.auth.tasks = authResp.data.tasks\n          VueCookies.config('30d')\n          VueCookies.set('token', this.$store.state.auth.token, 'infinity')\n          VueCookies.set('userID', this.$store.state.auth.userID, 'infinity')\n          VueCookies.set('role', this.$store.state.auth.role, 'infinity')\n          VueCookies.set(\n            'tasks',\n            JSON.stringify(this.$store.state.auth.tasks),\n            'infinity'\n          )\n          VueCookies.set(\n            'username',\n            this.$store.state.auth.username,\n            'infinity'\n          )\n          this.$store.state.auth.role = authResp.data.role\n          if (authResp.data.token) {\n            this.$store.state.clientId = uuid.v4()\n            this.$store.state.initializingApp = true\n            this.$store.state.denyAccess = false\n            eventBus.$emit('getConfig')\n          } else {\n            this.authStatus = true\n          }\n        })\n        .catch(err => {\n          if (err.hasOwnProperty('response')) {\n            console.log(err.response.data.error)\n          }\n        })\n    },\n    displaySignup () {\n      this.$router.push({ name: 'Signup' })\n    }\n  },\n  computed: {\n    usernameErrors () {\n      const errors = []\n      if (!this.$v.username.$dirty) return errors\n      !this.$v.username.required && errors.push('Username is required')\n      return errors\n    },\n    passwordErrors () {\n      const errors = []\n      if (!this.$v.password.$dirty) return errors\n      !this.$v.password.required && errors.push('Password is required')\n      return errors\n    }\n  },\n  created () {\n    axios.get('/getSignupConf').then(resp => {\n      if (resp.data) {\n        this.signupEnabled = true\n        this.$store.state.signupFields = resp.data.allSignupFields\n        this.$store.state.customSignupFields = resp.data.customSignupFields\n        VueCookies.set('signupFields', resp.data.allSignupFields, 'infinity')\n        VueCookies.set(\n          'customSignupFields',\n          resp.data.customSignupFields,\n          'infinity'\n        )\n      }\n    })\n  },\n  beforeCreate () {\n    if (this.$store.state.config.generalConfig.authDisabled) {\n      this.$store.state.clientId = uuid.v4()\n      this.$store.state.initializingApp = true\n      this.$store.state.denyAccess = false\n      this.$router.push({ name: 'DHIS2Auth' })\n    }\n  }\n}\n</script>\n\n"]}]}