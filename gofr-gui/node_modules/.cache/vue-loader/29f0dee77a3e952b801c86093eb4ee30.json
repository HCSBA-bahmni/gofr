{"remainingRequest":"/home/ally/gofr/gofr-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/gofr-gui/src/components/fhir/fhir-code.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/gofr-gui/src/components/fhir/fhir-code.vue","mtime":1619770994935},{"path":"/home/ally/gofr/gofr-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/gofr-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/gofr-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/gofr-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJaHJpc0VsZW1lbnQgZnJvbSAiLi4vaWhyaXMvaWhyaXMtZWxlbWVudC52dWUiCgovKgpjb25zdCBpdGVtU29ydCA9IChhLGIpID0+IHsKICByZXR1cm4gKGEuZGlzcGxheSA9PT0gYi5kaXNwbGF5ID8gKGEuY29kZSA9PT0gYi5jb2RlID8gMCA6IChhLmNvZGUgPCBiLmNvZGUgPyAtMTogMSkpIDogKGEuZGlzcGxheSA8IGIuZGlzcGxheSA/IC0xIDogMSkgKQp9CiovCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiZmhpci1jb2RlIiwKICBwcm9wczogWyJmaWVsZCIsIm1pbiIsIm1heCIsImJhc2UtbWluIiwiYmFzZS1tYXgiLCJsYWJlbCIsImJpbmRpbmciLCJzbG90UHJvcHMiLCJwYXRoIiwiZWRpdCIsInNsaWNlTmFtZSIsInJlYWRPbmx5SWZTZXQiLCJjb25zdHJhaW50cyJdLAogIGNvbXBvbmVudHM6IHsKICAgIElocmlzRWxlbWVudAogIH0sCiAgZGF0YTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gewogICAgICB2YWx1ZTogIiIsCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIGVycm9yczogW10sCiAgICAgIC8vZXJyb3I6IGZhbHNlLAogICAgICBpdGVtczogW10sCiAgICAgIHNvdXJjZTogeyBwYXRoOiAiIiwgZGF0YToge30sIGJpbmRpbmc6IHRoaXMuYmluZGluZyB9LAogICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgIGxvY2tXYXRjaDogZmFsc2UKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5zZXR1cERhdGEoKQogIH0sCiAgd2F0Y2g6IHsKICAgIHNsb3RQcm9wczogewogICAgICBoYW5kbGVyKCkgewogICAgICAgIC8vY29uc29sZS5sb2coIldBVENIIENPREUiLHRoaXMuZmllbGQsdGhpcy5wYXRoLHRoaXMuc2xvdFByb3BzKQogICAgICAgIGlmICggIXRoaXMubG9ja1dhdGNoICkgewogICAgICAgICAgdGhpcy5zZXR1cERhdGEoKQogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2V0dXBEYXRhKCkgewogICAgICBpZiAoIHRoaXMuc2xvdFByb3BzICYmIHRoaXMuc2xvdFByb3BzLnNvdXJjZSApIHsKICAgICAgICB0aGlzLnNvdXJjZSA9IHsgcGF0aDogdGhpcy5zbG90UHJvcHMuc291cmNlLnBhdGgrIi4iK3RoaXMuZmllbGQsIGRhdGE6IHt9IH0KICAgICAgICBpZiAoIHRoaXMuc2xvdFByb3BzLnNvdXJjZS5mcm9tQXJyYXkgKSB7CiAgICAgICAgICB0aGlzLnNvdXJjZS5kYXRhID0gdGhpcy5zbG90UHJvcHMuc291cmNlLmRhdGEKICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnNvdXJjZS5kYXRhCiAgICAgICAgICB0aGlzLmxvY2tXYXRjaCA9IHRydWUKICAgICAgICAgIC8vY29uc29sZS5sb2coIlNFVCB2YWx1ZSB0byAiLCB0aGlzLnNvdXJjZS5kYXRhLCB0aGlzLnNsb3RQcm9wcy5pbnB1dCkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IGV4cHJlc3Npb24gPSB0aGlzLiRmaGlydXRpbHMucGF0aEZpZWxkRXhwcmVzc2lvbiggdGhpcy5maWVsZCApCiAgICAgICAgICB0aGlzLnNvdXJjZS5kYXRhID0gdGhpcy4kZmhpcnBhdGguZXZhbHVhdGUoIHRoaXMuc2xvdFByb3BzLnNvdXJjZS5kYXRhLCBleHByZXNzaW9uICkKICAgICAgICAgIC8vY29uc29sZS5sb2coIlNUUiBGSElSUEFUSCIsIHRoaXMuc2xvdFByb3BzLnNvdXJjZS5kYXRhLCB0aGlzLmZpZWxkKQogICAgICAgICAgaWYgKCB0aGlzLnNvdXJjZS5kYXRhLmxlbmd0aCA9PSAxICkgewogICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5zb3VyY2UuZGF0YVswXQogICAgICAgICAgICB0aGlzLmxvY2tXYXRjaCA9IHRydWUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRoaXMucmVhZE9ubHlJZlNldCAmJiAoISF0aGlzLnZhbHVlKQogICAgICAgIC8vY29uc29sZS5sb2codGhpcy5zb3VyY2UpCiAgICAgIH0KICAgICAgbGV0IGJpbmRpbmcgPSB0aGlzLmJpbmRpbmcgfHwgdGhpcy5zbG90UHJvcHMuc291cmNlLmJpbmRpbmcKICAgICAgdGhpcy4kZmhpcnV0aWxzLmV4cGFuZCggYmluZGluZyApLnRoZW4oIGl0ZW1zID0+IHsKICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXMgCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgfSApLmNhdGNoKCBlcnIgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgICAvL3RoaXMuZXJyb3IgPSB0cnVlCiAgICAgICAgdGhpcy5lcnJvcnMucHVzaCggZXJyLm1lc3NhZ2UgKQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgIH0gKQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGluZGV4OiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICggdGhpcy5zbG90UHJvcHMgJiYgdGhpcy5zbG90UHJvcHMuaW5wdXQgKSByZXR1cm4gdGhpcy5zbG90UHJvcHMuaW5wdXQuaW5kZXgKICAgICAgZWxzZSByZXR1cm4gdW5kZWZpbmVkCiAgICB9LAogICAgZGlzcGxheTogZnVuY3Rpb24oKSB7CiAgICAgIGlmICggdGhpcy5zbG90UHJvcHMgJiYgdGhpcy5zbG90UHJvcHMuaW5wdXQpIHJldHVybiB0aGlzLnNsb3RQcm9wcy5pbnB1dC5sYWJlbAogICAgICBlbHNlIHJldHVybiB0aGlzLmxhYmVsCiAgICB9LAogICAgZGlzcGxheVZhbHVlOiBmdW5jdGlvbigpIHsKICAgICAgbGV0IGZvdW5kID0gdGhpcy5pdGVtcy5maW5kKCBpdGVtID0+IGl0ZW0uY29kZSA9PT0gdGhpcy52YWx1ZSApCiAgICAgIGlmICggZm91bmQgKSB7CiAgICAgICAgcmV0dXJuIGZvdW5kLmRpc3BsYXkKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIiIKICAgICAgfQogICAgfSwKICAgIHJlcXVpcmVkOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuICh0aGlzLmluZGV4IHx8IDApIDwgdGhpcy5taW4gCiAgICB9LAogICAgcnVsZXM6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIHRoaXMucmVxdWlyZWQgKSB7CiAgICAgICAgcmV0dXJuIFsgdiA9PiAhIXYgfHwgdGhpcy5kaXNwbGF5KyIgaXMgcmVxdWlyZWQiIF0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gW10KICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["fhir-code.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fhir-code.vue","sourceRoot":"src/components/fhir","sourcesContent":["<template>\n  <ihris-element :edit=\"edit\" :loading=\"loading\">\n    <template #form>\n      <v-select \n        :loading=\"loading\" \n        :label=\"display\" \n        v-model=\"value\" \n        :items=\"items\" \n        outlined \n        hide-details=\"auto\" \n        :error-messages=\"errors\"\n        item-text=\"display\"\n        item-value=\"code\"\n        :disabled=\"disabled\"\n        :rules=\"rules\"\n        dense\n        @change=\"errors = []\"\n      >\n        <template #label>{{display}} <span v-if=\"required\" class=\"red--text font-weight-bold\">*</span></template>\n      </v-select>\n    </template>\n    <template #header>\n      {{display}}\n    </template>\n    <template #value>\n      {{displayValue}}\n    </template>\n  </ihris-element>\n</template>\n\n<script>\nimport IhrisElement from \"../ihris/ihris-element.vue\"\n\n/*\nconst itemSort = (a,b) => {\n  return (a.display === b.display ? (a.code === b.code ? 0 : (a.code < b.code ? -1: 1)) : (a.display < b.display ? -1 : 1) )\n}\n*/\nexport default {\n  name: \"fhir-code\",\n  props: [\"field\",\"min\",\"max\",\"base-min\",\"base-max\",\"label\",\"binding\",\"slotProps\",\"path\",\"edit\",\"sliceName\",\"readOnlyIfSet\",\"constraints\"],\n  components: {\n    IhrisElement\n  },\n  data: function() {\n    return {\n      value: \"\",\n      loading: true,\n      errors: [],\n      //error: false,\n      items: [],\n      source: { path: \"\", data: {}, binding: this.binding },\n      disabled: false,\n      lockWatch: false\n    }\n  },\n  created: function() {\n    this.setupData()\n  },\n  watch: {\n    slotProps: {\n      handler() {\n        //console.log(\"WATCH CODE\",this.field,this.path,this.slotProps)\n        if ( !this.lockWatch ) {\n          this.setupData()\n        }\n      },\n      deep: true\n    }\n  },\n  methods: {\n    setupData() {\n      if ( this.slotProps && this.slotProps.source ) {\n        this.source = { path: this.slotProps.source.path+\".\"+this.field, data: {} }\n        if ( this.slotProps.source.fromArray ) {\n          this.source.data = this.slotProps.source.data\n          this.value = this.source.data\n          this.lockWatch = true\n          //console.log(\"SET value to \", this.source.data, this.slotProps.input)\n        } else {\n          let expression = this.$fhirutils.pathFieldExpression( this.field )\n          this.source.data = this.$fhirpath.evaluate( this.slotProps.source.data, expression )\n          //console.log(\"STR FHIRPATH\", this.slotProps.source.data, this.field)\n          if ( this.source.data.length == 1 ) {\n            this.value = this.source.data[0]\n            this.lockWatch = true\n          }\n        }\n        this.disabled = this.readOnlyIfSet && (!!this.value)\n        //console.log(this.source)\n      }\n      let binding = this.binding || this.slotProps.source.binding\n      this.$fhirutils.expand( binding ).then( items => {\n        this.items = items \n        this.loading = false\n      } ).catch( err => {\n        console.log(err)\n        //this.error = true\n        this.errors.push( err.message )\n        this.loading = false\n      } )\n    }\n  },\n  computed: {\n    index: function () {\n      if ( this.slotProps && this.slotProps.input ) return this.slotProps.input.index\n      else return undefined\n    },\n    display: function() {\n      if ( this.slotProps && this.slotProps.input) return this.slotProps.input.label\n      else return this.label\n    },\n    displayValue: function() {\n      let found = this.items.find( item => item.code === this.value )\n      if ( found ) {\n        return found.display\n      } else {\n        return \"\"\n      }\n    },\n    required: function() {\n      return (this.index || 0) < this.min \n    },\n    rules: function() {\n      if ( this.required ) {\n        return [ v => !!v || this.display+\" is required\" ]\n      } else {\n        return []\n      }\n    }\n  }\n}\n</script>\n"]}]}