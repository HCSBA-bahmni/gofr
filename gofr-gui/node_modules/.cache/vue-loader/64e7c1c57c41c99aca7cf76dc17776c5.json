{"remainingRequest":"/home/ally/gofr2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr2/src/components/FacilityReconView.vue?vue&type=script&scoped=true&lang=js&","dependencies":[{"path":"/home/ally/gofr2/src/components/FacilityReconView.vue","mtime":1619154037766},{"path":"/home/ally/gofr2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ally/gofr2/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ally/gofr2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ally/gofr2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMaXF1b3JUcmVlIGZyb20gJ2xpcXVvci10cmVlJwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnCmltcG9ydCB7IHJlcXVpcmVkIH0gZnJvbSAndnVlbGlkYXRlL2xpYi92YWxpZGF0b3JzJwppbXBvcnQgeyBzY29yZXNNaXhpbiB9IGZyb20gJy4uL21peGlucy9zY29yZXNNaXhpbicKaW1wb3J0IHsgZ2VuZXJhbE1peGluIH0gZnJvbSAnLi4vbWl4aW5zL2dlbmVyYWxNaXhpbicKCmV4cG9ydCBkZWZhdWx0IHsKICB2YWxpZGF0aW9uczogewogICAgZWRpdExvY2F0aW9uTmFtZTogeyByZXF1aXJlZCB9CiAgfSwKICBtaXhpbnM6IFtzY29yZXNNaXhpbiwgZ2VuZXJhbE1peGluXSwKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGNvbmZpcm1EZWxldGU6IGZhbHNlLAogICAgICBkZWxldGVMb2NhdGlvbkRhdGE6ICcnLAogICAgICBkZWxldGVTb3VyY2U6IHsKICAgICAgICBuYW1lOiAnJywKICAgICAgICB2YWx1ZTogJycKICAgICAgfSwKICAgICAgZWRpdERpYWxvZzogZmFsc2UsCiAgICAgIGVkaXRMb2NhdGlvbk5hbWU6ICcnLAogICAgICBlZGl0TG9jYXRpb25JZDogJycsCiAgICAgIGVkaXRQYXJlbnRzOiBbXSwKICAgICAgZWRpdExvY2F0aW9uUGFyZW50OiAnJywKICAgICAgZWRpdFNvdXJjZTogJycsCiAgICAgIGhlbHBEaWFsb2c6IGZhbHNlLAogICAgICBsYXN0TGV2ZWw6IFtdLAogICAgICBoZWFkZXJUZXh0OiB7CiAgICAgICAgbGV2ZWwyOiAnTGV2ZWwgMScsCiAgICAgICAgbGV2ZWwzOiAnTGV2ZWwgMicsCiAgICAgICAgbGV2ZWw0OiAnTGV2ZWwgMycsCiAgICAgICAgbGV2ZWw1OiAnTGV2ZWwgNCcsCiAgICAgICAgbGV2ZWw2OiAnTGV2ZWwgNScsCiAgICAgICAgbGV2ZWw3OiAnTGV2ZWwgNicsCiAgICAgICAgbGV2ZWw4OiAnTGV2ZWwgNycsCiAgICAgICAgbGV2ZWw5OiAnTGV2ZWwgOCcsCiAgICAgICAgbGV2ZWwxMDogJ0xldmVsIDknLAogICAgICAgIGZhY2lsaXR5OiAnRmFjaWxpdHknLAogICAgICAgIGxhdGl0dWRlOiAnTGF0aXR1ZGUnLAogICAgICAgIGxvbmdpdHVkZTogJ0xvbmdpdHVkZScKICAgICAgfSwKICAgICAgaGVhZGVyczogWwogICAgICAgIHsgdGV4dDogJ0xldmVsIDEnLCB2YWx1ZTogJ2xldmVsMScgfSwKICAgICAgICB7IHRleHQ6ICdMZXZlbCAyJywgdmFsdWU6ICdsZXZlbDInIH0sCiAgICAgICAgeyB0ZXh0OiAnTGV2ZWwgMycsIHZhbHVlOiAnbGV2ZWwzJyB9LAogICAgICAgIHsgdGV4dDogJ0xldmVsIDQnLCB2YWx1ZTogJ2xldmVsNCcgfSwKICAgICAgICB7IHRleHQ6ICdGYWNpbGl0eScsIHZhbHVlOiAnZmFjaWxpdHknIH0sCiAgICAgICAgeyB0ZXh0OiAnTGF0aXR1ZGUnLCB2YWx1ZTogJ2xhdGl0dWRlJyB9LAogICAgICAgIHsgdGV4dDogJ0xvbmdpdHVkZScsIHZhbHVlOiAnbG9uZ2l0dWRlJyB9CiAgICAgIF0sCiAgICAgIHNlYXJjaFNvdXJjZTE6ICcnLAogICAgICBzZWFyY2hTb3VyY2UyOiAnJywKICAgICAgZmlsdGVyU291cmNlMTogeyB0ZXh0OiAnJywgbGV2ZWw6ICcnIH0sCiAgICAgIGZpbHRlclNvdXJjZTI6IHsgdGV4dDogJycsIGxldmVsOiAnJyB9LAogICAgICBzb3VyY2UyUGFnaW5hdGlvbjogeyByb3dzUGVyUGFnZTogMjAgfSwKICAgICAgc291cmNlMVBhZ2luYXRpb246IHsgcm93c1BlclBhZ2U6IDIwIH0sCiAgICAgIGxvYWRpbmdTb3VyY2UxOiBmYWxzZSwKICAgICAgbG9hZGluZ1NvdXJjZTI6IGZhbHNlLAogICAgICB0b3RhbFNvdXJjZTFSZWNvcmRzOiAwLAogICAgICB0b3RhbFNvdXJjZTJSZWNvcmRzOiAwLAogICAgICBzb3VyY2UyR3JpZDogW10sCiAgICAgIHNvdXJjZTFHcmlkOiBbXSwKICAgICAgc291cmNlMVRyZWU6IFtdLAogICAgICBzb3VyY2UyVHJlZTogW10sCiAgICAgIHNvdXJjZTFTdGFydDogMSwKICAgICAgc291cmNlMlN0YXJ0OiAxLAogICAgICBzb3VyY2UxQ291bnQ6IDEwLAogICAgICBzb3VyY2UyQ291bnQ6IDEwLAogICAgICBsb2FkaW5nU291cmNlMVRyZWU6IGZhbHNlLAogICAgICBsb2FkaW5nU291cmNlMlRyZWU6IGZhbHNlLAogICAgICBsb2FkaW5nU291cmNlMUdyaWQ6IGZhbHNlLAogICAgICBsb2FkaW5nU291cmNlMkdyaWQ6IGZhbHNlLAogICAgICBjdXJyZW50U291cmNlMlBhZ2luYXRpb246IHt9LAogICAgICBjdXJyZW50U291cmNlMVBhZ2luYXRpb246IHt9LAogICAgICBzb3VyY2UxU2VsTm9kZUlkOiBmYWxzZSwKICAgICAgc291cmNlMlNlbE5vZGVJZDogZmFsc2UsCiAgICAgIHNvdXJjZU93bmVyOiAnJwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZWRpdCAoZGF0YSwgc291cmNlKSB7CiAgICAgIGxldCBzb3VyY2VzT3duZXIgPSB0aGlzLmdldERhdGFzb3VyY2VPd25lcigpCiAgICAgIGlmIChzb3VyY2UgPT09ICdzb3VyY2UxJykgewogICAgICAgIHRoaXMuc291cmNlT3duZXIgPSBzb3VyY2VzT3duZXIuc291cmNlMU93bmVyCiAgICAgICAgdGhpcy5lZGl0U291cmNlID0gdGhpcy5zb3VyY2UxCiAgICAgIH0gZWxzZSBpZiAoc291cmNlID09PSAnc291cmNlMicpIHsKICAgICAgICB0aGlzLnNvdXJjZU93bmVyID0gc291cmNlc093bmVyLnNvdXJjZTFPd25lcgogICAgICAgIHRoaXMuZWRpdFNvdXJjZSA9IHRoaXMuc291cmNlMgogICAgICB9CiAgICAgIHRoaXMuZWRpdExvY2F0aW9uTmFtZSA9IGRhdGEuZmFjaWxpdHkKICAgICAgdGhpcy5lZGl0TG9jYXRpb25JZCA9IGRhdGEuaWQKICAgICAgdGhpcy5lZGl0RGlhbG9nID0gdHJ1ZQogICAgICBsZXQgbGVuZ3RoID0gT2JqZWN0LmtleXModGhpcy5zb3VyY2UyR3JpZEhlYWRlcikubGVuZ3RoCiAgICAgIGxldCBsZXZlbE5leHRGYWNpbGl0eSA9IHRoaXMuc291cmNlMkdyaWRIZWFkZXJbbGVuZ3RoIC0gMV0udmFsdWUKICAgICAgdGhpcy5lZGl0TG9jYXRpb25QYXJlbnQgPSBkYXRhW2xldmVsTmV4dEZhY2lsaXR5ICsgJ2lkJ10KICAgICAgbGV0IGxldmVsID0gbGV2ZWxOZXh0RmFjaWxpdHkucmVwbGFjZSgnbGV2ZWwnLCAnJykKICAgICAgdGhpcy5nZXRMZXZlbERhdGEobGV2ZWwpCiAgICB9LAogICAgc2F2ZUVkaXQgKCkgewogICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3NvdXJjZU93bmVyJywgdGhpcy5zb3VyY2VPd25lcikKICAgICAgZm9ybURhdGEuYXBwZW5kKCdzb3VyY2UnLCB0aGlzLmVkaXRTb3VyY2UpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbG9jYXRpb25JZCcsIHRoaXMuZWRpdExvY2F0aW9uSWQpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbG9jYXRpb25OYW1lJywgdGhpcy5lZGl0TG9jYXRpb25OYW1lKQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ2xvY2F0aW9uUGFyZW50JywgdGhpcy5lZGl0TG9jYXRpb25QYXJlbnQpCiAgICAgIGF4aW9zLnBvc3QoJy9lZGl0TG9jYXRpb24nLCBmb3JtRGF0YSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScKICAgICAgICB9CiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuZWRpdERpYWxvZyA9IGZhbHNlCiAgICAgICAgdGhpcy5nZXRTb3VyY2UxR3JpZChmYWxzZSkKICAgICAgICB0aGlzLmdldFNvdXJjZTJHcmlkKGZhbHNlKQogICAgICAgIHRoaXMuZ2V0VHJlZSgpCiAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShlcnIpKQogICAgICB9KQogICAgfSwKICAgIGRlbGV0ZUxvY2F0aW9uIChsb2NhdGlvbiwgc291cmNlLCBzdGFnZSkgewogICAgICBpZiAoc3RhZ2UgPT09ICdyZXF1ZXN0Q29uZmlybWF0aW9uJykgewogICAgICAgIGxldCBzb3VyY2VzT3duZXIgPSB0aGlzLmdldERhdGFzb3VyY2VPd25lcigpCiAgICAgICAgaWYgKHNvdXJjZSA9PT0gJ3NvdXJjZTEnKSB7CiAgICAgICAgICB0aGlzLnNvdXJjZU93bmVyID0gc291cmNlc093bmVyLnNvdXJjZTFPd25lcgogICAgICAgICAgdGhpcy5kZWxldGVTb3VyY2UgPSB7CiAgICAgICAgICAgIG5hbWU6ICdzb3VyY2UxJywKICAgICAgICAgICAgc291cmNlSWQ6IHRoaXMuJHN0b3JlLnN0YXRlLmFjdGl2ZVBhaXIuc291cmNlMS5pZCwKICAgICAgICAgICAgc291cmNlTmFtZTogdGhpcy5zb3VyY2UxCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzb3VyY2UgPT09ICdzb3VyY2UyJykgewogICAgICAgICAgdGhpcy5zb3VyY2VPd25lciA9IHNvdXJjZXNPd25lci5zb3VyY2UyT3duZXIKICAgICAgICAgIHRoaXMuZGVsZXRlU291cmNlID0gewogICAgICAgICAgICBuYW1lOiAnc291cmNlMicsCiAgICAgICAgICAgIHNvdXJjZUlkOiB0aGlzLiRzdG9yZS5zdGF0ZS5hY3RpdmVQYWlyLnNvdXJjZTIuaWQsCiAgICAgICAgICAgIHNvdXJjZU5hbWU6IHRoaXMuc291cmNlMgogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLmRlbGV0ZUxvY2F0aW9uRGF0YSA9IGxvY2F0aW9uCiAgICAgICAgdGhpcy5jb25maXJtRGVsZXRlID0gdHJ1ZQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29uZmlybURlbGV0ZSA9IGZhbHNlCiAgICAgICAgbGV0IHVzZXJJRCA9IHRoaXMuJHN0b3JlLnN0YXRlLmFjdGl2ZVBhaXIudXNlcklELl9pZAogICAgICAgIGxldCBxdWVyeSA9IGBpZD0ke3RoaXMuZGVsZXRlTG9jYXRpb25EYXRhLmlkfSZzb3VyY2VJZD0ke3RoaXMuZGVsZXRlU291cmNlLnNvdXJjZUlkfSZzb3VyY2VOYW1lPSR7dGhpcy5kZWxldGVTb3VyY2Uuc291cmNlTmFtZX0mdXNlcklEPSR7dXNlcklEfSZzb3VyY2VPd25lcj0ke3RoaXMuc291cmNlT3duZXJ9YAogICAgICAgIGF4aW9zLmRlbGV0ZShgL2RlbGV0ZUxvY2F0aW9uPyR7cXVlcnl9YCkudGhlbigoKSA9PiB7CiAgICAgICAgICBpZiAodGhpcy5kZWxldGVTb3VyY2UubmFtZSA9PT0gJ3NvdXJjZTEnKSB7CiAgICAgICAgICAgIHRoaXMuZ2V0U291cmNlMUdyaWQoZmFsc2UpCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmdldFNvdXJjZTJHcmlkKGZhbHNlKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0KICAgIH0sCiAgICBnZXRMZXZlbERhdGEgKGxldmVsKSB7CiAgICAgIGF4aW9zLmdldCgnL2dldExldmVsRGF0YS8nICsgdGhpcy5lZGl0U291cmNlICsgJy8nICsgdGhpcy5zb3VyY2VPd25lciArICcvJyArIGxldmVsKS50aGVuKChkYXRhKSA9PiB7CiAgICAgICAgdGhpcy5lZGl0UGFyZW50cyA9IGRhdGEuZGF0YQogICAgICB9KQogICAgfSwKICAgIGdldFNvdXJjZTFHcmlkIChpZCkgewogICAgICBpZiAoIXRoaXMuc291cmNlMSkgewogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIHRoaXMubG9hZGluZ1NvdXJjZTEgPSB0cnVlCiAgICAgIGlmICghaWQpIHsKICAgICAgICBpZCA9ICcnCiAgICAgIH0KICAgICAgdGhpcy5sb2FkaW5nU291cmNlMUdyaWQgPSB0cnVlCiAgICAgIGxldCBzb3VyY2UxT3duZXIgPSB0aGlzLmdldERhdGFzb3VyY2VPd25lcigpLnNvdXJjZTFPd25lcgogICAgICBsZXQgc291cmNlMUxpbWl0T3JnSWQgPSB0aGlzLmdldExpbWl0T3JnSWRPbkFjdGl2ZVBhaXIoKS5zb3VyY2UxTGltaXRPcmdJZAogICAgICBsZXQgdXNlcklEID0gdGhpcy4kc3RvcmUuc3RhdGUuYWN0aXZlUGFpci51c2VySUQuX2lkCiAgICAgIGxldCBwYXRoID0gYC9oaWVyYXJjaHk/c291cmNlPSR7dGhpcy5zb3VyY2UxfSZzdGFydD0ke3RoaXMuc291cmNlMVN0YXJ0fSZjb3VudD0ke3RoaXMuc291cmNlMUNvdW50fSZpZD0ke2lkfSZ1c2VySUQ9JHt1c2VySUR9JnNvdXJjZU93bmVyPSR7c291cmNlMU93bmVyfSZzb3VyY2VMaW1pdE9yZ0lkPSR7c291cmNlMUxpbWl0T3JnSWR9YAogICAgICBheGlvcy5nZXQocGF0aCkudGhlbigoaGllcmFyY2h5KSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nU291cmNlMUdyaWQgPSBmYWxzZQogICAgICAgIGlmIChoaWVyYXJjaHkuZGF0YSkgewogICAgICAgICAgY29uc3QgeyBzb3J0QnksIGRlc2NlbmRpbmcgfSA9IHRoaXMuc291cmNlMVBhZ2luYXRpb24KICAgICAgICAgIGlmICh0aGlzLnNvdXJjZTFQYWdpbmF0aW9uLnNvcnRCeSkgewogICAgICAgICAgICBoaWVyYXJjaHkuZGF0YS50cmVlID0gaGllcmFyY2h5LmRhdGEuZ3JpZC5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgICAgICAgY29uc3Qgc29ydEEgPSBhW3NvcnRCeV0KICAgICAgICAgICAgICBjb25zdCBzb3J0QiA9IGJbc29ydEJ5XQoKICAgICAgICAgICAgICBpZiAoZGVzY2VuZGluZykgewogICAgICAgICAgICAgICAgaWYgKHNvcnRBIDwgc29ydEIpIHJldHVybiAxCiAgICAgICAgICAgICAgICBpZiAoc29ydEEgPiBzb3J0QikgcmV0dXJuIC0xCiAgICAgICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoc29ydEEgPCBzb3J0QikgcmV0dXJuIC0xCiAgICAgICAgICAgICAgICBpZiAoc29ydEEgPiBzb3J0QikgcmV0dXJuIDEKICAgICAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zb3VyY2UxR3JpZCA9IGhpZXJhcmNoeS5kYXRhLmdyaWQKICAgICAgICAgIHRoaXMudG90YWxTb3VyY2UxUmVjb3JkcyA9IGhpZXJhcmNoeS5kYXRhLnRvdGFsCiAgICAgICAgICB0aGlzLnNvdXJjZTFQYWdpbmF0aW9uLnRvdGFsSXRlbXMgPSBoaWVyYXJjaHkuZGF0YS50b3RhbAogICAgICAgICAgLy8gc2V0IHRoZXNlIHZhbHVlcyB0byBzdG9wIHJlbG9hZGluZyBkYXRhIGR1ZSB0byB3YXRjaGVyIHNlZSB0aGF0IHRoZSB2YXIgc291cmNlMlBhZ2luYXRpb24gaGFzIGNoYW5nZWQKICAgICAgICAgIHRoaXMuY3VycmVudFNvdXJjZTFQYWdpbmF0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zb3VyY2UxUGFnaW5hdGlvbikKICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50U291cmNlMVBhZ2luYXRpb24uaGFzT3duUHJvcGVydHkoJ2Rlc2NlbmRpbmcnKSkgewogICAgICAgICAgICB0aGlzLmN1cnJlbnRTb3VyY2UxUGFnaW5hdGlvbi5kZXNjZW5kaW5nID0gZmFsc2UKICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50U291cmNlMVBhZ2luYXRpb24uaGFzT3duUHJvcGVydHkoJ3BhZ2UnKSkgewogICAgICAgICAgICB0aGlzLmN1cnJlbnRTb3VyY2UxUGFnaW5hdGlvbi5wYWdlID0gMQogICAgICAgICAgfQogICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRTb3VyY2UxUGFnaW5hdGlvbi5oYXNPd25Qcm9wZXJ0eSgnc29ydEJ5JykpIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50U291cmNlMVBhZ2luYXRpb24uc29ydEJ5ID0gJ2ZhY2lsaXR5JwogICAgICAgICAgfQogICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRTb3VyY2UxUGFnaW5hdGlvbi5oYXNPd25Qcm9wZXJ0eSgndG90YWxJdGVtcycpKSB7CiAgICAgICAgICAgIHRoaXMuY3VycmVudFNvdXJjZTFQYWdpbmF0aW9uLnRvdGFsSXRlbXMgPSBoaWVyYXJjaHkuZGF0YS50b3RhbAogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLmxvYWRpbmdTb3VyY2UxID0gZmFsc2UKICAgICAgfSkKICAgIH0sCiAgICBnZXRTb3VyY2UyR3JpZCAoaWQpIHsKICAgICAgaWYgKCF0aGlzLnNvdXJjZTIpIHsKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICBpZiAoIWlkKSB7CiAgICAgICAgaWQgPSAnJwogICAgICB9CiAgICAgIHRoaXMubG9hZGluZ1NvdXJjZTIgPSB0cnVlCiAgICAgIHRoaXMubG9hZGluZ1NvdXJjZTJHcmlkID0gdHJ1ZQogICAgICBsZXQgc291cmNlMk93bmVyID0gdGhpcy5nZXREYXRhc291cmNlT3duZXIoKS5zb3VyY2UyT3duZXIKICAgICAgbGV0IHNvdXJjZTJMaW1pdE9yZ0lkID0gdGhpcy5nZXRMaW1pdE9yZ0lkT25BY3RpdmVQYWlyKCkuc291cmNlMkxpbWl0T3JnSWQKICAgICAgbGV0IHVzZXJJRCA9IHRoaXMuJHN0b3JlLnN0YXRlLmFjdGl2ZVBhaXIudXNlcklELl9pZAogICAgICBsZXQgcGF0aCA9IGAvaGllcmFyY2h5P3NvdXJjZT0ke3RoaXMuc291cmNlMn0mc3RhcnQ9JHt0aGlzLnNvdXJjZTJTdGFydH0mY291bnQ9JHt0aGlzLnNvdXJjZTJDb3VudH0maWQ9JHtpZH0mdXNlcklEPSR7dXNlcklEfSZzb3VyY2VPd25lcj0ke3NvdXJjZTJPd25lcn0mc291cmNlTGltaXRPcmdJZD0ke3NvdXJjZTJMaW1pdE9yZ0lkfWAKICAgICAgYXhpb3MuZ2V0KHBhdGgpLnRoZW4oKGhpZXJhcmNoeSkgPT4gewogICAgICAgIHRoaXMubG9hZGluZ1NvdXJjZTJHcmlkID0gZmFsc2UKICAgICAgICBpZiAoaGllcmFyY2h5LmRhdGEpIHsKICAgICAgICAgIGNvbnN0IHsgc29ydEJ5LCBkZXNjZW5kaW5nIH0gPSB0aGlzLnNvdXJjZTJQYWdpbmF0aW9uCiAgICAgICAgICBpZiAodGhpcy5zb3VyY2UyUGFnaW5hdGlvbi5zb3J0QnkpIHsKICAgICAgICAgICAgaGllcmFyY2h5LmRhdGEudHJlZSA9IGhpZXJhcmNoeS5kYXRhLmdyaWQuc29ydCgoYSwgYikgPT4gewogICAgICAgICAgICAgIGNvbnN0IHNvcnRBID0gYVtzb3J0QnldCiAgICAgICAgICAgICAgY29uc3Qgc29ydEIgPSBiW3NvcnRCeV0KCiAgICAgICAgICAgICAgaWYgKGRlc2NlbmRpbmcpIHsKICAgICAgICAgICAgICAgIGlmIChzb3J0QSA8IHNvcnRCKSByZXR1cm4gMQogICAgICAgICAgICAgICAgaWYgKHNvcnRBID4gc29ydEIpIHJldHVybiAtMQogICAgICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHNvcnRBIDwgc29ydEIpIHJldHVybiAtMQogICAgICAgICAgICAgICAgaWYgKHNvcnRBID4gc29ydEIpIHJldHVybiAxCiAgICAgICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc291cmNlMkdyaWQgPSBoaWVyYXJjaHkuZGF0YS5ncmlkCiAgICAgICAgICB0aGlzLnRvdGFsU291cmNlMlJlY29yZHMgPSBoaWVyYXJjaHkuZGF0YS50b3RhbAogICAgICAgICAgdGhpcy5zb3VyY2UyUGFnaW5hdGlvbi50b3RhbEl0ZW1zID0gaGllcmFyY2h5LmRhdGEudG90YWwKCiAgICAgICAgICAvLyBzZXQgdGhlc2UgdmFsdWVzIHRvIHN0b3AgcmVsb2FkaW5nIGRhdGEgZHVlIHRvIHdhdGNoZXIgc2VlIHRoYXQgdGhlIHZhciBzb3VyY2UyUGFnaW5hdGlvbiBoYXMgY2hhbmdlZAogICAgICAgICAgdGhpcy5jdXJyZW50U291cmNlMlBhZ2luYXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNvdXJjZTJQYWdpbmF0aW9uKQogICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRTb3VyY2UyUGFnaW5hdGlvbi5oYXNPd25Qcm9wZXJ0eSgnZGVzY2VuZGluZycpKSB7CiAgICAgICAgICAgIHRoaXMuY3VycmVudFNvdXJjZTJQYWdpbmF0aW9uLmRlc2NlbmRpbmcgPSBmYWxzZQogICAgICAgICAgfQogICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRTb3VyY2UyUGFnaW5hdGlvbi5oYXNPd25Qcm9wZXJ0eSgncGFnZScpKSB7CiAgICAgICAgICAgIHRoaXMuY3VycmVudFNvdXJjZTJQYWdpbmF0aW9uLnBhZ2UgPSAxCiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXRoaXMuY3VycmVudFNvdXJjZTJQYWdpbmF0aW9uLmhhc093blByb3BlcnR5KCdzb3J0QnknKSkgewogICAgICAgICAgICB0aGlzLmN1cnJlbnRTb3VyY2UyUGFnaW5hdGlvbi5zb3J0QnkgPSAnZmFjaWxpdHknCiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXRoaXMuY3VycmVudFNvdXJjZTJQYWdpbmF0aW9uLmhhc093blByb3BlcnR5KCd0b3RhbEl0ZW1zJykpIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50U291cmNlMlBhZ2luYXRpb24udG90YWxJdGVtcyA9IGhpZXJhcmNoeS5kYXRhLnRvdGFsCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMubG9hZGluZ1NvdXJjZTIgPSBmYWxzZQogICAgICB9KQogICAgfSwKICAgIGdldFRyZWUgKCkgewogICAgICBpZiAoIXRoaXMuc291cmNlMSB8fCAhdGhpcy5zb3VyY2UyKSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgbGV0IHNvdXJjZTJPd25lciA9IHRoaXMuZ2V0RGF0YXNvdXJjZU93bmVyKCkuc291cmNlMk93bmVyCiAgICAgIGxldCBzb3VyY2UyTGltaXRPcmdJZCA9IHRoaXMuZ2V0TGltaXRPcmdJZE9uQWN0aXZlUGFpcigpLnNvdXJjZTJMaW1pdE9yZ0lkCiAgICAgIHRoaXMubG9hZGluZ1NvdXJjZTJUcmVlID0gdHJ1ZQogICAgICBheGlvcy5nZXQoJy9nZXRUcmVlLycgKyB0aGlzLnNvdXJjZTIgKyAnLycgKyBzb3VyY2UyT3duZXIgKyAnLycgKyBzb3VyY2UyTGltaXRPcmdJZCkudGhlbigoaGllcmFyY2h5KSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nU291cmNlMlRyZWUgPSBmYWxzZQogICAgICAgIGlmIChoaWVyYXJjaHkuZGF0YSkgewogICAgICAgICAgdGhpcy5zb3VyY2UyVHJlZSA9IGhpZXJhcmNoeS5kYXRhCiAgICAgICAgfQogICAgICB9KQogICAgICBsZXQgc291cmNlMU93bmVyID0gdGhpcy5nZXREYXRhc291cmNlT3duZXIoKS5zb3VyY2UxT3duZXIKICAgICAgbGV0IHNvdXJjZTFMaW1pdE9yZ0lkID0gdGhpcy5nZXRMaW1pdE9yZ0lkT25BY3RpdmVQYWlyKCkuc291cmNlMUxpbWl0T3JnSWQKICAgICAgdGhpcy5sb2FkaW5nU291cmNlMVRyZWUgPSB0cnVlCiAgICAgIGF4aW9zLmdldCgnL2dldFRyZWUvJyArIHRoaXMuc291cmNlMSArICcvJyArIHNvdXJjZTFPd25lciArICcvJyArIHNvdXJjZTFMaW1pdE9yZ0lkKS50aGVuKChoaWVyYXJjaHkpID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmdTb3VyY2UxVHJlZSA9IGZhbHNlCiAgICAgICAgaWYgKGhpZXJhcmNoeS5kYXRhKSB7CiAgICAgICAgICB0aGlzLnNvdXJjZTFUcmVlID0gaGllcmFyY2h5LmRhdGEKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgc291cmNlMU5vZGVTZWxlY3RlZCAobm9kZSkgewogICAgICB0aGlzLnNvdXJjZTFTZWxOb2RlSWQgPSBub2RlLmlkCiAgICAgIHRoaXMuZ2V0U291cmNlMUdyaWQobm9kZS5pZCkKICAgIH0sCiAgICBzb3VyY2UyTm9kZVNlbGVjdGVkIChub2RlKSB7CiAgICAgIHRoaXMuc291cmNlMlNlbE5vZGVJZCA9IG5vZGUuaWQKICAgICAgdGhpcy5nZXRTb3VyY2UyR3JpZChub2RlLmlkKQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzRGF0YXNldDFPd25lciAoKSB7CiAgICAgIGxldCBzb3VyY2UxT3duZXIgPSB0aGlzLmdldERhdGFzb3VyY2VPd25lcigpLnNvdXJjZTFPd25lcgogICAgICBsZXQgdXNlcklEID0gdGhpcy4kc3RvcmUuc3RhdGUuYXV0aC51c2VySUQKICAgICAgaWYgKHNvdXJjZTFPd25lciAhPT0gdXNlcklEKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgICAgcmV0dXJuIHRydWUKICAgIH0sCiAgICBpc0RhdGFzZXQyT3duZXIgKCkgewogICAgICBsZXQgc291cmNlMk93bmVyID0gdGhpcy5nZXREYXRhc291cmNlT3duZXIoKS5zb3VyY2UyT3duZXIKICAgICAgbGV0IHVzZXJJRCA9IHRoaXMuJHN0b3JlLnN0YXRlLmF1dGgudXNlcklECiAgICAgIGlmIChzb3VyY2UyT3duZXIgIT09IHVzZXJJRCkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIHJldHVybiB0cnVlCiAgICB9LAogICAgc291cmNlMkdyaWRIZWFkZXIgKCkgewogICAgICBsZXQgaGVhZGVyID0gW10KICAgICAgaWYgKHRoaXMuaXNEYXRhc2V0Mk93bmVyKSB7CiAgICAgICAgaGVhZGVyLnB1c2goewogICAgICAgICAgdGV4dDogJycsCiAgICAgICAgICB2YWx1ZTogJycsCiAgICAgICAgICBzb3J0YWJsZTogZmFsc2UKICAgICAgICB9KQogICAgICB9CiAgICAgIGxldCBncmlkV2l0aEFsbEhlYWRlcnMgPSB7fQogICAgICBpZiAodGhpcy5zb3VyY2UyR3JpZCAmJiB0aGlzLnNvdXJjZTJHcmlkLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBncmlkIGluIHRoaXMuc291cmNlMkdyaWQpIHsKICAgICAgICAgIGlmIChncmlkV2l0aEFsbEhlYWRlcnMubGVuZ3RoID4gMCAmJiB0aGlzLnNvdXJjZTJHcmlkW2dyaWRdLmxlbmd0aCA+IE9iamVjdC5rZXlzKGdyaWRXaXRoQWxsSGVhZGVycykubGVuZ3RoKSB7CiAgICAgICAgICAgIGdyaWRXaXRoQWxsSGVhZGVycyA9IHRoaXMuc291cmNlMkdyaWRbZ3JpZF0KICAgICAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmtleXMoZ3JpZFdpdGhBbGxIZWFkZXJzKS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgZ3JpZFdpdGhBbGxIZWFkZXJzID0gdGhpcy5zb3VyY2UyR3JpZFtncmlkXQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKGNvbnN0IGtleSBpbiBncmlkV2l0aEFsbEhlYWRlcnMpIHsKICAgICAgICBpZiAodGhpcy5oZWFkZXJUZXh0W2tleV0pIHsKICAgICAgICAgIGhlYWRlci5wdXNoKHsgdGV4dDogdGhpcy5oZWFkZXJUZXh0W2tleV0sIHZhbHVlOiBrZXkgfSkKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGhlYWRlcgogICAgfSwKICAgIHNvdXJjZTFHcmlkSGVhZGVyICgpIHsKICAgICAgbGV0IGhlYWRlciA9IFtdCiAgICAgIGlmICh0aGlzLmlzRGF0YXNldDFPd25lcikgewogICAgICAgIGhlYWRlci5wdXNoKHsKICAgICAgICAgIHRleHQ6ICcnLAogICAgICAgICAgdmFsdWU6ICcnLAogICAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgICAgfSkKICAgICAgfQogICAgICBsZXQgZ3JpZFdpdGhBbGxIZWFkZXJzID0ge30KICAgICAgaWYgKHRoaXMuc291cmNlMUdyaWQgJiYgdGhpcy5zb3VyY2UxR3JpZC5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgZ3JpZCBpbiB0aGlzLnNvdXJjZTFHcmlkKSB7CiAgICAgICAgICBpZiAoZ3JpZFdpdGhBbGxIZWFkZXJzLmxlbmd0aCA+IDAgJiYgdGhpcy5zb3VyY2UxR3JpZFtncmlkXS5sZW5ndGggPiBPYmplY3Qua2V5cyhncmlkV2l0aEFsbEhlYWRlcnMpLmxlbmd0aCkgewogICAgICAgICAgICBncmlkV2l0aEFsbEhlYWRlcnMgPSB0aGlzLnNvdXJjZTFHcmlkW2dyaWRdCiAgICAgICAgICB9IGVsc2UgaWYgKE9iamVjdC5rZXlzKGdyaWRXaXRoQWxsSGVhZGVycykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGdyaWRXaXRoQWxsSGVhZGVycyA9IHRoaXMuc291cmNlMUdyaWRbZ3JpZF0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc291cmNlMUdyaWQgJiYgdGhpcy5zb3VyY2UxR3JpZC5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5zb3VyY2UxR3JpZFswXSkgewogICAgICAgICAgaWYgKHRoaXMuaGVhZGVyVGV4dFtrZXldKSB7CiAgICAgICAgICAgIGhlYWRlci5wdXNoKHsgdGV4dDogdGhpcy5oZWFkZXJUZXh0W2tleV0sIHZhbHVlOiBrZXkgfSkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGhlYWRlcgogICAgfSwKICAgIHNvdXJjZTJQYWdlcyAoKSB7CiAgICAgIGlmICh0aGlzLnNvdXJjZTJQYWdpbmF0aW9uLnJvd3NQZXJQYWdlID09IG51bGwgfHwgdGhpcy5zb3VyY2UyUGFnaW5hdGlvbi50b3RhbEl0ZW1zID09IG51bGwpIHsKICAgICAgICByZXR1cm4gMAogICAgICB9CiAgICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy5zb3VyY2UyUGFnaW5hdGlvbi50b3RhbEl0ZW1zIC8gdGhpcy5zb3VyY2UyQ291bnQpCiAgICB9LAogICAgc291cmNlMVBhZ2VzICgpIHsKICAgICAgaWYgKHRoaXMuc291cmNlMVBhZ2luYXRpb24ucm93c1BlclBhZ2UgPT0gbnVsbCB8fCB0aGlzLnNvdXJjZTFQYWdpbmF0aW9uLnRvdGFsSXRlbXMgPT0gbnVsbCkgewogICAgICAgIHJldHVybiAwCiAgICAgIH0KICAgICAgcmV0dXJuIE1hdGguY2VpbCh0aGlzLnNvdXJjZTFQYWdpbmF0aW9uLnRvdGFsSXRlbXMgLyB0aGlzLnNvdXJjZTFDb3VudCkKICAgIH0sCiAgICBzb3VyY2UxICgpIHsKICAgICAgbGV0IHNvdXJjZSA9IHRoaXMuJHN0b3JlLnN0YXRlLmFjdGl2ZVBhaXIuc291cmNlMS5uYW1lCiAgICAgIGlmIChzb3VyY2UpIHsKICAgICAgICBzb3VyY2UgPSB0aGlzLnRvVGl0bGVDYXNlKHNvdXJjZSkKICAgICAgfQogICAgICByZXR1cm4gc291cmNlCiAgICB9LAogICAgc291cmNlMiAoKSB7CiAgICAgIGxldCBzb3VyY2UgPSB0aGlzLiRzdG9yZS5zdGF0ZS5hY3RpdmVQYWlyLnNvdXJjZTIubmFtZQogICAgICBpZiAoc291cmNlKSB7CiAgICAgICAgc291cmNlID0gdGhpcy50b1RpdGxlQ2FzZShzb3VyY2UpCiAgICAgIH0KICAgICAgcmV0dXJuIHNvdXJjZQogICAgfSwKICAgIGVkaXRMb2NhdGlvbk5hbWVFcnJvcnMgKCkgewogICAgICBjb25zdCBlcnJvcnMgPSBbXQogICAgICBpZiAoIXRoaXMuJHYuZWRpdExvY2F0aW9uTmFtZS4kZGlydHkpIHJldHVybiBlcnJvcnMKICAgICAgIXRoaXMuJHYuZWRpdExvY2F0aW9uTmFtZS5yZXF1aXJlZCAmJiBlcnJvcnMucHVzaCgnRmFjaWxpdHkgTmFtZSBpcyByZXF1aXJlZCcpCiAgICAgIHJldHVybiBlcnJvcnMKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBzb3VyY2UxUGFnaW5hdGlvbjogewogICAgICBoYW5kbGVyICgpIHsKICAgICAgICAvLyBpZiBub3RoaW5nIGhhcyBjaGFuZ2VkIHRoZW4gZG9udCBzZW5kIHNlcnZlciByZXF1ZXN0CiAgICAgICAgaWYgKHRoaXMuY3VycmVudFNvdXJjZTFQYWdpbmF0aW9uLnNvcnRCeSA9PT0gdGhpcy5zb3VyY2UxUGFnaW5hdGlvbi5zb3J0QnkgJiYKICAgICAgICAgIHRoaXMuY3VycmVudFNvdXJjZTFQYWdpbmF0aW9uLmRlc2NlbmRpbmcgPT09IHRoaXMuc291cmNlMVBhZ2luYXRpb24uZGVzY2VuZGluZyAmJgogICAgICAgICAgdGhpcy5jdXJyZW50U291cmNlMVBhZ2luYXRpb24ucGFnZSA9PT0gdGhpcy5zb3VyY2UxUGFnaW5hdGlvbi5wYWdlCiAgICAgICAgKSB7CiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgbGV0IHBhZ2UgPSB0aGlzLnNvdXJjZTFQYWdpbmF0aW9uLnBhZ2UgLSAxCiAgICAgICAgdGhpcy5zb3VyY2UxU3RhcnQgPSBwYWdlICogdGhpcy5zb3VyY2UxQ291bnQgKyAxCiAgICAgICAgdGhpcy5nZXRTb3VyY2UxR3JpZCh0aGlzLnNvdXJjZTFTZWxOb2RlSWQpCiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUKICAgIH0sCiAgICBzb3VyY2UyUGFnaW5hdGlvbjogewogICAgICBoYW5kbGVyICgpIHsKICAgICAgICAvLyBpZiBub3RoaW5nIGhhcyBjaGFuZ2VkIHRoZW4gZG9udCBzZW5kIHNlcnZlciByZXF1ZXN0CiAgICAgICAgaWYgKHRoaXMuY3VycmVudFNvdXJjZTJQYWdpbmF0aW9uLnNvcnRCeSA9PT0gdGhpcy5zb3VyY2UyUGFnaW5hdGlvbi5zb3J0QnkgJiYKICAgICAgICAgIHRoaXMuY3VycmVudFNvdXJjZTJQYWdpbmF0aW9uLmRlc2NlbmRpbmcgPT09IHRoaXMuc291cmNlMlBhZ2luYXRpb24uZGVzY2VuZGluZyAmJgogICAgICAgICAgdGhpcy5jdXJyZW50U291cmNlMlBhZ2luYXRpb24ucGFnZSA9PT0gdGhpcy5zb3VyY2UyUGFnaW5hdGlvbi5wYWdlCiAgICAgICAgKSB7CiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgbGV0IHBhZ2UgPSB0aGlzLnNvdXJjZTJQYWdpbmF0aW9uLnBhZ2UgLSAxCiAgICAgICAgdGhpcy5zb3VyY2UyU3RhcnQgPSBwYWdlICogdGhpcy5zb3VyY2UyQ291bnQgKyAxCiAgICAgICAgdGhpcy5nZXRTb3VyY2UyR3JpZCh0aGlzLnNvdXJjZTJTZWxOb2RlSWQpCiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUKICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgdGhpcy5nZXRTb3VyY2UxR3JpZChmYWxzZSkKICAgIHRoaXMuZ2V0U291cmNlMkdyaWQoZmFsc2UpCiAgICB0aGlzLmdldFRyZWUoKQogIH0sCiAgY29tcG9uZW50czogewogICAgJ2xpcXVvci10cmVlJzogTGlxdW9yVHJlZQogIH0KfQo="},{"version":3,"sources":["FacilityReconView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2XA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FacilityReconView.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-container fluid>\n    <template v-if='$store.state.uploadRunning'><br><br><br>\n      <v-alert\n        type=\"info\"\n        :value=\"true\"\n      >\n        <b>Wait for upload to finish ...</b>\n        <v-progress-linear\n          indeterminate\n          color=\"white\"\n          class=\"mb-0\"\n        ></v-progress-linear>\n      </v-alert>\n    </template>\n    <template v-if='!$store.state.denyAccess & !$store.state.uploadRunning'>\n      <v-dialog\n        v-model=\"helpDialog\"\n        scrollable\n        persistent\n        :overlay=\"false\"\n        max-width=\"700px\"\n        transition=\"dialog-transition\"\n      >\n        <v-card>\n          <v-toolbar\n            color=\"primary\"\n            dark\n          >\n            <v-toolbar-title>\n              <v-icon>mdi-information</v-icon> About this page\n            </v-toolbar-title>\n            <v-spacer></v-spacer>\n            <v-btn\n              icon\n              dark\n              @click.native=\"helpDialog = false\"\n            >\n              <v-icon>mdi-close</v-icon>\n            </v-btn>\n          </v-toolbar>\n          <v-card-text>\n            This page let you view dat you have uploaded or synchronized from a remote server\n            <v-list>1. Use the tree to filter grid data</v-list>\n          </v-card-text>\n        </v-card>\n      </v-dialog>\n      <v-dialog\n        persistent\n        transition=\"scale-transition\"\n        v-model=\"confirmDelete\"\n        max-width=\"500px\"\n      >\n        <v-card>\n          <v-toolbar\n            color=\"primary\"\n            dark\n          >\n            <v-toolbar-title>\n              Warning\n            </v-toolbar-title>\n          </v-toolbar>\n          <v-card-text>\n            Are you sure that you want to delete {{deleteLocationData.facility}}\n          </v-card-text>\n          <v-card-actions>\n            <v-btn\n              color=\"error\"\n              @click.native=\"confirmDelete = false\"\n            >Cancel</v-btn>\n            <v-spacer></v-spacer>\n            <v-btn\n              color=\"primary\"\n              dark\n              @click.native=\"deleteLocation()\"\n            >Proceed</v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n      <v-dialog\n        persistent\n        v-model=\"editDialog\"\n        transition=\"scale-transition\"\n        max-width=\"500px\"\n      >\n        <v-card height=\"500px\">\n          <v-toolbar\n            color=\"primary\"\n            dark\n          >\n            <v-toolbar-title>\n              Edit Location\n            </v-toolbar-title>\n            <v-spacer></v-spacer>\n            <v-icon\n              @click=\"editDialog = false\"\n              style=\"cursor: pointer\"\n            >close</v-icon>\n          </v-toolbar>\n          <v-card-text>\n            <v-layout column>\n              <v-flex>\n                <v-text-field\n                  v-model=\"editLocationName\"\n                  @blur=\"$v.editLocationName.$touch()\"\n                  @change=\"$v.editLocationName.$touch()\"\n                  :error-messages=\"editLocationNameErrors\"\n                  required\n                  label=\"Facility\"\n                >\n                </v-text-field>\n              </v-flex>\n              <v-flex>\n                <v-select\n                  :items=\"editParents\"\n                  v-model=\"editLocationParent\"\n                  box\n                  label=\"Parent\"\n                ></v-select>\n              </v-flex>\n            </v-layout>\n          </v-card-text>\n        </v-card>\n        <v-layout column>\n          <v-flex>\n            <v-toolbar>\n              <v-layout\n                row\n                wrap\n              >\n                <v-flex\n                  xs6\n                  text-sm-left\n                >\n                  <v-btn\n                    color=\"error\"\n                    @click.native=\"editDialog = false\"\n                  >\n                    <v-icon left>cancel</v-icon> Cancel\n                  </v-btn>\n                </v-flex>\n                <v-flex\n                  xs6\n                  text-sm-right\n                >\n                  <v-btn\n                    color=\"primary\"\n                    :disabled=\"$v.$invalid\"\n                    dark\n                    @click=\"saveEdit()\"\n                  >\n                    <v-icon left>save</v-icon>Save\n                  </v-btn>\n                </v-flex>\n              </v-layout>\n            </v-toolbar>\n          </v-flex>\n        </v-layout>\n      </v-dialog>\n      <v-row>\n        <v-spacer></v-spacer>\n        <v-tooltip top>\n          <template v-slot:activator=\"{ on }\">\n            <v-btn\n              class=\"mx-1\"\n              fab\n              dark\n              x-small\n              color=\"primary\"\n              @click=\"helpDialog = true\"\n              v-on=\"on\"\n            >\n              <v-icon>mdi-help</v-icon>\n            </v-btn>\n          </template>\n          <span>Help</span>\n        </v-tooltip>\n      </v-row>\n      <v-layout\n        row\n        wrap\n      >\n        <v-flex xs6>\n          <v-card>\n            <v-card-title primary-title>\n              <h3 class=\"headline mb-0\">Source 1 Data Tree</h3>\n            </v-card-title>\n            <template v-if=\"loadingSource1Tree\">\n              <v-progress-linear :indeterminate=\"true\"></v-progress-linear>\n            </template>\n            <template v-else>\n              <v-card-text>\n                <p>\n                  <liquor-tree\n                    @node:selected=\"source1NodeSelected\"\n                    :data=\"source1Tree\"\n                    :options=\"{}\"\n                    ref=\"source1Tree\"\n                  />\n                </p>\n              </v-card-text>\n            </template>\n          </v-card>\n        </v-flex>\n        <v-flex xs6>\n          <v-card>\n            <v-card-title primary-title>\n              <h3 class=\"headline mb-0\">Source 2 Data Tree</h3>\n            </v-card-title>\n            <template v-if=\"loadingSource2Tree\">\n              <v-progress-linear :indeterminate=\"true\"></v-progress-linear>\n            </template>\n            <template v-else>\n              <v-card-text>\n                <p>\n                  <liquor-tree\n                    @node:selected=\"source2NodeSelected\"\n                    :data=\"source2Tree\"\n                    :options=\"{}\"\n                    ref=\"source2Tree\"\n                  />\n                </p>\n              </v-card-text>\n            </template>\n          </v-card>\n        </v-flex>\n        <v-flex xs6>\n          <v-card>\n            <v-card-title primary-title>\n              <h3 class=\"headline mb-0\">Source 1 Data Grid</h3>\n            </v-card-title>\n            <template v-if=\"loadingSource1Grid\">\n              <v-progress-linear :indeterminate=\"true\"></v-progress-linear>\n            </template>\n            <template v-else>\n              <!-- <v-card-title>\n                <v-text-field\n                  v-model=\"searchSource1\"\n                  append-icon=\"search\"\n                  label=\"Search\"\n                  single-line\n                  hide-details\n                ></v-text-field>\n              </v-card-title> -->\n              <v-card-text>\n                <v-data-table\n                  :headers=\"source1GridHeader\"\n                  :items=\"source1Grid\"\n                  :search=\"searchSource1\"\n                  :options=\"source1Pagination\"\n                  :server-items-length=\"totalSource1Records\"\n                  :loading=\"loadingSource1\"\n                  hide-default-footer\n                  class=\"elevation-1\"\n                >\n                  <template\n                    slot=\"items\"\n                    slot-scope=\"props\"\n                  >\n                    <td\n                      v-for='(header, key) in source1GridHeader'\n                      style=\"white-space:nowrap;overflow: hidden;\"\n                      :key=\"header.value + 1\"\n                    >\n                      <template v-if=\"key === 0 && isDataset1Owner\">\n                        <v-icon\n                          @click=\"edit(props.item, 'source1')\"\n                          style=\"cursor: pointer\"\n                        >edit</v-icon> |\n                        <v-icon\n                          @click=\"deleteLocation(props.item, 'source1', 'requestConfirmation')\"\n                          style=\"cursor: pointer\"\n                        >delete</v-icon>\n                      </template>\n                      <template v-else>\n                        {{props.item[header.value]}}\n                      </template>\n                    </td>\n                  </template>\n                </v-data-table>\n              </v-card-text>\n              <div class=\"text-xs-center pt-2\">\n                <v-pagination\n                  v-model=\"source1Pagination.page\"\n                  :length=\"source1Pages\"\n                ></v-pagination>\n              </div>\n            </template>\n          </v-card>\n        </v-flex>\n        <v-flex xs6>\n          <v-card>\n            <v-card-title primary-title>\n              <h3 class=\"headline mb-0\">Source 2 Data Grid</h3>\n            </v-card-title>\n            <template v-if=\"loadingSource2Grid\">\n              <v-progress-linear :indeterminate=\"true\"></v-progress-linear>\n            </template>\n            <template v-else>\n              <!-- <v-card-title>\n                <v-text-field\n                  v-model=\"searchSource2\"\n                  append-icon=\"search\"\n                  label=\"Search\"\n                  single-line\n                  hide-details\n                ></v-text-field>\n              </v-card-title> -->\n              <v-card-text>\n                <v-data-table\n                  :headers=\"source2GridHeader\"\n                  :items=\"source2Grid\"\n                  :search=\"searchSource2\"\n                  :options=\"source2Pagination\"\n                  :server-items-length=\"totalSource2Records\"\n                  :loading=\"loadingSource2\"\n                  hide-default-footer\n                  class=\"elevation-1\"\n                >\n                  <template\n                    slot=\"items\"\n                    slot-scope=\"props\"\n                  >\n                    <td\n                      v-for='(header, key) in source2GridHeader'\n                      style=\"white-space:nowrap;overflow: hidden;\"\n                      :key=\"header.value + 2\"\n                    >\n                      <template v-if=\"key === 0 && isDataset2Owner\">\n                        <v-icon\n                          @click=\"edit(props.item, 'source2')\"\n                          style=\"cursor: pointer\"\n                        >edit</v-icon> |\n                        <v-icon\n                          @click=\"deleteLocation(props.item, 'source2', 'requestConfirmation')\"\n                          style=\"cursor: pointer\"\n                        >delete</v-icon>\n                      </template>\n                      <template v-else>\n                        {{props.item[header.value]}}\n                      </template>\n                    </td>\n                  </template>\n                </v-data-table>\n              </v-card-text>\n              <div class=\"text-xs-center pt-2\">\n                <v-pagination\n                  v-model=\"source2Pagination.page\"\n                  :length=\"source2Pages\"\n                ></v-pagination>\n              </div>\n            </template>\n          </v-card>\n        </v-flex>\n      </v-layout>\n      <br>\n      <v-layout\n        row\n        wrap\n      >\n        <v-flex\n          xs1\n          xl10\n        >\n          <v-btn\n            color=\"primary\"\n            dark\n            @click='$router.push({name:\"FacilityReconScores\"})'\n          >\n            <v-icon left>mdi-file-find</v-icon>\n            Reconcile\n          </v-btn>\n        </v-flex>\n      </v-layout>\n    </template>\n  </v-container>\n</template>\n\n<script scoped>\nimport LiquorTree from 'liquor-tree'\nimport axios from 'axios'\nimport { required } from 'vuelidate/lib/validators'\nimport { scoresMixin } from '../mixins/scoresMixin'\nimport { generalMixin } from '../mixins/generalMixin'\n\nexport default {\n  validations: {\n    editLocationName: { required }\n  },\n  mixins: [scoresMixin, generalMixin],\n  data () {\n    return {\n      confirmDelete: false,\n      deleteLocationData: '',\n      deleteSource: {\n        name: '',\n        value: ''\n      },\n      editDialog: false,\n      editLocationName: '',\n      editLocationId: '',\n      editParents: [],\n      editLocationParent: '',\n      editSource: '',\n      helpDialog: false,\n      lastLevel: [],\n      headerText: {\n        level2: 'Level 1',\n        level3: 'Level 2',\n        level4: 'Level 3',\n        level5: 'Level 4',\n        level6: 'Level 5',\n        level7: 'Level 6',\n        level8: 'Level 7',\n        level9: 'Level 8',\n        level10: 'Level 9',\n        facility: 'Facility',\n        latitude: 'Latitude',\n        longitude: 'Longitude'\n      },\n      headers: [\n        { text: 'Level 1', value: 'level1' },\n        { text: 'Level 2', value: 'level2' },\n        { text: 'Level 3', value: 'level3' },\n        { text: 'Level 4', value: 'level4' },\n        { text: 'Facility', value: 'facility' },\n        { text: 'Latitude', value: 'latitude' },\n        { text: 'Longitude', value: 'longitude' }\n      ],\n      searchSource1: '',\n      searchSource2: '',\n      filterSource1: { text: '', level: '' },\n      filterSource2: { text: '', level: '' },\n      source2Pagination: { rowsPerPage: 20 },\n      source1Pagination: { rowsPerPage: 20 },\n      loadingSource1: false,\n      loadingSource2: false,\n      totalSource1Records: 0,\n      totalSource2Records: 0,\n      source2Grid: [],\n      source1Grid: [],\n      source1Tree: [],\n      source2Tree: [],\n      source1Start: 1,\n      source2Start: 1,\n      source1Count: 10,\n      source2Count: 10,\n      loadingSource1Tree: false,\n      loadingSource2Tree: false,\n      loadingSource1Grid: false,\n      loadingSource2Grid: false,\n      currentSource2Pagination: {},\n      currentSource1Pagination: {},\n      source1SelNodeId: false,\n      source2SelNodeId: false,\n      sourceOwner: ''\n    }\n  },\n  methods: {\n    edit (data, source) {\n      let sourcesOwner = this.getDatasourceOwner()\n      if (source === 'source1') {\n        this.sourceOwner = sourcesOwner.source1Owner\n        this.editSource = this.source1\n      } else if (source === 'source2') {\n        this.sourceOwner = sourcesOwner.source1Owner\n        this.editSource = this.source2\n      }\n      this.editLocationName = data.facility\n      this.editLocationId = data.id\n      this.editDialog = true\n      let length = Object.keys(this.source2GridHeader).length\n      let levelNextFacility = this.source2GridHeader[length - 1].value\n      this.editLocationParent = data[levelNextFacility + 'id']\n      let level = levelNextFacility.replace('level', '')\n      this.getLevelData(level)\n    },\n    saveEdit () {\n      let formData = new FormData()\n      formData.append('sourceOwner', this.sourceOwner)\n      formData.append('source', this.editSource)\n      formData.append('locationId', this.editLocationId)\n      formData.append('locationName', this.editLocationName)\n      formData.append('locationParent', this.editLocationParent)\n      axios.post('/editLocation', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(() => {\n        this.editDialog = false\n        this.getSource1Grid(false)\n        this.getSource2Grid(false)\n        this.getTree()\n      }).catch((err) => {\n        console.log(JSON.stringify(err))\n      })\n    },\n    deleteLocation (location, source, stage) {\n      if (stage === 'requestConfirmation') {\n        let sourcesOwner = this.getDatasourceOwner()\n        if (source === 'source1') {\n          this.sourceOwner = sourcesOwner.source1Owner\n          this.deleteSource = {\n            name: 'source1',\n            sourceId: this.$store.state.activePair.source1.id,\n            sourceName: this.source1\n          }\n        } else if (source === 'source2') {\n          this.sourceOwner = sourcesOwner.source2Owner\n          this.deleteSource = {\n            name: 'source2',\n            sourceId: this.$store.state.activePair.source2.id,\n            sourceName: this.source2\n          }\n        }\n        this.deleteLocationData = location\n        this.confirmDelete = true\n      } else {\n        this.confirmDelete = false\n        let userID = this.$store.state.activePair.userID._id\n        let query = `id=${this.deleteLocationData.id}&sourceId=${this.deleteSource.sourceId}&sourceName=${this.deleteSource.sourceName}&userID=${userID}&sourceOwner=${this.sourceOwner}`\n        axios.delete(`/deleteLocation?${query}`).then(() => {\n          if (this.deleteSource.name === 'source1') {\n            this.getSource1Grid(false)\n          } else {\n            this.getSource2Grid(false)\n          }\n        })\n      }\n    },\n    getLevelData (level) {\n      axios.get('/getLevelData/' + this.editSource + '/' + this.sourceOwner + '/' + level).then((data) => {\n        this.editParents = data.data\n      })\n    },\n    getSource1Grid (id) {\n      if (!this.source1) {\n        return\n      }\n      this.loadingSource1 = true\n      if (!id) {\n        id = ''\n      }\n      this.loadingSource1Grid = true\n      let source1Owner = this.getDatasourceOwner().source1Owner\n      let source1LimitOrgId = this.getLimitOrgIdOnActivePair().source1LimitOrgId\n      let userID = this.$store.state.activePair.userID._id\n      let path = `/hierarchy?source=${this.source1}&start=${this.source1Start}&count=${this.source1Count}&id=${id}&userID=${userID}&sourceOwner=${source1Owner}&sourceLimitOrgId=${source1LimitOrgId}`\n      axios.get(path).then((hierarchy) => {\n        this.loadingSource1Grid = false\n        if (hierarchy.data) {\n          const { sortBy, descending } = this.source1Pagination\n          if (this.source1Pagination.sortBy) {\n            hierarchy.data.tree = hierarchy.data.grid.sort((a, b) => {\n              const sortA = a[sortBy]\n              const sortB = b[sortBy]\n\n              if (descending) {\n                if (sortA < sortB) return 1\n                if (sortA > sortB) return -1\n                return 0\n              } else {\n                if (sortA < sortB) return -1\n                if (sortA > sortB) return 1\n                return 0\n              }\n            })\n          }\n          this.source1Grid = hierarchy.data.grid\n          this.totalSource1Records = hierarchy.data.total\n          this.source1Pagination.totalItems = hierarchy.data.total\n          // set these values to stop reloading data due to watcher see that the var source2Pagination has changed\n          this.currentSource1Pagination = Object.assign({}, this.source1Pagination)\n          if (!this.currentSource1Pagination.hasOwnProperty('descending')) {\n            this.currentSource1Pagination.descending = false\n          }\n          if (!this.currentSource1Pagination.hasOwnProperty('page')) {\n            this.currentSource1Pagination.page = 1\n          }\n          if (!this.currentSource1Pagination.hasOwnProperty('sortBy')) {\n            this.currentSource1Pagination.sortBy = 'facility'\n          }\n          if (!this.currentSource1Pagination.hasOwnProperty('totalItems')) {\n            this.currentSource1Pagination.totalItems = hierarchy.data.total\n          }\n        }\n        this.loadingSource1 = false\n      })\n    },\n    getSource2Grid (id) {\n      if (!this.source2) {\n        return\n      }\n      if (!id) {\n        id = ''\n      }\n      this.loadingSource2 = true\n      this.loadingSource2Grid = true\n      let source2Owner = this.getDatasourceOwner().source2Owner\n      let source2LimitOrgId = this.getLimitOrgIdOnActivePair().source2LimitOrgId\n      let userID = this.$store.state.activePair.userID._id\n      let path = `/hierarchy?source=${this.source2}&start=${this.source2Start}&count=${this.source2Count}&id=${id}&userID=${userID}&sourceOwner=${source2Owner}&sourceLimitOrgId=${source2LimitOrgId}`\n      axios.get(path).then((hierarchy) => {\n        this.loadingSource2Grid = false\n        if (hierarchy.data) {\n          const { sortBy, descending } = this.source2Pagination\n          if (this.source2Pagination.sortBy) {\n            hierarchy.data.tree = hierarchy.data.grid.sort((a, b) => {\n              const sortA = a[sortBy]\n              const sortB = b[sortBy]\n\n              if (descending) {\n                if (sortA < sortB) return 1\n                if (sortA > sortB) return -1\n                return 0\n              } else {\n                if (sortA < sortB) return -1\n                if (sortA > sortB) return 1\n                return 0\n              }\n            })\n          }\n          this.source2Grid = hierarchy.data.grid\n          this.totalSource2Records = hierarchy.data.total\n          this.source2Pagination.totalItems = hierarchy.data.total\n\n          // set these values to stop reloading data due to watcher see that the var source2Pagination has changed\n          this.currentSource2Pagination = Object.assign({}, this.source2Pagination)\n          if (!this.currentSource2Pagination.hasOwnProperty('descending')) {\n            this.currentSource2Pagination.descending = false\n          }\n          if (!this.currentSource2Pagination.hasOwnProperty('page')) {\n            this.currentSource2Pagination.page = 1\n          }\n          if (!this.currentSource2Pagination.hasOwnProperty('sortBy')) {\n            this.currentSource2Pagination.sortBy = 'facility'\n          }\n          if (!this.currentSource2Pagination.hasOwnProperty('totalItems')) {\n            this.currentSource2Pagination.totalItems = hierarchy.data.total\n          }\n        }\n        this.loadingSource2 = false\n      })\n    },\n    getTree () {\n      if (!this.source1 || !this.source2) {\n        return\n      }\n      let source2Owner = this.getDatasourceOwner().source2Owner\n      let source2LimitOrgId = this.getLimitOrgIdOnActivePair().source2LimitOrgId\n      this.loadingSource2Tree = true\n      axios.get('/getTree/' + this.source2 + '/' + source2Owner + '/' + source2LimitOrgId).then((hierarchy) => {\n        this.loadingSource2Tree = false\n        if (hierarchy.data) {\n          this.source2Tree = hierarchy.data\n        }\n      })\n      let source1Owner = this.getDatasourceOwner().source1Owner\n      let source1LimitOrgId = this.getLimitOrgIdOnActivePair().source1LimitOrgId\n      this.loadingSource1Tree = true\n      axios.get('/getTree/' + this.source1 + '/' + source1Owner + '/' + source1LimitOrgId).then((hierarchy) => {\n        this.loadingSource1Tree = false\n        if (hierarchy.data) {\n          this.source1Tree = hierarchy.data\n        }\n      })\n    },\n    source1NodeSelected (node) {\n      this.source1SelNodeId = node.id\n      this.getSource1Grid(node.id)\n    },\n    source2NodeSelected (node) {\n      this.source2SelNodeId = node.id\n      this.getSource2Grid(node.id)\n    }\n  },\n  computed: {\n    isDataset1Owner () {\n      let source1Owner = this.getDatasourceOwner().source1Owner\n      let userID = this.$store.state.auth.userID\n      if (source1Owner !== userID) {\n        return false\n      }\n      return true\n    },\n    isDataset2Owner () {\n      let source2Owner = this.getDatasourceOwner().source2Owner\n      let userID = this.$store.state.auth.userID\n      if (source2Owner !== userID) {\n        return false\n      }\n      return true\n    },\n    source2GridHeader () {\n      let header = []\n      if (this.isDataset2Owner) {\n        header.push({\n          text: '',\n          value: '',\n          sortable: false\n        })\n      }\n      let gridWithAllHeaders = {}\n      if (this.source2Grid && this.source2Grid.length > 0) {\n        for (var grid in this.source2Grid) {\n          if (gridWithAllHeaders.length > 0 && this.source2Grid[grid].length > Object.keys(gridWithAllHeaders).length) {\n            gridWithAllHeaders = this.source2Grid[grid]\n          } else if (Object.keys(gridWithAllHeaders).length === 0) {\n            gridWithAllHeaders = this.source2Grid[grid]\n          }\n        }\n      }\n      for (const key in gridWithAllHeaders) {\n        if (this.headerText[key]) {\n          header.push({ text: this.headerText[key], value: key })\n        }\n      }\n      return header\n    },\n    source1GridHeader () {\n      let header = []\n      if (this.isDataset1Owner) {\n        header.push({\n          text: '',\n          value: '',\n          sortable: false\n        })\n      }\n      let gridWithAllHeaders = {}\n      if (this.source1Grid && this.source1Grid.length > 0) {\n        for (var grid in this.source1Grid) {\n          if (gridWithAllHeaders.length > 0 && this.source1Grid[grid].length > Object.keys(gridWithAllHeaders).length) {\n            gridWithAllHeaders = this.source1Grid[grid]\n          } else if (Object.keys(gridWithAllHeaders).length === 0) {\n            gridWithAllHeaders = this.source1Grid[grid]\n          }\n        }\n      }\n      if (this.source1Grid && this.source1Grid.length > 0) {\n        for (const key in this.source1Grid[0]) {\n          if (this.headerText[key]) {\n            header.push({ text: this.headerText[key], value: key })\n          }\n        }\n      }\n      return header\n    },\n    source2Pages () {\n      if (this.source2Pagination.rowsPerPage == null || this.source2Pagination.totalItems == null) {\n        return 0\n      }\n      return Math.ceil(this.source2Pagination.totalItems / this.source2Count)\n    },\n    source1Pages () {\n      if (this.source1Pagination.rowsPerPage == null || this.source1Pagination.totalItems == null) {\n        return 0\n      }\n      return Math.ceil(this.source1Pagination.totalItems / this.source1Count)\n    },\n    source1 () {\n      let source = this.$store.state.activePair.source1.name\n      if (source) {\n        source = this.toTitleCase(source)\n      }\n      return source\n    },\n    source2 () {\n      let source = this.$store.state.activePair.source2.name\n      if (source) {\n        source = this.toTitleCase(source)\n      }\n      return source\n    },\n    editLocationNameErrors () {\n      const errors = []\n      if (!this.$v.editLocationName.$dirty) return errors\n      !this.$v.editLocationName.required && errors.push('Facility Name is required')\n      return errors\n    }\n  },\n  watch: {\n    source1Pagination: {\n      handler () {\n        // if nothing has changed then dont send server request\n        if (this.currentSource1Pagination.sortBy === this.source1Pagination.sortBy &&\n          this.currentSource1Pagination.descending === this.source1Pagination.descending &&\n          this.currentSource1Pagination.page === this.source1Pagination.page\n        ) {\n          return\n        }\n        let page = this.source1Pagination.page - 1\n        this.source1Start = page * this.source1Count + 1\n        this.getSource1Grid(this.source1SelNodeId)\n      },\n      deep: true\n    },\n    source2Pagination: {\n      handler () {\n        // if nothing has changed then dont send server request\n        if (this.currentSource2Pagination.sortBy === this.source2Pagination.sortBy &&\n          this.currentSource2Pagination.descending === this.source2Pagination.descending &&\n          this.currentSource2Pagination.page === this.source2Pagination.page\n        ) {\n          return\n        }\n        let page = this.source2Pagination.page - 1\n        this.source2Start = page * this.source2Count + 1\n        this.getSource2Grid(this.source2SelNodeId)\n      },\n      deep: true\n    }\n  },\n  mounted () {\n    this.getSource1Grid(false)\n    this.getSource2Grid(false)\n    this.getTree()\n  },\n  components: {\n    'liquor-tree': LiquorTree\n  }\n}\n</script>\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh1,\nh2 {\n  font-weight: normal;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n</style>\n"]}]}