{"remainingRequest":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/facility-recon-gui/src/components/ihris/ihris-questionnaire.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/facility-recon-gui/src/components/ihris/ihris-questionnaire.vue","mtime":1619258043467},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IHF1ZXJ5c3RyaW5nID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKQpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImlocmlzLXF1ZXN0aW9ubmFpcmUiLAogIHByb3BzOiBbImlkIiwgInVybCIsICJ0aXRsZSIsICJkZXNjcmlwdGlvbiIsICJwdXJwb3NlIiwgInNlY3Rpb24tbWVudSIsICJ2aWV3LXBhZ2UiLCAiZWRpdCIsICJjb25zdHJhaW50cyJdLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgZmhpcjoge30sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBvdmVybGF5OiBmYWxzZSwKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgdmFsaWQ6IHRydWUsCiAgICAgIGFkdmFuY2VkVmFsaWQ6IHRydWUKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgLy9jb25zb2xlLmxvZygiUVVFUlkiLHRoaXMuJHJvdXRlLnF1ZXJ5KQogIH0sCiAgbWV0aG9kczogewogICAgcHJvY2Vzc0ZISVI6IGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKQogICAgICBpZiAoICF0aGlzLnZhbGlkICkgcmV0dXJuCiAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IHRydWUKICAgICAgdGhpcy5vdmVybGF5ID0gdHJ1ZQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCgogICAgICBjb25zdCBwcm9jZXNzQ2hpbGRyZW4gPSBhc3luYyAoIG9iaiwgY2hpbGRyZW4sIGl0ZW1NYXAgKSA9PiB7CiAgICAgICAgLy9jb25zb2xlLmxvZygiY2FsbGVkIG9uICIrcGFyZW50KQogICAgICAgIGlmICggIWl0ZW1NYXAgKSBpdGVtTWFwID0ge30KCiAgICAgICAgZm9yICggbGV0IGNoaWxkIG9mIGNoaWxkcmVuICkgewoKICAgICAgICAgIGxldCBuZXh0ID0gb2JqCiAgICAgICAgICBsZXQgbXlJdGVtTWFwID0ge30KCiAgICAgICAgICBpZiAoIGNoaWxkLmlzQXJyYXkgKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIkFSUkFZIiwgY2hpbGQucGF0aCkKICAgICAgICAgIH0gZWxzZSBpZiAoIGNoaWxkLmlzUXVlc3Rpb25uYWlyZUdyb3VwICkgewogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJHUk9VUCIsIGNoaWxkLnBhdGgpCiAgICAgICAgICAgIGxldCBzZWN0aW9uID0geyBsaW5rSWQ6IGNoaWxkLnBhdGgsIHRleHQ6IGNoaWxkLmxhYmVsLCBpdGVtOiBbXSB9IAogICAgICAgICAgICBuZXh0LnB1c2goIHNlY3Rpb24gKQogICAgICAgICAgICBuZXh0ID0gc2VjdGlvbi5pdGVtCiAgICAgICAgICB9IGVsc2UgaWYgKCBjaGlsZC5xRmllbGQgKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIlBST0NFU1MiLHBhdGgsY2hpbGQucUZpZWxkLGNoaWxkLnZhbHVlKQogICAgICAgICAgICBsZXQgaXRlbQogICAgICAgICAgICBpZiAoIGl0ZW1NYXAuaGFzT3duUHJvcGVydHkoIGNoaWxkLnBhdGggKSApIHsKICAgICAgICAgICAgICBpdGVtID0gaXRlbU1hcFsgY2hpbGQucGF0aCBdCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaXRlbSA9IHsgbGlua0lkOiBjaGlsZC5wYXRoLCBhbnN3ZXI6IFtdIH0KICAgICAgICAgICAgICBpdGVtTWFwW2NoaWxkLnBhdGhdID0gaXRlbQogICAgICAgICAgICAgIG5leHQucHVzaCggaXRlbSApCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGFuc3dlciA9IHt9CiAgICAgICAgICAgIGFuc3dlcltjaGlsZC5xRmllbGRdID0gY2hpbGQudmFsdWUKICAgICAgICAgICAgaXRlbS5hbnN3ZXIucHVzaCggYW5zd2VyICkKICAgICAgICAgICAgaWYgKCBjaGlsZC5jb25zdHJhaW50cyApIHsKICAgICAgICAgICAgICBjaGlsZC5lcnJvcnMgPSBbXQogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0aGlzLmFkdmFuY2VkVmFsaWQgPSB0aGlzLmFkdmFuY2VkVmFsaWQgJiYgYXdhaXQgdGhpcy4kZmhpcnV0aWxzLmNoZWNrQ29uc3RyYWludHMoIGNoaWxkLmNvbnN0cmFpbnRzLCAKICAgICAgICAgICAgICAgICAgdGhpcy5jb25zdHJhaW50cywgY2hpbGQudmFsdWUsIGNoaWxkLmVycm9ycyApCiAgICAgICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gZmFsc2UKICAgICAgICAgICAgICAgIGNoaWxkLmVycm9ycy5wdXNoKCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkLiIpCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCBjaGlsZC4kY2hpbGRyZW4gKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIlBST0NFU1NJTkcgQ0hJTERSRU4gT0YiLGNoaWxkLnBhdGgpCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgYXdhaXQgcHJvY2Vzc0NoaWxkcmVuKCBuZXh0LCBjaGlsZC4kY2hpbGRyZW4sIG15SXRlbU1hcCApCiAgICAgICAgICAgIH0gY2F0Y2goIGVyciApIHsKICAgICAgICAgICAgICB0aGlzLmFkdmFuY2VkVmFsaWQgPSBmYWxzZQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgICAgICAgfQoKICAgICAgICAgIH0gCiAgICAgICAgICBpZiAoIGNoaWxkLmlzUXVlc3Rpb25uYWlyZUdyb3VwICYmIGNoaWxkLmNvbnN0cmFpbnRzICkgewogICAgICAgICAgICBjaGlsZC5lcnJvcnMgPSBbXQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IHRoaXMuYWR2YW5jZWRWYWxpZCAmJiBhd2FpdCB0aGlzLiRmaGlydXRpbHMuY2hlY2tDb25zdHJhaW50cyggY2hpbGQuY29uc3RyYWludHMsIAogICAgICAgICAgICAgICAgdGhpcy5jb25zdHJhaW50cywgbmV4dCwgY2hpbGQuZXJyb3JzICkKICAgICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IGZhbHNlCiAgICAgICAgICAgICAgY2hpbGQuZXJyb3JzLnB1c2goIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuIikKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCgogICAgICAgIH0KCiAgICAgIH0KCgogICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZmllbGQpCiAgICAgIHRoaXMuZmhpciA9IHsgCiAgICAgICAgcmVzb3VyY2VUeXBlOiAiUXVlc3Rpb25uYWlyZVJlc3BvbnNlIiwKICAgICAgICBxdWVzdGlvbm5haXJlOiB0aGlzLnVybCwKICAgICAgICBzdGF0dXM6ICJjb21wbGV0ZWQiLAogICAgICAgIGl0ZW06IFtdCiAgICAgIH0KICAgICAgLy9jb25zb2xlLmxvZyh0aGlzKQogICAgICB0cnkgewogICAgICAgIGF3YWl0IHByb2Nlc3NDaGlsZHJlbiggdGhpcy5maGlyLml0ZW0sIHRoaXMuJGNoaWxkcmVuICkKICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IGZhbHNlCiAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICB9CiAgICAgIGlmICggIXRoaXMuYWR2YW5jZWRWYWxpZCApIHsKICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRNZXNzYWdlJywgeyB0eXBlOiAnZXJyb3InLCB0ZXh0OiAnVGhlcmUgd2VyZSBlcnJvcnMgb24gdGhlIGZvcm0uJyB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCJTQVZFIix0aGlzLmZoaXIpCiAgICAgIGZldGNoKCAiL2ZoaXIvUXVlc3Rpb25uYWlyZVJlc3BvbnNlPyIrcXVlcnlzdHJpbmcuc3RyaW5naWZ5KCB0aGlzLiRyb3V0ZS5xdWVyeSApLCB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9maGlyK2pzb24iCiAgICAgICAgfSwKICAgICAgICByZWRpcmVjdDogJ21hbnVhbCcsCiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodGhpcy5maGlyKQogICAgICB9ICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSkKICAgICAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlLmhlYWRlcnMpCiAgICAgICAgaWYgKCByZXNwb25zZS5zdGF0dXMgPT09IDIwMSApIHsKICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKGRhdGEgPT4gewogICAgICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICBsZXQgc3ViamVjdAogICAgICAgICAgICBpZiAoIHRoaXMudmlld1BhZ2UgKSB7CiAgICAgICAgICAgICAgaWYgKCBkYXRhLm1ldGEudGFnICkgewogICAgICAgICAgICAgICAgbGV0IHJlZGlyZWN0ID0gZGF0YS5tZXRhLnRhZy5maW5kKCB0YWcgPT4gdGFnLnN5c3RlbSA9PT0gImh0dHA6Ly9paHJpcy5vcmcvZmhpci90YWdzL3Jlc291cmNlIiApCiAgICAgICAgICAgICAgICBpZiAoIHJlZGlyZWN0ICYmIHJlZGlyZWN0LmNvZGUgKSB7CiAgICAgICAgICAgICAgICAgIHN1YmplY3QgPSByZWRpcmVjdC5jb2RlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICBpZiAoICFzdWJqZWN0ICYmIGRhdGEuc3ViamVjdCAmJiBkYXRhLnN1YmplY3QucmVmZXJlbmNlICkgewogICAgICAgICAgICAgICAgc3ViamVjdCA9IGRhdGEuc3ViamVjdC5yZWZlcmVuY2UKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCBzdWJqZWN0ICkgewogICAgICAgICAgICAgICAgbGV0IHZpZXdQYWdlSWQgPSBzdWJqZWN0LnNwbGl0KCcvJykKICAgICAgICAgICAgICAgIGlmICggdmlld1BhZ2VJZFsxXSApIHsKICAgICAgICAgICAgICAgICAgdmlld1BhZ2VJZCA9IHZpZXdQYWdlSWRbMV0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHZpZXdQYWdlSWQgPSBzdWJqZWN0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6InJlc291cmNlX3ZpZXciLCBwYXJhbXM6IHtwYWdlOiB0aGlzLnZpZXdQYWdlLCBpZDogdmlld1BhZ2VJZCB9IH0pCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICggIXN1YmplY3QgKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiJob21lIiB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSkKICAgICAgICAgIH0pCiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldE1lc3NhZ2UnLCB7IHR5cGU6ICdzdWNjZXNzJywgdGV4dDogJ1VwZGF0ZSBzdWNjZXNzZnVsLicgfSApCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMub3ZlcmxheSA9IGZhbHNlCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICAgIGxldCBlcnJvcnMKICAgICAgICAgICAgaWYgKCBkYXRhLnJlc291cmNlVHlwZSA9PSAiT3BlcmF0aW9uT3V0Y29tZSIgKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGVycm9ycyA9IEFycmF5LmZyb20obmV3IFNldChkYXRhLmlzc3VlLm1hcCggaXNzdWUgPT4gaXNzdWUuZGlhZ25vc3RpY3MgKSkpLmpvaW4oIiwgIikKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcmV0cmlldmUgZXJyb3JzIGZyb20gIixkYXRhKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBlcnJvcnMgPSAiVW5rbm93biIKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldE1lc3NhZ2UnLCB7IHR5cGU6ICdlcnJvcicsIHRleHQ6ICdBbiBlcnJvciBvY2N1cnJlZCB0cnlpbmcgdG8gc2F2ZSB0aGlzIHJlY29yZDogJytlcnJvcnMgfSkKICAgICAgICAgIH0gKS5jYXRjaCggZXJyID0+IHsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRNZXNzYWdlJywgeyB0eXBlOiAnZXJyb3InLCB0ZXh0OiAnQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB0cnlpbmcgdG8gc2F2ZSB0aGlzIHJlY29yZC4nIH0pCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBvbiByZXRyaWV2aW5nIGVycm9yIHN0YXR1cyIsZXJyKQogICAgICAgICAgfSApCiAgICAgICAgfQogICAgICB9ICkuY2F0Y2goZXJyID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2UKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0TWVzc2FnZScsIHsgdHlwZTogJ2Vycm9yJywgdGV4dDogJ0ZhaWxlZCB0byB1cGRhdGUgZGF0YS4nIH0gKQogICAgICB9ICkKICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmZoaXIpCgogICAgICAvKgogICAgICBjb25zb2xlLmxvZyh0aGlzLiRzY29wZWRTbG90cy5kZWZhdWx0KCkpCiAgICAgIHByb2Nlc3NTbG90cyggdGhpcy5maWVsZCwgdGhpcy4kc2NvcGVkU2xvdHMuZGVmYXVsdCgpICkKICAgICAgKi8KICAgIH0KICB9Cn0KCgo="},{"version":3,"sources":["ihris-questionnaire.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ihris-questionnaire.vue","sourceRoot":"src/components/ihris","sourcesContent":["<template>\n  <v-container class=\"my-3\">\n\n    <v-form \n      ref=\"form\"\n      v-model=\"valid\"\n    >\n        \n      <slot></slot>\n      <v-overlay :value=\"overlay\">\n        <v-progress-circular\n          size=\"50\"\n          color=\"primary\"\n          indeterminate\n          ></v-progress-circular>\n        <v-btn icon @click=\"overlay = false\"><v-icon>mdi-close</v-icon></v-btn>\n      </v-overlay>\n  \n      <v-navigation-drawer\n        app\n        right\n        permanent\n        clipped\n        class=\"primary darken-1 white--text\"\n        style=\"z-index: 3;\"\n        >\n        <v-list class=\"white--text\">\n          <v-list-item>\n            <v-btn dark class=\"secondary\" @click=\"$router.go(-1)\">\n              <v-icon light>mdi-pencil-off</v-icon>\n              <span>Cancel</span>\n            </v-btn>\n            <v-spacer></v-spacer>\n            <v-btn v-if=\"valid\" dark class=\"success darken-1\" @click=\"processFHIR()\" :disabled=\"!valid\">\n              <v-icon light>mdi-content-save</v-icon>\n              <span>Save</span>\n            </v-btn>\n            <v-btn v-else dark class=\"warning\" @click=\"$refs.form.validate()\">\n              <v-icon light>mdi-content-save</v-icon>\n              <span>Save</span>\n            </v-btn>\n          </v-list-item>\n          <v-divider color=\"white\"></v-divider>\n          <v-subheader class=\"white--text\" v-if=\"sectionMenu\"><h2>Sections</h2></v-subheader>\n          <v-list-item v-for=\"section in sectionMenu\" :href=\"'#section-'+section.id\" :key=\"section.id\">\n            <v-list-item-content class=\"white--text\">\n              <v-list-item-title class=\"text-uppercase\"><h4>{{ section.title }}</h4></v-list-item-title>\n              <v-list-item-subtitle class=\"white--text\">{{ section.desc }}</v-list-item-subtitle>\n            </v-list-item-content>\n          </v-list-item>\n        </v-list>\n  \n      </v-navigation-drawer>\n    </v-form>\n  </v-container>\n\n</template>\n\n<script>\nconst querystring = require('querystring')\nexport default {\n  name: \"ihris-questionnaire\",\n  props: [\"id\", \"url\", \"title\", \"description\", \"purpose\", \"section-menu\", \"view-page\", \"edit\", \"constraints\"],\n  data: function() {\n    return {\n      fhir: {},\n      loading: false,\n      overlay: false,\n      isEdit: false,\n      valid: true,\n      advancedValid: true\n    }\n  },\n  created: function() {\n    //console.log(\"QUERY\",this.$route.query)\n  },\n  methods: {\n    processFHIR: async function() {\n      this.$refs.form.validate()\n      if ( !this.valid ) return\n      this.advancedValid = true\n      this.overlay = true\n      this.loading = true\n\n      const processChildren = async ( obj, children, itemMap ) => {\n        //console.log(\"called on \"+parent)\n        if ( !itemMap ) itemMap = {}\n\n        for ( let child of children ) {\n\n          let next = obj\n          let myItemMap = {}\n\n          if ( child.isArray ) {\n            //console.log(\"ARRAY\", child.path)\n          } else if ( child.isQuestionnaireGroup ) {\n            //console.log(\"GROUP\", child.path)\n            let section = { linkId: child.path, text: child.label, item: [] } \n            next.push( section )\n            next = section.item\n          } else if ( child.qField ) {\n            //console.log(\"PROCESS\",path,child.qField,child.value)\n            let item\n            if ( itemMap.hasOwnProperty( child.path ) ) {\n              item = itemMap[ child.path ]\n            } else {\n              item = { linkId: child.path, answer: [] }\n              itemMap[child.path] = item\n              next.push( item )\n            }\n            let answer = {}\n            answer[child.qField] = child.value\n            item.answer.push( answer )\n            if ( child.constraints ) {\n              child.errors = []\n              try {\n                this.advancedValid = this.advancedValid && await this.$fhirutils.checkConstraints( child.constraints, \n                  this.constraints, child.value, child.errors )\n              } catch( err ) {\n                this.advancedValid = false\n                child.errors.push(\"An unknown error occurred.\")\n                console.log(err)\n              }\n            }\n          }\n\n          if ( child.$children ) {\n            //console.log(\"PROCESSING CHILDREN OF\",child.path)\n            try {\n              await processChildren( next, child.$children, myItemMap )\n            } catch( err ) {\n              this.advancedValid = false\n              console.log(err)\n            }\n\n          } \n          if ( child.isQuestionnaireGroup && child.constraints ) {\n            child.errors = []\n            try {\n              this.advancedValid = this.advancedValid && await this.$fhirutils.checkConstraints( child.constraints, \n                this.constraints, next, child.errors )\n            } catch( err ) {\n              this.advancedValid = false\n              child.errors.push(\"An unknown error occurred.\")\n              console.log(err)\n            }\n          }\n\n\n        }\n\n      }\n\n\n      //console.log(this.field)\n      this.fhir = { \n        resourceType: \"QuestionnaireResponse\",\n        questionnaire: this.url,\n        status: \"completed\",\n        item: []\n      }\n      //console.log(this)\n      try {\n        await processChildren( this.fhir.item, this.$children )\n      } catch( err ) {\n        this.advancedValid = false\n        console.log(err)\n      }\n      if ( !this.advancedValid ) {\n        this.overlay = false\n        this.loading = false\n        this.$store.commit('setMessage', { type: 'error', text: 'There were errors on the form.' })\n        return\n      }\n      console.log(\"SAVE\",this.fhir)\n      fetch( \"/fhir/QuestionnaireResponse?\"+querystring.stringify( this.$route.query ), {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/fhir+json\"\n        },\n        redirect: 'manual',\n        body: JSON.stringify(this.fhir)\n      } ).then(response => {\n        //console.log(response)\n        //console.log(response.headers)\n        if ( response.status === 201 ) {\n          response.json().then(data => {\n            this.overlay = false\n            this.loading = false\n            let subject\n            if ( this.viewPage ) {\n              if ( data.meta.tag ) {\n                let redirect = data.meta.tag.find( tag => tag.system === \"http://ihris.org/fhir/tags/resource\" )\n                if ( redirect && redirect.code ) {\n                  subject = redirect.code\n                }\n              } \n              if ( !subject && data.subject && data.subject.reference ) {\n                subject = data.subject.reference\n              }\n              if ( subject ) {\n                let viewPageId = subject.split('/')\n                if ( viewPageId[1] ) {\n                  viewPageId = viewPageId[1]\n                } else {\n                  viewPageId = subject\n                }\n                this.$router.push({ name:\"resource_view\", params: {page: this.viewPage, id: viewPageId } })\n              }\n            }\n            if ( !subject ) {\n              this.$router.push({ name:\"home\" })\n            }\n            //console.log(data)\n          })\n          this.$store.commit('setMessage', { type: 'success', text: 'Update successful.' } )\n        } else {\n          this.overlay = false\n          this.loading = false\n          response.json().then(data => {\n            let errors\n            if ( data.resourceType == \"OperationOutcome\" ) {\n              try {\n                errors = Array.from(new Set(data.issue.map( issue => issue.diagnostics ))).join(\", \")\n              } catch (err) {\n                console.log(\"Unable to retrieve errors from \",data)\n              }\n            } else {\n              errors = \"Unknown\"\n            }\n            this.$store.commit('setMessage', { type: 'error', text: 'An error occurred trying to save this record: '+errors })\n          } ).catch( err => {\n            this.$store.commit('setMessage', { type: 'error', text: 'An unknown error occurred trying to save this record.' })\n            console.log(\"Error on retrieving error status\",err)\n          } )\n        }\n      } ).catch(err => {\n        console.log(err)\n        this.overlay = false\n        this.loading = false\n        this.$store.commit('setMessage', { type: 'error', text: 'Failed to update data.' } )\n      } )\n      //console.log(this.fhir)\n\n      /*\n      console.log(this.$scopedSlots.default())\n      processSlots( this.field, this.$scopedSlots.default() )\n      */\n    }\n  }\n}\n\n\n</script>\n"]}]}