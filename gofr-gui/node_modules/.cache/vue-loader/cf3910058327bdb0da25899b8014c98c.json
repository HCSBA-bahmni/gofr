{"remainingRequest":"/home/ally/gofr/gofr-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/gofr-gui/src/components/ihris/ihris-resource.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/gofr-gui/src/components/ihris/ihris-resource.vue","mtime":1621965248925},{"path":"/home/ally/gofr/gofr-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/gofr-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/gofr-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/gofr-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJpaHJpcy1yZXNvdXJjZSIsCiAgcHJvcHM6IFsidGl0bGUiLCJmaWVsZCIsImZoaXJJZCIsInBhZ2UiLCJwcm9maWxlIiwic2VjdGlvbi1tZW51IiwiZWRpdCIsImxpbmtzIiwiY29uc3RyYWludHMiIF0sCiAgZGF0YTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gewogICAgICBmaGlyOiB7fSwKICAgICAgb3JpZzoge30sCiAgICAgIHZhbGlkOiB0cnVlLAogICAgICBzb3VyY2U6IHsgZGF0YToge30sIHBhdGg6ICIiIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBvdmVybGF5OiBmYWxzZSwKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgbGlua3RleHQ6IFsgXSwKICAgICAgYWR2YW5jZWRWYWxpZDogdHJ1ZSwKICAgICAgY3VycmVudFJlcXVlc3RTdGF0dXM6ICcnCiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbigpIHsKICAgIGlmICggdGhpcy5maGlySWQgKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgYXhpb3MuZ2V0KCAiL2ZoaXIvIit0aGlzLmZpZWxkKyIvIit0aGlzLmZoaXJJZCApLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YQogICAgICAgIHRoaXMub3JpZyA9IGRhdGEKICAgICAgICB0aGlzLnNvdXJjZSA9IHsgZGF0YTogZGF0YSwgcGF0aDogdGhpcy5maWVsZCB9CiAgICAgICAgdGhpcy5zZXRMaW5rVGV4dCgpCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICBpZihkYXRhLmV4dGVuc2lvbikgewogICAgICAgICAgZm9yKGxldCBleHQgb2YgZGF0YS5leHRlbnNpb24pIHsKICAgICAgICAgICAgaWYoZXh0LnVybCA9PT0gImh0dHA6Ly9nb2ZyLm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vcmVxdWVzdC1zdGF0dXMiKSB7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UmVxdWVzdFN0YXR1cyA9IGV4dC52YWx1ZUNvZGluZy5jb2RlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycj0+IHsKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmZpZWxkLHRoaXMuZmhpcklkLGVycikKICAgICAgfSkKICAgIH0gZWxzZSBpZiAoIHRoaXMuJHJvdXRlLnF1ZXJ5ICkgewogICAgICBsZXQgcHJlc2V0cyA9IHsKICAgICAgICByZXNvdXJjZVR5cGU6IHRoaXMuZmllbGQKICAgICAgfQogICAgICBsZXQgaGFzUHJlc2V0cyA9IGZhbHNlCiAgICAgIGZvciggbGV0IHBhdGggb2YgT2JqZWN0LmtleXMoIHRoaXMuJHJvdXRlLnF1ZXJ5ICkgKSB7CiAgICAgICAgaWYgKCBwYXRoLnN0YXJ0c1dpdGgoIHRoaXMuZmllbGQgKyIuIiApICkgewogICAgICAgICAgaGFzUHJlc2V0cyA9IHRydWUKICAgICAgICAgIGxldCBlbGVtZW50cyA9IHBhdGguc3Vic3RyaW5nKCB0aGlzLmZpZWxkLmxlbmd0aCsxICkuc3BsaXQoJy4nKQogICAgICAgICAgbGV0IGxhc3QgPSBlbGVtZW50cy5wb3AoKQogICAgICAgICAgbGV0IGN1cnJlbnQgPSBwcmVzZXRzCiAgICAgICAgICBmb3IoIGxldCBlbGVtZW50IG9mIGVsZW1lbnRzICkgewogICAgICAgICAgICBpZiAoIGVsZW1lbnQuaW5jbHVkZXMoJ1snKSApIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHBhcnRzID0gZWxlbWVudC5zcGxpdCgnWycpCiAgICAgICAgICAgICAgICBsZXQgbmFtZSA9IHBhcnRzWzBdCiAgICAgICAgICAgICAgICBsZXQgaWR4ID0gcGFydHNbMV0uc2xpY2UoMCwtMSkKICAgICAgICAgICAgICAgIGlmICggIWN1cnJlbnQuaGFzT3duUHJvcGVydHkobmFtZSkgKSB7CiAgICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV0gPSBbXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCBpZHggKSB7CiAgICAgICAgICAgICAgICAgIGxldCBuZXh0ID0ge30KICAgICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXVtwYXJzZUludChpZHgpXSA9IG5leHQKICAgICAgICAgICAgICAgICAgY3VycmVudCA9IG5leHQKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGxldCBuZXh0ID0ge30KICAgICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXS5wdXNoKCBuZXh0ICkKICAgICAgICAgICAgICAgICAgY3VycmVudCA9IG5leHQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoKCBlcnIgKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHByb2Nlc3MiLHBhdGgpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoICFjdXJyZW50Lmhhc093blByb3BlcnR5KGVsZW1lbnQpICkgewogICAgICAgICAgICAgICAgY3VycmVudFtlbGVtZW50XSA9IHt9CiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtlbGVtZW50XQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCBsYXN0LmluY2x1ZGVzKCdbJykgKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgbGV0IHBhcnRzID0gbGFzdC5zcGxpdCgnWycpCiAgICAgICAgICAgICAgbGV0IG5hbWUgPSBwYXJ0c1swXQogICAgICAgICAgICAgIGxldCBpZHggPSBwYXJ0c1sxXS5zbGljZSgwLC0xKQogICAgICAgICAgICAgIGlmICggIWN1cnJlbnQuaGFzT3duUHJvcGVydHkobmFtZSkgKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50W25hbWVdID0gW10KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCBpZHggKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50W25hbWVdW3BhcnNlSW50KGlkeCldID0gdGhpcy4kcm91dGUucXVlcnlbcGF0aF0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXS5wdXNoKCB0aGlzLiRyb3V0ZS5xdWVyeVtwYXRoXSApCiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcHJvY2VzcyIscGF0aCkKICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjdXJyZW50W2xhc3RdID0gdGhpcy4kcm91dGUucXVlcnlbcGF0aF0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCBoYXNQcmVzZXRzICkgewogICAgICAgIHRoaXMuc291cmNlID0geyBkYXRhOiBwcmVzZXRzLCBwYXRoOiB0aGlzLmZpZWxkIH0KICAgICAgfQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGhhc0ZoaXJJZDogZnVuY3Rpb24oKSB7CiAgICAgIGlmICggdGhpcy5maGlySWQgPT0gJycgKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0gZWxzZSBpZiAoICF0aGlzLmZoaXJJZCApIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdHJ1ZQogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBjcmVhdGVVcGRhdGVSZXF1ZXN0KCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKQogICAgICBpZiAoICF0aGlzLnZhbGlkICkgcmV0dXJuCiAgICAgIHRoaXMuZmhpciA9IHsKICAgICAgICByZXNvdXJjZVR5cGU6IHRoaXMuZmllbGQsCiAgICAgICAgbWV0YTogewogICAgICAgICAgcHJvZmlsZTogWyAiaHR0cDovL2dvZnIub3JnL2ZoaXIvU3RydWN0dXJlRGVmaW5pdGlvbi9nb2ZyLWZhY2lsaXR5LXVwZGF0ZS1yZXF1ZXN0IiBdCiAgICAgICAgfQogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzQ2hpbGRyZW4oIHRoaXMuZmllbGQsIHRoaXMuZmhpciwgdGhpcy4kY2hpbGRyZW4gKQogICAgICB9IGNhdGNoKCBlcnIgKSB7CiAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gZmFsc2UKICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgIH0KICAgICAgaWYgKCAhdGhpcy5hZHZhbmNlZFZhbGlkICkgewogICAgICAgIHRoaXMub3ZlcmxheSA9IGZhbHNlCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldE1lc3NhZ2UnLCB7IHR5cGU6ICdlcnJvcicsIHRleHQ6ICdUaGVyZSB3ZXJlIGVycm9ycyBvbiB0aGUgZm9ybS4nIH0pCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgaWYoIXRoaXMuZmhpci5leHRlbnNpb24pIHsKICAgICAgICB0aGlzLmZoaXIuZXh0ZW5zaW9uID0gW10KICAgICAgfQogICAgICB0aGlzLmZoaXIuZXh0ZW5zaW9uLnB1c2goewogICAgICAgIHVybDogImh0dHA6Ly9nb2ZyLm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vcmVxdWVzdC1zdGF0dXMiLAogICAgICAgIHZhbHVlQ29kaW5nOiB7CiAgICAgICAgICBzeXN0ZW06ICJodHRwOi8vZ29mci5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uL3JlcXVlc3Qtc3RhdHVzLWNvZGVzeXN0ZW0iLAogICAgICAgICAgY29kZTogInBlbmRpbmciLAogICAgICAgICAgZGlzcGxheTogIlBlbmRpbmciCiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgInVybCI6ICJodHRwOi8vZ29mci5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uL3JlcXVlc3QtYWZmZWN0ZWQtcmVzb3VyY2UiLAogICAgICAgICJ2YWx1ZVJlZmVyZW5jZSI6IHsKICAgICAgICAgICJyZWZlcmVuY2UiOiAiTG9jYXRpb24vIiArIHRoaXMuZmhpcklkCiAgICAgICAgfQogICAgICB9KQogICAgICBsZXQgdXJsID0gIi9maGlyLyIrdGhpcy5maWVsZAogICAgICBsZXQgb3B0cyA9IHsKICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICB1cmwsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgIH0sCiAgICAgICAgZGF0YTogdGhpcy5maGlyCiAgICAgIH0KICAgICAgYXhpb3MoIG9wdHMgKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuc2VhcmNoQWN0aW9uID0gIiIKICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oMCkKICAgICAgfSApLmNhdGNoKChlcnIpID0+IHsKICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZXJyb3JUaXRsZSA9ICdFcnJvcicKICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5lcnJvckRlc2NyaXB0aW9uID0gJ1RoaXMgcmVxdWVzdCB3YXMgbm90IHN1Y2Nlc3NmdWxseSBwcm9jZXNzZWQnCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZGlhbG9nRXJyb3IgPSB0cnVlCiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpOwogICAgICB9KQogICAgfSwKICAgIHByb2Nlc3NSZXF1ZXN0KG5ld1N0YXR1cykgewogICAgICBsZXQgdXJsCiAgICAgIGlmKHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RSZXNvdXJjZVVwZGF0ZURhdGEucmVxdWVzdFR5cGUgPT09ICdhZGQtcmVxdWVzdCcpIHsKICAgICAgICB1cmwgPSAiL2ZhY2lsaXRpZXNSZXF1ZXN0cy9hZGQiCiAgICAgIH0gZWxzZSBpZih0aGlzLiRzdG9yZS5zdGF0ZS5yZXF1ZXN0UmVzb3VyY2VVcGRhdGVEYXRhLnJlcXVlc3RUeXBlID09PSAndXBkYXRlLXJlcXVlc3QnKSB7CiAgICAgICAgdXJsID0gIi9mYWNpbGl0aWVzUmVxdWVzdHMvdXBkYXRlIgogICAgICB9CiAgICAgIGxldCBvcHRzID0gewogICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIHVybCwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgfSwKICAgICAgICBkYXRhOiB7CiAgICAgICAgICByZXNvdXJjZTogdGhpcy5zb3VyY2UuZGF0YSwKICAgICAgICAgIHJlcXVlc3RTdGF0dXM6IG5ld1N0YXR1cywKICAgICAgICAgIHJlcXVlc3RVcGRhdGluZ1Jlc291cmNlOiB0aGlzLiRzdG9yZS5zdGF0ZS5yZXF1ZXN0UmVzb3VyY2VVcGRhdGVEYXRhLnJlcXVlc3RVcGRhdGluZ1Jlc291cmNlLAogICAgICAgICAgcHJvZmlsZTogdGhpcy5wcm9maWxlCiAgICAgICAgfQogICAgICB9CiAgICAgIGF4aW9zKCBvcHRzICkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2UKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnJlcXVlc3RSZXNvdXJjZVVwZGF0ZURhdGEgPSB7CiAgICAgICAgICByZXF1ZXN0VHlwZTogJycsCiAgICAgICAgICByZXF1ZXN0VXBkYXRpbmdSZXNvdXJjZTogJycKICAgICAgICB9CiAgICAgICAgdGhpcy4kcm91dGVyLmdvKDApCiAgICAgIH0gKS5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2UKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmVycm9yVGl0bGUgPSAnRXJyb3InCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZXJyb3JEZXNjcmlwdGlvbiA9ICdUaGlzIHJlcXVlc3Qgd2FzIG5vdCBzdWNjZXNzZnVsbHkgcHJvY2Vzc2VkJwogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmRpYWxvZ0Vycm9yID0gdHJ1ZQogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgfSkKICAgIH0sCiAgICBnZXRMaW5rRmllbGQ6IGZ1bmN0aW9uKGZpZWxkKSB7CiAgICAgIGxldCBjb250ZW50ID0gdGhpcy4kZmhpcnBhdGguZXZhbHVhdGUoIHRoaXMuc291cmNlLmRhdGEsIGZpZWxkICkKICAgICAgaWYgKCBjb250ZW50ICkgewogICAgICAgIHJldHVybiBjb250ZW50WzBdCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICBnZXRMaW5rVXJsOiBmdW5jdGlvbihsaW5rKSB7CiAgICAgIGxldCBmaWVsZAogICAgICBpZiAoIGxpbmsuZmllbGQgKSB7CiAgICAgICAgZmllbGQgPSB0aGlzLmdldExpbmtGaWVsZChsaW5rLmZpZWxkKQogICAgICB9CiAgICAgIGlmICggZmllbGQgKSB7CiAgICAgICAgaWYgKCBmaWVsZC5pbmNsdWRlcygnLycpICkgewogICAgICAgICAgbGV0IHJlZiA9IGZpZWxkLnNwbGl0KCcvJykKICAgICAgICAgIGZpZWxkID0gcmVmWzFdCiAgICAgICAgfQogICAgICAgIHJldHVybiBsaW5rLnVybC5yZXBsYWNlKCJGSUVMRCIsZmllbGQpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGxpbmsudXJsCiAgICAgIH0KICAgIH0sCiAgICBzZXRMaW5rVGV4dDogZnVuY3Rpb24oKSB7CiAgICAgIGZvciAoIGxldCBpZHggaW4gdGhpcy5saW5rcyApIHsKICAgICAgICBsZXQgbGluayA9IHRoaXMubGlua3NbaWR4XQogICAgICAgIGlmICggbGluay50ZXh0ICkgewogICAgICAgICAgdGhpcy5saW5rdGV4dFtpZHhdID0gbGluay50ZXh0CiAgICAgICAgfSBlbHNlIGlmICggbGluay5maWVsZCApIHsKICAgICAgICAgIGxldCBmaWVsZCA9IHRoaXMuZ2V0TGlua0ZpZWxkKGxpbmsuZmllbGQpCiAgICAgICAgICBpZiAoIGZpZWxkICkgewogICAgICAgICAgICB0aGlzLiRmaGlydXRpbHMubG9va3VwKGZpZWxkKS50aGVuKCBkaXNwbGF5ID0+IHsKICAgICAgICAgICAgICB0aGlzLiRzZXQoIHRoaXMubGlua3RleHQsIGlkeCwgZGlzcGxheSApCiAgICAgICAgICAgIH0gKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHByb2Nlc3NDaGlsZHJlbjogYXN5bmMgZnVuY3Rpb24oIHBhcmVudCwgb2JqLCBjaGlsZHJlbiApIHsKICAgICAgZm9yKCBsZXQgY2hpbGQgb2YgY2hpbGRyZW4gKSB7CiAgICAgICAgbGV0IGZ1bGxGaWVsZCA9IHBhcmVudAoKICAgICAgICBsZXQgbmV4dCA9IG9iagoKICAgICAgICBpZiAoIGNoaWxkLmZpZWxkICYmICFjaGlsZC5maWVsZFR5cGUgLyogaWdub3JlIGFycmF5cyAqLyApIHsKICAgICAgICAgIGxldCBmaWVsZAogICAgICAgICAgaWYgKCBjaGlsZC5zbGljZU5hbWUgKSB7CiAgICAgICAgICAgIGlmICggY2hpbGQuZmllbGQuc3RhcnRzV2l0aCgidmFsdWVbeF0iKSApIHsKICAgICAgICAgICAgICBmaWVsZCA9IGNoaWxkLmZpZWxkLnN1YnN0cmluZyg5KQogICAgICAgICAgICAgIGZ1bGxGaWVsZCArPSAiLiIgKyBmaWVsZAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGZpZWxkID0gY2hpbGQuZmllbGQucmVwbGFjZSgiOiIrY2hpbGQuc2xpY2VOYW1lLCAiIikKICAgICAgICAgICAgICBmdWxsRmllbGQgKz0gIi4iICsgZmllbGQKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmllbGQgPSBjaGlsZC5maWVsZAogICAgICAgICAgICBmdWxsRmllbGQgKz0gIi4iK2ZpZWxkCiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIGNoaWxkLm1heCAhPT0gIjEiIHx8IGNoaWxkLmJhc2VNYXggIT09ICIxIiApIHsKICAgICAgICAgICAgaWYgKCAhb2JqLmhhc093blByb3BlcnR5KGZpZWxkKSApIHsKICAgICAgICAgICAgICBuZXh0W2ZpZWxkXSA9IFtdCiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5leHRbZmllbGRdID0ge30KICAgICAgICAgIH0KICAgICAgICAgIGlmICggY2hpbGQuaGFzT3duUHJvcGVydHkoInZhbHVlIikgKSB7CiAgICAgICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggbmV4dFtmaWVsZF0gKSApIHsKICAgICAgICAgICAgICBuZXh0W2ZpZWxkXS5wdXNoKCBjaGlsZC52YWx1ZSApCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmV4dFtmaWVsZF0gPSBjaGlsZC52YWx1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIG5leHQgPSBuZXh0W2ZpZWxkXQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCBuZXh0W2ZpZWxkXSApICkgewogICAgICAgICAgICAgIGxldCBzdWIgPSB7fQogICAgICAgICAgICAgIGlmICggY2hpbGQucHJvZmlsZSApIHsKICAgICAgICAgICAgICAgIHN1Yi51cmwgPSBjaGlsZC5wcm9maWxlCiAgICAgICAgICAgICAgfSBlbHNlIGlmICggZmllbGQgPT09ICJleHRlbnNpb24iICYmIGNoaWxkLnNsaWNlTmFtZSApIHsKICAgICAgICAgICAgICAgIHN1Yi51cmwgPSBjaGlsZC5zbGljZU5hbWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbmV4dFtmaWVsZF0ucHVzaCggc3ViICkKICAgICAgICAgICAgICBuZXh0ID0gc3ViCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmV4dCA9IG5leHRbZmllbGRdCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCBjaGlsZC4kY2hpbGRyZW4gKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBhd2FpdCB0aGlzLnByb2Nlc3NDaGlsZHJlbiggZnVsbEZpZWxkLCBuZXh0LCBjaGlsZC4kY2hpbGRyZW4gKQogICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICB0aGlzLmFkdmFuY2VkVmFsaWQgPSBmYWxzZQogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICggY2hpbGQuY29uc3RyYWludHMgKSB7CiAgICAgICAgICBjaGlsZC5lcnJvcnMgPSBbXQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gdGhpcy5hZHZhbmNlZFZhbGlkICYmIGF3YWl0IHRoaXMuJGZoaXJ1dGlscy5jaGVja0NvbnN0cmFpbnRzKCBjaGlsZC5jb25zdHJhaW50cywKICAgICAgICAgICAgICB0aGlzLmNvbnN0cmFpbnRzLCBuZXh0LCBjaGlsZC5lcnJvcnMsIHRoaXMuZmhpcklkICkKICAgICAgICAgIH0gY2F0Y2goIGVyciApIHsKICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gZmFsc2UKICAgICAgICAgICAgY2hpbGQuZXJyb3JzLnB1c2goIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuIikKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgIH0KCiAgICB9LAogICAgcHJvY2Vzc0ZISVI6IGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKQogICAgICBpZiAoICF0aGlzLnZhbGlkICkgcmV0dXJuCiAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IHRydWUKICAgICAgdGhpcy5vdmVybGF5ID0gdHJ1ZQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCgogICAgICB0aGlzLmZoaXIgPSB7CiAgICAgICAgcmVzb3VyY2VUeXBlOiB0aGlzLmZpZWxkLAogICAgICAgIG1ldGE6IHsKICAgICAgICAgIHByb2ZpbGU6IFsgdGhpcy5wcm9maWxlIF0KICAgICAgICB9CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLnByb2Nlc3NDaGlsZHJlbiggdGhpcy5maWVsZCwgdGhpcy5maGlyLCB0aGlzLiRjaGlsZHJlbiApCiAgICAgIH0gY2F0Y2goIGVyciApIHsKICAgICAgICB0aGlzLmFkdmFuY2VkVmFsaWQgPSBmYWxzZQogICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgfQogICAgICBpZiAoICF0aGlzLmFkdmFuY2VkVmFsaWQgKSB7CiAgICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2UKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0TWVzc2FnZScsIHsgdHlwZTogJ2Vycm9yJywgdGV4dDogJ1RoZXJlIHdlcmUgZXJyb3JzIG9uIHRoZSBmb3JtLicgfSkKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICBsZXQgdXJsID0gIi9maGlyLyIrdGhpcy5maWVsZAogICAgICBsZXQgb3B0cyA9IHsKICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICB1cmwsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIHRoaXMuZmhpcklkICkgewogICAgICAgIHRoaXMuZmhpci5pZCA9IHRoaXMuZmhpcklkCiAgICAgICAgdXJsICs9ICIvIiArIHRoaXMuZmhpcklkCiAgICAgICAgb3B0cy5tZXRob2QgPSAiUFVUIgogICAgICAgIG9wdHMudXJsID0gdXJsCiAgICAgIH0KICAgICAgb3B0cy5kYXRhID0gdGhpcy5maGlyCiAgICAgIGF4aW9zKCBvcHRzICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhCiAgICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2UKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIGlmICggdGhpcy5maGlySWQgKSB7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oMCkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiJSZXNvdXJjZVZpZXciLCBwYXJhbXM6IHtwYWdlOiB0aGlzLnBhZ2UsIGlkOiBkYXRhLmlkIH0gfSkKICAgICAgICB9CiAgICAgIH0gKQogICAgfQogIH0sCiAgYmVmb3JlRGVzdHJveSgpIHsKICAgIHRoaXMuJHN0b3JlLnN0YXRlLnNlYXJjaEFjdGlvbiA9ICIiCiAgICB0aGlzLiRzdG9yZS5zdGF0ZS5yZXF1ZXN0UmVzb3VyY2VVcGRhdGVEYXRhID0gewogICAgICByZXF1ZXN0VHlwZTogJycsCiAgICAgIHJlcXVlc3RVcGRhdGluZ1Jlc291cmNlOiAnJwogICAgfQogIH0KfQoKCgo="},{"version":3,"sources":["ihris-resource.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ihris-resource.vue","sourceRoot":"src/components/ihris","sourcesContent":["<template>\n  <v-container class=\"my-3\">\n    <v-form\n      ref=\"form\"\n      v-model=\"valid\"\n    >\n\n      <slot :source=\"source\"></slot>\n      <v-overlay :value=\"overlay\">\n        <v-progress-circular\n          size=\"50\"\n          color=\"primary\"\n          indeterminate\n          ></v-progress-circular>\n      </v-overlay>\n\n      <v-navigation-drawer\n        app\n        left\n        permanent\n        clipped\n        class=\"primary darken-1 white--text\"\n        style=\"z-index: 3;\"\n        >\n        <v-list class=\"white--text\">\n          <v-list-item>\n            <template v-if=\"!edit\">\n              <v-row>\n                <v-col md=\"12\">\n                  <v-btn small dark class=\"secondary\" @click=\"$emit('set-edit', !edit)\">\n                    <v-icon left light>mdi-pencil</v-icon>\n                    <span>Edit</span>\n                  </v-btn>\n                </v-col>\n                <v-col>\n                  <v-btn\n                    small\n                    @click=\"processRequest('approved')\"\n                    color=\"success\"\n                    v-if=\"$store.state.requestResourceUpdateData.requestUpdatingResource\"\n                    :disabled=\"currentRequestStatus === 'approved' || currentRequestStatus === ''\"\n                  >\n                    <v-icon left>mdi-check-circle</v-icon> Approve\n                  </v-btn>\n                </v-col>\n                <v-col>\n                  <v-btn\n                    small\n                    @click=\"processRequest('rejected')\"\n                    color=\"error\"\n                    v-if=\"$store.state.requestResourceUpdateData.requestUpdatingResource\"\n                    :disabled=\"currentRequestStatus !== 'pending'\"\n                  >\n                    <v-icon left>mdi-cancel</v-icon> Reject\n                  </v-btn>\n                </v-col>\n              </v-row>\n              <v-layout row wrap>\n                <v-flex xs12>\n\n                </v-flex>\n                <v-flex xs5>\n\n                </v-flex>\n                <v-spacer></v-spacer>\n                <v-flex xs5>\n\n                </v-flex>\n              </v-layout>\n            </template>\n            <v-btn small v-else dark class=\"secondary\" @click=\"$router.go(0)\">\n              <v-icon light>mdi-pencil-off</v-icon>\n              <span>Cancel</span>\n            </v-btn>\n            <v-spacer></v-spacer>\n            <template v-if=\"edit && $store.state.searchAction !== 'send-update-request'\">\n              <v-btn small v-if=\"valid\" dark class=\"success darken-1\" @click=\"processFHIR()\" :disabled=\"!valid\">\n                <v-icon light>mdi-content-save</v-icon>\n                <span>Save</span>\n              </v-btn>\n              <v-btn small v-else dark class=\"warning\" @click=\"$refs.form.validate()\">\n                <v-icon light>mdi-content-save</v-icon>\n                <span>Save</span>\n              </v-btn>\n            </template>\n            <template v-else-if=\"edit && $store.state.searchAction === 'send-update-request'\">\n              <v-btn\n                small\n                @click=\"createUpdateRequest\"\n                color=\"success\"\n              >\n                <v-icon left>mdi-check-circle</v-icon> Send Update Request\n              </v-btn>\n            </template>\n          </v-list-item>\n          <v-divider color=\"white\"></v-divider>\n          <template v-if=\"!edit && links && links.length\">\n            <v-list-item v-for=\"(link,idx) in links\" :key=\"link.url\">\n              <v-btn :key=\"link.url\" :text=\"!link.button\" :to=\"getLinkUrl(link)\" class=\"primary\">\n                <v-icon light v-if=\"link.icon\">{{link.icon}}</v-icon>\n                {{ linktext[idx]  }}\n              </v-btn>\n            </v-list-item>\n          </template>\n          <v-subheader v-if=\"sectionMenu\" class=\"white--text\"><h2>Sections</h2></v-subheader>\n          <v-list-item v-for=\"section in sectionMenu\" :href=\"'#section-'+section.name\" :key=\"section.name\">\n            <v-list-item-content class=\"white--text\" v-if=\"!edit || !section.secondary\">\n              <v-list-item-title class=\"text-uppercase\"><h4>{{ section.title }}</h4></v-list-item-title>\n              <v-list-item-subtitle class=\"white--text\">{{ section.desc }}</v-list-item-subtitle>\n            </v-list-item-content>\n          </v-list-item>\n        </v-list>\n\n      </v-navigation-drawer>\n    </v-form>\n  </v-container>\n\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n  name: \"ihris-resource\",\n  props: [\"title\",\"field\",\"fhirId\",\"page\",\"profile\",\"section-menu\",\"edit\",\"links\",\"constraints\" ],\n  data: function() {\n    return {\n      fhir: {},\n      orig: {},\n      valid: true,\n      source: { data: {}, path: \"\" },\n      loading: false,\n      overlay: false,\n      isEdit: false,\n      linktext: [ ],\n      advancedValid: true,\n      currentRequestStatus: ''\n    }\n  },\n  created: function() {\n    if ( this.fhirId ) {\n      this.loading = true\n      axios.get( \"/fhir/\"+this.field+\"/\"+this.fhirId ).then(response => {\n        let data = response.data\n        this.orig = data\n        this.source = { data: data, path: this.field }\n        this.setLinkText()\n        this.loading = false\n        if(data.extension) {\n          for(let ext of data.extension) {\n            if(ext.url === \"http://gofr.org/fhir/StructureDefinition/request-status\") {\n              this.currentRequestStatus = ext.valueCoding.code\n            }\n          }\n        }\n      }).catch(err=> {\n        console.log(this.field,this.fhirId,err)\n      })\n    } else if ( this.$route.query ) {\n      let presets = {\n        resourceType: this.field\n      }\n      let hasPresets = false\n      for( let path of Object.keys( this.$route.query ) ) {\n        if ( path.startsWith( this.field +\".\" ) ) {\n          hasPresets = true\n          let elements = path.substring( this.field.length+1 ).split('.')\n          let last = elements.pop()\n          let current = presets\n          for( let element of elements ) {\n            if ( element.includes('[') ) {\n              try {\n                let parts = element.split('[')\n                let name = parts[0]\n                let idx = parts[1].slice(0,-1)\n                if ( !current.hasOwnProperty(name) ) {\n                  current[name] = []\n                }\n                if ( idx ) {\n                  let next = {}\n                  current[name][parseInt(idx)] = next\n                  current = next\n                } else {\n                  let next = {}\n                  current[name].push( next )\n                  current = next\n                }\n              } catch( err ) {\n                console.log(\"Unable to process\",path)\n                continue\n              }\n            } else {\n              if ( !current.hasOwnProperty(element) ) {\n                current[element] = {}\n                current = current[element]\n              }\n            }\n          }\n          if ( last.includes('[') ) {\n            try {\n              let parts = last.split('[')\n              let name = parts[0]\n              let idx = parts[1].slice(0,-1)\n              if ( !current.hasOwnProperty(name) ) {\n                current[name] = []\n              }\n              if ( idx ) {\n                current[name][parseInt(idx)] = this.$route.query[path]\n              } else {\n                current[name].push( this.$route.query[path] )\n              }\n\n            } catch( err ) {\n              console.log(\"Unable to process\",path)\n              continue\n            }\n          } else {\n            current[last] = this.$route.query[path]\n          }\n        }\n      }\n      if ( hasPresets ) {\n        this.source = { data: presets, path: this.field }\n      }\n    }\n  },\n  computed: {\n    hasFhirId: function() {\n      if ( this.fhirId == '' ) {\n        return false\n      } else if ( !this.fhirId ) {\n        return false\n      } else {\n        return true\n      }\n    }\n  },\n  methods: {\n    async createUpdateRequest() {\n      this.$refs.form.validate()\n      if ( !this.valid ) return\n      this.fhir = {\n        resourceType: this.field,\n        meta: {\n          profile: [ \"http://gofr.org/fhir/StructureDefinition/gofr-facility-update-request\" ]\n        }\n      }\n      try {\n        await this.processChildren( this.field, this.fhir, this.$children )\n      } catch( err ) {\n        this.advancedValid = false\n        console.log(err)\n      }\n      if ( !this.advancedValid ) {\n        this.overlay = false\n        this.loading = false\n        this.$store.commit('setMessage', { type: 'error', text: 'There were errors on the form.' })\n        return\n      }\n      if(!this.fhir.extension) {\n        this.fhir.extension = []\n      }\n      this.fhir.extension.push({\n        url: \"http://gofr.org/fhir/StructureDefinition/request-status\",\n        valueCoding: {\n          system: \"http://gofr.org/fhir/StructureDefinition/request-status-codesystem\",\n          code: \"pending\",\n          display: \"Pending\"\n        }\n      }, {\n        \"url\": \"http://gofr.org/fhir/StructureDefinition/request-affected-resource\",\n        \"valueReference\": {\n          \"reference\": \"Location/\" + this.fhirId\n        }\n      })\n      let url = \"/fhir/\"+this.field\n      let opts = {\n        method: \"POST\",\n        url,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        data: this.fhir\n      }\n      axios( opts ).then(() => {\n        this.overlay = false\n        this.loading = false\n        this.$store.state.searchAction = \"\"\n        // this.$router.go(0)\n      } ).catch((err) => {\n        this.overlay = false\n        this.loading = false\n        this.$store.state.errorTitle = 'Error'\n        this.$store.state.errorDescription = 'This request was not successfully processed'\n        this.$store.state.dialogError = true\n        console.error(err);\n      })\n    },\n    processRequest(newStatus) {\n      let url\n      if(this.$store.state.requestResourceUpdateData.requestType === 'add-request') {\n        url = \"/facilitiesRequests/add\"\n      } else if(this.$store.state.requestResourceUpdateData.requestType === 'update-request') {\n        url = \"/facilitiesRequests/update\"\n      }\n      let opts = {\n        method: \"POST\",\n        url,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        data: {\n          resource: this.source.data,\n          requestStatus: newStatus,\n          requestUpdatingResource: this.$store.state.requestResourceUpdateData.requestUpdatingResource,\n          profile: this.profile\n        }\n      }\n      axios( opts ).then(() => {\n        this.overlay = false\n        this.loading = false\n        this.$store.state.requestResourceUpdateData = {\n          requestType: '',\n          requestUpdatingResource: ''\n        }\n        this.$router.go(0)\n      } ).catch((err) => {\n        this.overlay = false\n        this.loading = false\n        this.$store.state.errorTitle = 'Error'\n        this.$store.state.errorDescription = 'This request was not successfully processed'\n        this.$store.state.dialogError = true\n        console.error(err);\n      })\n    },\n    getLinkField: function(field) {\n      let content = this.$fhirpath.evaluate( this.source.data, field )\n      if ( content ) {\n        return content[0]\n      } else {\n        return false\n      }\n    },\n    getLinkUrl: function(link) {\n      let field\n      if ( link.field ) {\n        field = this.getLinkField(link.field)\n      }\n      if ( field ) {\n        if ( field.includes('/') ) {\n          let ref = field.split('/')\n          field = ref[1]\n        }\n        return link.url.replace(\"FIELD\",field)\n      } else {\n        return link.url\n      }\n    },\n    setLinkText: function() {\n      for ( let idx in this.links ) {\n        let link = this.links[idx]\n        if ( link.text ) {\n          this.linktext[idx] = link.text\n        } else if ( link.field ) {\n          let field = this.getLinkField(link.field)\n          if ( field ) {\n            this.$fhirutils.lookup(field).then( display => {\n              this.$set( this.linktext, idx, display )\n            } )\n          }\n        }\n      }\n    },\n    processChildren: async function( parent, obj, children ) {\n      for( let child of children ) {\n        let fullField = parent\n\n        let next = obj\n\n        if ( child.field && !child.fieldType /* ignore arrays */ ) {\n          let field\n          if ( child.sliceName ) {\n            if ( child.field.startsWith(\"value[x]\") ) {\n              field = child.field.substring(9)\n              fullField += \".\" + field\n            } else {\n              field = child.field.replace(\":\"+child.sliceName, \"\")\n              fullField += \".\" + field\n            }\n          } else {\n            field = child.field\n            fullField += \".\"+field\n          }\n          if ( child.max !== \"1\" || child.baseMax !== \"1\" ) {\n            if ( !obj.hasOwnProperty(field) ) {\n              next[field] = []\n            }\n          } else {\n            next[field] = {}\n          }\n          if ( child.hasOwnProperty(\"value\") ) {\n            if ( Array.isArray( next[field] ) ) {\n              next[field].push( child.value )\n            } else {\n              next[field] = child.value\n            }\n            next = next[field]\n          } else {\n            if ( Array.isArray( next[field] ) ) {\n              let sub = {}\n              if ( child.profile ) {\n                sub.url = child.profile\n              } else if ( field === \"extension\" && child.sliceName ) {\n                sub.url = child.sliceName\n              }\n              next[field].push( sub )\n              next = sub\n            } else {\n              next = next[field]\n            }\n          }\n        }\n        if ( child.$children ) {\n          try {\n            await this.processChildren( fullField, next, child.$children )\n          } catch( err ) {\n            this.advancedValid = false\n            console.log(err)\n          }\n        }\n        if ( child.constraints ) {\n          child.errors = []\n          try {\n            this.advancedValid = this.advancedValid && await this.$fhirutils.checkConstraints( child.constraints,\n              this.constraints, next, child.errors, this.fhirId )\n          } catch( err ) {\n            this.advancedValid = false\n            child.errors.push(\"An unknown error occurred.\")\n            console.log(err)\n          }\n        }\n\n      }\n\n    },\n    processFHIR: async function() {\n      this.$refs.form.validate()\n      if ( !this.valid ) return\n      this.advancedValid = true\n      this.overlay = true\n      this.loading = true\n\n      this.fhir = {\n        resourceType: this.field,\n        meta: {\n          profile: [ this.profile ]\n        }\n      }\n      try {\n        await this.processChildren( this.field, this.fhir, this.$children )\n      } catch( err ) {\n        this.advancedValid = false\n        console.log(err)\n      }\n      if ( !this.advancedValid ) {\n        this.overlay = false\n        this.loading = false\n        this.$store.commit('setMessage', { type: 'error', text: 'There were errors on the form.' })\n        return\n      }\n      let url = \"/fhir/\"+this.field\n      let opts = {\n        method: \"POST\",\n        url,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }\n      if ( this.fhirId ) {\n        this.fhir.id = this.fhirId\n        url += \"/\" + this.fhirId\n        opts.method = \"PUT\"\n        opts.url = url\n      }\n      opts.data = this.fhir\n      axios( opts ).then(response => {\n        let data = response.data\n        this.overlay = false\n        this.loading = false\n        if ( this.fhirId ) {\n          this.$router.go(0)\n        } else {\n          this.$router.push({ name:\"ResourceView\", params: {page: this.page, id: data.id } })\n        }\n      } )\n    }\n  },\n  beforeDestroy() {\n    this.$store.state.searchAction = \"\"\n    this.$store.state.requestResourceUpdateData = {\n      requestType: '',\n      requestUpdatingResource: ''\n    }\n  }\n}\n\n\n\n</script>\n"]}]}