{"remainingRequest":"/home/ally/gofr/gofr-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/gofr-gui/src/components/ihris/ihris-resource.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/gofr-gui/src/components/ihris/ihris-resource.vue","mtime":1621325984987},{"path":"/home/ally/gofr/gofr-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/gofr-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/gofr-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/gofr-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJpaHJpcy1yZXNvdXJjZSIsCiAgcHJvcHM6IFsidGl0bGUiLCJmaWVsZCIsImZoaXItaWQiLCJwYWdlIiwicHJvZmlsZSIsInNlY3Rpb24tbWVudSIsImVkaXQiLCJsaW5rcyIsImNvbnN0cmFpbnRzIiBdLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgZmhpcjoge30sCiAgICAgIG9yaWc6IHt9LAogICAgICB2YWxpZDogdHJ1ZSwKICAgICAgc291cmNlOiB7IGRhdGE6IHt9LCBwYXRoOiAiIiB9LAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgb3ZlcmxheTogZmFsc2UsCiAgICAgIGlzRWRpdDogZmFsc2UsCiAgICAgIGxpbmt0ZXh0OiBbIF0sCiAgICAgIGFkdmFuY2VkVmFsaWQ6IHRydWUKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgaWYgKCB0aGlzLmZoaXJJZCApIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICAvL2NvbnNvbGUubG9nKCJnZXR0aW5nIix0aGlzLmZpZWxkLHRoaXMuZmhpcklkKQogICAgICBheGlvcy5nZXQoICIvZmhpci8iK3RoaXMuZmllbGQrIi8iK3RoaXMuZmhpcklkICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhCiAgICAgICAgLy90aGlzLiRzdG9yZS5jb21taXQoJ3NldEN1cnJlbnRSZXNvdXJjZScsIGRhdGEpCiAgICAgICAgdGhpcy5vcmlnID0gZGF0YQogICAgICAgIHRoaXMuc291cmNlID0geyBkYXRhOiBkYXRhLCBwYXRoOiB0aGlzLmZpZWxkIH0KICAgICAgICB0aGlzLnNldExpbmtUZXh0KCkKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICB9KS5jYXRjaChlcnI9PiB7CiAgICAgICAgY29uc29sZS5sb2codGhpcy5maWVsZCx0aGlzLmZoaXJJZCxlcnIpCiAgICAgIH0pCiAgICB9IGVsc2UgaWYgKCB0aGlzLiRyb3V0ZS5xdWVyeSApIHsKICAgICAgbGV0IHByZXNldHMgPSB7CiAgICAgICAgcmVzb3VyY2VUeXBlOiB0aGlzLmZpZWxkCiAgICAgIH0KICAgICAgbGV0IGhhc1ByZXNldHMgPSBmYWxzZQogICAgICBmb3IoIGxldCBwYXRoIG9mIE9iamVjdC5rZXlzKCB0aGlzLiRyb3V0ZS5xdWVyeSApICkgewogICAgICAgIGlmICggcGF0aC5zdGFydHNXaXRoKCB0aGlzLmZpZWxkICsiLiIgKSApIHsKICAgICAgICAgIGhhc1ByZXNldHMgPSB0cnVlCiAgICAgICAgICBsZXQgZWxlbWVudHMgPSBwYXRoLnN1YnN0cmluZyggdGhpcy5maWVsZC5sZW5ndGgrMSApLnNwbGl0KCcuJykKICAgICAgICAgIGxldCBsYXN0ID0gZWxlbWVudHMucG9wKCkKICAgICAgICAgIGxldCBjdXJyZW50ID0gcHJlc2V0cwogICAgICAgICAgZm9yKCBsZXQgZWxlbWVudCBvZiBlbGVtZW50cyApIHsKICAgICAgICAgICAgaWYgKCBlbGVtZW50LmluY2x1ZGVzKCdbJykgKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCBwYXJ0cyA9IGVsZW1lbnQuc3BsaXQoJ1snKQogICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBwYXJ0c1swXQogICAgICAgICAgICAgICAgbGV0IGlkeCA9IHBhcnRzWzFdLnNsaWNlKDAsLTEpCiAgICAgICAgICAgICAgICBpZiAoICFjdXJyZW50Lmhhc093blByb3BlcnR5KG5hbWUpICkgewogICAgICAgICAgICAgICAgICBjdXJyZW50W25hbWVdID0gW10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICggaWR4ICkgewogICAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IHt9CiAgICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV1bcGFyc2VJbnQoaWR4KV0gPSBuZXh0CiAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBuZXh0CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IHt9CiAgICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV0ucHVzaCggbmV4dCApCiAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBuZXh0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlVuYWJsZSB0byBwcm9jZXNzIixwYXRoKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKCAhY3VycmVudC5oYXNPd25Qcm9wZXJ0eShlbGVtZW50KSApIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRbZWxlbWVudF0gPSB7fQogICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbZWxlbWVudF0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICggbGFzdC5pbmNsdWRlcygnWycpICkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGxldCBwYXJ0cyA9IGxhc3Quc3BsaXQoJ1snKQogICAgICAgICAgICAgIGxldCBuYW1lID0gcGFydHNbMF0KICAgICAgICAgICAgICBsZXQgaWR4ID0gcGFydHNbMV0uc2xpY2UoMCwtMSkKICAgICAgICAgICAgICBpZiAoICFjdXJyZW50Lmhhc093blByb3BlcnR5KG5hbWUpICkgewogICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXSA9IFtdCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICggaWR4ICkgewogICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXVtwYXJzZUludChpZHgpXSA9IHRoaXMuJHJvdXRlLnF1ZXJ5W3BhdGhdCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV0ucHVzaCggdGhpcy4kcm91dGUucXVlcnlbcGF0aF0gKQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0gY2F0Y2goIGVyciApIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHByb2Nlc3MiLHBhdGgpCiAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3VycmVudFtsYXN0XSA9IHRoaXMuJHJvdXRlLnF1ZXJ5W3BhdGhdCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICggaGFzUHJlc2V0cyApIHsKICAgICAgICB0aGlzLnNvdXJjZSA9IHsgZGF0YTogcHJlc2V0cywgcGF0aDogdGhpcy5maWVsZCB9CiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBoYXNGaGlySWQ6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIHRoaXMuZmhpcklkID09ICcnICkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9IGVsc2UgaWYgKCAhdGhpcy5maGlySWQgKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfQogICAgLyoKICAgIHNvdXJjZTogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5maGlyCiAgICB9CiAgICAqLwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlua0ZpZWxkOiBmdW5jdGlvbihmaWVsZCkgewogICAgICBsZXQgY29udGVudCA9IHRoaXMuJGZoaXJwYXRoLmV2YWx1YXRlKCB0aGlzLnNvdXJjZS5kYXRhLCBmaWVsZCApCiAgICAgIGlmICggY29udGVudCApIHsKICAgICAgICByZXR1cm4gY29udGVudFswXQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9LAogICAgZ2V0TGlua1VybDogZnVuY3Rpb24obGluaykgewogICAgICBsZXQgZmllbGQKICAgICAgaWYgKCBsaW5rLmZpZWxkICkgewogICAgICAgIGZpZWxkID0gdGhpcy5nZXRMaW5rRmllbGQobGluay5maWVsZCkKICAgICAgfQogICAgICBpZiAoIGZpZWxkICkgewogICAgICAgIGlmICggZmllbGQuaW5jbHVkZXMoJy8nKSApIHsKICAgICAgICAgIGxldCByZWYgPSBmaWVsZC5zcGxpdCgnLycpCiAgICAgICAgICBmaWVsZCA9IHJlZlsxXQogICAgICAgIH0KICAgICAgICByZXR1cm4gbGluay51cmwucmVwbGFjZSgiRklFTEQiLGZpZWxkKQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBsaW5rLnVybAogICAgICB9CiAgICB9LAogICAgc2V0TGlua1RleHQ6IGZ1bmN0aW9uKCkgewogICAgICBmb3IgKCBsZXQgaWR4IGluIHRoaXMubGlua3MgKSB7CiAgICAgICAgbGV0IGxpbmsgPSB0aGlzLmxpbmtzW2lkeF0KICAgICAgICBpZiAoIGxpbmsudGV4dCApIHsKICAgICAgICAgIHRoaXMubGlua3RleHRbaWR4XSA9IGxpbmsudGV4dAogICAgICAgIH0gZWxzZSBpZiAoIGxpbmsuZmllbGQgKSB7CiAgICAgICAgICBsZXQgZmllbGQgPSB0aGlzLmdldExpbmtGaWVsZChsaW5rLmZpZWxkKQogICAgICAgICAgaWYgKCBmaWVsZCApIHsKICAgICAgICAgICAgdGhpcy4kZmhpcnV0aWxzLmxvb2t1cChmaWVsZCkudGhlbiggZGlzcGxheSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kc2V0KCB0aGlzLmxpbmt0ZXh0LCBpZHgsIGRpc3BsYXkgKQogICAgICAgICAgICB9ICkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBwcm9jZXNzRkhJUjogYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZSgpCiAgICAgIGlmICggIXRoaXMudmFsaWQgKSByZXR1cm4KICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gdHJ1ZQogICAgICB0aGlzLm92ZXJsYXkgPSB0cnVlCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKCiAgICAgIC8vY29uc3QgcHJvY2Vzc0NoaWxkcmVuID0gZnVuY3Rpb24oIHBhcmVudCwgb2JqLCBjaGlsZHJlbiApIHsKICAgICAgY29uc3QgcHJvY2Vzc0NoaWxkcmVuID0gYXN5bmMgKCBwYXJlbnQsIG9iaiwgY2hpbGRyZW4gKSA9PiB7CiAgICAgICAgLy9jb25zb2xlLmxvZygiY2FsbGVkIG9uICIrcGFyZW50KQoKICAgICAgICBmb3IoIGxldCBjaGlsZCBvZiBjaGlsZHJlbiApIHsKCiAgICAgICAgICBsZXQgZnVsbEZpZWxkID0gcGFyZW50CgogICAgICAgICAgbGV0IG5leHQgPSBvYmoKCiAgICAgICAgICBpZiAoIGNoaWxkLmZpZWxkICYmICFjaGlsZC5maWVsZFR5cGUgLyogaWdub3JlIGFycmF5cyAqLyApIHsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygid29ya2luZyBvbiAiK3BhcmVudCsiIC4gIitjaGlsZC5maWVsZCkKICAgICAgICAgICAgbGV0IGZpZWxkCiAgICAgICAgICAgIGlmICggY2hpbGQuc2xpY2VOYW1lICkgewogICAgICAgICAgICAgIGlmICggY2hpbGQuZmllbGQuc3RhcnRzV2l0aCgidmFsdWVbeF0iKSApIHsKICAgICAgICAgICAgICAgIGZpZWxkID0gY2hpbGQuZmllbGQuc3Vic3RyaW5nKDkpCiAgICAgICAgICAgICAgICBmdWxsRmllbGQgKz0gIi4iICsgZmllbGQKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZmllbGQgPSBjaGlsZC5maWVsZC5yZXBsYWNlKCI6IitjaGlsZC5zbGljZU5hbWUsICIiKQogICAgICAgICAgICAgICAgZnVsbEZpZWxkICs9ICIuIiArIGZpZWxkCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGZpZWxkID0gY2hpbGQuZmllbGQKICAgICAgICAgICAgICBmdWxsRmllbGQgKz0gIi4iK2ZpZWxkCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCBjaGlsZC5tYXggIT09ICIxIiB8fCBjaGlsZC5iYXNlTWF4ICE9PSAiMSIgKSB7CiAgICAgICAgICAgICAgaWYgKCAhb2JqLmhhc093blByb3BlcnR5KGZpZWxkKSApIHsKICAgICAgICAgICAgICAgIG5leHRbZmllbGRdID0gW10KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmV4dFtmaWVsZF0gPSB7fQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZnVsbEZpZWxkKQogICAgICAgICAgICAvL2NvbnNvbGUubG9nKGNoaWxkLm1heCwgY2hpbGQuYmFzZU1heCkKICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjaGlsZCkKICAgICAgICAgICAgaWYgKCBjaGlsZC5oYXNPd25Qcm9wZXJ0eSgidmFsdWUiKSApIHsKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBmdWxsRmllbGQgKyI9IisgY2hpbGQudmFsdWUgKQogICAgICAgICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggbmV4dFtmaWVsZF0gKSApIHsKICAgICAgICAgICAgICAgIG5leHRbZmllbGRdLnB1c2goIGNoaWxkLnZhbHVlICkKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV4dFtmaWVsZF0gPSBjaGlsZC52YWx1ZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBuZXh0ID0gbmV4dFtmaWVsZF0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIG5leHRbZmllbGRdICkgKSB7CiAgICAgICAgICAgICAgICBsZXQgc3ViID0ge30KICAgICAgICAgICAgICAgIGlmICggY2hpbGQucHJvZmlsZSApIHsKICAgICAgICAgICAgICAgICAgc3ViLnVybCA9IGNoaWxkLnByb2ZpbGUKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIGZpZWxkID09PSAiZXh0ZW5zaW9uIiAmJiBjaGlsZC5zbGljZU5hbWUgKSB7CiAgICAgICAgICAgICAgICAgIHN1Yi51cmwgPSBjaGlsZC5zbGljZU5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG5leHRbZmllbGRdLnB1c2goIHN1YiApCiAgICAgICAgICAgICAgICBuZXh0ID0gc3ViCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5leHQgPSBuZXh0W2ZpZWxkXQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICggY2hpbGQuJGNoaWxkcmVuICkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGF3YWl0IHByb2Nlc3NDaGlsZHJlbiggZnVsbEZpZWxkLCBuZXh0LCBjaGlsZC4kY2hpbGRyZW4gKQogICAgICAgICAgICB9IGNhdGNoKCBlcnIgKSB7CiAgICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gZmFsc2UKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICggY2hpbGQuY29uc3RyYWludHMgKSB7CiAgICAgICAgICAgIGNoaWxkLmVycm9ycyA9IFtdCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gdGhpcy5hZHZhbmNlZFZhbGlkICYmIGF3YWl0IHRoaXMuJGZoaXJ1dGlscy5jaGVja0NvbnN0cmFpbnRzKCBjaGlsZC5jb25zdHJhaW50cywKICAgICAgICAgICAgICAgIHRoaXMuY29uc3RyYWludHMsIG5leHQsIGNoaWxkLmVycm9ycywgdGhpcy5maGlySWQgKQogICAgICAgICAgICB9IGNhdGNoKCBlcnIgKSB7CiAgICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gZmFsc2UKICAgICAgICAgICAgICBjaGlsZC5lcnJvcnMucHVzaCgiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZC4iKQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICB9CgogICAgICB9CgogICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZmllbGQpCiAgICAgIHRoaXMuZmhpciA9IHsKICAgICAgICByZXNvdXJjZVR5cGU6IHRoaXMuZmllbGQsCiAgICAgICAgbWV0YTogewogICAgICAgICAgcHJvZmlsZTogWyB0aGlzLnByb2ZpbGUgXQogICAgICAgIH0KICAgICAgfQogICAgICAvL2NvbnNvbGUubG9nKHRoaXMpCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgcHJvY2Vzc0NoaWxkcmVuKCB0aGlzLmZpZWxkLCB0aGlzLmZoaXIsIHRoaXMuJGNoaWxkcmVuICkKICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IGZhbHNlCiAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICB9CiAgICAgIGlmICggIXRoaXMuYWR2YW5jZWRWYWxpZCApIHsKICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRNZXNzYWdlJywgeyB0eXBlOiAnZXJyb3InLCB0ZXh0OiAnVGhlcmUgd2VyZSBlcnJvcnMgb24gdGhlIGZvcm0uJyB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCJGSU5JU0hFRCBQUk9DRVNTIEFORCBDSEVDSy4iKQogICAgICBsZXQgdXJsID0gIi9maGlyLyIrdGhpcy5maWVsZAogICAgICBsZXQgb3B0cyA9IHsKICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICB1cmwsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIHRoaXMuZmhpcklkICkgewogICAgICAgIHRoaXMuZmhpci5pZCA9IHRoaXMuZmhpcklkCiAgICAgICAgdXJsICs9ICIvIiArIHRoaXMuZmhpcklkCiAgICAgICAgb3B0cy5tZXRob2QgPSAiUFVUIgogICAgICAgIG9wdHMudXJsID0gdXJsCiAgICAgIH0KICAgICAgb3B0cy5kYXRhID0gdGhpcy5maGlyCiAgICAgIGNvbnNvbGUubG9nKCJTQVZFIix1cmwsdGhpcy5maGlyKQogICAgICBheGlvcyggb3B0cyApLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpCiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZS5oZWFkZXJzKQogICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YQogICAgICAgIHRoaXMub3ZlcmxheSA9IGZhbHNlCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICBpZiAoIHRoaXMuZmhpcklkICkgewogICAgICAgICAgdGhpcy4kcm91dGVyLmdvKDApCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZToiUmVzb3VyY2VWaWV3IiwgcGFyYW1zOiB7cGFnZTogdGhpcy5wYWdlLCBpZDogZGF0YS5pZCB9IH0pCiAgICAgICAgfQogICAgICB9ICkKICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmZoaXIpCgogICAgICAvKgogICAgICBjb25zb2xlLmxvZyh0aGlzLiRzY29wZWRTbG90cy5kZWZhdWx0KCkpCiAgICAgIHByb2Nlc3NTbG90cyggdGhpcy5maWVsZCwgdGhpcy4kc2NvcGVkU2xvdHMuZGVmYXVsdCgpICkKICAgICAgKi8KICAgIH0KICB9Cn0KCgoK"},{"version":3,"sources":["ihris-resource.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ihris-resource.vue","sourceRoot":"src/components/ihris","sourcesContent":["<template>\n  <v-container class=\"my-3\">\n    <v-form\n      ref=\"form\"\n      v-model=\"valid\"\n    >\n\n      <slot :source=\"source\"></slot>\n      <v-overlay :value=\"overlay\">\n        <v-progress-circular\n          size=\"50\"\n          color=\"primary\"\n          indeterminate\n          ></v-progress-circular>\n      </v-overlay>\n\n      <v-navigation-drawer\n        app\n        left\n        permanent\n        clipped\n        class=\"primary darken-1 white--text\"\n        style=\"z-index: 3;\"\n        >\n        <v-list class=\"white--text\">\n          <v-list-item>\n            <v-btn v-if=\"!edit\" dark class=\"secondary\" @click=\"$emit('set-edit', !edit)\">\n              <v-icon light>mdi-pencil</v-icon>\n              <span>Edit</span>\n            </v-btn>\n            <v-btn v-else dark class=\"secondary\" @click=\"$router.go(0)\">\n              <v-icon light>mdi-pencil-off</v-icon>\n              <span>Cancel</span>\n            </v-btn>\n            <v-spacer></v-spacer>\n            <template v-if=\"edit\">\n              <v-btn v-if=\"valid\" dark class=\"success darken-1\" @click=\"processFHIR()\" :disabled=\"!valid\">\n                <v-icon light>mdi-content-save</v-icon>\n                <span>Save</span>\n              </v-btn>\n              <v-btn v-else dark class=\"warning\" @click=\"$refs.form.validate()\">\n                <v-icon light>mdi-content-save</v-icon>\n                <span>Save</span>\n              </v-btn>\n            </template>\n          </v-list-item>\n          <v-divider color=\"white\"></v-divider>\n          <template v-if=\"!edit && links && links.length\">\n            <v-list-item v-for=\"(link,idx) in links\" :key=\"link.url\">\n              <v-btn :key=\"link.url\" :text=\"!link.button\" :to=\"getLinkUrl(link)\" class=\"primary\">\n                <v-icon light v-if=\"link.icon\">{{link.icon}}</v-icon>\n                {{ linktext[idx]  }}\n              </v-btn>\n            </v-list-item>\n          </template>\n          <v-subheader v-if=\"sectionMenu\" class=\"white--text\"><h2>Sections</h2></v-subheader>\n          <v-list-item v-for=\"section in sectionMenu\" :href=\"'#section-'+section.name\" :key=\"section.name\">\n            <v-list-item-content class=\"white--text\" v-if=\"!edit || !section.secondary\">\n              <v-list-item-title class=\"text-uppercase\"><h4>{{ section.title }}</h4></v-list-item-title>\n              <v-list-item-subtitle class=\"white--text\">{{ section.desc }}</v-list-item-subtitle>\n            </v-list-item-content>\n          </v-list-item>\n        </v-list>\n\n      </v-navigation-drawer>\n    </v-form>\n  </v-container>\n\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n  name: \"ihris-resource\",\n  props: [\"title\",\"field\",\"fhir-id\",\"page\",\"profile\",\"section-menu\",\"edit\",\"links\",\"constraints\" ],\n  data: function() {\n    return {\n      fhir: {},\n      orig: {},\n      valid: true,\n      source: { data: {}, path: \"\" },\n      loading: false,\n      overlay: false,\n      isEdit: false,\n      linktext: [ ],\n      advancedValid: true\n    }\n  },\n  created: function() {\n    if ( this.fhirId ) {\n      this.loading = true\n      //console.log(\"getting\",this.field,this.fhirId)\n      axios.get( \"/fhir/\"+this.field+\"/\"+this.fhirId ).then(response => {\n        let data = response.data\n        //this.$store.commit('setCurrentResource', data)\n        this.orig = data\n        this.source = { data: data, path: this.field }\n        this.setLinkText()\n        this.loading = false\n      }).catch(err=> {\n        console.log(this.field,this.fhirId,err)\n      })\n    } else if ( this.$route.query ) {\n      let presets = {\n        resourceType: this.field\n      }\n      let hasPresets = false\n      for( let path of Object.keys( this.$route.query ) ) {\n        if ( path.startsWith( this.field +\".\" ) ) {\n          hasPresets = true\n          let elements = path.substring( this.field.length+1 ).split('.')\n          let last = elements.pop()\n          let current = presets\n          for( let element of elements ) {\n            if ( element.includes('[') ) {\n              try {\n                let parts = element.split('[')\n                let name = parts[0]\n                let idx = parts[1].slice(0,-1)\n                if ( !current.hasOwnProperty(name) ) {\n                  current[name] = []\n                }\n                if ( idx ) {\n                  let next = {}\n                  current[name][parseInt(idx)] = next\n                  current = next\n                } else {\n                  let next = {}\n                  current[name].push( next )\n                  current = next\n                }\n              } catch( err ) {\n                console.log(\"Unable to process\",path)\n                continue\n              }\n            } else {\n              if ( !current.hasOwnProperty(element) ) {\n                current[element] = {}\n                current = current[element]\n              }\n            }\n          }\n          if ( last.includes('[') ) {\n            try {\n              let parts = last.split('[')\n              let name = parts[0]\n              let idx = parts[1].slice(0,-1)\n              if ( !current.hasOwnProperty(name) ) {\n                current[name] = []\n              }\n              if ( idx ) {\n                current[name][parseInt(idx)] = this.$route.query[path]\n              } else {\n                current[name].push( this.$route.query[path] )\n              }\n\n            } catch( err ) {\n              console.log(\"Unable to process\",path)\n              continue\n            }\n          } else {\n            current[last] = this.$route.query[path]\n          }\n        }\n      }\n      if ( hasPresets ) {\n        this.source = { data: presets, path: this.field }\n      }\n    }\n  },\n  computed: {\n    hasFhirId: function() {\n      if ( this.fhirId == '' ) {\n        return false\n      } else if ( !this.fhirId ) {\n        return false\n      } else {\n        return true\n      }\n    }\n    /*\n    source: function() {\n      return this.$store.state.fhir\n    }\n    */\n  },\n  methods: {\n    getLinkField: function(field) {\n      let content = this.$fhirpath.evaluate( this.source.data, field )\n      if ( content ) {\n        return content[0]\n      } else {\n        return false\n      }\n    },\n    getLinkUrl: function(link) {\n      let field\n      if ( link.field ) {\n        field = this.getLinkField(link.field)\n      }\n      if ( field ) {\n        if ( field.includes('/') ) {\n          let ref = field.split('/')\n          field = ref[1]\n        }\n        return link.url.replace(\"FIELD\",field)\n      } else {\n        return link.url\n      }\n    },\n    setLinkText: function() {\n      for ( let idx in this.links ) {\n        let link = this.links[idx]\n        if ( link.text ) {\n          this.linktext[idx] = link.text\n        } else if ( link.field ) {\n          let field = this.getLinkField(link.field)\n          if ( field ) {\n            this.$fhirutils.lookup(field).then( display => {\n              this.$set( this.linktext, idx, display )\n            } )\n          }\n        }\n      }\n    },\n    processFHIR: async function() {\n      this.$refs.form.validate()\n      if ( !this.valid ) return\n      this.advancedValid = true\n      this.overlay = true\n      this.loading = true\n\n      //const processChildren = function( parent, obj, children ) {\n      const processChildren = async ( parent, obj, children ) => {\n        //console.log(\"called on \"+parent)\n\n        for( let child of children ) {\n\n          let fullField = parent\n\n          let next = obj\n\n          if ( child.field && !child.fieldType /* ignore arrays */ ) {\n            //console.log(\"working on \"+parent+\" . \"+child.field)\n            let field\n            if ( child.sliceName ) {\n              if ( child.field.startsWith(\"value[x]\") ) {\n                field = child.field.substring(9)\n                fullField += \".\" + field\n              } else {\n                field = child.field.replace(\":\"+child.sliceName, \"\")\n                fullField += \".\" + field\n              }\n            } else {\n              field = child.field\n              fullField += \".\"+field\n            }\n            if ( child.max !== \"1\" || child.baseMax !== \"1\" ) {\n              if ( !obj.hasOwnProperty(field) ) {\n                next[field] = []\n              }\n            } else {\n              next[field] = {}\n            }\n            //console.log(fullField)\n            //console.log(child.max, child.baseMax)\n            //console.log(child)\n            if ( child.hasOwnProperty(\"value\") ) {\n              //console.log( fullField +\"=\"+ child.value )\n              if ( Array.isArray( next[field] ) ) {\n                next[field].push( child.value )\n              } else {\n                next[field] = child.value\n              }\n              next = next[field]\n            } else {\n              if ( Array.isArray( next[field] ) ) {\n                let sub = {}\n                if ( child.profile ) {\n                  sub.url = child.profile\n                } else if ( field === \"extension\" && child.sliceName ) {\n                  sub.url = child.sliceName\n                }\n                next[field].push( sub )\n                next = sub\n              } else {\n                next = next[field]\n              }\n            }\n          }\n\n          if ( child.$children ) {\n            try {\n              await processChildren( fullField, next, child.$children )\n            } catch( err ) {\n              this.advancedValid = false\n              console.log(err)\n            }\n          }\n          if ( child.constraints ) {\n            child.errors = []\n            try {\n              this.advancedValid = this.advancedValid && await this.$fhirutils.checkConstraints( child.constraints,\n                this.constraints, next, child.errors, this.fhirId )\n            } catch( err ) {\n              this.advancedValid = false\n              child.errors.push(\"An unknown error occurred.\")\n              console.log(err)\n            }\n          }\n\n        }\n\n      }\n\n      //console.log(this.field)\n      this.fhir = {\n        resourceType: this.field,\n        meta: {\n          profile: [ this.profile ]\n        }\n      }\n      //console.log(this)\n      try {\n        await processChildren( this.field, this.fhir, this.$children )\n      } catch( err ) {\n        this.advancedValid = false\n        console.log(err)\n      }\n      if ( !this.advancedValid ) {\n        this.overlay = false\n        this.loading = false\n        this.$store.commit('setMessage', { type: 'error', text: 'There were errors on the form.' })\n        return\n      }\n      console.log(\"FINISHED PROCESS AND CHECK.\")\n      let url = \"/fhir/\"+this.field\n      let opts = {\n        method: \"POST\",\n        url,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }\n      if ( this.fhirId ) {\n        this.fhir.id = this.fhirId\n        url += \"/\" + this.fhirId\n        opts.method = \"PUT\"\n        opts.url = url\n      }\n      opts.data = this.fhir\n      console.log(\"SAVE\",url,this.fhir)\n      axios( opts ).then(response => {\n        //console.log(response)\n        //console.log(response.headers)\n        let data = response.data\n        this.overlay = false\n        this.loading = false\n        if ( this.fhirId ) {\n          this.$router.go(0)\n        } else {\n          this.$router.push({ name:\"ResourceView\", params: {page: this.page, id: data.id } })\n        }\n      } )\n      //console.log(this.fhir)\n\n      /*\n      console.log(this.$scopedSlots.default())\n      processSlots( this.field, this.$scopedSlots.default() )\n      */\n    }\n  }\n}\n\n\n\n</script>\n"]}]}