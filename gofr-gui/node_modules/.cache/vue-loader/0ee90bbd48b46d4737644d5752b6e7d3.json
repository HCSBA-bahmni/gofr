{"remainingRequest":"/home/ally/gofr2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr2/src/components/DataSources/FacilityReconRemoteSources.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr2/src/components/DataSources/FacilityReconRemoteSources.vue","mtime":1619080790043},{"path":"/home/ally/gofr2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ally/gofr2/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ally/gofr2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ally/gofr2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHJlcXVpcmVkIH0gZnJvbSAndnVlbGlkYXRlL2xpYi92YWxpZGF0b3JzJwppbXBvcnQgeyBkYXRhU291cmNlc01peGluIH0gZnJvbSAnLi9kYXRhU291cmNlc01peGluJwppbXBvcnQgeyBnZW5lcmFsTWl4aW4gfSBmcm9tICcuLi8uLi9taXhpbnMvZ2VuZXJhbE1peGluJwppbXBvcnQgeyBldmVudEJ1cyB9IGZyb20gJy4uLy4uL21haW4nCmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtkYXRhU291cmNlc01peGluLCBnZW5lcmFsTWl4aW5dLAogIHZhbGlkYXRpb25zOiB7CiAgICBob3N0OiB7IHJlcXVpcmVkIH0sCiAgICBuYW1lOiB7IHJlcXVpcmVkIH0sCiAgICBzb3VyY2VUeXBlOiB7IHJlcXVpcmVkIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YXNldExpbWl0V2FybjogZmFsc2UsCiAgICAgIG5hbWVFcnJvcnM6IFtdCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBjbG9zZSAoKSB7CiAgICAgIGV2ZW50QnVzLiRlbWl0KCdkYXRhU291cmNlU2F2ZWQnKQogICAgfSwKICAgIHBlcmZvcm1FeHRyYUNoZWNrICgpIHsKICAgICAgLy8gcmVsb2FkIGdlbmVyYWwgY29uZmlnIGFuZCBzZWUgaWYgc3RpbGwgYWxsb3dlZCB0byB1cGxvYWQgbW9yZSBkYXRhIHNvdXJjZXMKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZHluYW1pY1Byb2dyZXNzID0gdHJ1ZQogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5wcm9ncmVzc1RpdGxlID0gJ1BlcmZvcm1pbmcgZXh0cmEgdmFsaWRhdGlvbnMnCiAgICAgIHRoaXMuZ2V0R2VuZXJhbENvbmZpZygoKSA9PiB7CiAgICAgICAgdGhpcy5kYXRhc2V0TGltaXRXYXJuID0gZmFsc2UKICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5keW5hbWljUHJvZ3Jlc3MgPSBmYWxzZQogICAgICAgIGlmICh0aGlzLmNhbkFkZERhdGFzZXQpIHsKICAgICAgICAgIHRoaXMuYWRkRGF0YVNvdXJjZSgnc3luY1NlcnZlcicpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZGF0YXNldExpbWl0V2FybiA9IHRydWUKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgZW5zdXJlTmFtZVVuaXF1ZSAoKSB7CiAgICAgIHRoaXMubmFtZUVycm9ycyA9IFtdCiAgICAgIGlmICh0aGlzLm5hbWUgPT09ICcnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZUVycm9ycy5wdXNoKCdOYW1lIGlzIHJlcXVpcmVkJykKICAgICAgfQogICAgICBpZiAodGhpcy5uYW1lLmxlbmd0aCA+IDM1KSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZUVycm9ycy5wdXNoKCdOYW1lIG11c3Qgbm90IGV4Y2VlZCAzNSBjaGFyYWN0ZXJzJykKICAgICAgfQogICAgICBmb3IgKGxldCBpbnZhbGlkQ2hhciBvZiB0aGlzLmludmFsaWRDaGFyYWN0ZXJzKSB7CiAgICAgICAgaWYgKHRoaXMubmFtZS5pbmRleE9mKGludmFsaWRDaGFyKSAhPT0gLTEpIHsKICAgICAgICAgIHJldHVybiB0aGlzLm5hbWVFcnJvcnMucHVzaCgnTmFtZSBpcyBpbnZhbGlkJykKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChsZXQgZHRTcmMgb2YgdGhpcy4kc3RvcmUuc3RhdGUuZGF0YVNvdXJjZXMpIHsKICAgICAgICBpZiAoZHRTcmMubmFtZSA9PT0gdGhpcy5uYW1lKSB7CiAgICAgICAgICB0aGlzLm5hbWVFcnJvcnMucHVzaCgnVGhpcyBOYW1lIEV4aXN0cycpCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["FacilityReconRemoteSources.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FacilityReconRemoteSources.vue","sourceRoot":"src/components/DataSources","sourcesContent":["<template>\n  <v-container>\n    <v-layout\n      row\n      wrap\n    >\n      <v-spacer></v-spacer>\n      <v-flex xs6>\n        <v-card\n          class=\"mx-auto\"\n          style=\"max-width: 500px;\"\n        >\n          <v-system-bar\n            color=\"deep-purple darken-4\"\n            dark\n          >\n\n          </v-system-bar>\n          <v-toolbar\n            color=\"deep-purple accent-4\"\n            cards\n            dark\n            text\n          >\n            <v-card-title class=\"title font-weight-regular\">Add New Remote Source</v-card-title>\n            <v-spacer></v-spacer>\n            <v-btn\n              icon\n              dark\n              @click.native=\"close()\"\n            >\n              <v-icon>mdi-close</v-icon>\n            </v-btn>\n          </v-toolbar>\n          <v-form\n            ref=\"form\"\n            class=\"pa-3 pt-4\"\n          >\n            <v-select\n              :items=\"$store.state.remoteDataSources\"\n              v-model=\"sourceType\"\n              required\n              label=\"Source Type\"\n            ></v-select>\n            <v-text-field\n              v-model=\"name\"\n              filled\n              required\n              @blur=\"ensureNameUnique\"\n              @input=\"ensureNameUnique\"\n              :error-messages=\"nameErrors\"\n              color=\"deep-purple\"\n              label=\"Source Name\"\n            ></v-text-field>\n            <v-text-field\n              v-model=\"host\"\n              filled\n              required\n              color=\"deep-purple\"\n              label=\"Base URL\"\n            ></v-text-field>\n            <v-text-field\n              v-model=\"username\"\n              filled\n              color=\"deep-purple\"\n              label=\"Username\"\n            ></v-text-field>\n            <v-text-field\n              v-model=\"password\"\n              filled\n              color=\"deep-purple\"\n              label=\"Password\"\n              style=\"min-height: 96px\"\n              type=\"password\"\n            ></v-text-field>\n            <template>\n              <v-tooltip top>\n                <v-checkbox\n                  v-if=\"$store.state.dhis.user.orgId\"\n                  :disabled=\"shareWithAll\"\n                  slot=\"activator\"\n                  color=\"primary\"\n                  label=\"Share with other users of the same org unit as yours\"\n                  v-model=\"shareToSameOrgid\"\n                ></v-checkbox>\n                <span>\n                  Share this dataset with all other users that are on the same org unit as you\n                </span>\n              </v-tooltip>\n              <v-checkbox\n                v-if='$store.state.config.generalConfig.allowShareToAllForNonAdmin || $store.state.auth.role === \"Admin\"'\n                @change=\"sharingOptions\"\n                color=\"primary\"\n                label=\"Share with all other users\"\n                v-model=\"shareWithAll\"\n              >\n              </v-checkbox>\n              <v-tooltip top>\n                <v-checkbox\n                  v-if=\"shareWithAll && $store.state.dhis.user.orgId\"\n                  slot=\"activator\"\n                  color=\"primary\"\n                  label=\"Limit orgs sharing by user orgid\"\n                  v-model=\"limitShareByOrgId\"\n                >\n                </v-checkbox>\n                <span>\n                  if activated, other users will see locations (including location children) that has the same location id as their location id\n                </span>\n              </v-tooltip>\n            </template>\n          </v-form>\n          <v-divider></v-divider>\n          <v-card-actions>\n            <v-spacer></v-spacer>\n            <v-btn\n              @click=\"performExtraCheck\"\n              :disabled=\"$v.$invalid\"\n              class=\"white--text\"\n              color=\"deep-purple accent-4\"\n              depressed\n            >\n              Add\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-flex>\n      <v-spacer></v-spacer>\n    </v-layout>\n  </v-container>\n</template>\n<script>\nimport { required } from 'vuelidate/lib/validators'\nimport { dataSourcesMixin } from './dataSourcesMixin'\nimport { generalMixin } from '../../mixins/generalMixin'\nimport { eventBus } from '../../main'\nexport default {\n  mixins: [dataSourcesMixin, generalMixin],\n  validations: {\n    host: { required },\n    name: { required },\n    sourceType: { required }\n  },\n  data () {\n    return {\n      datasetLimitWarn: false,\n      nameErrors: []\n    }\n  },\n  methods: {\n    close () {\n      eventBus.$emit('dataSourceSaved')\n    },\n    performExtraCheck () {\n      // reload general config and see if still allowed to upload more data sources\n      this.$store.state.dynamicProgress = true\n      this.$store.state.progressTitle = 'Performing extra validations'\n      this.getGeneralConfig(() => {\n        this.datasetLimitWarn = false\n        this.$store.state.dynamicProgress = false\n        if (this.canAddDataset) {\n          this.addDataSource('syncServer')\n        } else {\n          this.datasetLimitWarn = true\n        }\n      })\n    },\n    ensureNameUnique () {\n      this.nameErrors = []\n      if (this.name === '') {\n        return this.nameErrors.push('Name is required')\n      }\n      if (this.name.length > 35) {\n        return this.nameErrors.push('Name must not exceed 35 characters')\n      }\n      for (let invalidChar of this.invalidCharacters) {\n        if (this.name.indexOf(invalidChar) !== -1) {\n          return this.nameErrors.push('Name is invalid')\n        }\n      }\n      for (let dtSrc of this.$store.state.dataSources) {\n        if (dtSrc.name === this.name) {\n          this.nameErrors.push('This Name Exists')\n          return false\n        }\n      }\n    }\n  }\n}\n</script>\n"]}]}