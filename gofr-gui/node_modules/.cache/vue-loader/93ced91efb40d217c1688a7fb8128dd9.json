{"remainingRequest":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/facility-recon-gui/src/components/fhir/fhir-reference.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/facility-recon-gui/src/components/fhir/fhir-reference.vue","mtime":1619258093079},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJaHJpc0VsZW1lbnQgZnJvbSAiLi4vaWhyaXMvaWhyaXMtZWxlbWVudC52dWUiCgpjb25zdCBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJykKY29uc3QgZmhpcnVybCA9ICJodHRwOi8vaGw3Lm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vIgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImZoaXItcmVmZXJlbmNlIiwKICBwcm9wczogWyJmaWVsZCIsImxhYmVsIiwic2xpY2VOYW1lIiwidGFyZ2V0UHJvZmlsZSIsInRhcmdldFJlc291cmNlIiwibWluIiwibWF4IiwiYmFzZS1taW4iLCJiYXNlLW1heCIsCiAgICAic2xvdFByb3BzIiwicGF0aCIsInN1Yi1maWVsZHMiLCJlZGl0IiwicmVhZE9ubHlJZlNldCIsImNvbnN0cmFpbnRzIiwgImRpc3BsYXlUeXBlIiwgImluaXRpYWxWYWx1ZSIsICJvdmVycmlkZVZhbHVlIl0sCiAgY29tcG9uZW50czogewogICAgSWhyaXNFbGVtZW50CiAgfSwKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIHNvdXJjZTogeyBwYXRoOiAiIiwgZGF0YToge30gfSwKICAgICAgdmFsdWU6IHsgcmVmZXJlbmNlOiAiIiB9LAogICAgICBxRmllbGQ6ICJ2YWx1ZVJlZmVyZW5jZSIsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBzZWFyY2g6ICIiLAogICAgICBtZW51OiBmYWxzZSwKICAgICAgaXRlbXM6IFtdLAogICAgICBzZWxlY3Q6ICIiLAogICAgICByZXNvdXJjZTogIiIsCiAgICAgIGF3YWl0aW5nU2VhcmNoOiBmYWxzZSwKICAgICAgZGlzcGxheVZhbHVlOiAiIiwKICAgICAgcHJlc2V0OiBmYWxzZSwKICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICBlcnJvcnM6IFtdLAogICAgICBsb2NrV2F0Y2g6IGZhbHNlLAogICAgICBhY3RpdmU6IFtdLAogICAgICBvcGVuOiBbXSwKICAgICAgdHJlZUxvb2t1cDoge30sCiAgICAgIGFsbEFsbG93ZWQ6IHRydWUKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5zZXR1cERhdGEoKQogIH0sCiAgd2F0Y2g6IHsKICAgIHNsb3RQcm9wczogewogICAgICBoYW5kbGVyKCkgewogICAgICAgIC8vY29uc29sZS5sb2coIldBVENIIFJFRkVSRU5DRSIsdGhpcy5wYXRoLHRoaXMuc2xvdFByb3BzKQogICAgICAgIGlmICggIXRoaXMubG9ja1dhdGNoICkgewogICAgICAgICAgdGhpcy5zZXR1cERhdGEoKQogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfSwKICAgIHNlYXJjaDogZnVuY3Rpb24gKHZhbCkgewogICAgICBpZiAoICF0aGlzLmF3YWl0aW5nU2VhcmNoKSB7CiAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewogICAgICAgICAgdmFsICYmIHZhbC5sZW5ndGggPiAxICYmIHRoaXMucXVlcnlTZWxlY3Rpb25zKCB0aGlzLnNlYXJjaCApCiAgICAgICAgICB0aGlzLmF3YWl0aW5nU2VhcmNoID0gZmFsc2UKICAgICAgICB9LCA1MDAgKQogICAgICB9CiAgICAgIHRoaXMuYXdhaXRpbmdTZWFyY2ggPSB0cnVlCiAgICB9LAogICAgc2VsZWN0OiBmdW5jdGlvbih2YWwpIHsKICAgICAgdGhpcy52YWx1ZS5yZWZlcmVuY2UgPSB2YWwKICAgICAgdGhpcy5nZXREaXNwbGF5KCkKICAgIH0sCiAgICBhY3RpdmU6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIHRoaXMuYWN0aXZlLmxlbmd0aCApIHsKICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMuYWN0aXZlWzBdCiAgICAgICAgdGhpcy5kaXNwbGF5VmFsdWUgPSB0aGlzLnRyZWVMb29rdXBbIHRoaXMuc2VsZWN0IF0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNlbGVjdCA9IHVuZGVmaW5lZAogICAgICAgIHRoaXMuZGlzcGxheVZhbHVlID0gIiIKICAgICAgfQogICAgICB0aGlzLm1lbnUgPSBmYWxzZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2V0dXBEYXRhOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKCB0aGlzLnRhcmdldFByb2ZpbGUgJiYgdGhpcy50YXJnZXRSZXNvdXJjZSApIHsKICAgICAgICBpZiAoIHRoaXMudGFyZ2V0UHJvZmlsZS5yZXBsYWNlKCBmaGlydXJsLCAiIiApID09PSB0aGlzLnRhcmdldFJlc291cmNlICkgewogICAgICAgICAgdGhpcy5hbGxBbGxvd2VkID0gdHJ1ZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmFsbEFsbG93ZWQgPSBmYWxzZQogICAgICAgIH0KICAgICAgICB0aGlzLnJlc291cmNlID0gdGhpcy50YXJnZXRSZXNvdXJjZQogICAgICB9CiAgICAgIGlmICggdGhpcy5kaXNwbGF5VHlwZSA9PT0gInRyZWUiICkgewogICAgICAgIHRoaXMuc2V0dXBUcmVlSXRlbXMoKQogICAgICB9CiAgICAgIGlmICggdGhpcy5zbG90UHJvcHMgJiYgdGhpcy5zbG90UHJvcHMuc291cmNlICkgewogICAgICAgIHRoaXMuc291cmNlID0geyBwYXRoOiB0aGlzLnNsb3RQcm9wcy5zb3VyY2UucGF0aCsiLiIrdGhpcy5maWVsZCwgZGF0YToge30gfQogICAgICAgIGlmICggdGhpcy5zbG90UHJvcHMuc291cmNlLmZyb21BcnJheSApIHsKICAgICAgICAgIHRoaXMuc291cmNlLmRhdGEgPSB0aGlzLnNsb3RQcm9wcy5zb3VyY2UuZGF0YQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsZXQgZXhwcmVzc2lvbiA9IHRoaXMuJGZoaXJ1dGlscy5wYXRoRmllbGRFeHByZXNzaW9uKCB0aGlzLmZpZWxkICkKICAgICAgICAgIGxldCByZXN1bHRzID0gdGhpcy4kZmhpcnBhdGguZXZhbHVhdGUoIHRoaXMuc2xvdFByb3BzLnNvdXJjZS5kYXRhLCBleHByZXNzaW9uICkKICAgICAgICAgIHRoaXMuc291cmNlLmRhdGEgPSByZXN1bHRzWzBdCiAgICAgICAgfQogICAgICAgIGlmKCB0aGlzLnNvdXJjZS5kYXRhICkgewogICAgICAgICAgdGhpcy5wcmVzZXQgPSB0cnVlCiAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMuc291cmNlLmRhdGEucmVmZXJlbmNlCiAgICAgICAgICB0aGlzLmxvY2tXYXRjaCA9IHRydWUKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5kaXNhYmxlZCA9IHRoaXMucmVhZE9ubHlJZlNldCAmJiB0aGlzLnByZXNldAogICAgfSwKICAgIHNldHVwVHJlZUl0ZW1zOiBmdW5jdGlvbigpIHsKICAgICAgbGV0IHRyZWV0b3AgPSB0aGlzLmluaXRpYWxWYWx1ZQogICAgICBpZiAoIHRoaXMub3ZlcnJpZGVWYWx1ZSApIHsKICAgICAgICB0cmVldG9wID0gdGhpcy5vdmVycmlkZVZhbHVlCiAgICAgIH0KICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICBsZXQgcGFyYW1zID0ge30KICAgICAgaWYgKCB0cmVldG9wICkgewogICAgICAgIHBhcmFtcyA9IHsgInBhcnRvZiI6IHRyZWV0b3AgfQogICAgICB9IGVsc2UgewogICAgICAgIHBhcmFtcyA9IHsgInBhcnRvZjptaXNzaW5nIjogdHJ1ZSB9CiAgICAgIH0KICAgICAgcGFyYW1zLl9jb3VudCA9IDUwMAogICAgICBsZXQgdXJsID0gIi9maGlyLyIrdGhpcy5yZXNvdXJjZSsiPyIrcXVlcnlzdHJpbmcuc3RyaW5naWZ5KCBwYXJhbXMgKQogICAgICB0aGlzLml0ZW1zID0gW10KICAgICAgdGhpcy5hZGRJdGVtcyggdXJsLCB0aGlzLml0ZW1zICkKCiAgICB9LAogICAgY2hlY2tDaGlsZHJlbjogZnVuY3Rpb24oaXRlbSkgewogICAgICBsZXQgcGFyYW1zID0geyAicGFydG9mIjogaXRlbS5pZCwgIl9zdW1tYXJ5IjogImNvdW50IiB9CiAgICAgIGxldCB1cmwgPSAiL2ZoaXIvIit0aGlzLnJlc291cmNlKyI/IitxdWVyeXN0cmluZy5zdHJpbmdpZnkoIHBhcmFtcyApCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSggcmVzb2x2ZSA9PiB7CiAgICAgICAgZmV0Y2goIHVybCApLnRoZW4oIHJlc3BvbnNlID0+IHsKICAgICAgICAgIGlmICggcmVzcG9uc2Uub2sgKSB7CiAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKCBkYXRhID0+IHsKICAgICAgICAgICAgICBpZiAoIGRhdGEudG90YWwgJiYgZGF0YS50b3RhbCA+IDAgKSB7CiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuID0gW10KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmVzb2x2ZSgpCiAgICAgICAgICAgIH0gKS5jYXRjaCggZXJyID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZmFpbGVkIHRvIGNoZWNrIGNoaWxkcmVuIGZvciIsdXJsLGVycikKICAgICAgICAgICAgICByZXNvbHZlKCkKICAgICAgICAgICAgfSApCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygiZmFpbGVkIHRvIGNoZWNrIGNoaWxkcmVuIGZvciIsdXJsLHJlc3BvbnNlLnN0YXR1cykKICAgICAgICAgICAgcmVzb2x2ZSgpCiAgICAgICAgICB9CiAgICAgICAgfSApLmNhdGNoKCBlcnIgPT4gewogICAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCB0byBjaGVjayBjaGlsZHJlbiBmb3IiLHVybCxlcnIpCiAgICAgICAgICByZXNvbHZlKCkKICAgICAgICB9ICkKICAgICAgfSApCiAgICB9LAogICAgYWRkSXRlbXM6IGZ1bmN0aW9uKHVybCwgaXRlbXMpIHsKICAgICAgZmV0Y2goIHVybCApLnRoZW4oIHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAoIHJlc3BvbnNlLm9rICkgewogICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oIGFzeW5jIGRhdGEgPT4gewogICAgICAgICAgICBpZiAoIGRhdGEuZW50cnkgJiYgZGF0YS5lbnRyeS5sZW5ndGggPiAwICkgewogICAgICAgICAgICAgIGZvciggbGV0IGVudHJ5IG9mIGRhdGEuZW50cnkgKSB7CiAgICAgICAgICAgICAgICBsZXQgbG9ja2VkID0gdGhpcy5hbGxBbGxvd2VkID8gZmFsc2UgOiAhZW50cnkucmVzb3VyY2UubWV0YS5wcm9maWxlLmluY2x1ZGVzKCB0aGlzLnRhcmdldFByb2ZpbGUgKQogICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7IAogICAgICAgICAgICAgICAgICBpZDogZW50cnkucmVzb3VyY2UucmVzb3VyY2VUeXBlKyIvIitlbnRyeS5yZXNvdXJjZS5pZCwKICAgICAgICAgICAgICAgICAgbmFtZTogZW50cnkucmVzb3VyY2UubmFtZSwKICAgICAgICAgICAgICAgICAgbG9ja2VkOiBsb2NrZWQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuY2hlY2tDaGlsZHJlbiggaXRlbSApCiAgICAgICAgICAgICAgICB0aGlzLnRyZWVMb29rdXBbIGl0ZW0uaWQgXSA9IGl0ZW0ubmFtZQogICAgICAgICAgICAgICAgaXRlbXMucHVzaCggaXRlbSApCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICggZGF0YS5saW5rICkgewogICAgICAgICAgICAgIGxldCBuZXh0ID0gZGF0YS5saW5rLmZpbmQoIGxpbmsgPT4gbGluay5yZWxhdGlvbiA9PT0gIm5leHQiICkKICAgICAgICAgICAgICBpZiAoIG5leHQgKSB7CiAgICAgICAgICAgICAgICB0aGlzLmFkZEl0ZW1zKCBuZXh0LnVybCwgaXRlbXMgKQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICB9ICkuY2F0Y2goIGVyciA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGYWlsZWQgdG8gYWRkIGl0ZW1zIGZvciIsdXJsLGVycikKICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICAgIH0gKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIGFkZCBpdGVtcyBmb3IiLHVybCxyZXNwb25zZS5zdGF0dXMpCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIH0KICAgICAgfSApLmNhdGNoKCBlcnIgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCJGYWlsZWQgdG8gYWRkIGl0ZW1zIGZvciIsdXJsLGVycikKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICB9ICkKICAgIH0sCiAgICBmZXRjaENoaWxkcmVuOiBmdW5jdGlvbihpdGVtKSB7CiAgICAgIGxldCBwYXJhbXMgPSB7fQogICAgICBwYXJhbXMgPSB7ICJwYXJ0b2YiOiBpdGVtLmlkLCBfY291bnQ6IDUwMCB9CiAgICAgIGxldCB1cmwgPSAiL2ZoaXIvIit0aGlzLnJlc291cmNlKyI/IitxdWVyeXN0cmluZy5zdHJpbmdpZnkoIHBhcmFtcyApCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgdGhpcy5hZGRJdGVtcyggdXJsLCBpdGVtLmNoaWxkcmVuICkKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCByZXNvbHZlID0+IHsKICAgICAgICBsZXQgY291bnQgPSAwCiAgICAgICAgY29uc3QgY2hlY2tMb2FkaW5nID0gKCkgPT4gewogICAgICAgICAgaWYgKCAhdGhpcy5sb2FkaW5nIHx8IGNvdW50KysgPiAxMDApIHsKICAgICAgICAgICAgcmVzb2x2ZSgpCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXRUaW1lb3V0KCBjaGVja0xvYWRpbmcsIDIwMCApCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNoZWNrTG9hZGluZygpCiAgICAgIH0gKQogICAgfSwKICAgIHF1ZXJ5U2VsZWN0aW9uczogZnVuY3Rpb24oIHZhbCApIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICBsZXQgcGFyYW1zID0geyAibmFtZTpjb250YWlucyI6IHZhbCB9CiAgICAgIGlmICggIXRoaXMudGFyZ2V0UHJvZmlsZS5lbmRzV2l0aCggdGhpcy5yZXNvdXJjZSApICkgewogICAgICAgIHBhcmFtcy5fcHJvZmlsZSA9IHRoaXMudGFyZ2V0UHJvZmlsZQogICAgICB9CiAgICAgIGxldCB1cmwgPSAiL2ZoaXIvIit0aGlzLnJlc291cmNlKyI/IitxdWVyeXN0cmluZy5zdHJpbmdpZnkoIHBhcmFtcyApCiAgICAgIGZldGNoKCB1cmwgKS50aGVuKCByZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKCByZXNwb25zZS5vayApIHsKICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKCBhc3luYyAoZGF0YSkgPT4gewogICAgICAgICAgICB0aGlzLml0ZW1zID0gW10KICAgICAgICAgICAgaWYgKCBkYXRhLmVudHJ5ICYmIGRhdGEuZW50cnkubGVuZ3RoICkgewogICAgICAgICAgICAgIGZvciggbGV0IGVudHJ5IG9mIGRhdGEuZW50cnkgKSB7CiAgICAgICAgICAgICAgICBsZXQgcmVmID0gZW50cnkucmVzb3VyY2UucmVzb3VyY2VUeXBlKyIvIitlbnRyeS5yZXNvdXJjZS5pZAogICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7IHZhbHVlOiByZWYgfQogICAgICAgICAgICAgICAgaXRlbS50ZXh0ID0gYXdhaXQgdGhpcy4kZmhpcnV0aWxzLnJlc291cmNlTG9va3VwKCByZWYgKQogICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKCBpdGVtICkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICAgIH0gKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHJldHJpZXZlIix0aGlzLnJlc291cmNlKQogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB9CiAgICAgIH0gKQogICAgfSwKICAgIGdldERpc3BsYXk6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoICghdGhpcy5lZGl0IHx8IHRoaXMucHJlc2V0KSAmJiB0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUucmVmZXJlbmNlICkgewogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgICB0aGlzLiRmaGlydXRpbHMucmVzb3VyY2VMb29rdXAoIHRoaXMudmFsdWUucmVmZXJlbmNlICkudGhlbiggZGlzcGxheSA9PiB7CiAgICAgICAgICB0aGlzLmRpc3BsYXlWYWx1ZSA9IGRpc3BsYXkKICAgICAgICAgIGlmICggdGhpcy5kaXNwbGF5VHlwZSAhPT0gInRyZWUiICkgewogICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goIHt0ZXh0OiBkaXNwbGF5LCB2YWx1ZTogdGhpcy52YWx1ZS5yZWZlcmVuY2V9ICkKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgfSApCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBpbmRleDogZnVuY3Rpb24oKSB7CiAgICAgIGlmICggdGhpcy5zbG90UHJvcHMgKSByZXR1cm4gdGhpcy5zbG90UHJvcHMuaW5wdXQKICAgICAgZWxzZSByZXR1cm4gdW5kZWZpbmVkCiAgICB9LAogICAgZGlzcGxheTogZnVuY3Rpb24oKSB7CiAgICAgIGlmICggdGhpcy5zbG90UHJvcHMgJiYgdGhpcy5zbG90UHJvcHMuaW5wdXQpIHJldHVybiB0aGlzLnNsb3RQcm9wcy5pbnB1dC5sYWJlbAogICAgICBlbHNlIHJldHVybiB0aGlzLmxhYmVsCiAgICB9LAogICAgcmVxdWlyZWQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gKHRoaXMuaW5kZXggfHwgMCkgPCB0aGlzLm1pbgogICAgfSwKICAgIHJ1bGVzOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKCB0aGlzLnJlcXVpcmVkICkgewogICAgICAgIHJldHVybiBbIHYgPT4gISF2IHx8IHRoaXMuZGlzcGxheSsiIGlzIHJlcXVpcmVkIiBdCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgIH0KICB9Cgp9Cg=="},{"version":3,"sources":["fhir-reference.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"fhir-reference.vue","sourceRoot":"src/components/fhir","sourcesContent":["<template>\n  <ihris-element :edit=\"edit\" :loading=\"loading\">\n    <template #form>\n      <v-menu \n        v-if=\"displayType == 'tree'\"\n        ref=\"menu\"\n        v-model=\"menu\"\n        :close-on-content-click=\"false\"\n        transition=\"scale-transition\"\n        offset-y\n        min-width=\"290px\"\n        max-height=\"500px\"\n        >\n        <template v-slot:activator=\"{ on }\">\n          <v-text-field\n            v-model=\"displayValue\"\n            :label=\"display\"\n            readonly\n            v-on=\"on\"\n            outlined\n            hide-details=\"auto\"\n            :rules=\"rules\"\n            :error-messages=\"errors\"\n            :loading=\"loading\"\n            dense>\n            <template #label>{{display}} <span v-if=\"required\" class=\"red--text font-weight-bold\">*</span></template>\n          </v-text-field>\n        </template>\n        <v-card v-if=\"!((disabled) || (preset && $route.name === 'resource_add'))\">\n          <v-treeview\n            :active.sync=\"active\"\n            :items=\"items\"\n            :load-children=\"fetchChildren\"\n            :open.sync=\"open\"\n            item-disabled=\"locked\"\n            activatable\n            :multiple-active=\"false\"\n            selection-type=\"independent\"\n            :loading=\"loading\"\n            ></v-treeview>\n        </v-card>\n      </v-menu>\n      <v-autocomplete\n        v-else\n        v-model=\"select\"\n        :loading=\"loading\"\n        :items=\"items\"\n        :search-input.sync=\"search\"\n        cache-items\n        flat\n        hide-no-data\n        hide-details\n        :label=\"display\"\n        outlined\n        dense\n        placeholder=\"Start typing for selection\"\n        :rules=\"rules\"\n        :disabled=\"(disabled) || (preset && $route.name === 'resource_add')\"\n        :error-messages=\"errors\"\n        @change=\"errors = []\"\n      >\n        <template #label>{{display}} <span v-if=\"required\" class=\"red--text font-weight-bold\">*</span></template>\n      </v-autocomplete>\n    </template>\n    <template #header>\n      {{display}}\n    </template>\n    <template #value>\n      {{displayValue}}\n    </template>\n  </ihris-element>\n</template>\n\n<script>\nimport IhrisElement from \"../ihris/ihris-element.vue\"\n\nconst querystring = require('querystring')\nconst fhirurl = \"http://hl7.org/fhir/StructureDefinition/\"\nexport default {\n  name: \"fhir-reference\",\n  props: [\"field\",\"label\",\"sliceName\",\"targetProfile\",\"targetResource\",\"min\",\"max\",\"base-min\",\"base-max\",\n    \"slotProps\",\"path\",\"sub-fields\",\"edit\",\"readOnlyIfSet\",\"constraints\", \"displayType\", \"initialValue\", \"overrideValue\"],\n  components: {\n    IhrisElement\n  },\n  data: function() {\n    return {\n      source: { path: \"\", data: {} },\n      value: { reference: \"\" },\n      qField: \"valueReference\",\n      loading: false,\n      search: \"\",\n      menu: false,\n      items: [],\n      select: \"\",\n      resource: \"\",\n      awaitingSearch: false,\n      displayValue: \"\",\n      preset: false,\n      disabled: false,\n      errors: [],\n      lockWatch: false,\n      active: [],\n      open: [],\n      treeLookup: {},\n      allAllowed: true\n    }\n  },\n  created: function() {\n    this.setupData()\n  },\n  watch: {\n    slotProps: {\n      handler() {\n        //console.log(\"WATCH REFERENCE\",this.path,this.slotProps)\n        if ( !this.lockWatch ) {\n          this.setupData()\n        }\n      },\n      deep: true\n    },\n    search: function (val) {\n      if ( !this.awaitingSearch) {\n        setTimeout( () => {\n          val && val.length > 1 && this.querySelections( this.search )\n          this.awaitingSearch = false\n        }, 500 )\n      }\n      this.awaitingSearch = true\n    },\n    select: function(val) {\n      this.value.reference = val\n      this.getDisplay()\n    },\n    active: function() {\n      if ( this.active.length ) {\n        this.select = this.active[0]\n        this.displayValue = this.treeLookup[ this.select ]\n      } else {\n        this.select = undefined\n        this.displayValue = \"\"\n      }\n      this.menu = false\n    }\n  },\n  methods: {\n    setupData: function() {\n      if ( this.targetProfile && this.targetResource ) {\n        if ( this.targetProfile.replace( fhirurl, \"\" ) === this.targetResource ) {\n          this.allAllowed = true\n        } else {\n          this.allAllowed = false\n        }\n        this.resource = this.targetResource\n      }\n      if ( this.displayType === \"tree\" ) {\n        this.setupTreeItems()\n      }\n      if ( this.slotProps && this.slotProps.source ) {\n        this.source = { path: this.slotProps.source.path+\".\"+this.field, data: {} }\n        if ( this.slotProps.source.fromArray ) {\n          this.source.data = this.slotProps.source.data\n        } else {\n          let expression = this.$fhirutils.pathFieldExpression( this.field )\n          let results = this.$fhirpath.evaluate( this.slotProps.source.data, expression )\n          this.source.data = results[0]\n        }\n        if( this.source.data ) {\n          this.preset = true\n          this.select = this.source.data.reference\n          this.lockWatch = true\n        }\n      }\n      this.disabled = this.readOnlyIfSet && this.preset\n    },\n    setupTreeItems: function() {\n      let treetop = this.initialValue\n      if ( this.overrideValue ) {\n        treetop = this.overrideValue\n      }\n      this.loading = true\n      let params = {}\n      if ( treetop ) {\n        params = { \"partof\": treetop }\n      } else {\n        params = { \"partof:missing\": true }\n      }\n      params._count = 500\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      this.items = []\n      this.addItems( url, this.items )\n\n    },\n    checkChildren: function(item) {\n      let params = { \"partof\": item.id, \"_summary\": \"count\" }\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      return new Promise( resolve => {\n        fetch( url ).then( response => {\n          if ( response.ok ) {\n            response.json().then( data => {\n              if ( data.total && data.total > 0 ) {\n                item.children = []\n              }\n              resolve()\n            } ).catch( err => {\n              console.log(\"failed to check children for\",url,err)\n              resolve()\n            } )\n          } else {\n            console.log(\"failed to check children for\",url,response.status)\n            resolve()\n          }\n        } ).catch( err => {\n          console.log(\"failed to check children for\",url,err)\n          resolve()\n        } )\n      } )\n    },\n    addItems: function(url, items) {\n      fetch( url ).then( response => {\n        if ( response.ok ) {\n          response.json().then( async data => {\n            if ( data.entry && data.entry.length > 0 ) {\n              for( let entry of data.entry ) {\n                let locked = this.allAllowed ? false : !entry.resource.meta.profile.includes( this.targetProfile )\n                let item = { \n                  id: entry.resource.resourceType+\"/\"+entry.resource.id,\n                  name: entry.resource.name,\n                  locked: locked\n                }\n                await this.checkChildren( item )\n                this.treeLookup[ item.id ] = item.name\n                items.push( item )\n              }\n            }\n            if ( data.link ) {\n              let next = data.link.find( link => link.relation === \"next\" )\n              if ( next ) {\n                this.addItems( next.url, items )\n              } else {\n                this.loading = false\n              }\n            } else {\n              this.loading = false\n            }\n          } ).catch( err => {\n            console.log(\"Failed to add items for\",url,err)\n            this.loading = false\n          } )\n        } else {\n          console.log(\"Failed to add items for\",url,response.status)\n          this.loading = false\n        }\n      } ).catch( err => {\n        console.log(\"Failed to add items for\",url,err)\n        this.loading = false\n      } )\n    },\n    fetchChildren: function(item) {\n      let params = {}\n      params = { \"partof\": item.id, _count: 500 }\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      this.loading = true\n      this.addItems( url, item.children )\n      return new Promise( resolve => {\n        let count = 0\n        const checkLoading = () => {\n          if ( !this.loading || count++ > 100) {\n            resolve()\n          } else {\n            setTimeout( checkLoading, 200 )\n          }\n        }\n        checkLoading()\n      } )\n    },\n    querySelections: function( val ) {\n      this.loading = true\n      let params = { \"name:contains\": val }\n      if ( !this.targetProfile.endsWith( this.resource ) ) {\n        params._profile = this.targetProfile\n      }\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      fetch( url ).then( response => {\n        if ( response.ok ) {\n          response.json().then( async (data) => {\n            this.items = []\n            if ( data.entry && data.entry.length ) {\n              for( let entry of data.entry ) {\n                let ref = entry.resource.resourceType+\"/\"+entry.resource.id\n                let item = { value: ref }\n                item.text = await this.$fhirutils.resourceLookup( ref )\n                this.items.push( item )\n              }\n            }\n            this.loading = false\n          } )\n        } else {\n          console.log(\"Failed to retrieve\",this.resource)\n          this.loading = false\n        }\n      } )\n    },\n    getDisplay: function() {\n      if ( (!this.edit || this.preset) && this.value && this.value.reference ) {\n        this.loading = true\n        this.$fhirutils.resourceLookup( this.value.reference ).then( display => {\n          this.displayValue = display\n          if ( this.displayType !== \"tree\" ) {\n            this.items.push( {text: display, value: this.value.reference} )\n          }\n          this.loading = false\n        } )\n      }\n    }\n  },\n  computed: {\n    index: function() {\n      if ( this.slotProps ) return this.slotProps.input\n      else return undefined\n    },\n    display: function() {\n      if ( this.slotProps && this.slotProps.input) return this.slotProps.input.label\n      else return this.label\n    },\n    required: function() {\n      return (this.index || 0) < this.min\n    },\n    rules: function() {\n      if ( this.required ) {\n        return [ v => !!v || this.display+\" is required\" ]\n      } else {\n        return []\n      }\n    }\n  }\n\n}\n</script>\n"]}]}