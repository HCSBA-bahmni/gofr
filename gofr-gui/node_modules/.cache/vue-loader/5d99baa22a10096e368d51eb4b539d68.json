{"remainingRequest":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/facility-recon-gui/src/components/ihris/ihris-resource.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/facility-recon-gui/src/components/ihris/ihris-resource.vue","mtime":1619771126601},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiaWhyaXMtcmVzb3VyY2UiLAogIHByb3BzOiBbInRpdGxlIiwiZmllbGQiLCJmaGlyLWlkIiwicGFnZSIsInByb2ZpbGUiLCJzZWN0aW9uLW1lbnUiLCJlZGl0IiwibGlua3MiLCJjb25zdHJhaW50cyIgXSwKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIGZoaXI6IHt9LAogICAgICBvcmlnOiB7fSwKICAgICAgdmFsaWQ6IHRydWUsCiAgICAgIHNvdXJjZTogeyBkYXRhOiB7fSwgcGF0aDogIiIgfSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIG92ZXJsYXk6IGZhbHNlLAogICAgICBpc0VkaXQ6IGZhbHNlLAogICAgICBsaW5rdGV4dDogWyBdLAogICAgICBhZHZhbmNlZFZhbGlkOiB0cnVlCiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbigpIHsKICAgIGlmICggdGhpcy5maGlySWQgKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgLy9jb25zb2xlLmxvZygiZ2V0dGluZyIsdGhpcy5maWVsZCx0aGlzLmZoaXJJZCkKICAgICAgZmV0Y2goICIvZmhpci8iK3RoaXMuZmllbGQrIi8iK3RoaXMuZmhpcklkICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICAvL3RoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Q3VycmVudFJlc291cmNlJywgZGF0YSkKICAgICAgICAgIHRoaXMub3JpZyA9IGRhdGEKICAgICAgICAgIHRoaXMuc291cmNlID0geyBkYXRhOiBkYXRhLCBwYXRoOiB0aGlzLmZpZWxkIH0KICAgICAgICAgIHRoaXMuc2V0TGlua1RleHQoKQogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB9KS5jYXRjaChlcnI9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmZpZWxkLHRoaXMuZmhpcklkLGVycikKICAgICAgICB9KQogICAgICB9KS5jYXRjaChlcnI9PiB7CiAgICAgICAgY29uc29sZS5sb2codGhpcy5maWVsZCx0aGlzLmZoaXJJZCxlcnIpCiAgICAgIH0pCiAgICB9IGVsc2UgaWYgKCB0aGlzLiRyb3V0ZS5xdWVyeSApIHsKICAgICAgbGV0IHByZXNldHMgPSB7CiAgICAgICAgcmVzb3VyY2VUeXBlOiB0aGlzLmZpZWxkCiAgICAgIH0KICAgICAgbGV0IGhhc1ByZXNldHMgPSBmYWxzZQogICAgICBmb3IoIGxldCBwYXRoIG9mIE9iamVjdC5rZXlzKCB0aGlzLiRyb3V0ZS5xdWVyeSApICkgewogICAgICAgIGlmICggcGF0aC5zdGFydHNXaXRoKCB0aGlzLmZpZWxkICsiLiIgKSApIHsKICAgICAgICAgIGhhc1ByZXNldHMgPSB0cnVlCiAgICAgICAgICBsZXQgZWxlbWVudHMgPSBwYXRoLnN1YnN0cmluZyggdGhpcy5maWVsZC5sZW5ndGgrMSApLnNwbGl0KCcuJykKICAgICAgICAgIGxldCBsYXN0ID0gZWxlbWVudHMucG9wKCkKICAgICAgICAgIGxldCBjdXJyZW50ID0gcHJlc2V0cwogICAgICAgICAgZm9yKCBsZXQgZWxlbWVudCBvZiBlbGVtZW50cyApIHsKICAgICAgICAgICAgaWYgKCBlbGVtZW50LmluY2x1ZGVzKCdbJykgKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCBwYXJ0cyA9IGVsZW1lbnQuc3BsaXQoJ1snKQogICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBwYXJ0c1swXQogICAgICAgICAgICAgICAgbGV0IGlkeCA9IHBhcnRzWzFdLnNsaWNlKDAsLTEpCiAgICAgICAgICAgICAgICBpZiAoICFjdXJyZW50Lmhhc093blByb3BlcnR5KG5hbWUpICkgewogICAgICAgICAgICAgICAgICBjdXJyZW50W25hbWVdID0gW10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICggaWR4ICkgewogICAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IHt9CiAgICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV1bcGFyc2VJbnQoaWR4KV0gPSBuZXh0CiAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBuZXh0CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IHt9CiAgICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV0ucHVzaCggbmV4dCApCiAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBuZXh0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlVuYWJsZSB0byBwcm9jZXNzIixwYXRoKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKCAhY3VycmVudC5oYXNPd25Qcm9wZXJ0eShlbGVtZW50KSApIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRbZWxlbWVudF0gPSB7fQogICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbZWxlbWVudF0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICggbGFzdC5pbmNsdWRlcygnWycpICkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGxldCBwYXJ0cyA9IGxhc3Quc3BsaXQoJ1snKQogICAgICAgICAgICAgIGxldCBuYW1lID0gcGFydHNbMF0KICAgICAgICAgICAgICBsZXQgaWR4ID0gcGFydHNbMV0uc2xpY2UoMCwtMSkKICAgICAgICAgICAgICBpZiAoICFjdXJyZW50Lmhhc093blByb3BlcnR5KG5hbWUpICkgewogICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXSA9IFtdCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICggaWR4ICkgewogICAgICAgICAgICAgICAgY3VycmVudFtuYW1lXVtwYXJzZUludChpZHgpXSA9IHRoaXMuJHJvdXRlLnF1ZXJ5W3BhdGhdCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRbbmFtZV0ucHVzaCggdGhpcy4kcm91dGUucXVlcnlbcGF0aF0gKQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0gY2F0Y2goIGVyciApIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHByb2Nlc3MiLHBhdGgpCiAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3VycmVudFtsYXN0XSA9IHRoaXMuJHJvdXRlLnF1ZXJ5W3BhdGhdCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICggaGFzUHJlc2V0cyApIHsKICAgICAgICB0aGlzLnNvdXJjZSA9IHsgZGF0YTogcHJlc2V0cywgcGF0aDogdGhpcy5maWVsZCB9CiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBoYXNGaGlySWQ6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIHRoaXMuZmhpcklkID09ICcnICkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9IGVsc2UgaWYgKCAhdGhpcy5maGlySWQgKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfQogICAgLyoKICAgIHNvdXJjZTogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5maGlyCiAgICB9CiAgICAqLwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlua0ZpZWxkOiBmdW5jdGlvbihmaWVsZCkgewogICAgICBsZXQgY29udGVudCA9IHRoaXMuJGZoaXJwYXRoLmV2YWx1YXRlKCB0aGlzLnNvdXJjZS5kYXRhLCBmaWVsZCApCiAgICAgIGlmICggY29udGVudCApIHsKICAgICAgICByZXR1cm4gY29udGVudFswXQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9LAogICAgZ2V0TGlua1VybDogZnVuY3Rpb24obGluaykgewogICAgICBsZXQgZmllbGQKICAgICAgaWYgKCBsaW5rLmZpZWxkICkgewogICAgICAgIGZpZWxkID0gdGhpcy5nZXRMaW5rRmllbGQobGluay5maWVsZCkKICAgICAgfQogICAgICBpZiAoIGZpZWxkICkgewogICAgICAgIGlmICggZmllbGQuaW5jbHVkZXMoJy8nKSApIHsKICAgICAgICAgIGxldCByZWYgPSBmaWVsZC5zcGxpdCgnLycpCiAgICAgICAgICBmaWVsZCA9IHJlZlsxXQogICAgICAgIH0KICAgICAgICByZXR1cm4gbGluay51cmwucmVwbGFjZSgiRklFTEQiLGZpZWxkKQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBsaW5rLnVybCAKICAgICAgfQogICAgfSwKICAgIHNldExpbmtUZXh0OiBmdW5jdGlvbigpIHsKICAgICAgZm9yICggbGV0IGlkeCBpbiB0aGlzLmxpbmtzICkgewogICAgICAgIGxldCBsaW5rID0gdGhpcy5saW5rc1tpZHhdCiAgICAgICAgaWYgKCBsaW5rLnRleHQgKSB7CiAgICAgICAgICB0aGlzLmxpbmt0ZXh0W2lkeF0gPSBsaW5rLnRleHQKICAgICAgICB9IGVsc2UgaWYgKCBsaW5rLmZpZWxkICkgewogICAgICAgICAgbGV0IGZpZWxkID0gdGhpcy5nZXRMaW5rRmllbGQobGluay5maWVsZCkKICAgICAgICAgIGlmICggZmllbGQgKSB7CiAgICAgICAgICAgIHRoaXMuJGZoaXJ1dGlscy5sb29rdXAoZmllbGQpLnRoZW4oIGRpc3BsYXkgPT4gewogICAgICAgICAgICAgIHRoaXMuJHNldCggdGhpcy5saW5rdGV4dCwgaWR4LCBkaXNwbGF5ICkKICAgICAgICAgICAgfSApCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcHJvY2Vzc0ZISVI6IGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKQogICAgICBpZiAoICF0aGlzLnZhbGlkICkgcmV0dXJuCiAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IHRydWUKICAgICAgdGhpcy5vdmVybGF5ID0gdHJ1ZQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCgogICAgICAvL2NvbnN0IHByb2Nlc3NDaGlsZHJlbiA9IGZ1bmN0aW9uKCBwYXJlbnQsIG9iaiwgY2hpbGRyZW4gKSB7CiAgICAgIGNvbnN0IHByb2Nlc3NDaGlsZHJlbiA9IGFzeW5jICggcGFyZW50LCBvYmosIGNoaWxkcmVuICkgPT4gewogICAgICAgIC8vY29uc29sZS5sb2coImNhbGxlZCBvbiAiK3BhcmVudCkKCiAgICAgICAgZm9yKCBsZXQgY2hpbGQgb2YgY2hpbGRyZW4gKSB7CgogICAgICAgICAgbGV0IGZ1bGxGaWVsZCA9IHBhcmVudAoKICAgICAgICAgIGxldCBuZXh0ID0gb2JqCgogICAgICAgICAgaWYgKCBjaGlsZC5maWVsZCAmJiAhY2hpbGQuZmllbGRUeXBlIC8qIGlnbm9yZSBhcnJheXMgKi8gKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIndvcmtpbmcgb24gIitwYXJlbnQrIiAuICIrY2hpbGQuZmllbGQpCiAgICAgICAgICAgIGxldCBmaWVsZAogICAgICAgICAgICBpZiAoIGNoaWxkLnNsaWNlTmFtZSApIHsKICAgICAgICAgICAgICBpZiAoIGNoaWxkLmZpZWxkLnN0YXJ0c1dpdGgoInZhbHVlW3hdIikgKSB7CiAgICAgICAgICAgICAgICBmaWVsZCA9IGNoaWxkLmZpZWxkLnN1YnN0cmluZyg5KQogICAgICAgICAgICAgICAgZnVsbEZpZWxkICs9ICIuIiArIGZpZWxkCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZpZWxkID0gY2hpbGQuZmllbGQucmVwbGFjZSgiOiIrY2hpbGQuc2xpY2VOYW1lLCAiIikKICAgICAgICAgICAgICAgIGZ1bGxGaWVsZCArPSAiLiIgKyBmaWVsZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBmaWVsZCA9IGNoaWxkLmZpZWxkCiAgICAgICAgICAgICAgZnVsbEZpZWxkICs9ICIuIitmaWVsZAogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICggY2hpbGQubWF4ICE9PSAiMSIgfHwgY2hpbGQuYmFzZU1heCAhPT0gIjEiICkgewogICAgICAgICAgICAgIGlmICggIW9iai5oYXNPd25Qcm9wZXJ0eShmaWVsZCkgKSB7CiAgICAgICAgICAgICAgICBuZXh0W2ZpZWxkXSA9IFtdCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG5leHRbZmllbGRdID0ge30KICAgICAgICAgICAgfQogICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZ1bGxGaWVsZCkKICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjaGlsZC5tYXgsIGNoaWxkLmJhc2VNYXgpCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coY2hpbGQpCiAgICAgICAgICAgIGlmICggY2hpbGQuaGFzT3duUHJvcGVydHkoInZhbHVlIikgKSB7CiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyggZnVsbEZpZWxkICsiPSIrIGNoaWxkLnZhbHVlICkKICAgICAgICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIG5leHRbZmllbGRdICkgKSB7CiAgICAgICAgICAgICAgICBuZXh0W2ZpZWxkXS5wdXNoKCBjaGlsZC52YWx1ZSApCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5leHRbZmllbGRdID0gY2hpbGQudmFsdWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbmV4dCA9IG5leHRbZmllbGRdCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCBuZXh0W2ZpZWxkXSApICkgewogICAgICAgICAgICAgICAgbGV0IHN1YiA9IHt9CiAgICAgICAgICAgICAgICBpZiAoIGNoaWxkLnByb2ZpbGUgKSB7CiAgICAgICAgICAgICAgICAgIHN1Yi51cmwgPSBjaGlsZC5wcm9maWxlCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBmaWVsZCA9PT0gImV4dGVuc2lvbiIgJiYgY2hpbGQuc2xpY2VOYW1lICkgewogICAgICAgICAgICAgICAgICBzdWIudXJsID0gY2hpbGQuc2xpY2VOYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBuZXh0W2ZpZWxkXS5wdXNoKCBzdWIgKQogICAgICAgICAgICAgICAgbmV4dCA9IHN1YgogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBuZXh0ID0gbmV4dFtmaWVsZF0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIGNoaWxkLiRjaGlsZHJlbiApIHsKICAgICAgICAgICAgdHJ5IHsgCiAgICAgICAgICAgICAgYXdhaXQgcHJvY2Vzc0NoaWxkcmVuKCBmdWxsRmllbGQsIG5leHQsIGNoaWxkLiRjaGlsZHJlbiApCiAgICAgICAgICAgIH0gY2F0Y2goIGVyciApIHsKICAgICAgICAgICAgICB0aGlzLmFkdmFuY2VkVmFsaWQgPSBmYWxzZQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgICAgICAgfQogICAgICAgICAgfSAKICAgICAgICAgIGlmICggY2hpbGQuY29uc3RyYWludHMgKSB7CiAgICAgICAgICAgIGNoaWxkLmVycm9ycyA9IFtdCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdGhpcy5hZHZhbmNlZFZhbGlkID0gdGhpcy5hZHZhbmNlZFZhbGlkICYmIGF3YWl0IHRoaXMuJGZoaXJ1dGlscy5jaGVja0NvbnN0cmFpbnRzKCBjaGlsZC5jb25zdHJhaW50cywgCiAgICAgICAgICAgICAgICB0aGlzLmNvbnN0cmFpbnRzLCBuZXh0LCBjaGlsZC5lcnJvcnMsIHRoaXMuZmhpcklkICkKICAgICAgICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgICAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IGZhbHNlCiAgICAgICAgICAgICAgY2hpbGQuZXJyb3JzLnB1c2goIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuIikKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgfQoKICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmZpZWxkKQogICAgICB0aGlzLmZoaXIgPSB7IAogICAgICAgIHJlc291cmNlVHlwZTogdGhpcy5maWVsZCwKICAgICAgICBtZXRhOiB7CiAgICAgICAgICBwcm9maWxlOiBbIHRoaXMucHJvZmlsZSBdIAogICAgICAgIH0KICAgICAgfQogICAgICAvL2NvbnNvbGUubG9nKHRoaXMpCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgcHJvY2Vzc0NoaWxkcmVuKCB0aGlzLmZpZWxkLCB0aGlzLmZoaXIsIHRoaXMuJGNoaWxkcmVuICkKICAgICAgfSBjYXRjaCggZXJyICkgewogICAgICAgIHRoaXMuYWR2YW5jZWRWYWxpZCA9IGZhbHNlCiAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICB9CiAgICAgIGlmICggIXRoaXMuYWR2YW5jZWRWYWxpZCApIHsKICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRNZXNzYWdlJywgeyB0eXBlOiAnZXJyb3InLCB0ZXh0OiAnVGhlcmUgd2VyZSBlcnJvcnMgb24gdGhlIGZvcm0uJyB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCJGSU5JU0hFRCBQUk9DRVNTIEFORCBDSEVDSy4iKQogICAgICBsZXQgdXJsID0gIi9maGlyLyIrdGhpcy5maWVsZAogICAgICBsZXQgb3B0cyA9IHsKICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2ZoaXIranNvbiIKICAgICAgICB9LAogICAgICAgIHJlZGlyZWN0OiAnbWFudWFsJywKICAgICAgfSAKICAgICAgaWYgKCB0aGlzLmZoaXJJZCApIHsKICAgICAgICB0aGlzLmZoaXIuaWQgPSB0aGlzLmZoaXJJZAogICAgICAgIHVybCArPSAiLyIgKyB0aGlzLmZoaXJJZAogICAgICAgIG9wdHMubWV0aG9kID0gIlBVVCIKICAgICAgfQogICAgICBvcHRzLmJvZHkgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmZoaXIpCiAgICAgIGNvbnNvbGUubG9nKCJTQVZFIix1cmwsdGhpcy5maGlyKQogICAgICBmZXRjaCggdXJsLCBvcHRzICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSkKICAgICAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlLmhlYWRlcnMpCiAgICAgICAgaWYgKCByZXNwb25zZS5zdGF0dXMgPT09IDIwMSB8fCByZXNwb25zZS5zdGF0dXMgPT09IDIwMCApIHsKICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKGRhdGEgPT4gewogICAgICAgICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICBpZiAoIHRoaXMuZmhpcklkICkgewogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbygwKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZToicmVzb3VyY2VfdmlldyIsIHBhcmFtczoge3BhZ2U6IHRoaXMucGFnZSwgaWQ6IGRhdGEuaWQgfSB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSApCiAgICAgIC8vY29uc29sZS5sb2codGhpcy5maGlyKQoKICAgICAgLyoKICAgICAgY29uc29sZS5sb2codGhpcy4kc2NvcGVkU2xvdHMuZGVmYXVsdCgpKQogICAgICBwcm9jZXNzU2xvdHMoIHRoaXMuZmllbGQsIHRoaXMuJHNjb3BlZFNsb3RzLmRlZmF1bHQoKSApCiAgICAgICovCiAgICB9CiAgfQp9CgoKCg=="},{"version":3,"sources":["ihris-resource.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ihris-resource.vue","sourceRoot":"src/components/ihris","sourcesContent":["<template>\n  <v-container class=\"my-3\">\n        \n    <v-form \n      ref=\"form\"\n      v-model=\"valid\"\n    >\n  \n      <slot :source=\"source\"></slot>\n      <v-overlay :value=\"overlay\">\n        <v-progress-circular\n          size=\"50\"\n          color=\"primary\"\n          indeterminate\n          ></v-progress-circular>\n      </v-overlay>\n\n      <v-navigation-drawer\n        app\n        right\n        permanent\n        clipped\n        class=\"primary darken-1 white--text\"\n        style=\"z-index: 3;\"\n        >\n        <v-list class=\"white--text\">\n          <v-list-item>\n            <v-btn v-if=\"!edit\" dark class=\"secondary\" @click=\"$emit('set-edit', !edit)\">\n              <v-icon light>mdi-pencil</v-icon>\n              <span>Edit</span>\n            </v-btn>\n            <v-btn v-else dark class=\"secondary\" @click=\"$router.go(0)\">\n              <v-icon light>mdi-pencil-off</v-icon>\n              <span>Cancel</span>\n            </v-btn>\n            <v-spacer></v-spacer>\n            <template v-if=\"edit\">\n              <v-btn v-if=\"valid\" dark class=\"success darken-1\" @click=\"processFHIR()\" :disabled=\"!valid\">\n                <v-icon light>mdi-content-save</v-icon>\n                <span>Save</span>\n              </v-btn>\n              <v-btn v-else dark class=\"warning\" @click=\"$refs.form.validate()\">\n                <v-icon light>mdi-content-save</v-icon>\n                <span>Save</span>\n              </v-btn>\n            </template>\n          </v-list-item>\n          <v-divider color=\"white\"></v-divider>\n          <template v-if=\"!edit && links && links.length\">\n            <v-list-item v-for=\"(link,idx) in links\" :key=\"link.url\">\n              <v-btn :key=\"link.url\" :text=\"!link.button\" :to=\"getLinkUrl(link)\" class=\"primary\">\n                <v-icon light v-if=\"link.icon\">{{link.icon}}</v-icon>\n                {{ linktext[idx]  }}\n              </v-btn>\n            </v-list-item>\n          </template>\n          <v-subheader v-if=\"sectionMenu\" class=\"white--text\"><h2>Sections</h2></v-subheader>\n          <v-list-item v-for=\"section in sectionMenu\" :href=\"'#section-'+section.name\" :key=\"section.name\">\n            <v-list-item-content class=\"white--text\" v-if=\"!edit || !section.secondary\">\n              <v-list-item-title class=\"text-uppercase\"><h4>{{ section.title }}</h4></v-list-item-title>\n              <v-list-item-subtitle class=\"white--text\">{{ section.desc }}</v-list-item-subtitle>\n            </v-list-item-content>\n          </v-list-item>\n        </v-list>\n  \n      </v-navigation-drawer>\n    </v-form>\n  </v-container>\n\n</template>\n\n<script>\nexport default {\n  name: \"ihris-resource\",\n  props: [\"title\",\"field\",\"fhir-id\",\"page\",\"profile\",\"section-menu\",\"edit\",\"links\",\"constraints\" ],\n  data: function() {\n    return {\n      fhir: {},\n      orig: {},\n      valid: true,\n      source: { data: {}, path: \"\" },\n      loading: false,\n      overlay: false,\n      isEdit: false,\n      linktext: [ ],\n      advancedValid: true\n    }\n  },\n  created: function() {\n    if ( this.fhirId ) {\n      this.loading = true\n      //console.log(\"getting\",this.field,this.fhirId)\n      fetch( \"/fhir/\"+this.field+\"/\"+this.fhirId ).then(response => {\n        response.json().then(data => {\n          //this.$store.commit('setCurrentResource', data)\n          this.orig = data\n          this.source = { data: data, path: this.field }\n          this.setLinkText()\n          this.loading = false\n        }).catch(err=> {\n          console.log(this.field,this.fhirId,err)\n        })\n      }).catch(err=> {\n        console.log(this.field,this.fhirId,err)\n      })\n    } else if ( this.$route.query ) {\n      let presets = {\n        resourceType: this.field\n      }\n      let hasPresets = false\n      for( let path of Object.keys( this.$route.query ) ) {\n        if ( path.startsWith( this.field +\".\" ) ) {\n          hasPresets = true\n          let elements = path.substring( this.field.length+1 ).split('.')\n          let last = elements.pop()\n          let current = presets\n          for( let element of elements ) {\n            if ( element.includes('[') ) {\n              try {\n                let parts = element.split('[')\n                let name = parts[0]\n                let idx = parts[1].slice(0,-1)\n                if ( !current.hasOwnProperty(name) ) {\n                  current[name] = []\n                }\n                if ( idx ) {\n                  let next = {}\n                  current[name][parseInt(idx)] = next\n                  current = next\n                } else {\n                  let next = {}\n                  current[name].push( next )\n                  current = next\n                }\n              } catch( err ) {\n                console.log(\"Unable to process\",path)\n                continue\n              }\n            } else {\n              if ( !current.hasOwnProperty(element) ) {\n                current[element] = {}\n                current = current[element]\n              }\n            }\n          }\n          if ( last.includes('[') ) {\n            try {\n              let parts = last.split('[')\n              let name = parts[0]\n              let idx = parts[1].slice(0,-1)\n              if ( !current.hasOwnProperty(name) ) {\n                current[name] = []\n              }\n              if ( idx ) {\n                current[name][parseInt(idx)] = this.$route.query[path]\n              } else {\n                current[name].push( this.$route.query[path] )\n              }\n\n            } catch( err ) {\n              console.log(\"Unable to process\",path)\n              continue\n            }\n          } else {\n            current[last] = this.$route.query[path]\n          }\n        }\n      }\n      if ( hasPresets ) {\n        this.source = { data: presets, path: this.field }\n      }\n    }\n  },\n  computed: {\n    hasFhirId: function() {\n      if ( this.fhirId == '' ) {\n        return false\n      } else if ( !this.fhirId ) {\n        return false\n      } else {\n        return true\n      }\n    }\n    /*\n    source: function() {\n      return this.$store.state.fhir\n    }\n    */\n  },\n  methods: {\n    getLinkField: function(field) {\n      let content = this.$fhirpath.evaluate( this.source.data, field )\n      if ( content ) {\n        return content[0]\n      } else {\n        return false\n      }\n    },\n    getLinkUrl: function(link) {\n      let field\n      if ( link.field ) {\n        field = this.getLinkField(link.field)\n      }\n      if ( field ) {\n        if ( field.includes('/') ) {\n          let ref = field.split('/')\n          field = ref[1]\n        }\n        return link.url.replace(\"FIELD\",field)\n      } else {\n        return link.url \n      }\n    },\n    setLinkText: function() {\n      for ( let idx in this.links ) {\n        let link = this.links[idx]\n        if ( link.text ) {\n          this.linktext[idx] = link.text\n        } else if ( link.field ) {\n          let field = this.getLinkField(link.field)\n          if ( field ) {\n            this.$fhirutils.lookup(field).then( display => {\n              this.$set( this.linktext, idx, display )\n            } )\n          }\n        }\n      }\n    },\n    processFHIR: async function() {\n      this.$refs.form.validate()\n      if ( !this.valid ) return\n      this.advancedValid = true\n      this.overlay = true\n      this.loading = true\n\n      //const processChildren = function( parent, obj, children ) {\n      const processChildren = async ( parent, obj, children ) => {\n        //console.log(\"called on \"+parent)\n\n        for( let child of children ) {\n\n          let fullField = parent\n\n          let next = obj\n\n          if ( child.field && !child.fieldType /* ignore arrays */ ) {\n            //console.log(\"working on \"+parent+\" . \"+child.field)\n            let field\n            if ( child.sliceName ) {\n              if ( child.field.startsWith(\"value[x]\") ) {\n                field = child.field.substring(9)\n                fullField += \".\" + field\n              } else {\n                field = child.field.replace(\":\"+child.sliceName, \"\")\n                fullField += \".\" + field\n              }\n            } else {\n              field = child.field\n              fullField += \".\"+field\n            }\n            if ( child.max !== \"1\" || child.baseMax !== \"1\" ) {\n              if ( !obj.hasOwnProperty(field) ) {\n                next[field] = []\n              }\n            } else {\n              next[field] = {}\n            }\n            //console.log(fullField)\n            //console.log(child.max, child.baseMax)\n            //console.log(child)\n            if ( child.hasOwnProperty(\"value\") ) {\n              //console.log( fullField +\"=\"+ child.value )\n              if ( Array.isArray( next[field] ) ) {\n                next[field].push( child.value )\n              } else {\n                next[field] = child.value\n              }\n              next = next[field]\n            } else {\n              if ( Array.isArray( next[field] ) ) {\n                let sub = {}\n                if ( child.profile ) {\n                  sub.url = child.profile\n                } else if ( field === \"extension\" && child.sliceName ) {\n                  sub.url = child.sliceName\n                }\n                next[field].push( sub )\n                next = sub\n              } else {\n                next = next[field]\n              }\n            }\n          }\n\n          if ( child.$children ) {\n            try { \n              await processChildren( fullField, next, child.$children )\n            } catch( err ) {\n              this.advancedValid = false\n              console.log(err)\n            }\n          } \n          if ( child.constraints ) {\n            child.errors = []\n            try {\n              this.advancedValid = this.advancedValid && await this.$fhirutils.checkConstraints( child.constraints, \n                this.constraints, next, child.errors, this.fhirId )\n            } catch( err ) {\n              this.advancedValid = false\n              child.errors.push(\"An unknown error occurred.\")\n              console.log(err)\n            }\n          }\n\n        }\n\n      }\n\n      //console.log(this.field)\n      this.fhir = { \n        resourceType: this.field,\n        meta: {\n          profile: [ this.profile ] \n        }\n      }\n      //console.log(this)\n      try {\n        await processChildren( this.field, this.fhir, this.$children )\n      } catch( err ) {\n        this.advancedValid = false\n        console.log(err)\n      }\n      if ( !this.advancedValid ) {\n        this.overlay = false\n        this.loading = false\n        this.$store.commit('setMessage', { type: 'error', text: 'There were errors on the form.' })\n        return\n      }\n      console.log(\"FINISHED PROCESS AND CHECK.\")\n      let url = \"/fhir/\"+this.field\n      let opts = {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/fhir+json\"\n        },\n        redirect: 'manual',\n      } \n      if ( this.fhirId ) {\n        this.fhir.id = this.fhirId\n        url += \"/\" + this.fhirId\n        opts.method = \"PUT\"\n      }\n      opts.body = JSON.stringify(this.fhir)\n      console.log(\"SAVE\",url,this.fhir)\n      fetch( url, opts ).then(response => {\n        //console.log(response)\n        //console.log(response.headers)\n        if ( response.status === 201 || response.status === 200 ) {\n          response.json().then(data => {\n            this.overlay = false\n            this.loading = false\n            if ( this.fhirId ) {\n              this.$router.go(0)\n            } else {\n              this.$router.push({ name:\"resource_view\", params: {page: this.page, id: data.id } })\n            }\n          })\n        }\n      } )\n      //console.log(this.fhir)\n\n      /*\n      console.log(this.$scopedSlots.default())\n      processSlots( this.field, this.$scopedSlots.default() )\n      */\n    }\n  }\n}\n\n\n\n</script>\n"]}]}