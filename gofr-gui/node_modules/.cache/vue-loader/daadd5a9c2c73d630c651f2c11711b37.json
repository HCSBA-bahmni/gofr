{"remainingRequest":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ally/gofr/facility-recon-gui/src/components/fhir/fhir-reference.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ally/gofr/facility-recon-gui/src/components/fhir/fhir-reference.vue","mtime":1619768856174},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/babel-loader/lib/index.js","mtime":1619257191453},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/cache-loader/dist/cjs.js","mtime":1619257191457},{"path":"/home/ally/gofr/facility-recon-gui/node_modules/vue-loader/lib/index.js","mtime":1619257191305}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IElocmlzRWxlbWVudCBmcm9tICIuLi9paHJpcy9paHJpcy1lbGVtZW50LnZ1ZSIKCmNvbnN0IHF1ZXJ5c3RyaW5nID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKQpjb25zdCBmaGlydXJsID0gImh0dHA6Ly9obDcub3JnL2ZoaXIvU3RydWN0dXJlRGVmaW5pdGlvbi8iCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiZmhpci1yZWZlcmVuY2UiLAogIHByb3BzOiBbImZpZWxkIiwibGFiZWwiLCJzbGljZU5hbWUiLCJ0YXJnZXRQcm9maWxlIiwidGFyZ2V0UmVzb3VyY2UiLCJtaW4iLCJtYXgiLCJiYXNlLW1pbiIsImJhc2UtbWF4IiwKICAgICJzbG90UHJvcHMiLCJwYXRoIiwic3ViLWZpZWxkcyIsImVkaXQiLCJyZWFkT25seUlmU2V0IiwiY29uc3RyYWludHMiLCAiZGlzcGxheVR5cGUiLCAiaW5pdGlhbFZhbHVlIiwgIm92ZXJyaWRlVmFsdWUiXSwKICBjb21wb25lbnRzOiB7CiAgICBJaHJpc0VsZW1lbnQKICB9LAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgc291cmNlOiB7IHBhdGg6ICIiLCBkYXRhOiB7fSB9LAogICAgICB2YWx1ZTogeyByZWZlcmVuY2U6ICIiIH0sCiAgICAgIHFGaWVsZDogInZhbHVlUmVmZXJlbmNlIiwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHNlYXJjaDogIiIsCiAgICAgIG1lbnU6IGZhbHNlLAogICAgICBpdGVtczogW10sCiAgICAgIHNlbGVjdDogIiIsCiAgICAgIHJlc291cmNlOiAiIiwKICAgICAgYXdhaXRpbmdTZWFyY2g6IGZhbHNlLAogICAgICBkaXNwbGF5VmFsdWU6ICIiLAogICAgICBwcmVzZXQ6IGZhbHNlLAogICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgIGVycm9yczogW10sCiAgICAgIGxvY2tXYXRjaDogZmFsc2UsCiAgICAgIGFjdGl2ZTogW10sCiAgICAgIG9wZW46IFtdLAogICAgICB0cmVlTG9va3VwOiB7fSwKICAgICAgYWxsQWxsb3dlZDogdHJ1ZQogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnNldHVwRGF0YSgpCiAgfSwKICB3YXRjaDogewogICAgc2xvdFByb3BzOiB7CiAgICAgIGhhbmRsZXIoKSB7CiAgICAgICAgLy9jb25zb2xlLmxvZygiV0FUQ0ggUkVGRVJFTkNFIix0aGlzLnBhdGgsdGhpcy5zbG90UHJvcHMpCiAgICAgICAgaWYgKCAhdGhpcy5sb2NrV2F0Y2ggKSB7CiAgICAgICAgICB0aGlzLnNldHVwRGF0YSgpCiAgICAgICAgfQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9LAogICAgc2VhcmNoOiBmdW5jdGlvbiAodmFsKSB7CiAgICAgIGlmICggIXRoaXMuYXdhaXRpbmdTZWFyY2gpIHsKICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CiAgICAgICAgICB2YWwgJiYgdmFsLmxlbmd0aCA+IDEgJiYgdGhpcy5xdWVyeVNlbGVjdGlvbnMoIHRoaXMuc2VhcmNoICkKICAgICAgICAgIHRoaXMuYXdhaXRpbmdTZWFyY2ggPSBmYWxzZQogICAgICAgIH0sIDUwMCApCiAgICAgIH0KICAgICAgdGhpcy5hd2FpdGluZ1NlYXJjaCA9IHRydWUKICAgIH0sCiAgICBzZWxlY3Q6IGZ1bmN0aW9uKHZhbCkgewogICAgICB0aGlzLnZhbHVlLnJlZmVyZW5jZSA9IHZhbAogICAgICB0aGlzLmdldERpc3BsYXkoKQogICAgfSwKICAgIGFjdGl2ZTogZnVuY3Rpb24oKSB7CiAgICAgIGlmICggdGhpcy5hY3RpdmUubGVuZ3RoICkgewogICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5hY3RpdmVbMF0KICAgICAgICB0aGlzLmRpc3BsYXlWYWx1ZSA9IHRoaXMudHJlZUxvb2t1cFsgdGhpcy5zZWxlY3QgXQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2VsZWN0ID0gdW5kZWZpbmVkCiAgICAgICAgdGhpcy5kaXNwbGF5VmFsdWUgPSAiIgogICAgICB9CiAgICAgIHRoaXMubWVudSA9IGZhbHNlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXR1cERhdGE6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIHRoaXMudGFyZ2V0UHJvZmlsZSAmJiB0aGlzLnRhcmdldFJlc291cmNlICkgewogICAgICAgIGlmICggdGhpcy50YXJnZXRQcm9maWxlLnJlcGxhY2UoIGZoaXJ1cmwsICIiICkgPT09IHRoaXMudGFyZ2V0UmVzb3VyY2UgKSB7CiAgICAgICAgICB0aGlzLmFsbEFsbG93ZWQgPSB0cnVlCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYWxsQWxsb3dlZCA9IGZhbHNlCiAgICAgICAgfQogICAgICAgIHRoaXMucmVzb3VyY2UgPSB0aGlzLnRhcmdldFJlc291cmNlCiAgICAgIH0KICAgICAgaWYgKCB0aGlzLmRpc3BsYXlUeXBlID09PSAidHJlZSIgKSB7CiAgICAgICAgdGhpcy5zZXR1cFRyZWVJdGVtcygpCiAgICAgIH0KICAgICAgaWYgKCB0aGlzLnNsb3RQcm9wcyAmJiB0aGlzLnNsb3RQcm9wcy5zb3VyY2UgKSB7CiAgICAgICAgdGhpcy5zb3VyY2UgPSB7IHBhdGg6IHRoaXMuc2xvdFByb3BzLnNvdXJjZS5wYXRoKyIuIit0aGlzLmZpZWxkLCBkYXRhOiB7fSB9CiAgICAgICAgaWYgKCB0aGlzLnNsb3RQcm9wcy5zb3VyY2UuZnJvbUFycmF5ICkgewogICAgICAgICAgdGhpcy5zb3VyY2UuZGF0YSA9IHRoaXMuc2xvdFByb3BzLnNvdXJjZS5kYXRhCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxldCBleHByZXNzaW9uID0gdGhpcy4kZmhpcnV0aWxzLnBhdGhGaWVsZEV4cHJlc3Npb24oIHRoaXMuZmllbGQgKQogICAgICAgICAgbGV0IHJlc3VsdHMgPSB0aGlzLiRmaGlycGF0aC5ldmFsdWF0ZSggdGhpcy5zbG90UHJvcHMuc291cmNlLmRhdGEsIGV4cHJlc3Npb24gKQogICAgICAgICAgdGhpcy5zb3VyY2UuZGF0YSA9IHJlc3VsdHNbMF0KICAgICAgICB9CiAgICAgICAgaWYoIHRoaXMuc291cmNlLmRhdGEgKSB7CiAgICAgICAgICB0aGlzLnByZXNldCA9IHRydWUKICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5zb3VyY2UuZGF0YS5yZWZlcmVuY2UKICAgICAgICAgIHRoaXMubG9ja1dhdGNoID0gdHJ1ZQogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmRpc2FibGVkID0gdGhpcy5yZWFkT25seUlmU2V0ICYmIHRoaXMucHJlc2V0CiAgICB9LAogICAgc2V0dXBUcmVlSXRlbXM6IGZ1bmN0aW9uKCkgewogICAgICBsZXQgdHJlZXRvcCA9IHRoaXMuaW5pdGlhbFZhbHVlCiAgICAgIGlmICggdGhpcy5vdmVycmlkZVZhbHVlICkgewogICAgICAgIHRyZWV0b3AgPSB0aGlzLm92ZXJyaWRlVmFsdWUKICAgICAgfQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGxldCBwYXJhbXMgPSB7fQogICAgICBpZiAoIHRyZWV0b3AgKSB7CiAgICAgICAgcGFyYW1zID0geyAicGFydG9mIjogdHJlZXRvcCB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGFyYW1zID0geyAicGFydG9mOm1pc3NpbmciOiB0cnVlIH0KICAgICAgfQogICAgICBwYXJhbXMuX2NvdW50ID0gNTAwCiAgICAgIGxldCB1cmwgPSAiL2ZoaXIvIit0aGlzLnJlc291cmNlKyI/IitxdWVyeXN0cmluZy5zdHJpbmdpZnkoIHBhcmFtcyApCiAgICAgIHRoaXMuaXRlbXMgPSBbXQogICAgICB0aGlzLmFkZEl0ZW1zKCB1cmwsIHRoaXMuaXRlbXMgKQoKICAgIH0sCiAgICBjaGVja0NoaWxkcmVuOiBmdW5jdGlvbihpdGVtKSB7CiAgICAgIGxldCBwYXJhbXMgPSB7ICJwYXJ0b2YiOiBpdGVtLmlkLCAiX3N1bW1hcnkiOiAiY291bnQiIH0KICAgICAgbGV0IHVybCA9ICIvZmhpci8iK3RoaXMucmVzb3VyY2UrIj8iK3F1ZXJ5c3RyaW5nLnN0cmluZ2lmeSggcGFyYW1zICkKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCByZXNvbHZlID0+IHsKICAgICAgICBheGlvcy5nZXQoIHVybCApLnRoZW4oIHJlc3BvbnNlID0+IHsKICAgICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YQogICAgICAgICAgaWYgKCBkYXRhLnRvdGFsICYmIGRhdGEudG90YWwgPiAwICkgewogICAgICAgICAgICBpdGVtLmNoaWxkcmVuID0gW10KICAgICAgICAgIH0KICAgICAgICAgIHJlc29sdmUoKQogICAgICAgIH0gKS5jYXRjaCggZXJyID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJmYWlsZWQgdG8gY2hlY2sgY2hpbGRyZW4gZm9yIix1cmwsZXJyKQogICAgICAgICAgcmVzb2x2ZSgpCiAgICAgICAgfSApCiAgICAgIH0gKQogICAgfSwKICAgIGFkZEl0ZW1zOiBmdW5jdGlvbih1cmwsIGl0ZW1zKSB7CiAgICAgIGF4aW9zLmdldCggdXJsICkudGhlbiggYXN5bmMocmVzcG9uc2UpID0+IHsKICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGEKICAgICAgICBpZiAoIGRhdGEuZW50cnkgJiYgZGF0YS5lbnRyeS5sZW5ndGggPiAwICkgewogICAgICAgICAgZm9yKCBsZXQgZW50cnkgb2YgZGF0YS5lbnRyeSApIHsKICAgICAgICAgICAgbGV0IGxvY2tlZCA9IHRoaXMuYWxsQWxsb3dlZCA/IGZhbHNlIDogIWVudHJ5LnJlc291cmNlLm1ldGEucHJvZmlsZS5pbmNsdWRlcyggdGhpcy50YXJnZXRQcm9maWxlICkKICAgICAgICAgICAgbGV0IGl0ZW0gPSB7CiAgICAgICAgICAgICAgaWQ6IGVudHJ5LnJlc291cmNlLnJlc291cmNlVHlwZSsiLyIrZW50cnkucmVzb3VyY2UuaWQsCiAgICAgICAgICAgICAgbmFtZTogZW50cnkucmVzb3VyY2UubmFtZSwKICAgICAgICAgICAgICBsb2NrZWQ6IGxvY2tlZAogICAgICAgICAgICB9CiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2hlY2tDaGlsZHJlbiggaXRlbSApCiAgICAgICAgICAgIHRoaXMudHJlZUxvb2t1cFsgaXRlbS5pZCBdID0gaXRlbS5uYW1lCiAgICAgICAgICAgIGl0ZW1zLnB1c2goIGl0ZW0gKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIGRhdGEubGluayApIHsKICAgICAgICAgIGxldCBuZXh0ID0gZGF0YS5saW5rLmZpbmQoIGxpbmsgPT4gbGluay5yZWxhdGlvbiA9PT0gIm5leHQiICkKICAgICAgICAgIGlmICggbmV4dCApIHsKICAgICAgICAgICAgdGhpcy5hZGRJdGVtcyggbmV4dC51cmwsIGl0ZW1zICkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgfQogICAgICB9ICkuY2F0Y2goIGVyciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBhZGQgaXRlbXMgZm9yIix1cmwsZXJyKQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgIH0gKQogICAgfSwKICAgIGZldGNoQ2hpbGRyZW46IGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgbGV0IHBhcmFtcyA9IHt9CiAgICAgIHBhcmFtcyA9IHsgInBhcnRvZiI6IGl0ZW0uaWQsIF9jb3VudDogNTAwIH0KICAgICAgbGV0IHVybCA9ICIvZmhpci8iK3RoaXMucmVzb3VyY2UrIj8iK3F1ZXJ5c3RyaW5nLnN0cmluZ2lmeSggcGFyYW1zICkKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICB0aGlzLmFkZEl0ZW1zKCB1cmwsIGl0ZW0uY2hpbGRyZW4gKQogICAgICByZXR1cm4gbmV3IFByb21pc2UoIHJlc29sdmUgPT4gewogICAgICAgIGxldCBjb3VudCA9IDAKICAgICAgICBjb25zdCBjaGVja0xvYWRpbmcgPSAoKSA9PiB7CiAgICAgICAgICBpZiAoICF0aGlzLmxvYWRpbmcgfHwgY291bnQrKyA+IDEwMCkgewogICAgICAgICAgICByZXNvbHZlKCkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldFRpbWVvdXQoIGNoZWNrTG9hZGluZywgMjAwICkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2hlY2tMb2FkaW5nKCkKICAgICAgfSApCiAgICB9LAogICAgcXVlcnlTZWxlY3Rpb25zOiBmdW5jdGlvbiggdmFsICkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGxldCBwYXJhbXMgPSB7ICJuYW1lOmNvbnRhaW5zIjogdmFsIH0KICAgICAgaWYgKCAhdGhpcy50YXJnZXRQcm9maWxlLmVuZHNXaXRoKCB0aGlzLnJlc291cmNlICkgKSB7CiAgICAgICAgcGFyYW1zLl9wcm9maWxlID0gdGhpcy50YXJnZXRQcm9maWxlCiAgICAgIH0KICAgICAgbGV0IHVybCA9ICIvZmhpci8iK3RoaXMucmVzb3VyY2UrIj8iK3F1ZXJ5c3RyaW5nLnN0cmluZ2lmeSggcGFyYW1zICkKICAgICAgYXhpb3MuZ2V0KCB1cmwgKS50aGVuKCBhc3luYyhyZXNwb25zZSkgPT4gewogICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YQogICAgICAgIHRoaXMuaXRlbXMgPSBbXQogICAgICAgIGlmICggZGF0YS5lbnRyeSAmJiBkYXRhLmVudHJ5Lmxlbmd0aCApIHsKICAgICAgICAgIGZvciggbGV0IGVudHJ5IG9mIGRhdGEuZW50cnkgKSB7CiAgICAgICAgICAgIGxldCByZWYgPSBlbnRyeS5yZXNvdXJjZS5yZXNvdXJjZVR5cGUrIi8iK2VudHJ5LnJlc291cmNlLmlkCiAgICAgICAgICAgIGxldCBpdGVtID0geyB2YWx1ZTogcmVmIH0KICAgICAgICAgICAgaXRlbS50ZXh0ID0gYXdhaXQgdGhpcy4kZmhpcnV0aWxzLnJlc291cmNlTG9va3VwKCByZWYgKQogICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goIGl0ZW0gKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSApCiAgICB9LAogICAgZ2V0RGlzcGxheTogZnVuY3Rpb24oKSB7CiAgICAgIGlmICggKCF0aGlzLmVkaXQgfHwgdGhpcy5wcmVzZXQpICYmIHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5yZWZlcmVuY2UgKSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICAgIHRoaXMuJGZoaXJ1dGlscy5yZXNvdXJjZUxvb2t1cCggdGhpcy52YWx1ZS5yZWZlcmVuY2UgKS50aGVuKCBkaXNwbGF5ID0+IHsKICAgICAgICAgIHRoaXMuZGlzcGxheVZhbHVlID0gZGlzcGxheQogICAgICAgICAgaWYgKCB0aGlzLmRpc3BsYXlUeXBlICE9PSAidHJlZSIgKSB7CiAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaCgge3RleHQ6IGRpc3BsYXksIHZhbHVlOiB0aGlzLnZhbHVlLnJlZmVyZW5jZX0gKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB9ICkKICAgICAgfQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGluZGV4OiBmdW5jdGlvbigpIHsKICAgICAgaWYgKCB0aGlzLnNsb3RQcm9wcyApIHJldHVybiB0aGlzLnNsb3RQcm9wcy5pbnB1dAogICAgICBlbHNlIHJldHVybiB1bmRlZmluZWQKICAgIH0sCiAgICBkaXNwbGF5OiBmdW5jdGlvbigpIHsKICAgICAgaWYgKCB0aGlzLnNsb3RQcm9wcyAmJiB0aGlzLnNsb3RQcm9wcy5pbnB1dCkgcmV0dXJuIHRoaXMuc2xvdFByb3BzLmlucHV0LmxhYmVsCiAgICAgIGVsc2UgcmV0dXJuIHRoaXMubGFiZWwKICAgIH0sCiAgICByZXF1aXJlZDogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiAodGhpcy5pbmRleCB8fCAwKSA8IHRoaXMubWluCiAgICB9LAogICAgcnVsZXM6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIHRoaXMucmVxdWlyZWQgKSB7CiAgICAgICAgcmV0dXJuIFsgdiA9PiAhIXYgfHwgdGhpcy5kaXNwbGF5KyIgaXMgcmVxdWlyZWQiIF0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gW10KICAgICAgfQogICAgfQogIH0KCn0K"},{"version":3,"sources":["fhir-reference.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"fhir-reference.vue","sourceRoot":"src/components/fhir","sourcesContent":["<template>\n  <ihris-element :edit=\"edit\" :loading=\"loading\">\n    <template #form>\n      <v-menu\n        v-if=\"displayType == 'tree'\"\n        ref=\"menu\"\n        v-model=\"menu\"\n        :close-on-content-click=\"false\"\n        transition=\"scale-transition\"\n        offset-y\n        min-width=\"290px\"\n        max-height=\"500px\"\n        >\n        <template v-slot:activator=\"{ on }\">\n          <v-text-field\n            v-model=\"displayValue\"\n            :label=\"display\"\n            readonly\n            v-on=\"on\"\n            outlined\n            hide-details=\"auto\"\n            :rules=\"rules\"\n            :error-messages=\"errors\"\n            :loading=\"loading\"\n            dense>\n            <template #label>{{display}} <span v-if=\"required\" class=\"red--text font-weight-bold\">*</span></template>\n          </v-text-field>\n        </template>\n        <v-card v-if=\"!((disabled) || (preset && $route.name === 'resource_add'))\">\n          <v-treeview\n            :active.sync=\"active\"\n            :items=\"items\"\n            :load-children=\"fetchChildren\"\n            :open.sync=\"open\"\n            item-disabled=\"locked\"\n            activatable\n            :multiple-active=\"false\"\n            selection-type=\"independent\"\n            :loading=\"loading\"\n            ></v-treeview>\n        </v-card>\n      </v-menu>\n      <v-autocomplete\n        v-else\n        v-model=\"select\"\n        :loading=\"loading\"\n        :items=\"items\"\n        :search-input.sync=\"search\"\n        cache-items\n        flat\n        hide-no-data\n        hide-details\n        :label=\"display\"\n        outlined\n        dense\n        placeholder=\"Start typing for selection\"\n        :rules=\"rules\"\n        :disabled=\"(disabled) || (preset && $route.name === 'resource_add')\"\n        :error-messages=\"errors\"\n        @change=\"errors = []\"\n      >\n        <template #label>{{display}} <span v-if=\"required\" class=\"red--text font-weight-bold\">*</span></template>\n      </v-autocomplete>\n    </template>\n    <template #header>\n      {{display}}\n    </template>\n    <template #value>\n      {{displayValue}}\n    </template>\n  </ihris-element>\n</template>\n\n<script>\nimport axios from 'axios'\nimport IhrisElement from \"../ihris/ihris-element.vue\"\n\nconst querystring = require('querystring')\nconst fhirurl = \"http://hl7.org/fhir/StructureDefinition/\"\nexport default {\n  name: \"fhir-reference\",\n  props: [\"field\",\"label\",\"sliceName\",\"targetProfile\",\"targetResource\",\"min\",\"max\",\"base-min\",\"base-max\",\n    \"slotProps\",\"path\",\"sub-fields\",\"edit\",\"readOnlyIfSet\",\"constraints\", \"displayType\", \"initialValue\", \"overrideValue\"],\n  components: {\n    IhrisElement\n  },\n  data: function() {\n    return {\n      source: { path: \"\", data: {} },\n      value: { reference: \"\" },\n      qField: \"valueReference\",\n      loading: false,\n      search: \"\",\n      menu: false,\n      items: [],\n      select: \"\",\n      resource: \"\",\n      awaitingSearch: false,\n      displayValue: \"\",\n      preset: false,\n      disabled: false,\n      errors: [],\n      lockWatch: false,\n      active: [],\n      open: [],\n      treeLookup: {},\n      allAllowed: true\n    }\n  },\n  created: function() {\n    this.setupData()\n  },\n  watch: {\n    slotProps: {\n      handler() {\n        //console.log(\"WATCH REFERENCE\",this.path,this.slotProps)\n        if ( !this.lockWatch ) {\n          this.setupData()\n        }\n      },\n      deep: true\n    },\n    search: function (val) {\n      if ( !this.awaitingSearch) {\n        setTimeout( () => {\n          val && val.length > 1 && this.querySelections( this.search )\n          this.awaitingSearch = false\n        }, 500 )\n      }\n      this.awaitingSearch = true\n    },\n    select: function(val) {\n      this.value.reference = val\n      this.getDisplay()\n    },\n    active: function() {\n      if ( this.active.length ) {\n        this.select = this.active[0]\n        this.displayValue = this.treeLookup[ this.select ]\n      } else {\n        this.select = undefined\n        this.displayValue = \"\"\n      }\n      this.menu = false\n    }\n  },\n  methods: {\n    setupData: function() {\n      if ( this.targetProfile && this.targetResource ) {\n        if ( this.targetProfile.replace( fhirurl, \"\" ) === this.targetResource ) {\n          this.allAllowed = true\n        } else {\n          this.allAllowed = false\n        }\n        this.resource = this.targetResource\n      }\n      if ( this.displayType === \"tree\" ) {\n        this.setupTreeItems()\n      }\n      if ( this.slotProps && this.slotProps.source ) {\n        this.source = { path: this.slotProps.source.path+\".\"+this.field, data: {} }\n        if ( this.slotProps.source.fromArray ) {\n          this.source.data = this.slotProps.source.data\n        } else {\n          let expression = this.$fhirutils.pathFieldExpression( this.field )\n          let results = this.$fhirpath.evaluate( this.slotProps.source.data, expression )\n          this.source.data = results[0]\n        }\n        if( this.source.data ) {\n          this.preset = true\n          this.select = this.source.data.reference\n          this.lockWatch = true\n        }\n      }\n      this.disabled = this.readOnlyIfSet && this.preset\n    },\n    setupTreeItems: function() {\n      let treetop = this.initialValue\n      if ( this.overrideValue ) {\n        treetop = this.overrideValue\n      }\n      this.loading = true\n      let params = {}\n      if ( treetop ) {\n        params = { \"partof\": treetop }\n      } else {\n        params = { \"partof:missing\": true }\n      }\n      params._count = 500\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      this.items = []\n      this.addItems( url, this.items )\n\n    },\n    checkChildren: function(item) {\n      let params = { \"partof\": item.id, \"_summary\": \"count\" }\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      return new Promise( resolve => {\n        axios.get( url ).then( response => {\n          let data = response.data\n          if ( data.total && data.total > 0 ) {\n            item.children = []\n          }\n          resolve()\n        } ).catch( err => {\n          console.log(\"failed to check children for\",url,err)\n          resolve()\n        } )\n      } )\n    },\n    addItems: function(url, items) {\n      axios.get( url ).then( async(response) => {\n        let data = response.data\n        if ( data.entry && data.entry.length > 0 ) {\n          for( let entry of data.entry ) {\n            let locked = this.allAllowed ? false : !entry.resource.meta.profile.includes( this.targetProfile )\n            let item = {\n              id: entry.resource.resourceType+\"/\"+entry.resource.id,\n              name: entry.resource.name,\n              locked: locked\n            }\n            await this.checkChildren( item )\n            this.treeLookup[ item.id ] = item.name\n            items.push( item )\n          }\n        }\n        if ( data.link ) {\n          let next = data.link.find( link => link.relation === \"next\" )\n          if ( next ) {\n            this.addItems( next.url, items )\n          } else {\n            this.loading = false\n          }\n        } else {\n          this.loading = false\n        }\n      } ).catch( err => {\n        console.log(\"Failed to add items for\",url,err)\n        this.loading = false\n      } )\n    },\n    fetchChildren: function(item) {\n      let params = {}\n      params = { \"partof\": item.id, _count: 500 }\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      this.loading = true\n      this.addItems( url, item.children )\n      return new Promise( resolve => {\n        let count = 0\n        const checkLoading = () => {\n          if ( !this.loading || count++ > 100) {\n            resolve()\n          } else {\n            setTimeout( checkLoading, 200 )\n          }\n        }\n        checkLoading()\n      } )\n    },\n    querySelections: function( val ) {\n      this.loading = true\n      let params = { \"name:contains\": val }\n      if ( !this.targetProfile.endsWith( this.resource ) ) {\n        params._profile = this.targetProfile\n      }\n      let url = \"/fhir/\"+this.resource+\"?\"+querystring.stringify( params )\n      axios.get( url ).then( async(response) => {\n        let data = response.data\n        this.items = []\n        if ( data.entry && data.entry.length ) {\n          for( let entry of data.entry ) {\n            let ref = entry.resource.resourceType+\"/\"+entry.resource.id\n            let item = { value: ref }\n            item.text = await this.$fhirutils.resourceLookup( ref )\n            this.items.push( item )\n          }\n        }\n      } )\n    },\n    getDisplay: function() {\n      if ( (!this.edit || this.preset) && this.value && this.value.reference ) {\n        this.loading = true\n        this.$fhirutils.resourceLookup( this.value.reference ).then( display => {\n          this.displayValue = display\n          if ( this.displayType !== \"tree\" ) {\n            this.items.push( {text: display, value: this.value.reference} )\n          }\n          this.loading = false\n        } )\n      }\n    }\n  },\n  computed: {\n    index: function() {\n      if ( this.slotProps ) return this.slotProps.input\n      else return undefined\n    },\n    display: function() {\n      if ( this.slotProps && this.slotProps.input) return this.slotProps.input.label\n      else return this.label\n    },\n    required: function() {\n      return (this.index || 0) < this.min\n    },\n    rules: function() {\n      if ( this.required ) {\n        return [ v => !!v || this.display+\" is required\" ]\n      } else {\n        return []\n      }\n    }\n  }\n\n}\n</script>\n"]}]}