webpackJsonp([1],{"7zck":function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),s=r("mvHQ"),o=r.n(s),i=r("fZjL"),n=r.n(i),c=r("mtWM"),l=r.n(c),u=r("BO1k"),d=r.n(u),v={methods:{toTitleCase:function(e){return e.toLowerCase().split(" ").map(function(e){return e.replace(e[0],e[0].toUpperCase())}).join("")},translateDataHeader:function(e,t){if(!this.$store.state.config.reconciliation.useCSVHeader)return"Level "+t;if(this.$store.state.levelMapping[e]){var r=this.$store.state.levelMapping[e]["level"+t];return r&&"null"!==r&&"undefined"!==r&&"false"!==r?r:this.$store.state.levelMapping[e].facility}return"Level "+t}}},h={mixins:[v],data:function(){return{scoreProgressTitle:"Waiting for progress status",scoreDialog:!1,scoreProgressPercent:null,progressType:"",scoreProgressTimer:!1,loadingSource2Unmatched:!1,loadingSource1Unmatched:!1}},methods:{checkScoreProgress:function(){var e=this,t=this.$store.state.clientId;l.a.get("/scoreProgress/"+t).then(function(t){null===t.data||void 0===t.data||!1===t.data||null===t.data.status&&null===t.data.percent&&null===t.data.error?clearInterval(e.scoreProgressTimer):(e.scoreProgressTitle=t.data.status,t.data.percent&&("percent"!==e.progressType&&(e.progressType="percent"),e.scoreProgressPercent=t.data.percent),"Done"===t.data.status&&(clearInterval(e.scoreProgressTimer),e.scoreDialog=!1,e.scoreProgressTitle="Waiting for progress status"))}).catch(function(e){console.log(e)})},getScores:function(){var e=this,t=this.getSource1(),r=this.getSource2();if(this.$store.state.source1UnMatched=[],this.$store.state.source2UnMatched=[],this.$store.state.matchedContent=[],this.$store.state.noMatchContent=[],this.$store.state.flagged=[],this.$store.state.source1TotalAllRecords=0,this.$store.state.totalAllMapped=0,this.$store.state.totalAllFlagged=0,this.$store.state.totalAllNoMatch=0,this.$store.state.source2TotalRecords=0,this.$store.state.scoreResults=[],t&&r){this.loadingSource1Unmatched=!0,this.loadingSource2Unmatched=!0,this.scoreDialog=!0,this.scoreProgressTitle="Waiting for progress status",this.progressType="indeterminate";var a=this.$store.state.recoLevel,s=this.$store.state.totalSource1Levels,o=this.$store.state.totalSource2Levels,i=this.$store.state.clientId,c=this.$store.state.source1Parents.slice(0,this.$store.state.source1Parents.length);this.$store.state.levelArray=[];for(var u=1;u<this.$store.state.totalSource1Levels;u++){var v;u+1>this.$store.state.recoLevel||(v=this.translateDataHeader("source1",u),this.$store.state.levelArray.push({text:v,value:u+1}))}var h="source1="+t+"&source2="+r+"&totalSource1Levels="+s+"&totalSource2Levels="+o;h+="&recoLevel="+a+"&clientId="+i+"&userID="+this.$store.state.activePair.userID._id,l.a.get("/reconcile/?"+h).then(function(t){e.loadingSource1Unmatched=!1,e.getSource2Unmached(),e.$store.state.source1UnMatched=[],e.$store.state.matchedContent=[],e.$store.state.noMatchContent=[],e.$store.state.flagged=[],e.$store.state.scoreResults=t.data.scoreResults,e.$store.state.source2TotalRecords=t.data.source2TotalRecords,e.$store.state.source2TotalAllRecords=t.data.source2TotalAllRecords,e.$store.state.totalAllMapped=t.data.totalAllMapped,e.$store.state.totalAllFlagged=t.data.totalAllFlagged,e.$store.state.totalAllNoMatch=t.data.totalAllNoMatch,e.$store.state.source1TotalAllNotMapped=t.data.source1TotalAllNotMapped,e.$store.state.source1TotalAllRecords=t.data.source1TotalAllRecords;var r=!0,a=!1,s=void 0;try{for(var o,i=d()(e.$store.state.scoreResults);!(r=(o=i.next()).done);r=!0){var l=o.value;if(l.source1.hasOwnProperty("tag")&&"flagged"===l.source1.tag)e.$store.state.flagged.push({source1Name:l.source1.name,source1Id:l.source1.id,source1Parents:l.source1.parents,source2Name:l.exactMatch.name,source2Id:l.exactMatch.id,source2Parents:l.exactMatch.parents});else if(l.source1.hasOwnProperty("tag")&&"noMatch"===l.source1.tag){var u=l.source1.parents;e.$store.state.noMatchContent.push({source1Name:l.source1.name,source1Id:l.source1.id,parents:u})}else if(n()(l.exactMatch).length>0)e.$store.state.matchedContent.push({source1Name:l.source1.name,source1Id:l.source1.id,source1Parents:l.source1.parents,source2Name:l.exactMatch.name,source2Id:l.exactMatch.id,source2Parents:l.exactMatch.parents});else{for(var v=c,h=l.source1.parents.length-1;h>=0;h--)v[l.source1.parents[h]]||(v[l.source1.parents[h]]={}),v=v[l.source1.parents[h]];e.$store.state.source1UnMatched.push({name:l.source1.name,id:l.source1.id,parents:l.source1.parents})}}}catch(e){a=!0,s=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw s}}e.$store.state.source1Parents=c}),this.scoreProgressTimer=setInterval(this.checkScoreProgress,1e3)}},getSource2Unmached:function(){var e=this,t=this.getSource1(),r=this.getSource2(),a=this.$store.state.activePair.userID._id;if(t&&r){var s=this.$store.state.recoLevel,o=this.$store.state.totalSource1Levels,i=this.$store.state.totalSource2Levels,n=s;s===o&&(n=i),l.a.get("/getUnmatched/"+t+"/"+r+"/"+n+"/"+a).then(function(t){e.loadingSource2Unmatched=!1,e.$store.state.source2UnMatched=t.data})}},getSource1:function(){var e=this.$store.state.activePair.source1.name;return e&&(e=this.toTitleCase(e)),e},getSource2:function(){var e=this.$store.state.activePair.source2.name;return e&&(e=this.toTitleCase(e)),e},getSource1Name:function(){return this.$store.state.activePair.source1.name},getSource2Name:function(){return this.$store.state.activePair.source2.name}},created:function(){this.scoreProgressTitle=this.$store.state.scoresProgressData.scoreProgressTitle,this.scoreProgressPercent=this.$store.state.scoresProgressData.scoreProgressPercent,this.$store.state.scoresProgressData.scoreDialog?this.scoreDialog=this.$store.state.scoresProgressData.scoreDialog:this.scoreDialog=!1,this.progressType=this.$store.state.scoresProgressData.progressType,this.scoreProgressTimer=this.$store.state.scoresProgressData.scoreProgressTimer,this.scoreDialog&&(this.scoreProgressTimer=setInterval(this.checkScoreProgress,1e3))},destroyed:function(){this.$store.state.scoresProgressData.scoreProgressTitle=this.scoreProgressTitle,this.$store.state.scoresProgressData.scoreProgressPercent=this.scoreProgressPercent,this.$store.state.scoresProgressData.scoreDialog=this.scoreDialog,this.$store.state.scoresProgressData.progressType=this.progressType,this.$store.state.scoresProgressData.scoreProgressTimer=this.scoreProgressTimer,clearInterval(this.scoreProgressTimer)}},p=r("fzx2"),g=r("ppUw"),m=r.n(g),f={mixins:[h,v],data:function(){return{fixed:!1,title:this.$t("App.title"),locale:"en",locales:[{text:"English",value:"en"},{text:"French",value:"fr"}]}},watch:{locale:function(e){this.$i18n.locale=e}},methods:{renderInitialPage:function(){var e=this,t=this.$store.state.activePair.source1.name,r=this.$store.state.activePair.source2.name;if(t&&r||!(this.$store.state.dataSources.length>1||this.$store.state.dataSourcePairs.length>0))if(t&&r){t=this.toTitleCase(t),r=this.toTitleCase(r);var a=this.$store.state.activePair.userID._id;l.a.get("/uploadAvailable/"+t+"/"+r+"/"+a).then(function(t){t.data.dataUploaded?e.$router.push({name:"FacilityReconScores"}):e.$router.push({name:"FacilityReconDataSync"})}).catch(function(t){console.log(t),e.$router.push({name:"FacilityReconDataSync"})})}else this.$router.push({name:"FacilityReconDataSync"});else this.$router.push({name:"FacilityReconDataSourcePair"})},getTotalLevels:function(){var e=this,t=this.$store.state.activePair.source1.name,r=this.$store.state.activePair.source2.name;if(!t||!r)return this.$store.state.totalSource1Levels=5,this.$store.state.totalSource2Levels=5,this.$store.state.initializingApp=!1,this.getScores(),this.$store.state.recoLevel=2,void this.getRecoStatus();t=this.toTitleCase(t),r=this.toTitleCase(r);var a=this.$store.state.activePair.userID._id;l.a.get("/countLevels/"+t+"/"+r+"/"+a).then(function(t){e.$store.state.initializingApp=!1,e.$store.state.levelMapping.source1=t.data.levelMapping.levelMapping1,e.$store.state.levelMapping.source2=t.data.levelMapping.levelMapping2,e.$store.state.totalSource1Levels=t.data.totalSource1Levels,e.$store.state.totalSource2Levels=t.data.totalSource2Levels,e.getScores(),e.$store.state.recoLevel=2,e.getRecoStatus()})},getRecoStatus:function(){var e=this;if(0!==n()(this.$store.state.activePair.source1).length&&0!==n()(this.$store.state.activePair.source2).length){var t=this.toTitleCase(this.$store.state.activePair.source1.name),r=this.toTitleCase(this.$store.state.activePair.source2.name),a=this.$store.state.activePair.userID._id;l.a.get("/recoStatus/"+t+"/"+r+"/"+a).then(function(t){t.data.status&&(e.$store.state.recoStatus=t.data.status)}).catch(function(e){console.log(e.response.data.error)})}},getDataSources:function(){var e=this;this.$store.state.loadingServers=!0,this.$store.state.dataSources=[];var t=this.$store.state.auth.userID;l.a.get("/getDataSources/"+t).then(function(t){e.$store.state.loadingServers=!1,e.$store.state.dataSources=t.data.servers,e.getDataSourcePair()}).catch(function(t){e.$store.state.loadingServers=!1,console.log(o()(t))})},getDataSourcePair:function(){var e=this;this.$store.state.activePair.source1={},this.$store.state.activePair.source2={};var t=this.$store.state.auth.userID;l.a.get("/getDataSourcePair/"+t).then(function(t){e.$store.state.dataSourcePairs=t.data;var r=e.getActivePair();n()(r).length>0&&(e.$store.state.activePair.source1.id=r.source1._id,e.$store.state.activePair.source1.name=r.source1.name,e.$store.state.activePair.source2.id=r.source2._id,e.$store.state.activePair.source2.name=r.source2.name,e.$store.state.activePair.shared=r.shared,e.$store.state.activePair.userID=r.userID),e.renderInitialPage(),e.getTotalLevels()}).catch(function(t){console.log(o()(t)),e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription="An error occured while getting data source pairs, reload the app to retry",e.renderInitialPage(),e.getTotalLevels()})},getActivePair:function(){var e=this,t=void 0,r={};return this.$store.state.dataSourcePairs.forEach(function(a){a.userID._id===e.$store.state.auth.userID&&"active"===a.status&&(r=a),n()(r).length>0?t=void 0:a.userID._id!==e.$store.state.auth.userID&&"active"===a.status&&(t=a)}),t&&(r=t),r}},created:function(){var e=this;m.a.get("token")&&m.a.get("userID")&&(this.$store.state.auth.token=m.a.get("token"),this.$store.state.auth.userID=m.a.get("userID"),this.$store.state.auth.username=m.a.get("username"),this.$store.state.auth.role=m.a.get("role"),l.a.get("/isTokenActive/").then(function(t){e.$store.state.clientId=p.a.v4(),e.$store.state.initializingApp=!0,e.$store.state.denyAccess=!1,e.getDataSources()})),ke.$on("refreshApp",function(){e.getDataSources()}),ke.$on("recalculateScores",function(){e.getScores()}),ke.$on("getDataSources",function(){e.getDataSources()}),ke.$on("getDataSourcePair",function(){e.getDataSourcePair()})},name:"App"},_={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-toolbar",{attrs:{color:"primary",dark:"",app:""}},[r("v-toolbar-title",{domProps:{textContent:e._s(e.title)}}),e._v(" "),r("v-spacer"),e._v(" "),e.$store.state.auth.token?r("v-toolbar-items",[r("v-tooltip",{attrs:{bottom:""}},[e.$store.state.denyAccess?e._e():r("v-btn",{attrs:{slot:"activator",to:"dataSync",flat:""},slot:"activator"},[r("v-icon",[e._v("sync")]),e._v(e._s(e.$t("App.menu.dataSources.msg"))+"\n        ")],1),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.dataSources.tooltip")))])],1),e._v(" "),r("v-tooltip",{attrs:{bottom:""}},[e.$store.state.denyAccess?e._e():r("v-btn",{attrs:{slot:"activator",to:"view",flat:""},slot:"activator"},[r("v-icon",[e._v("list")]),e._v(e._s(e.$t("App.menu.view.msg"))+"\n        ")],1),e._v(" "),r("span",[e._v("{{ $t('App.menu.view.tooltip')}")])],1),e._v(" "),r("v-menu",{attrs:{"open-on-hover":"",bottom:"","offset-y":""}},[r("v-btn",{attrs:{slot:"activator",flat:""},slot:"activator"},[e._v("\n          "+e._s(e.$t("App.menu.recoParent.msg"))+"\n        ")]),e._v(" "),r("v-list",[r("v-tooltip",{attrs:{top:""}},[e.$store.state.dataSources.length>1?r("v-list-tile",{attrs:{slot:"activator",to:"dataSourcePair"},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("compare_arrows")]),e._v(e._s(e.$t("App.menu.createPair.msg"))+"\n              ")],1)],1):r("v-list-tile",{attrs:{slot:"activator",to:"dataSourcePair",disabled:""},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("compare_arrows")]),e._v(e._s(e.$t("App.menu.createPair.msg"))+"\n              ")],1)],1),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.createPair.tooltip")))])],1),e._v(" "),r("v-tooltip",{attrs:{top:""}},[0===Object.keys(e.$store.state.activePair.source1).length?r("v-list-tile",{attrs:{slot:"activator",to:"scores",disabled:""},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("find_in_page")]),e._v(e._s(e.$t("App.menu.reconcile.msg"))+"\n              ")],1)],1):r("v-list-tile",{attrs:{slot:"activator",to:"scores"},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("find_in_page")]),e._v(e._s(e.$t("App.menu.reconcile.msg"))+"\n              ")],1)],1),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.reconcile.tooltip")))])],1),e._v(" "),r("v-tooltip",{attrs:{bottom:""}},[0===Object.keys(e.$store.state.activePair.source1).length?r("v-list-tile",{attrs:{slot:"activator",to:"recoStatus",disabled:""},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("dashboard")]),e._v(" "+e._s(e.$t("App.menu.recoStatus.msg"))+"\n              ")],1)],1):r("v-list-tile",{attrs:{slot:"activator",to:"recoStatus"},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("dashboard")]),e._v(" "+e._s(e.$t("App.menu.recoStatus.msg"))+"\n              ")],1)],1),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.recoStatus.tooltip")))])],1),e._v(" "),r("v-tooltip",{attrs:{bottom:""}},[r("v-list-tile",{attrs:{slot:"activator",to:"dbAdmin"},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("archive")]),e._v(" "+e._s(e.$t("App.menu.archive.msg"))+"\n              ")],1)],1),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.archive.tooltip")))])],1)],1)],1),e._v(" "),e.$store.state.denyAccess?e._e():r("v-menu",{attrs:{"open-on-hover":"",bottom:"","offset-y":""}},[r("v-btn",{attrs:{slot:"activator",flat:""},slot:"activator"},[r("v-icon",[e._v("perm_identity")]),e._v(e._s(e.$t("App.menu.account.msg"))+"\n        ")],1),e._v(" "),r("v-list",[r("v-tooltip",{attrs:{top:""}},["Admin"===e.$store.state.auth.role?r("v-list-tile",{attrs:{slot:"activator",to:"addUser"},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("perm_identity")]),e._v(e._s(e.$t("App.menu.addUser.msg"))+"\n              ")],1)],1):e._e(),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.addUser.tooltip")))])],1),e._v(" "),r("v-tooltip",{attrs:{bottom:""}},["Admin"===e.$store.state.auth.role?r("v-list-tile",{attrs:{slot:"activator",to:"usersList"},slot:"activator"},[r("v-list-tile-title",[r("v-icon",[e._v("perm_identity")]),e._v(e._s(e.$t("App.menu.usersList.msg"))+"\n              ")],1)],1):e._e(),e._v(" "),r("span",[e._v(e._s(e.$t("App.menu.usersList.tooltip")))])],1),e._v(" "),r("v-list-tile",{attrs:{to:"changePassword"}},[r("v-list-tile-title",[r("v-icon",[e._v("perm_identity")]),e._v(e._s(e.$t("App.menu.changePassword.msg"))+"\n            ")],1)],1)],1)],1),e._v(" "),e.$store.state.denyAccess?e._e():r("v-btn",{attrs:{flat:"",to:"logout"}},[r("v-icon",[e._v("logout")]),e._v(" "+e._s(e.$t("App.menu.logout.msg"))+"\n      ")],1)],1):e._e(),e._v(" "),r("v-spacer"),e._v(" "),r("v-toolbar-items")],1),e._v(" "),r("v-content",[r("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.$store.state.dynamicProgress,callback:function(t){e.$set(e.$store.state,"dynamicProgress",t)},expression:"$store.state.dynamicProgress"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v("\n          "+e._s(e.$store.state.progressTitle)+"\n          "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.$store.state.dialogError,callback:function(t){e.$set(e.$store.state,"dialogError",t)},expression:"$store.state.dialogError"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n            "+e._s(e.$store.state.errorTitle)+"\n          ")])],1),e._v(" "),r("v-card-text",[e._v("\n          "+e._s(e.$store.state.errorDescription)+"\n        ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){e.$store.state.dialogError=!1}}},[e._v("Ok")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.$store.state.initializingApp,callback:function(t){e.$set(e.$store.state,"initializingApp",t)},expression:"$store.state.initializingApp"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v("\n          "+e._s(e.$t("App.initApp"))+"\n          "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[Object.keys(e.$store.state.activePair.source1).length>0&&e.$store.state.auth.token?[e._v("\n         "+e._s(e.$t("App.source"))+" 1: "),r("b",[e._v(e._s(e.$store.state.activePair.source1.name))]),e._v(",     "+e._s(e.$t("App.source"))+" 2: "),r("b",[e._v(e._s(e.$store.state.activePair.source2.name))]),e._v(",\n             Reco Status: "),"on-progress"===e.$store.state.recoStatus?r("v-icon",{attrs:{small:""}},[e._v("lock_open")]):r("v-icon",{attrs:{small:""}},[e._v("lock")]),e._v(" "),r("b",[e._v(e._s(e.$store.state.recoStatus))])]:e._e()],2),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-select",{attrs:{items:e.locales},model:{value:e.locale,callback:function(t){e.locale=t},expression:"locale"}})],1)],1),e._v(" "),r("router-view")],1),e._v(" "),r("v-footer",{attrs:{dark:"",color:"primary",fixed:e.fixed,app:""}})],1)},staticRenderFns:[]},x=r("VU/8")(f,_,!1,null,null,null).exports,S=r("/ocq"),$=r("gRE1"),y=r.n($),b={data:function(){return{name:"",host:"",username:"",password:"",sourceType:""}},methods:{addDataSource:function(e){var t=this,r=new FormData,a=this.$store.state.clientId;r.append("host",this.host),r.append("sourceType",this.sourceType),r.append("source",e),r.append("username",this.username),r.append("password",this.password),r.append("name",this.name),r.append("clientId",a),r.append("userID",this.$store.state.auth.userID);var s=this.$store.state.dataSources.find(function(e){return e.host===t.host});l.a.post("/addDataSource",r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){ke.$emit("dataSourceSaved"),ke.$emit("dataSourceAddedSuccessfully"),ke.$emit("getDataSources"),s?(s.name=t.name,s.username=t.username,s.password=e.data.password,s.sourceType=t.sourceType):t.$store.state.dataSources.push({name:t.name,host:t.host,sourceType:t.sourceType,source:"syncServer",username:t.username,password:e.data.password})}).catch(function(e){console.log(e),ke.$emit("remoteServerFailedAdd")})}}},P=r("+cKO"),w={mixins:[b,v],data:function(){return{errorDialog:!1,errorTitle:"",errorContent:"",dialog:!1,fileUploadPercentage:"",percentDialog:!1,uploadPrepaProgr:!1,UploadProgressTimer:"",uploadStatus:"1/3 Uploading CSV to the server",uploadPercent:null,uploadName:"",uploadNameErrors:[],confirmUpload:!1,confirmTitle:"",confirmMsg:"",file:"",uploadedFileName:"",e1:0,facility:null,code:null,lat:null,long:null,level1:null,level2:null,level3:null,level4:null,level5:null,level6:null,level7:null,showLevel3:!1,showLevel4:!1,showLevel5:!1,showLevel6:!1,showLevel7:!1,uploadedHeaders:[],mappedHeaders:[],invalidRowsHeader:[],invalidRowsContent:[],invalidRows:!1,valid:!1}},validations:{facility:{required:P.required},code:{required:P.required},level1:{required:P.required},level2:{required:P.required},uploadName:{required:P.required}},methods:{fileSelected:function(e){this.uploadedFileName=e.target.files[0].name,"text/csv"===e.target.files[0].type||"application/vnd.ms-excel"===e.target.files[0].type&&"csv"===e.target.files[0].name.slice(-3).toLowerCase()||(this.errorDialog=!0,this.errorTitle="Error",this.errorContent="Wrong file type uploaded,Only CSV format is supported",this.uploadedFileName=""),this.file=e.target.files[0];var t=new FileReader;t.addEventListener("load",function(){for(var e=t.result,r=e.byteLength,a=new Uint8Array(e,0),s="",o=0;o<r;o++){var i=String.fromCharCode(a[o]);if(null===i.match(/[^\r\n]+/g))break;s+=i}this.uploadedHeaders=s.split(",")}.bind(this),!1),t.readAsArrayBuffer(e.target.files[0])},ensureNameUnique:function(){if(this.uploadNameErrors=[],""===this.uploadName)return this.uploadNameErrors.push("Upload name is required");var e=!0,t=!1,r=void 0;try{for(var a,s=d()(this.$store.state.dataSources);!(e=(a=s.next()).done);e=!0){if(a.value.name===this.uploadName)return this.uploadNameErrors.push("This Name Exists"),!1}}catch(e){t=!0,r=e}finally{try{!e&&s.return&&s.return()}finally{if(t)throw r}}},confirmSubmit:function(){this.confirmUpload=!0},checkUploadProgress:function(){var e=this,t=this.$store.state.clientId;l.a.get("/uploadProgress/"+t).then(function(t){if(null===t.data||void 0===t.data||!1===t.data)return e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,void clearInterval(e.UploadProgressTimer);null!==t.data.error?(e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.data.error,clearInterval(e.UploadProgressTimer),console.log(t.data.error)):null===t.data.status&&(e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,clearInterval(e.UploadProgressTimer)),e.uploadStatus=t.data.status,t.data.percent&&(e.percentDialog||(e.uploadPrepaProgr=!1,e.percentDialog=!0),e.uploadPercent=t.data.percent),("Done"===t.data.status||t.data.status>=100)&&(e.addDataSource("upload"),clearInterval(e.UploadProgressTimer),e.$store.state.recoLevel=2,e.percentDialog=!1,e.dialog=!0,e.$store.state.uploadRunning=!1)}).catch(function(e){console.log(e)})},submitCSV:function(){var e=this,t=new FormData;t.append("file",this.file),t.append("csvName",this.uploadName),t.append("facility",this.facility),t.append("code",this.code),t.append("lat",this.lat),t.append("long",this.long),t.append("level1",this.level1),t.append("level2",this.level2),t.append("level3",this.level3),t.append("level4",this.level4),t.append("level5",this.level5),t.append("level6",this.level6),t.append("level7",this.level7),t.append("clientId",this.$store.state.clientId),t.append("userID",this.$store.state.auth.userID),this.confirmUpload=!1,this.$store.state.uploadRunning=!0,this.uploadPrepaProgr=!0,this.host="",this.sourceType="upload",this.username="",this.password="",this.name=this.uploadName,l.a.post("/uploadCSV",t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){this.fileUploadPercentage=parseInt(Math.round(100*e.loaded/e.total)),100===this.fileUploadPercentage&&(this.fileUploadPercentage="",this.uploadStatus="2/3 Validating CSV Data")}.bind(this)}).then(function(t){e.UploadProgressTimer=setInterval(e.checkUploadProgress,1e3)}).catch(function(t){if(Array.isArray(t.response.data.error)){e.invalidRows=!0;for(var r=0;r<t.response.data.error.length;r++){if(0===r){var a=n()(t.response.data.error[r].data),s=!0,o=!1,i=void 0;try{for(var c,l=d()(a);!(s=(c=l.next()).done);s=!0){var u=c.value;e.invalidRowsHeader.push({text:u,value:u})}}catch(t){o=!0,i=t}finally{try{!s&&l.return&&l.return()}finally{if(o)throw i}}e.invalidRowsHeader.push({text:"Reason",value:"reason"})}var v=y()(t.response.data.error[r].data),h={};for(var p in v)h[e.invalidRowsHeader[p].value]=v[p];h.reason=t.response.data.error[r].reason,e.invalidRowsContent.push(h)}}else e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.response.data.error+". Reload page and retry";e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,clearInterval(e.UploadProgressTimer)})},closeInvalidRows:function(){this.invalidRows=!1,this.invalidRowsHeader=[],this.invalidRowsContent=[],this.e1=1},closeDialog:function(e){this.$router.push({name:e}),this.dialog=!1},closeUploadWindow:function(){ke.$emit("dataSourceSaved")},showMoreLevel:function(){this.showLevel3?this.showLevel4?this.showLevel5?this.showLevel6?this.showLevel7||(this.showLevel7=!0):this.showLevel6=!0:this.showLevel5=!0:this.showLevel4=!0:this.showLevel3=!0}},computed:{uploadNameErrorsss:function(){var e=[];return this.$v.uploadName.$dirty?(!this.$v.uploadName.required&&e.push("Upload Name is required"),e):e},facilityErrors:function(){var e=[];return this.$v.facility.$dirty?(!this.$v.facility.required&&e.push("Facility is required"),e):e},codeErrors:function(){var e=[];return this.$v.code.$dirty?(!this.$v.code.required&&e.push("Code is required"),e):e},latErrors:function(){var e=[];return this.$v.lat.$dirty?(!this.$v.lat.required&&e.push("Latitude is required"),e):e},longErrors:function(){var e=[];return this.$v.long.$dirty?(!this.$v.long.required&&e.push("Longitude is required"),e):e},level1Errors:function(){var e=[];return this.$v.level1.$dirty?(!this.$v.level1.required&&e.push("Level 1 is required"),e):e},level2Errors:function(){var e=[];return this.$v.level2.$dirty?(!this.$v.level2.required&&e.push("Level 2 is required"),e):e},filteredItemFacility:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemCode:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLat:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLong:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLevel1:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLevel2:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLevel3:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLevel4:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level5&&t!==e.level6&&t!==e.level7})},filteredItemLevel5:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level6&&t!==e.level7})},filteredItemLevel6:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level7})},filteredItemLevel7:function(){var e=this;return this.uploadedHeaders.filter(function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6})}},created:function(){this.$store.state.uploadProgressData.percentDialog&&(this.percentDialog=this.$store.state.uploadProgressData.percentDialog),this.$store.state.uploadProgressData.uploadPrepaProgr&&(this.uploadPrepaProgr=this.$store.state.uploadProgressData.uploadPrepaProgr),this.$store.state.uploadProgressData.UploadProgressTimer&&(this.UploadProgressTimer=this.$store.state.uploadProgressData.UploadProgressTimer),this.$store.state.uploadProgressData.uploadStatus&&(this.uploadStatus=this.$store.state.uploadProgressData.uploadStatus),this.$store.state.uploadProgressData.uploadPercent&&(this.uploadPercent=this.$store.state.uploadProgressData.uploadPercent),(this.percentDialog||this.uploadPrepaProgr)&&(this.UploadProgressTimer=setInterval(this.checkUploadProgress,1e3))},destroyed:function(){this.$store.state.uploadProgressData.dialog=this.dialog,this.$store.state.uploadProgressData.percentDialog=this.percentDialog,this.$store.state.uploadProgressData.uploadPrepaProgr=this.uploadPrepaProgr,this.$store.state.uploadProgressData.UploadProgressTimer=this.UploadProgressTimer,this.$store.state.uploadProgressData.uploadStatus=this.uploadStatus,this.$store.state.uploadProgressData.uploadPercent=this.uploadPercent,clearInterval(this.checkUploadProgress)}},D={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n          Information\n        ")])],1),e._v(" "),r("v-card-text",[e._v("\n        Data uploaded successfully\n      ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){e.closeDialog("FacilityReconView")}}},[r("v-icon",{attrs:{left:""}},[e._v("list")]),e._v("\n          View Data\n        ")],1)],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"1050px"},model:{value:e.invalidRows,callback:function(t){e.invalidRows=t},expression:"invalidRows"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("error")]),e._v("Data Upload was not successful,review below invalid rows in your CSV\n        ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.closeInvalidRows()}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.invalidRowsHeader,items:e.invalidRowsContent,light:""},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.invalidRowsHeader,function(a){return r("td",[e._v(e._s(t.item[a.value]))])})}}])})],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.confirmUpload,callback:function(t){e.confirmUpload=t},expression:"confirmUpload"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n          Warning\n        ")])],1),e._v(" "),r("v-card-text",[e._v("\n        You are about to upload CSV data into the app, click proceed to upload\n      ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.confirmUpload=!1}}},[e._v("Cancel")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.submitCSV(t)}}},[e._v("Proceed")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.errorDialog,callback:function(t){e.errorDialog=t},expression:"errorDialog"}},[r("v-card",[r("v-card-title",[e._v("\n        "+e._s(e.errorTitle)+"\n      ")]),e._v(" "),r("v-card-text",[e._v("\n        "+e._s(e.errorContent)+"\n      ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.errorDialog=!1}}},[e._v("Ok")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{transition:"scale-transition",persistent:"",width:"300"},model:{value:e.uploadPrepaProgr,callback:function(t){e.uploadPrepaProgr=t},expression:"uploadPrepaProgr"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v("\n        "+e._s(e.uploadStatus)+"\n        "),e.fileUploadPercentage?r("v-progress-linear",{staticClass:"mb-0",attrs:{color:"white"},model:{value:e.fileUploadPercentage,callback:function(t){e.fileUploadPercentage=t},expression:"fileUploadPercentage"}}):r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{transition:"scale-transition",persistent:"",width:"270"},model:{value:e.percentDialog,callback:function(t){e.percentDialog=t},expression:"percentDialog"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.uploadStatus))]),r("br"),e._v(" "),r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.uploadPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.uploadPercent)+"%")])])])],1)],1)],1)],1)],1),e._v(" "),e.$store.state.denyAccess?e._e():r("v-slide-y-transition",{attrs:{mode:"out-in"}},[r("v-stepper",{model:{value:e.e1,callback:function(t){e.e1=t},expression:"e1"}},[r("v-stepper-header",[r("v-stepper-step",{attrs:{step:"1",complete:e.e1>1}},[e._v("Upload CSV")]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{step:"2",complete:e.e1>2}},[e._v("Map Headers")]),e._v(" "),r("v-btn",{attrs:{icon:""},nativeOn:{click:function(t){e.closeUploadWindow()}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-stepper-items",[r("v-stepper-content",{attrs:{step:"1"}},[r("v-card",{staticClass:"mb-5",attrs:{height:"200px"}},[r("v-card-title",[e._v("Upload CSV (utf-8 only) - "),r("b",[e._v("Select a CSV file and upload")])]),e._v(" "),r("v-card-text",[r("v-text-field",{attrs:{label:"Enter Unique Name For Your Data","error-messages":e.uploadNameErrors,required:""},on:{blur:e.ensureNameUnique,input:e.ensureNameUnique},model:{value:e.uploadName,callback:function(t){e.uploadName=t},expression:"uploadName"}}),e._v(" "),r("div",{staticClass:"btn btn-primary jbtn-file"},[e._v("Upload CSV"),r("input",{attrs:{type:"file"},on:{change:e.fileSelected}})]),e._v("\n              "+e._s(e.uploadedFileName)+"\n            ")],1)],1),e._v(" "),e.uploadedFileName&&e.uploadName&&0===e.uploadNameErrors.length?r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){e.e1=2}}},[e._v("Continue")]):r("v-btn",{attrs:{color:"primary",disabled:""},nativeOn:{click:function(t){e.e1=2}}},[e._v("Continue")])],1),e._v(" "),r("v-stepper-content",{attrs:{step:"2"}},[r("b",[e._v("Map an appropriate CSV header against those on the app.")]),e._v(" "),r("v-container",{attrs:{fluid:""}},[r("v-layout",{ref:"form",attrs:{row:"",wrap:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Facility*")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemFacility,"error-messages":e.facilityErrors,label:"Select",required:"","single-line":"",clearable:""},on:{blur:function(t){e.$v.facility.$touch()},change:function(t){e.$v.facility.$touch()}},model:{value:e.facility,callback:function(t){e.facility=t},expression:"facility"}})],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Code")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemCode,"error-messages":e.codeErrors,label:"Select",required:"","single-line":"",clearable:""},on:{blur:function(t){e.$v.code.$touch()},change:function(t){e.$v.code.$touch()}},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Latitude")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLat,label:"Select","single-line":"",clearable:""},model:{value:e.lat,callback:function(t){e.lat=t},expression:"lat"}})],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Longitude")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLong,label:"Select","single-line":"",clearable:""},model:{value:e.long,callback:function(t){e.long=t},expression:"long"}})],1),e._v(" "),[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 1*")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel1,"error-messages":e.level1Errors,required:"",label:"Select","single-line":"",clearable:""},on:{blur:function(t){e.$v.level1.$touch()},change:function(t){e.$v.level1.$touch()}},model:{value:e.level1,callback:function(t){e.level1=t},expression:"level1"}})],1)],e._v(" "),[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 2*")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel2,"error-messages":e.level2Errors,required:"",label:"Select","single-line":"",clearable:""},on:{blur:function(t){e.$v.level2.$touch()},change:function(t){e.$v.level2.$touch()}},model:{value:e.level2,callback:function(t){e.level2=t},expression:"level2"}})],1)],e._v(" "),e.showLevel3?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 3")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel3,label:"Select","single-line":"",clearable:""},model:{value:e.level3,callback:function(t){e.level3=t},expression:"level3"}})],1)]:e._e(),e._v(" "),e.showLevel4?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 4")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel4,label:"Select","single-line":"",clearable:""},model:{value:e.level4,callback:function(t){e.level4=t},expression:"level4"}})],1)]:e._e(),e._v(" "),e.showLevel5?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 5")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel5,label:"Select","single-line":"",clearable:""},model:{value:e.level5,callback:function(t){e.level5=t},expression:"level5"}})],1)]:e._e(),e._v(" "),e.showLevel6?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 6")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel6,label:"Select","single-line":"",clearable:""},model:{value:e.level6,callback:function(t){e.level6=t},expression:"level6"}})],1)]:e._e(),e._v(" "),e.showLevel7?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 7")])],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel7,label:"Select","single-line":"",clearable:""},model:{value:e.level7,callback:function(t){e.level7=t},expression:"level7"}})],1)]:e._e(),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),e._v(" "),r("v-tooltip",{attrs:{top:""}},[e.showLevel7?e._e():r("v-btn",{attrs:{slot:"activator",color:"success",icon:""},on:{click:e.showMoreLevel},slot:"activator"},[r("v-icon",[e._v("add")])],1),e._v(" "),r("span",[e._v("Add More Level")])],1)],1)],2)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.e1=1}}},[e._v("Go Back")])],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{color:"primary",disabled:e.$v.$invalid},nativeOn:{click:function(t){e.confirmUpload=!0}}},[e._v("Upload")])],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var k=r("VU/8")(w,D,!1,function(e){r("zMXS")},"data-v-1612a57e",null).exports,T={validations:{username:{required:P.required},password:{required:P.required}},data:function(){return{username:"",password:"",authStatus:!1}},methods:{authenticate:function(){var e=this,t=new FormData;t.append("username",this.username),t.append("password",this.password),l.a.post("/authenticate/",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.$store.state.auth.token=t.data.token,e.$store.state.auth.username=e.username,e.$store.state.auth.userID=t.data.userID,e.$store.state.auth.role=t.data.role,m.a.config("30d"),m.a.set("token",e.$store.state.auth.token,"infinity"),m.a.set("userID",e.$store.state.auth.userID,"infinity"),m.a.set("role",e.$store.state.auth.role,"infinity"),m.a.set("username",e.$store.state.auth.username,"infinity"),e.$store.state.auth.role=t.data.role,t.data.token?(e.$store.state.clientId=p.a.v4(),e.$store.state.initializingApp=!0,e.$store.state.denyAccess=!1,ke.$emit("getDataSources")):e.authStatus=!0}).catch(function(e){e.hasOwnProperty("response")&&console.log(e.response.data.error)})}},created:function(){console.log("")},computed:{usernameErrors:function(){var e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e}}},I={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("center",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}}),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-alert",{attrs:{type:"error",value:e.authStatus}},[e._v("\n        Authentication Failed\n      ")])],1)],1),e._v(" "),r("v-card",{attrs:{width:"430px",hover:""}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{color:"white"},attrs:{color:"primary"}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs2:"","text-xs-left":""}},[r("v-icon",{attrs:{"x-large":"",color:"white"}},[e._v("lock")])],1),e._v(" "),r("v-flex",{attrs:{xs9:"","text-xs-right":""}},[r("b",[e._v("Login")])])],1)],1)],1),e._v(" "),r("v-card-text",[r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,box:"",color:"deep-purple",label:"Username"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.authenticate()},blur:function(t){e.$v.username.$touch()},change:function(t){e.$v.username.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,box:"",type:"password",color:"deep-purple",label:"Password"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.authenticate()},blur:function(t){e.$v.password.$touch()},change:function(t){e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-toolbar",{attrs:{color:"#5F6A6A"}},[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){e.authenticate()}}},[e._v("Login")])],1)],1)],1)],1)],1)},staticRenderFns:[]},M=r("VU/8")(T,I,!1,null,null,null).exports,L={mounted:function(){this.$store.state.auth.token="",m.a.remove("token"),m.a.remove("userID"),m.a.remove("role"),m.a.remove("username"),this.$router.push("login")}},C={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]},A=r("VU/8")(L,C,!1,null,null,null).exports,U={data:function(){return{usersHeader:[{text:"Firstname",value:"firstname"},{text:"Surname",value:"surname"},{text:"Othername",value:"othername"},{text:"User Name",value:"username"},{text:"Role",value:"role"},{text:"Status",value:"status"}],users:[],loadingUsers:!1,searchUsers:"",alertSuccess:!1,alertFail:!1,alertMsg:""}},methods:{getUsers:function(){var e=this,t=new FormData;t.append("username",this.username),t.append("password",this.password),this.loadingUsers=!0,l.a.get("/getUsers/").then(function(t){e.loadingUsers=!1,e.users=t.data}).catch(function(t){e.loadingUsers=!1,t.hasOwnProperty("response")&&console.log(t.response.data.error)})},accountAction:function(e,t){var r=this,a=t._id,s=new FormData;s.append("id",a),"Active"===e||"Inactive"===e?(s.append("status",e),l.a.post("/changeAccountStatus",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){r.alertSuccess=!0,"Active"===e?r.alertMsg="Account activated successfully":"Inactive"===e&&(r.alertMsg="Account deactivated successfully"),r.getUsers()}).catch(function(e){console.log(o()(e)),r.alertFail=!0,r.alertMsg="Action failed"})):"reset"===e&&(s.append("surname",t.surname),l.a.post("/resetPassword",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){r.alertSuccess=!0,r.alertMsg="Password reseted successfully",r.getUsers()}).catch(function(e){console.log(o()(e)),r.alertFail=!0,r.alertMsg="Action failed"}))}},created:function(){this.getUsers()}},R={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v("\n    "+e._s(e.alertMsg)+"\n  ")]),e._v(" "),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertFail,callback:function(t){e.alertFail=t},expression:"alertFail"}},[e._v("\n    "+e._s(e.alertMsg)+"\n  ")]),e._v(" "),r("v-card",{attrs:{color:"cyan lighten-5"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v("\n        Users List\n        "),r("v-spacer"),e._v(" "),r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUsers,callback:function(t){e.searchUsers=t},expression:"searchUsers"}})],1)],1),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.usersHeader,items:e.users,search:e.searchUsers,dark:"",loading:e.$store.state.loadingusers},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.firstName))]),e._v(" "),r("td",[e._v(e._s(t.item.surname))]),e._v(" "),r("td",[e._v(e._s(t.item.otherName))]),e._v(" "),r("td",[e._v(e._s(t.item.userName))]),e._v(" "),r("td",[e._v(e._s(t.item.role.name))]),e._v(" "),r("td",[e._v(e._s(t.item.status))]),e._v(" "),r("td",["Active"===t.item.status?r("v-btn",{attrs:{small:"",color:"error"},on:{click:function(r){e.accountAction("Inactive",t.item)}}},[e._v("Deactivate")]):r("v-btn",{attrs:{small:"",color:"success"},on:{click:function(r){e.accountAction("Active",t.item)}}},[e._v("Activate")]),e._v(" "),r("v-btn",{attrs:{small:"",color:"error"},on:{click:function(r){e.accountAction("reset",t.item)}}},[r("v-icon",{attrs:{left:""}},[e._v("refresh")]),e._v(" Reset Password")],1)],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1)},staticRenderFns:[]},F=r("VU/8")(U,R,!1,null,null,null).exports,N={validations:{username:{required:P.required},retype_password:{required:P.required},password:{required:P.required},role:{required:P.required},firstname:{required:P.required},surname:{required:P.required}},data:function(){return{firstname:"",othername:"",surname:"",username:"",password:"",retype_password:"",role:"",alertFail:!1,alertSuccess:!1,alertMsg:"",roles:[]}},methods:{addUser:function(){var e=this;if(this.password!==this.retype_password)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Password mismatch");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Saving User";var t=new FormData;t.append("firstname",this.firstname),t.append("othername",this.othername),t.append("password",this.password),t.append("username",this.username),t.append("surname",this.surname),t.append("role",this.role),l.a.post("/addUser/",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){e.firstname="",e.othername="",e.surname="",e.password="",e.username="",e.retype_password="",e.role="",e.$store.state.dynamicProgress=!1,e.alertSuccess=!0,e.alertMsg="User added successfully"}).catch(function(t){e.$store.state.dynamicProgress=!1,e.alertFail=!0,e.alertMsg="This user was not added, ensure username is not used",console.log(t.response.data.error)})},getRoles:function(){var e=this;l.a.get("/getRoles").then(function(t){var r=!0,a=!1,s=void 0;try{for(var o,i=d()(t.data);!(r=(o=i.next()).done);r=!0){var n=o.value;e.roles.push({text:n.name,value:n._id})}}catch(e){a=!0,s=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw s}}}).catch(function(e){console.log(e.response.data)})}},computed:{codeErrors:function(){var e=[];return this.$v.code.$dirty?(!this.$v.code.required&&e.push("Code is required"),e):e},firstnameErrors:function(){var e=[];return this.$v.firstname.$dirty?(!this.$v.firstname.required&&e.push("First Name is required"),e):e},surnameErrors:function(){var e=[];return this.$v.surname.$dirty?(!this.$v.surname.required&&e.push("Surname is required"),e):e},usernameErrors:function(){var e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e},roleErrors:function(){var e=[];return this.$v.role.$dirty?(!this.$v.role.required&&e.push("Role is required"),e):e}},created:function(){this.getRoles()}},E={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v("\n        "+e._s(e.alertMsg)+"\n      ")]),e._v(" "),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertFail,callback:function(t){e.alertFail=t},expression:"alertFail"}},[e._v("\n        "+e._s(e.alertMsg)+"\n      ")]),e._v(" "),r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),e._v(" "),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",flat:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add New User")])],1),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.firstnameErrors,box:"",color:"deep-purple",label:"First Name"},on:{blur:function(t){e.$v.firstname.$touch()},change:function(t){e.$v.firstname.$touch()}},model:{value:e.firstname,callback:function(t){e.firstname=t},expression:"firstname"}}),e._v(" "),r("v-text-field",{attrs:{box:"",color:"deep-purple",label:"Middle Names"},model:{value:e.othername,callback:function(t){e.othername=t},expression:"othername"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.surnameErrors,box:"",color:"deep-purple",label:"Surname"},on:{blur:function(t){e.$v.surname.$touch()},change:function(t){e.$v.surname.$touch()}},model:{value:e.surname,callback:function(t){e.surname=t},expression:"surname"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,box:"",color:"deep-purple",label:"Username"},on:{blur:function(t){e.$v.username.$touch()},change:function(t){e.$v.surname.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",box:"",color:"deep-purple",label:"Password"},on:{blur:function(t){e.$v.password.$touch()},change:function(t){e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.retype_passwordErrors,type:"password",box:"",color:"deep-purple",label:"Re-type Password"},on:{blur:function(t){e.$v.retype_password.$touch()},change:function(t){e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}}),e._v(" "),r("v-select",{attrs:{required:"",items:e.roles,"single-line":"",clearable:"","error-messages":e.roleErrors,box:"",label:"Role"},on:{blur:function(t){e.$v.role.$touch()},change:function(t){e.$v.role.$touch()}},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}})],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{flat:""},on:{click:function(t){e.$refs.form.reset()}}},[r("v-icon",[e._v("clear")]),e._v("Clear\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){e.addUser()}}},[r("v-icon",{attrs:{left:""}},[e._v("how_to_reg")]),e._v("Add")],1)],1)],1)],1),e._v(" "),r("v-spacer")],1)],1)},staticRenderFns:[]},q=r("VU/8")(N,E,!1,null,null,null).exports,H={validations:{retype_password:{required:P.required},password:{required:P.required},oldPassword:{required:P.required}},data:function(){return{oldPassword:"",password:"",retype_password:"",alertFail:!1,alertSuccess:!1,alertMsg:""}},methods:{changePassword:function(){var e=this;if(this.password!==this.retype_password)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Password mismatch");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Changing Password";var t=new FormData;t.append("password",this.password),t.append("id",this.$store.state.auth.userID),l.a.post("/changePassword/",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){e.oldPassword="",e.password="",e.retype_password="",e.$store.state.dynamicProgress=!1,e.alertSuccess=!0,e.alertMsg="Password changed successfully"}).catch(function(t){e.$store.state.dynamicProgress=!1,e.alertFail=!0,e.alertMsg="Password change failed",console.log(t.response.data.error)})},verifyPassword:function(){var e=this,t=new FormData;t.append("username",this.$store.state.auth.username),t.append("password",this.oldPassword),l.a.post("/authenticate/",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){t.data.token?e.changePassword():(e.alertFail=!0,e.alertMsg="Wrong Old Password")}).catch(function(e){console.log(o()(e))})}},computed:{oldPasswordErrors:function(){var e=[];return this.$v.oldPassword.$dirty?(!this.$v.oldPassword.required&&e.push("Old Password is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e}}},O={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v("\n        "+e._s(e.alertMsg)+"\n      ")]),e._v(" "),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertFail,callback:function(t){e.alertFail=t},expression:"alertFail"}},[e._v("\n        "+e._s(e.alertMsg)+"\n      ")]),e._v(" "),r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),e._v(" "),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",flat:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Change Password")])],1),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.oldPasswordErrors,type:"password",box:"",color:"deep-purple",label:"Old Password"},on:{blur:function(t){e.$v.oldPassword.$touch()},change:function(t){e.$v.oldPassword.$touch()}},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",box:"",color:"deep-purple",label:"Password"},on:{blur:function(t){e.$v.password.$touch()},change:function(t){e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),r("v-text-field",{attrs:{required:"","error-messages":e.retype_passwordErrors,type:"password",box:"",color:"deep-purple",label:"Re-type Password"},on:{blur:function(t){e.$v.retype_password.$touch()},change:function(t){e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}})],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{flat:""},on:{click:function(t){e.$refs.form.reset()}}},[r("v-icon",[e._v("clear")]),e._v("Clear\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){e.verifyPassword()}}},[r("v-icon",{attrs:{left:""}},[e._v("how_to_reg")]),e._v("Change")],1)],1)],1)],1),e._v(" "),r("v-spacer")],1)],1)},staticRenderFns:[]},V=r("VU/8")(H,O,!1,null,null,null).exports,G=r("woOf"),z=r.n(G),B=r("ZIfW"),j={validations:{editLocationName:{required:P.required}},mixins:[h],data:function(){return{confirmDelete:!1,deleteLocationData:"",deleteSource:"",editDialog:!1,editLocationName:"",editLocationId:"",editParents:[],editLocationParent:"",editSource:"",helpDialog:!1,lastLevel:[],headerText:{level2:"Level 1",level3:"Level 2",level4:"Level 3",level5:"Level 4",level6:"Level 5",level7:"Level 6",level8:"Level 7",level9:"Level 8",level10:"Level 9",facility:"Facility",latitude:"Latitude",longitude:"Longitude"},headers:[{text:"Level 1",value:"level1"},{text:"Level 2",value:"level2"},{text:"Level 3",value:"level3"},{text:"Level 4",value:"level4"},{text:"Facility",value:"facility"},{text:"Latitude",value:"latitude"},{text:"Longitude",value:"longitude"}],searchSource1:"",searchSource2:"",filterSource1:{text:"",level:""},filterSource2:{text:"",level:""},source2Pagination:{rowsPerPage:20},source1Pagination:{rowsPerPage:20},loadingSource1:!1,loadingSource2:!1,totalSource1Records:0,totalSource2Records:0,source2Grid:[],source1Grid:[],source1Tree:[],source2Tree:[],source1Start:1,source2Start:1,source1Count:10,source2Count:10,loadingSource1Tree:!1,loadingSource2Tree:!1,loadingSource1Grid:!1,loadingSource2Grid:!1,currentSource2Pagination:{},currentSource1Pagination:{},source1SelNodeId:!1,source2SelNodeId:!1}},methods:{edit:function(e,t){"source1"===t?this.editSource=this.source1:"source2"===t&&(this.editSource=this.source2),this.editLocationName=e.facility,this.editLocationId=e.id,this.editDialog=!0;var r=n()(this.source2GridHeader).length,a=this.source2GridHeader[r-1].value;this.editLocationParent=e[a+"id"];var s=a.replace("level","");this.getLevelData(s)},saveEdit:function(){var e=this,t=new FormData;t.append("userID",this.$store.state.activePair.userID._id),t.append("source",this.editSource),t.append("locationId",this.editLocationId),t.append("locationName",this.editLocationName),t.append("locationParent",this.editLocationParent),l.a.post("/editLocation",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.editDialog=!1,e.getSource1Grid(!1),e.getSource2Grid(!1),e.getTree()}).catch(function(e){console.log(o()(e))})},deleteLocation:function(e,t,r){if("requestConfirmation"===r)"source1"===t?this.deleteSource=this.source1:"source2"===t&&(this.deleteSource=this.source2),this.deleteLocationData=e,this.confirmDelete=!0;else{var a=this.$store.state.activePair.userID._id;l.a.delete("/deleteLocation?id="+this.deleteLocationData.id+"&source="+this.deleteSource+"&userID="+a).then(function(e){})}},getLevelData:function(e){var t=this,r=this.$store.state.activePair.userID._id;l.a.get("/getLevelData/"+this.editSource+"/"+r+"/"+e).then(function(e){t.editParents=e.data})},getSource1Grid:function(e){var t=this;this.loadingSource1=!0,e||(e=""),this.loadingSource1Grid=!0;var r=this.$store.state.activePair.userID._id,a="/hierarchy?source="+this.source1+"&start="+this.source1Start+"&count="+this.source1Count+"&id="+e+"&userID="+r;l.a.get(""+a).then(function(e){if(t.loadingSource1Grid=!1,e.data){var r=t.source1Pagination,a=r.sortBy,s=r.descending;t.source1Pagination.sortBy&&(e.data.tree=e.data.grid.sort(function(e,t){var r=e[a],o=t[a];return s?r<o?1:r>o?-1:0:r<o?-1:r>o?1:0})),t.source1Grid=e.data.grid,t.totalSource1Records=e.data.total,t.source1Pagination.totalItems=e.data.total,t.currentSource1Pagination=z()({},t.source1Pagination),t.currentSource1Pagination.hasOwnProperty("descending")||(t.currentSource1Pagination.descending=!1),t.currentSource1Pagination.hasOwnProperty("page")||(t.currentSource1Pagination.page=1),t.currentSource1Pagination.hasOwnProperty("sortBy")||(t.currentSource1Pagination.sortBy="facility"),t.currentSource1Pagination.hasOwnProperty("totalItems")||(t.currentSource1Pagination.totalItems=e.data.total)}t.loadingSource1=!1})},getSource2Grid:function(e){var t=this;e||(e=""),this.loadingSource2=!0,this.loadingSource2Grid=!0;var r=this.$store.state.activePair.userID._id,a="/hierarchy?source="+this.source2+"&start="+this.source2Start+"&count="+this.source2Count+"&id="+e+"&userID="+r;l.a.get(""+a).then(function(e){if(t.loadingSource2Grid=!1,e.data){var r=t.source2Pagination,a=r.sortBy,s=r.descending;t.source2Pagination.sortBy&&(e.data.tree=e.data.grid.sort(function(e,t){var r=e[a],o=t[a];return s?r<o?1:r>o?-1:0:r<o?-1:r>o?1:0})),t.source2Grid=e.data.grid,t.totalSource2Records=e.data.total,t.source2Pagination.totalItems=e.data.total,t.currentSource2Pagination=z()({},t.source2Pagination),t.currentSource2Pagination.hasOwnProperty("descending")||(t.currentSource2Pagination.descending=!1),t.currentSource2Pagination.hasOwnProperty("page")||(t.currentSource2Pagination.page=1),t.currentSource2Pagination.hasOwnProperty("sortBy")||(t.currentSource2Pagination.sortBy="facility"),t.currentSource2Pagination.hasOwnProperty("totalItems")||(t.currentSource2Pagination.totalItems=e.data.total)}t.loadingSource2=!1})},getTree:function(){var e=this,t=this.$store.state.activePair.userID._id;this.loadingSource2Tree=!0,l.a.get("/getTree/"+this.source2+"/"+t).then(function(t){e.loadingSource2Tree=!1,t.data&&(e.source2Tree=t.data)}),this.loadingSource1Tree=!0,l.a.get("/getTree/"+this.source1+"/"+t).then(function(t){e.loadingSource1Tree=!1,t.data&&(e.source1Tree=t.data)})},source1NodeSelected:function(e){this.source1SelNodeId=e.id,this.getSource1Grid(e.id)},source2NodeSelected:function(e){this.source2SelNodeId=e.id,this.getSource2Grid(e.id)}},computed:{source2GridHeader:function(){var e=[];e.push({text:"",value:"",sortable:!1});var t={};if(this.source2Grid&&this.source2Grid.length>0)for(var r in this.source2Grid)t.length>0&&this.source2Grid[r].length>n()(t).length?t=this.source2Grid[r]:0===n()(t).length&&(t=this.source2Grid[r]);for(var a in t)this.headerText[a]&&e.push({text:this.headerText[a],value:a});return e},source1GridHeader:function(){var e=[];e.push({text:"",value:"",sortable:!1});var t={};if(this.source1Grid&&this.source1Grid.length>0)for(var r in this.source1Grid)t.length>0&&this.source1Grid[r].length>n()(t).length?t=this.source1Grid[r]:0===n()(t).length&&(t=this.source1Grid[r]);if(this.source1Grid&&this.source1Grid.length>0)for(var a in this.source1Grid[0])this.headerText[a]&&e.push({text:this.headerText[a],value:a});return e},source2Pages:function(){return null==this.source2Pagination.rowsPerPage||null==this.source2Pagination.totalItems?0:Math.ceil(this.source2Pagination.totalItems/this.source2Count)},source1Pages:function(){return null==this.source1Pagination.rowsPerPage||null==this.source1Pagination.totalItems?0:Math.ceil(this.source1Pagination.totalItems/this.source1Count)},source1:function(){var e=this.$store.state.activePair.source1.name;return e&&(e=this.toTitleCase(e)),e},source2:function(){var e=this.$store.state.activePair.source2.name;return e&&(e=this.toTitleCase(e)),e},editLocationNameErrors:function(){var e=[];return this.$v.editLocationName.$dirty?(!this.$v.editLocationName.required&&e.push("Facility Name is required"),e):e}},watch:{source1Pagination:{handler:function(){if(this.currentSource1Pagination.sortBy!==this.source1Pagination.sortBy||this.currentSource1Pagination.descending!==this.source1Pagination.descending||this.currentSource1Pagination.page!==this.source1Pagination.page){var e=this.source1Pagination.page-1;this.source1Start=e*this.source1Count+1,this.getSource1Grid(this.source1SelNodeId)}},deep:!0},source2Pagination:{handler:function(){if(this.currentSource2Pagination.sortBy!==this.source2Pagination.sortBy||this.currentSource2Pagination.descending!==this.source2Pagination.descending||this.currentSource2Pagination.page!==this.source2Pagination.page){var e=this.source2Pagination.page-1;this.source2Start=e*this.source2Count+1,this.getSource2Grid(this.source2SelNodeId)}},deep:!0}},mounted:function(){this.getSource1Grid(!1),this.getSource2Grid(!1),this.getTree()},components:{"liquor-tree":B.a}},W={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[e.$store.state.uploadRunning?[r("br"),r("br"),r("br"),e._v(" "),r("v-alert",{attrs:{type:"info",value:!0}},[r("b",[e._v("Wait for upload to finish ...")]),e._v(" "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)]:e._e(),e._v(" "),!e.$store.state.denyAccess&!e.$store.state.uploadRunning?[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("info")]),e._v(" About this page\n              ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[e._v("\n              This page let you view dat you have uploaded or synchronized from a remote server\n              "),r("v-list",[e._v("1. Use the tree to filter grid data")])],1)],1)],1),e._v(" "),r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(t){e.helpDialog=!0}},slot:"activator"},[r("v-icon",[e._v("help")])],1),e._v(" "),r("span",[e._v("Help")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n            Warning\n          ")])],1),e._v(" "),r("v-card-text",[e._v("\n          Are you sure that you want to delete "+e._s(e.deleteLocationData.facility)+"\n        ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.confirmDelete=!1}}},[e._v("Cancel")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){e.deleteLocation()}}},[e._v("Proceed")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}},[r("v-card",{attrs:{height:"500px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n            Edit Location\n          ")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.editDialog=!1}}},[e._v("close")])],1),e._v(" "),r("v-card-text",[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-text-field",{attrs:{"error-messages":e.editLocationNameErrors,required:"",label:"Facility"},on:{blur:function(t){e.$v.editLocationName.$touch()},change:function(t){e.$v.editLocationName.$touch()}},model:{value:e.editLocationName,callback:function(t){e.editLocationName=t},expression:"editLocationName"}})],1),e._v(" "),r("v-flex",[r("v-select",{attrs:{items:e.editParents,box:"",label:"Parent"},model:{value:e.editLocationParent,callback:function(t){e.editLocationParent=t},expression:"editLocationParent"}})],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-toolbar",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:"","text-sm-left":""}},[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.editDialog=!1}}},[r("v-icon",{attrs:{left:""}},[e._v("cancel")]),e._v(" Cancel")],1)],1),e._v(" "),r("v-flex",{attrs:{xs6:"","text-sm-right":""}},[r("v-btn",{attrs:{color:"primary",disabled:e.$v.$invalid,dark:""},on:{click:function(t){e.saveEdit()}}},[r("v-icon",{attrs:{left:""}},[e._v("save")]),e._v("Save")],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 1 Data Tree")])]),e._v(" "),e.loadingSource1Tree?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("p",[r("liquor-tree",{ref:"source1Tree",attrs:{data:e.source1Tree,options:{}},on:{"node:selected":e.source1NodeSelected}})],1)])]],2)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 2 Data Tree")])]),e._v(" "),e.loadingSource2Tree?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("p",[r("liquor-tree",{ref:"source2Tree",attrs:{data:e.source2Tree,options:{}},on:{"node:selected":e.source2NodeSelected}})],1)])]],2)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 1 Data Grid")])]),e._v(" "),e.loadingSource1Grid?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-title",[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchSource1,callback:function(t){e.searchSource1=t},expression:"searchSource1"}})],1),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source1GridHeader,items:e.source1Grid,search:e.searchSource1,pagination:e.source1Pagination,"total-items":e.totalSource1Records,loading:e.loadingSource1,"hide-actions":""},on:{"update:pagination":function(t){e.source1Pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.source1GridHeader,function(a,s){return r("td",{key:a.value+1,staticStyle:{"white-space":"nowrap",overflow:"hidden"}},[0===s?[r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){e.edit(t.item,"source1")}}},[e._v("edit")]),e._v(" | \n                      "),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){e.deleteLocation(t.item,"source1","requestConfirmation")}}},[e._v("delete")])]:[e._v("\n                      "+e._s(t.item[a.value])+"\n                    ")]],2)})}}])})],1),e._v(" "),r("div",{staticClass:"text-xs-center pt-2"},[r("v-pagination",{attrs:{length:e.source1Pages},model:{value:e.source1Pagination.page,callback:function(t){e.$set(e.source1Pagination,"page",t)},expression:"source1Pagination.page"}})],1)]],2)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 2 Data Grid")])]),e._v(" "),e.loadingSource2Grid?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-title",[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchSource2,callback:function(t){e.searchSource2=t},expression:"searchSource2"}})],1),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source2GridHeader,items:e.source2Grid,search:e.searchSource2,pagination:e.source2Pagination,"total-items":e.totalSource2Records,loading:e.loadingSource2,"hide-actions":""},on:{"update:pagination":function(t){e.source2Pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.source2GridHeader,function(a,s){return r("td",{key:a.value+2,staticStyle:{"white-space":"nowrap",overflow:"hidden"}},[0===s?[r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){e.edit(t.item,"source2")}}},[e._v("edit")]),e._v(" | \n                      "),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){e.deleteLocation(t.item,"source2","requestConfirmation")}}},[e._v("delete")])]:[e._v("\n                      "+e._s(t.item[a.value])+"\n                    ")]],2)})}}])})],1),e._v(" "),r("div",{staticClass:"text-xs-center pt-2"},[r("v-pagination",{attrs:{length:e.source2Pages},model:{value:e.source2Pagination.page,callback:function(t){e.$set(e.source2Pagination,"page",t)},expression:"source2Pagination.page"}})],1)]],2)],1)],1),e._v(" "),r("br"),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs1:"",xl10:""}},[r("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){e.$router.push({name:"FacilityReconScores"})}}},[r("v-icon",[e._v("find_in_page")]),e._v("\n          Reconcile\n        ")],1)],1)],1)]:e._e()],2)},staticRenderFns:[]};var K=r("VU/8")(j,W,!1,function(e){r("XV7c")},"data-v-2dc270e4",null).exports,X={mixins:[h,v],data:function(){return{helpDialog:!1,sort_arrow:"up",pagination:{sortBy:"score"},recoLevel:0,searchUnmatchedSource2:"",searchUnmatchedSource1:"",searchPotential:"",searchMatched:"",searchNotMatched:"",searchFlagged:"",potentialMatches:[],showAllPotential:null,alertText:"",alertTitle:"",alert:!1,source1Parents:{},source1Filter:{text:"",level:""},source1TreeUpdate:0,selectedSource1Name:null,selectedSource1Id:null,selectedSource1Lat:null,selectedSource1Long:null,selectedSource1Parents:[],dialog:!1,dialogWidth:"",source1UnmatchedHeaders:[{text:"Location",value:"name"}],noMatchHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Parents",value:"parents"}],flaggedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Source 2 Location",value:"source2Name"},{text:"Source 2 ID",value:"source2Id"}],loadingCSV:!1,loadingFHIR:!1}},filters:{removeCountry:function(e){var t=e.slice(0);return t.splice(t.length-1,1),t},joinParents:function(e){return e.join("->")}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1),this.pagination.descending?this.sort_arrow="down":this.sort_arrow="up"},addListener:function(){var e=this;!function t(){e.$refs&&e.$refs.source1Tree?e.$refs.source1Tree.$on("node:selected",function(t){e.source1Filter.text=t.data.text;for(var r=1;t.parent;)t=t.parent,r++;e.source1Filter.level=r}):setTimeout(function(){t()},500)}()},levelChanged:function(e){this.$store.state.recoLevel!==e&&(this.$store.state.recoLevel=e,this.getScores(),this.$store.state.recoLevel===this.$store.state.totalSource1Levels?this.dialogWidth="1440px":this.dialogWidth="1190px")},getPotentialMatch:function(e){var t=this;this.potentialMatches=[],this.showAllPotential=null;var r=!0,a=!1,s=void 0;try{for(var o,i=d()(this.$store.state.scoreResults);!(r=(o=i.next()).done);r=!0){var n=o.value;if(n.source1.id===e)for(var c in this.selectedSource1Name=n.source1.name,this.selectedSource1Parents=n.source1.parents,this.selectedSource1Lat=n.source1.lat,this.selectedSource1Long=n.source1.long,this.selectedSource1Id=n.source1.id,n.potentialMatches){var l=function(e){var r=n.potentialMatches[c][e];return v=t.$store.state.matchedContent.find(function(e){return e.source2Id===r.id}),h=t.$store.state.flagged.find(function(e){return e.source2Id===r.id}),v?"continue":h?"continue":void t.potentialMatches.push({score:c,name:r.name,id:r.id,lat:r.lat,long:r.long,geoDistance:r.geoDistance,parents:r.parents})};for(var u in n.potentialMatches[c]){var v,h;l(u)}}}}catch(e){a=!0,s=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw s}}this.dialog=!0},match:function(e,t,r){var a=this;if(null===t)return this.alert=!0,this.alertTitle="Information",void(this.alertText="Select Source 2 Location to match against Source 1 Location");this.$store.state.progressTitle="Saving match",this.$store.state.dynamicProgress=!0;var s=new FormData;s.append("source1Id",this.selectedSource1Id),s.append("source2Id",t),s.append("source1DB",this.getSource1()),s.append("source2DB",this.getSource2()),s.append("recoLevel",this.$store.state.recoLevel),s.append("totalLevels",this.$store.state.totalSource1Levels),s.append("userID",this.$store.state.activePair.userID._id),l.a.post("/match/"+e,s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){a.$store.state.dynamicProgress=!1;var s=null;for(var o in a.$store.state.source2UnMatched)a.$store.state.source2UnMatched[o].id===t&&(s=a.$store.state.source2UnMatched[o].parents,a.$store.state.source2UnMatched.splice(o,1));for(var i in a.$store.state.source1UnMatched)a.$store.state.source1UnMatched[i].id===a.selectedSource1Id&&("match"===e?(++a.$store.state.totalAllMapped,a.$store.state.matchedContent.push({source1Name:a.selectedSource1Name,source1Id:a.selectedSource1Id,source1Parents:a.$store.state.source1UnMatched[i].parents,source2Name:r,source2Id:t,source2Parents:s})):"flag"===e&&(++a.$store.state.totalAllFlagged,a.$store.state.flagged.push({source1Name:a.selectedSource1Name,source1Id:a.selectedSource1Id,source1Parents:a.$store.state.source1UnMatched[i].parents,source2Name:r,source2Id:t,source2Parents:s})),a.$store.state.source1UnMatched.splice(i,1));a.selectedSource1Id=null,a.selectedSource1Name=null,a.dialog=!1}).catch(function(e){a.$store.state.dynamicProgress=!1,a.alert=!0,a.alertTitle="Error",a.alertText=e.response.data.error,a.selectedSource1Id=null,a.selectedSource1Name=null,a.dialog=!1})},acceptFlag:function(e){var t=this;this.$store.state.progressTitle="Accepting flag",this.$store.state.dynamicProgress=!0;var r=new FormData;r.append("source2Id",e);var a=this.$store.state.activePair.userID._id;l.a.post("/acceptFlag/"+this.getSource1()+"/"+this.getSource2()+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){for(var r in t.$store.state.dynamicProgress=!1,t.$store.state.flagged)t.$store.state.flagged[r].source2Id===e&&(t.$store.state.matchedContent.push({source1Name:t.$store.state.flagged[r].source1Name,source1Id:t.$store.state.flagged[r].source1Id,source1Parents:t.$store.state.flagged[r].source1Parents,source2Name:t.$store.state.flagged[r].source2Name,source2Id:t.$store.state.flagged[r].source2Id,source2Parents:t.$store.state.flagged[r].source2Parents}),t.$store.state.flagged.splice(r,1),++t.$store.state.totalAllMapped,--t.$store.state.totalAllFlagged)}).catch(function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)})},breakMatch:function(e){var t=this;this.$store.state.progressTitle="Breaking match",this.$store.state.dynamicProgress=!0;var r=new FormData,a=this.$store.state.activePair.userID._id;r.append("source2Id",e),l.a.post("/breakMatch/"+this.getSource1()+"/"+this.getSource2()+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(r){for(var a in t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Information",t.alertText="Scores for this Location may not be available unless you recalculate scores",t.$store.state.matchedContent)t.$store.state.matchedContent[a].source2Id===e&&(t.$store.state.source1UnMatched.push({name:t.$store.state.matchedContent[a].source1Name,id:t.$store.state.matchedContent[a].source1Id,parents:t.$store.state.matchedContent[a].source1Parents}),t.$store.state.source2UnMatched.push({name:t.$store.state.matchedContent[a].source2Name,id:t.$store.state.matchedContent[a].source2Id,parents:t.$store.state.matchedContent[a].source2Parents}),t.$store.state.matchedContent.splice(a,1),--t.$store.state.totalAllMapped)}).catch(function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)})},unFlag:function(e){var t=this;this.$store.state.progressTitle="Unflagging match",this.$store.state.dynamicProgress=!0;var r=new FormData,a=this.$store.state.activePair.userID._id;r.append("source2Id",e),l.a.post("/breakMatch/"+this.getSource1()+"/"+this.getSource2()+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(r){for(var a in t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Information",t.alertText="Scores for this Location may not be available unless you recalculate scores",t.$store.state.flagged)t.$store.state.flagged[a].source2Id===e&&(t.$store.state.source1UnMatched.push({name:t.$store.state.flagged[a].source1Name,id:t.$store.state.flagged[a].source1Id,parents:t.$store.state.flagged[a].source1Parents}),t.$store.state.source2UnMatched.push({name:t.$store.state.flagged[a].source2Name,id:t.$store.state.flagged[a].source2Id,parents:t.$store.state.flagged[a].source2Parents}),t.$store.state.flagged.splice(a,1),--t.$store.state.totalAllFlagged)}).catch(function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)})},breakNoMatch:function(e){var t=this;this.$store.state.progressTitle="Breaking no match",this.$store.state.dynamicProgress=!0;var r=new FormData;r.append("source1Id",e),r.append("recoLevel",this.$store.state.recoLevel),r.append("totalLevels",this.$store.state.totalSource1Levels);var a=this.$store.state.activePair.userID._id;l.a.post("/breakNoMatch/"+this.getSource1()+"/"+this.getSource2()+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(r){for(var a in t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Information",t.alertText="Scores for this Location may not be available unless you recalculate scores",t.$store.state.noMatchContent)t.$store.state.noMatchContent[a].source1Id===e&&(t.$store.state.source1UnMatched.push({name:t.$store.state.noMatchContent[a].source1Name,id:t.$store.state.noMatchContent[a].source1Id,parents:t.$store.state.noMatchContent[a].parents}),t.$store.state.noMatchContent.splice(a,1),--t.$store.state.totalAllNoMatch)}).catch(function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)})},noMatch:function(){var e=this;this.$store.state.progressTitle="Saving as no match",this.$store.state.dynamicProgress=!0;var t=this.$store.state.activePair.userID._id,r=new FormData;r.append("source1Id",this.selectedSource1Id),r.append("recoLevel",this.$store.state.recoLevel),r.append("totalLevels",this.$store.state.totalSource1Levels),l.a.post("/noMatch/"+this.getSource1()+"/"+this.getSource2()+"/"+t,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){for(var t in e.$store.state.dynamicProgress=!1,e.$store.state.source1UnMatched)e.$store.state.source1UnMatched[t].id===e.selectedSource1Id&&(e.$store.state.noMatchContent.push({source1Name:e.selectedSource1Name,source1Id:e.selectedSource1Id,parents:e.$store.state.source1UnMatched[t].parents}),++e.$store.state.totalAllNoMatch,e.$store.state.source1UnMatched.splice(t,1));e.dialog=!1,e.selectedSource1Id=null,e.selectedSource1Name=null}).catch(function(t){e.$store.state.dynamicProgress=!1,e.alert=!0,e.alertTitle="Error",e.alertText=t.response.data.error,e.dialog=!1,e.selectedSource1Id=null,e.selectedSource1Name=null})},back:function(){this.searchPotential="",this.dialog=!1},matchedLocations:function(e){var t=this.$store.state.activePair.userID._id,r=o()(this.$store.state.levelMapping.source1),a=o()(this.$store.state.levelMapping.source2);return l.a.get("/matchedLocations/"+this.getSource1()+"/"+this.getSource2()+"/"+e+"/"+t,{params:{levelMapping1:r,levelMapping2:a}})},unMatchedLocations:function(e){var t=this.$store.state.activePair.userID._id,r=this.$store.state.levelMapping.source1,a=this.$store.state.levelMapping.source2;return l.a.get("/unmatchedLocations/"+this.getSource1()+"/"+this.getSource2()+"/"+e+"/"+t,{params:{levelMapping1:r,levelMapping2:a}})},csvExport:function(){this.loadingCSV=!0;var e=this;l.a.all([this.matchedLocations("CSV"),this.unMatchedLocations("CSV")]).then(l.a.spread(function(t,r){e.loadingCSV=!1;var a=encodeURI("data:text/csv;charset=utf-8,"+t.data),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","matched"+e.getSource1()+e.getSource2()+".csv"),s.click();var o=encodeURI("data:text/csv;charset=utf-8,"+r.data.unmatchedSource1CSV);s.setAttribute("href",o),s.setAttribute("download","unmatched"+e.getSource1()+".csv"),s.click();var i=encodeURI("data:text/csv;charset=utf-8,"+r.data.unmatchedSource2CSV);s.setAttribute("href",i),s.setAttribute("download","unmatched"+e.getSource2()+".csv"),s.click()}))},fhirExport:function(){this.loadingFHIR=!0;var e=this;l.a.all([this.matchedLocations("FHIR"),this.unMatchedLocations("FHIR")]).then(l.a.spread(function(t,r){e.loadingFHIR=!1;var a=encodeURI("data:text/json;charset=utf-8,"+o()(t.data)),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","matched"+e.getSource1()+e.getSource2()+".json"),s.click();var i=encodeURI("data:text/json;charset=utf-8,"+o()(r.data.unmatchedSource1mCSD));s.setAttribute("href",i),s.setAttribute("download","unmatched"+e.getSource1()+".json"),s.click();var n=encodeURI("data:text/json;charset=utf-8,"+o()(r.data.unmatchedSource2mCSD));s.setAttribute("href",n),s.setAttribute("download","unmatched"+e.getSource2()+".json"),s.click()}))}},computed:{nextLevelText:function(){return this.translateDataHeader("source1",this.$store.state.recoLevel)},currentLevelText:function(){return this.translateDataHeader("source1",this.$store.state.recoLevel-1)},matchedHeaders:function(){return[{text:"Source1 Location",value:"source1Name"},{text:"Source1 ID",value:"source1Id"},{text:"Source2 Location",value:"source2Name"},{text:"Source2 ID",value:"source2Id"}]},source1GridHeaders:function(){var e=[{text:"Location",value:"name"}];if(this.$store.state.source1UnMatched.length>0)for(var t=this.$store.state.source1UnMatched[0].parents.length;t>0;t--)e.push({text:"Level "+t,value:"level"+(t+1)});return e.splice(1,1),e},potentialHeaders:function(){var e=[];return e.push({sortable:!1},{text:"Source 2 Location",value:"name",sortable:!1},{text:"ID",value:"id",sortable:!1},{text:"Parent",value:"source2Parent",sortable:!1}),this.$store.state.recoLevel===this.$store.state.totalSource1Levels&&e.push({text:"Geo Dist (Miles)",value:"geodist",sortable:!1}),e.push({text:"Score",value:"score"}),e},potentialAvailable:function(){return null!==this.$store.state.source2UnMatched&&this.$store.state.source2UnMatched.length>this.potentialMatches.length},allPotentialMatches:function(){var e=this;if(null!==this.$store.state.source2UnMatched&&this.$store.state.source2UnMatched.length>this.potentialMatches.length&&"all"===this.showAllPotential){var t=[],r=function(r){e.potentialMatches.find(function(e){return e.id===r.id})||(r.score="N/A",t.push(r))},a=!0,s=!1,o=void 0;try{for(var i,n=d()(this.$store.state.source2UnMatched);!(a=(i=n.next()).done);a=!0){r(i.value)}}catch(e){s=!0,o=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw o}}return this.potentialMatches.concat(t)}return this.potentialMatches},source1Tree:function(){this.addListener();var e=[];return 1===n()(this.$store.state.source1Parents).length&&"null"===n()(this.$store.state.source1Parents)[0]?e:(function e(t,r){for(var a in t){var s={text:a,children:[]};e(t[a],s.children),0===s.children.length&&delete s.children,r.push(s)}}(this.$store.state.source1Parents,e),this.source1TreeUpdate++,e)},source1Grid:function(){var e=this;if(this.$store.state.source1UnMatched.length>0&&""!==this.source1Filter.level){var t=this.$store.state.source1UnMatched[0].parents.length-this.source1Filter.level;return this.$store.state.source1UnMatched.filter(function(r){return r.parents[t]===e.source1Filter.text})}return this.$store.state.source1UnMatched},goNextLevel:function(){return this.$store.state.recoLevel<this.$store.state.totalSource1Levels&&null!==this.$store.state.source1UnMatched&&0===this.$store.state.source1UnMatched.length&&null!==this.$store.state.flagged&&0===this.$store.state.flagged.length&&null!==this.$store.state.matchedContent&&0!==this.$store.state.matchedContent.length?"yes":"no"},lastLevelDone:function(){return this.$store.state.recoLevel===this.$store.state.totalSource1Levels&&null!==this.$store.state.source1UnMatched&&0===this.$store.state.source1UnMatched.length&&null!==this.$store.state.flagged&&0===this.$store.state.flagged.length?"yes":"no"},source1TotalRecords:function(){return this.$store.state.scoreResults?this.$store.state.scoreResults.length:0},source1TotalMatched:function(){return this.$store.state.matchedContent?this.$store.state.matchedContent.length:0},source1PercentMatched:function(){return 0===this.source1TotalRecords?0:parseFloat((100*this.source1TotalMatched/this.source1TotalRecords).toFixed(1))},source1TotalUnMatched:function(){return this.source1TotalRecords-this.source1TotalMatched},source1PercentUnMatched:function(){return 0===this.source1TotalRecords?0:parseFloat((100*this.source1TotalUnMatched/this.source1TotalRecords).toFixed(1))},totalFlagged:function(){return this.$store.state.flagged?this.$store.state.flagged.length:0},source1PercentFlagged:function(){return 0===this.$store.state.scoreResults.length?0:this.$store.state.flagged?parseFloat((100*this.$store.state.flagged.length/this.$store.state.scoreResults.length).toFixed(1)):0},source1TotalNoMatch:function(){return this.$store.state.noMatchContent?this.$store.state.noMatchContent.length:0},source1PercentNoMatch:function(){return 0===this.$store.state.scoreResults.length?0:this.$store.state.noMatchContent?parseFloat((100*this.$store.state.noMatchContent.length/this.$store.state.scoreResults.length).toFixed(1)):0},source2TotalRecords:function(){return this.$store.state.source2TotalRecords?this.$store.state.source2TotalRecords:0},source2TotalUnmatched:function(){return this.source2TotalRecords>0&&this.$store.state.matchedContent?parseInt(this.source2TotalRecords)-parseInt(this.$store.state.matchedContent.length):0},source2PercentUnmatched:function(){return 0===this.$store.state.source2TotalRecords?0:parseFloat((100*this.source2TotalUnmatched/this.$store.state.source2TotalRecords).toFixed(1))},source2PercentFlagged:function(){return 0===this.$store.state.source2TotalRecords?0:this.$store.state.flagged?parseFloat((100*this.$store.state.flagged.length/this.$store.state.source2TotalRecords).toFixed(1)):0},source2TotalMatched:function(){return this.source1TotalMatched},source2PercentMatched:function(){return 0===this.$store.state.source2TotalRecords?0:parseFloat((100*this.source2TotalMatched/this.$store.state.source2TotalRecords).toFixed(1))},source2NotInSource1:function(){var e=this.source2TotalRecords-this.source1TotalRecords;return e<0?0:e},source2PercentNotInSource1:function(){if(0===this.source2NotInSource1)return 0;var e=parseFloat((100*this.source2NotInSource1/this.source2TotalRecords).toFixed(1));return parseFloat(e)}},created:function(){this.addListener(),this.$store.state.recoLevel===this.$store.state.totalSource1Levels?this.dialogWidth="auto":this.dialogWidth="1190px"},components:{"liquor-tree":B.a}},Y={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[e.$store.state.uploadRunning?[r("br"),r("br"),r("br"),e._v(" "),r("v-alert",{attrs:{type:"info",value:!0}},[r("b",[e._v("Wait for upload to finish ...")]),e._v(" "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)]:e._e(),e._v(" "),!e.$store.state.denyAccess&!e.$store.state.uploadRunning?r("v-container",{attrs:{fluid:"","grid-list-lg":""}},[r("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"350"},model:{value:e.scoreDialog,callback:function(t){e.scoreDialog=t},expression:"scoreDialog"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.scoreProgressTitle))]),r("br"),e._v(" "),"percent"==e.progressType?r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.scoreProgressPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.scoreProgressPercent)+"%")])])])],1):e._e(),e._v(" "),"indeterminate"==e.progressType?r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"red"}}):e._e()],1)],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",width:"500px"},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n            "+e._s(e.alertTitle)+"\n          ")])],1),e._v(" "),r("v-card-text",[e._v("\n          "+e._s(e.alertText)+"\n        ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"success"},on:{click:function(t){e.alert=!1}}},[e._v("OK")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition",width:e.dialogWidth},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",{attrs:{width:e.dialogWidth}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n            Matching "+e._s(e.selectedSource1Name)+"\n          ")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":"",color:"yellow"},model:{value:e.searchPotential,callback:function(t){e.searchPotential=t},expression:"searchPotential"}}),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.back(t)}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-title",[e._v("\n          Parents:\n          "),r("b",[e._v(e._s(e.selectedSource1Parents.join("->")))]),e._v(" "),r("v-spacer"),e._v(" "),e.$store.state.recoLevel==e.$store.state.totalSource1Levels?[e._v("\n            Latitude:\n            "),r("b",[e._v(e._s(e.selectedSource1Lat))]),e._v(" "),r("v-spacer"),e._v("\n            Longitude:\n            "),r("b",[e._v(e._s(e.selectedSource1Long))]),e._v(" "),r("v-spacer")]:e._e()],2),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.potentialHeaders,items:e.allPotentialMatches,search:e.searchPotential,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"headers",fn:function(t){return[r("tr",[e._l(e.potentialHeaders,function(t){return["Score"==t.text?r("th",{key:t.text,staticClass:"column sortable active",attrs:{align:"left"},on:{click:function(r){e.changeSort(t.value)}}},["up"==e.sort_arrow?r("v-icon",{attrs:{small:""}},[e._v("arrow_upward")]):r("v-icon",{attrs:{small:""}},[e._v("arrow_downward")]),e._v("\n                    "+e._s(t.text)+"\n                    "),r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[r("v-icon",[e._v("help")])],1),e._v(" "),r("span",[e._v("The lower the score, the better the match")])],1)],1):r("th",{key:t.text,attrs:{align:"left"}},[e._v("\n                    "+e._s(t.text)+"\n                  ")])]})],2)]}},{key:"items",fn:function(t){return[r("tr",[r("td",[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",color:"error",small:""},nativeOn:{click:function(r){e.match("flag",t.item.id,t.item.name)}},slot:"activator"},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("notification_important")]),e._v("Flag\n                    ")],1),e._v(" "),r("span",[e._v("Mark the selected item as a match to be reviewed")])],1),e._v(" "),r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",color:"primary",small:"",dark:""},nativeOn:{click:function(r){e.match("match",t.item.id,t.item.name)}},slot:"activator"},[r("v-icon",{attrs:{left:""}},[e._v("thumb_up")]),e._v("Save Match\n                    ")],1),e._v(" "),r("span",[e._v("Save the selected item as a match")])],1)],1),e._v(" "),r("td",[e._v(e._s(t.item.name))]),e._v(" "),r("td",[e._v(e._s(t.item.id))]),e._v(" "),r("td",[e._v(e._s(t.item.parents.join("->")))]),e._v(" "),e.$store.state.recoLevel==e.$store.state.totalSource1Levels?r("td",[e._v(e._s(t.item.geoDistance))]):e._e(),e._v(" "),r("td",[e._v(e._s(t.item.score))])])]}}])})],1),e._v(" "),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs4:"","text-sm-left":""}},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",color:"green",small:"",dark:""},nativeOn:{click:function(t){return e.noMatch(t)}},slot:"activator"},[r("v-icon",{attrs:{left:""}},[e._v("thumb_down")]),e._v("No Match\n                ")],1),e._v(" "),r("span",[e._v("Save this Source 1 location as having no match")])],1)],1),e._v(" "),r("v-flex",{attrs:{xs4:"","text-xs-center":""}},[r("v-tooltip",{attrs:{top:""}},[e.potentialAvailable?r("v-btn-toggle",{attrs:{slot:"activator"},slot:"activator",model:{value:e.showAllPotential,callback:function(t){e.showAllPotential=t},expression:"showAllPotential"}},[r("v-btn",{staticStyle:{color:"white"},attrs:{color:"teal darken-2",value:"all"}},["all"===e.showAllPotential?[e._v("Show Scored Suggestions")]:[e._v("Show All Suggestions")]],2)],1):e._e(),e._v(" "),"all"===e.showAllPotential?r("span",[e._v("Limit to only scored suggestions")]):r("span",[e._v("See all possible choices ignoring the score")])],1)],1),e._v(" "),r("v-flex",{attrs:{xs4:"","text-sm-right":""}},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{staticStyle:{color:"white"},attrs:{slot:"activator",color:"orange darken-2"},nativeOn:{click:function(t){return e.back(t)}},slot:"activator"},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("arrow_back")]),e._v("Back\n                ")],1),e._v(" "),r("span",[e._v("Return without saving")])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-btn",{attrs:{color:"success",round:""},on:{click:e.csvExport}},[r("v-icon",{attrs:{left:""}},[e._v("file_copy")]),e._v(" "),e.loadingCSV?r("v-progress-circular",{attrs:{indeterminate:"",color:"red"}}):e._e(),e._v("\n        CSV Export\n      ")],1),e._v(" "),r("v-btn",{attrs:{color:"success",round:""},on:{click:e.fhirExport}},[r("v-icon",{attrs:{left:""}},[e._v("file_copy")]),e._v(" "),e.loadingFHIR?r("v-progress-circular",{attrs:{indeterminate:"",color:"red"}}):e._e(),e._v("\n        FHIR Export\n      ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("b",[e._v("Reconciling "+e._s(e.currentLevelText))]),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs1:"",sm2:"",md2:"",right:""}},[r("v-select",{staticClass:"input-group--focused",attrs:{items:e.$store.state.levelArray,"item-value":e.$store.state.levelArray.value,"item-name":e.$store.state.levelArray.text,label:"Level",height:"1","single-line":""},on:{change:e.levelChanged},model:{value:e.$store.state.recoLevel,callback:function(t){e.$set(e.$store.state,"recoLevel",t)},expression:"$store.state.recoLevel"}})],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{slot:"activator",color:"primary",dark:"",round:""},on:{click:e.getScores},slot:"activator"},[r("v-icon",[e._v("repeat_one")]),e._v(" Recalculate Scores")],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(t){e.helpDialog=!0}},slot:"activator"},[r("v-icon",[e._v("help")])],1),e._v(" "),r("span",[e._v("Help")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("info")]),e._v(" About this page\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[e._v("\n          This page let you map source 1 data with those in source2\n          "),r("v-list",[e._v("\n            1. Source 1 refer to the data source name selected as source 1 under data source pair section\n          ")]),e._v(" "),r("v-list",[e._v("\n            2. Source 2 refer to the data source name selected as source 2 under data source pair section\n          ")]),e._v(" "),r("v-list",[e._v("\n            3. After breaking a match, you will need to recalculate scores for the app to load potential matches of the broken location\n          ")]),e._v(" "),r("v-list",[e._v("\n            4. FLAGGED Locations are the locations that will need to be reviewed before they are saved as matches\n          ")]),e._v(" "),r("v-list",[e._v("\n            5. NO MATCHES - these are locations that do not matches anything from source 2\n          ")])],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs2:"",right:""}},[r("div",{staticStyle:{"border-style":"solid","border-color":"green","text-align":"center"}},[r("b",[e._v("Source 1 Reconciliation Status")]),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("b",[e._v("Matched")])]),e._v(" "),r("v-flex",{attrs:{"align-center":""}},[r("center",[r("b",[e._v(e._s(e.source1TotalMatched)+"/"+e._s(e.source1TotalRecords))])])],1),e._v(" "),r("v-flex",[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentMatched,color:"green"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentMatched)+"%")])])],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Unmatched")])]),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source1TotalUnMatched)+"/"+e._s(e.source1TotalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentUnMatched,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentUnMatched)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Flagged")])]),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.totalFlagged)+"/"+e._s(e.source1TotalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentFlagged,color:"orange"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentFlagged)+"%")])])],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("No Match")])]),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source1TotalNoMatch)+"/"+e._s(e.source1TotalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentNoMatch,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentNoMatch)+"%")])])],1)],1)],1)],1)],1)],1)],1)]),e._v(" "),r("v-flex",{attrs:{xs4:"","child-flex":""}},[r("v-card",{attrs:{color:"green lighten-2"}},[r("v-card-title",{attrs:{"primary-title":""}},[e._v("\n            Source 1 Unmatched\n            "),r("v-spacer"),e._v(" "),r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUnmatchedSource1,callback:function(t){e.searchUnmatchedSource1=t},expression:"searchUnmatchedSource1"}})],1),e._v(" "),e.loadingSource1Unmatched?[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]:[r("liquor-tree",{key:e.source1TreeUpdate,ref:"source1Tree",attrs:{data:e.source1Tree}}),e._v(" "),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source1GridHeaders,items:e.source1Grid,search:e.searchUnmatchedSource1,light:""},scopedSlots:e._u([{key:"items",fn:function(t){return["Done"===e.$store.state.recoStatus?r("td",{key:t.item.id},[e._v(e._s(t.item.name))]):r("td",{key:t.item.id,staticStyle:{cursor:"pointer"},on:{click:function(r){e.getPotentialMatch(t.item.id)}}},[e._v(e._s(t.item.name))]),e._v(" "),e._l(t.item.parents,function(a,s){return s!=t.item.parents.length-1?r("td",{key:t.item.id+s},[e._v("\n                  "+e._s(a)+"\n                ")]):e._e()})]}}])})]],2)],1),e._v(" "),r("v-flex",{attrs:{xs4:""}},[r("v-card",{attrs:{color:"blue lighten-2",dark:""}},[r("v-card-title",{attrs:{"primary-title":""}},[e._v("\n            Source 2 Unmatched\n            "),r("v-spacer"),e._v(" "),r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUnmatchedSource2,callback:function(t){e.searchUnmatchedSource2=t},expression:"searchUnmatchedSource2"}})],1),e._v(" "),e.loadingSource2Unmatched?[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]:[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source1UnmatchedHeaders,items:e.$store.state.source2UnMatched,search:e.searchUnmatchedSource2,light:""},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.name)+" "),r("br"),e._v("  "+e._s(e._f("joinParents")(e._f("removeCountry")(t.item.parents))))])]}}])})]],2)],1),e._v(" "),r("v-flex",{attrs:{xs2:"",right:""}},[r("div",{staticStyle:{"border-style":"solid","border-color":"green","text-align":"center"}},[r("b",[e._v("Source 2 Reconciliation Status")]),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Matched")])]),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source2TotalMatched)+"/"+e._s(e.source2TotalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentMatched,color:"green"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentMatched)+"%")])])],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Unmatched")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.source2TotalUnmatched)+"/"+e._s(e.source2TotalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentUnmatched,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentUnmatched)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Flagged")])]),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.totalFlagged)+"/"+e._s(e.source2TotalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentFlagged,color:"orange"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentFlagged)+"%")])])],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Not in Source 1")])]),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source2NotInSource1))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentNotInSource1,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentNotInSource1)+"%")])])],1)],1)],1)],1)],1)],1)],1)])],1),e._v(" "),r("v-layout",{attrs:{column:"",wrap:""}},[r("v-tabs",{attrs:{"icons-and-text":"",centered:"",grow:"",dark:"",color:"cyan"}},[r("v-tabs-slider",{attrs:{color:"red"}}),e._v(" "),r("v-tab",{key:"match"},[e._v("\n          MATCHED ("+e._s(e.source1TotalMatched)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("thumb_up")])],1),e._v(" "),r("v-tab",{key:"nomatch"},[e._v("\n          NO MATCH ("+e._s(e.source1TotalNoMatch)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("thumb_down")])],1),e._v(" "),r("v-tab",{key:"flagged"},[e._v("\n          FLAGGED ("+e._s(e.totalFlagged)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("notification_important")])],1),e._v(" "),r("v-tab-item",{key:"match"},[null!=e.$store.state.matchedContent?[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchMatched,callback:function(t){e.searchMatched=t},expression:"searchMatched"}}),e._v(" "),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.matchedHeaders,items:e.$store.state.matchedContent,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Id))]),e._v(" "),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(r){e.breakMatch(t.item.source2Id)}}},[r("v-icon",[e._v("undo")]),e._v("Break Match")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(r){e.breakMatch(t.item.source2Id)}}},[r("v-icon",[e._v("undo")]),e._v("Break Match")],1)],1)]}}])})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2),e._v(" "),r("v-tab-item",{key:"nomatch"},[null!=e.$store.state.noMatchContent?[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchNotMatched,callback:function(t){e.searchNotMatched=t},expression:"searchNotMatched"}}),e._v(" "),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.noMatchHeaders,items:e.$store.state.noMatchContent,search:e.searchNotMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))]),e._v(" "),r("td",[e._v(e._s(t.item.parents.join("->")))]),e._v(" "),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(r){e.breakNoMatch(t.item.source1Id)}}},[r("v-icon",[e._v("cached")]),e._v("Break No Match\n                  ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(r){e.breakNoMatch(t.item.source1Id)}}},[r("v-icon",[e._v("cached")]),e._v("Break No Match\n                  ")],1)],1)]}}])})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2),e._v(" "),r("v-tab-item",{key:"flagged"},[null!=e.$store.state.flagged?[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchFlagged,callback:function(t){e.searchFlagged=t},expression:"searchFlagged"}}),e._v(" "),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.flaggedHeaders,items:e.$store.state.flagged,search:e.searchFlagged},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Id))]),e._v(" "),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"primary",small:""},on:{click:function(r){e.acceptFlag(t.item.source2Id)}}},[r("v-icon",[e._v("thumb_up")]),e._v("Confirm Match\n                  ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"primary",small:""},on:{click:function(r){e.acceptFlag(t.item.source2Id)}}},[r("v-icon",[e._v("thumb_up")]),e._v("Confirm Match\n                  ")],1),e._v(" "),"Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(r){e.unFlag(t.item.source2Id)}}},[r("v-icon",[e._v("cached")]),e._v("Release\n                  ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(r){e.unFlag(t.item.source2Id)}}},[r("v-icon",[e._v("cached")]),e._v("Release\n                  ")],1)],1)]}}])})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2)],1)],1),e._v(" "),r("v-layout",["yes"==e.goNextLevel?r("v-flex",{attrs:{xs1:"",sm4:"",md2:""}},[r("v-btn",{attrs:{color:"primary",round:""},on:{click:function(t){e.levelChanged(e.$store.state.recoLevel+1)}}},[r("v-icon",[e._v("forward")]),e._v("Proceed to "+e._s(e.nextLevelText))],1)],1):e._e(),e._v(" "),"yes"==e.lastLevelDone?r("v-flex",{attrs:{xs1:"",sm4:"",md2:""}},[r("v-btn",{attrs:{color:"primary",round:""},on:{click:function(t){e.$router.push({name:"FacilityRecoStatus"})}}},[r("v-icon",[e._v("dashboard")]),e._v("Reconciliation Status")],1)],1):e._e()],1)],1):e._e()],2)},staticRenderFns:[]};var Z=r("VU/8")(X,Y,!1,function(e){r("cLBk")},null,null).exports,J={mixins:[h],data:function(){return{helpDialog:!1,matchedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Source 2 Location",value:"source2Name"},{text:"Source 2 ID",value:"source2Id"}],noMatchHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"}],notMappedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"}],flaggedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Source 2 Location",value:"source2Name"},{text:"Source 2 ID",value:"source2Id"}],searchMatched:"",mappingData:{},recoLevel:2,mappingStatusDialog:!1,mappingStatusProgressTitle:"Waiting for progress status",mappingStatusProgressPercent:0,locationLevels:[]}},methods:{checkMappingStatusProgress:function(){var e=this,t=this.$store.state.clientId;l.a.get("/mappingStatusProgress/"+t).then(function(t){null!==t.data&&void 0!==t.data&&!1!==t.data?(e.mappingStatusProgressTitle=t.data.status,t.data.percent&&("percent"!==e.progressType&&(e.progressType="percent"),e.mappingStatusProgressPercent=t.data.percent),"Done"===t.data.status&&(clearInterval(e.mappingStatusProgressTimer),e.mappingStatusDialog=!1,e.mappingStatusProgressTitle="Waiting for progress status")):clearInterval(e.mappingStatusProgressTimer)}).catch(function(e){console.log(e)})},mappingStatus:function(){var e=this;if(this.source1&&this.source2){this.mappingData={};var t=this.$store.state.clientId,r=this.$store.state.totalSource2Levels,a=this.$store.state.totalSource1Levels,s=this.$store.state.activePair.userID._id;this.mappingStatusDialog=!0,this.progressType="indeterminate",l.a.get("/mappingStatus/"+this.source1+"/"+this.source2+"/"+this.recoLevel+"/"+r+"/"+a+"/"+t+"/"+s).then(function(t){e.mappingData=t.data}),this.mappingStatusProgressTimer=setInterval(this.checkMappingStatusProgress,500)}},levelChanged:function(e){this.recoLevel=e,this.mappingStatus()},markRecoDone:function(){var e=this,t=this.$store.state.activePair.userID._id;l.a.get("/markRecoDone/"+this.source1+"/"+this.source2+"/"+t).then(function(t){t.data.status&&(e.$store.state.recoStatus=t.data.status)}).catch(function(e){console.log(e.response.data.error)})},markRecoUnDone:function(){var e=this,t=this.$store.state.activePair.userID._id;l.a.get("/markRecoUnDone/"+this.source1+"/"+this.source2+"/"+t).then(function(t){t.data.status&&(e.$store.state.recoStatus=t.data.status)}).catch(function(e){console.log(e.response.data.error)})}},computed:{currentLevelText:function(){return this.translateDataHeader("source1",this.$store.state.recoLevel-1)},source1:function(){var e=this.$store.state.activePair.source1.name;return e&&(e=this.toTitleCase(e)),e},source2:function(){var e=this.$store.state.activePair.source2.name;return e&&(e=this.toTitleCase(e)),e},source1PercentMapped:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllMapped/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentMappedLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalMapped/this.totalRecords).toFixed(2))},source1PercentNoMatch:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllNoMatch/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentNoMatchLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalNoMatch/this.totalRecords).toFixed(2))},source1PercentFlagged:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllFlagged/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentFlaggedLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalFlagged/this.totalRecords).toFixed(2))},source1PercentNotMapped:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.source1TotalAllNotMapped/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentNotMappedLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalNotMapped/this.totalRecords).toFixed(2))},source2PercentFlagged:function(){return 0===this.$store.state.source2TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllFlagged/this.$store.state.source2TotalAllRecords).toFixed(2))},source2PercentMapped:function(){return 0===this.$store.state.source2TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllMapped/this.$store.state.source2TotalAllRecords).toFixed(2))},totalMapped:function(){return this.mappingData&&this.mappingData.hasOwnProperty("mapped")?this.mappingData.mapped.length:0},totalNotMapped:function(){return this.mappingData&&this.mappingData.hasOwnProperty("notMapped")?this.mappingData.notMapped.length:0},totalNoMatch:function(){return this.mappingData&&this.mappingData.hasOwnProperty("noMatch")?this.mappingData.noMatch.length:0},totalFlagged:function(){return this.mappingData&&this.mappingData.hasOwnProperty("flagged")?this.mappingData.flagged.length:0},totalRecords:function(){return this.totalMapped+this.totalNotMapped+this.totalNoMatch+this.totalFlagged}},created:function(){this.mappingStatus();for(var e=1;e<this.$store.state.totalSource1Levels;e++){var t=this.translateDataHeader("source1",e);this.locationLevels.push({text:t,value:e+1})}}},Q={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{transition:"scale-transition","hide-overlay":"",persistent:"",width:"350"},model:{value:e.mappingStatusDialog,callback:function(t){e.mappingStatusDialog=t},expression:"mappingStatusDialog"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.mappingStatusProgressTitle))]),r("br"),e._v(" "),"percent"==e.progressType?r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.mappingStatusProgressPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.mappingStatusProgressPercent)+"%")])])])],1):e._e(),e._v(" "),"indeterminate"==e.progressType?r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"red"}}):e._e()],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{column:""}},[r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("info")]),e._v(" About this page\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[e._v("\n          This page let you visualize the mapping status for various levels\n          "),r("v-list",[e._v("\n            1. Right boxes shows reconciliation status for a selected level\n          ")]),e._v(" "),r("v-list",[e._v("\n            2. Left boxes shows reconciliation status for a all levels\n          ")]),e._v(" "),r("v-list",[e._v("\n            3. The search box let you search locations for a selected level only\n          ")])],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(t){e.helpDialog=!0}},slot:"activator"},[r("v-icon",[e._v("help")])],1),e._v(" "),r("span",[e._v("Help")])],1)],1)],1),e._v(" "),r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("b",[e._v("All Levels")])]),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs3:""}},[r("b",[e._v(e._s(e.currentLevelText)+" Only")])])],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Matched")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllMapped)+"/"+e._s(e.$store.state.source1TotalAllRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentMapped,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source1PercentMapped)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 No Match")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllNoMatch)+"/"+e._s(e.$store.state.source1TotalAllRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentNoMatch,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source1PercentNoMatch)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Flagged")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllFlagged)+"/"+e._s(e.$store.state.source1TotalAllRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentFlagged,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source1PercentFlagged)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 2 Matched")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllMapped)+"/"+e._s(e.$store.state.source2TotalAllRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentMapped,color:"green"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source2PercentMapped)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 2 Flagged")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllFlagged)+"/"+e._s(e.$store.state.source2TotalAllRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentFlagged,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source2PercentFlagged)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"cyan","text-color":"black"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Matched")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.totalMapped)+"/"+e._s(e.totalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentMappedLevel,color:"yellow"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentMappedLevel)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"cyan","text-color":"black"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 No Match")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.totalNoMatch)+"/"+e._s(e.totalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentNoMatchLevel,color:"yellow"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentNoMatchLevel)+"%")])])],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"cyan","text-color":"black"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Flagged")])]),e._v(" "),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.totalFlagged)+"/"+e._s(e.totalRecords))])])],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentFlagged,color:"yellow"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentFlagged)+"%")])])],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}},[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchMatched,callback:function(t){e.searchMatched=t},expression:"searchMatched"}})],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs2:""}},[this.$store.state.activePair.userID._id===this.$store.state.auth.userID?["Done"!==e.$store.state.recoStatus?r("v-btn",{attrs:{color:"success",round:""},on:{click:e.markRecoDone}},[r("v-icon",[e._v("lock")]),e._v("Mark Reconciliation Done")],1):r("v-btn",{attrs:{color:"success",round:""},on:{click:e.markRecoUnDone}},[r("v-icon",[e._v("lock_open")]),e._v("Mark Reconciliation UnDone")],1)]:e._e()],2),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs1:"",sm2:"",md2:"",right:""}},[r("v-select",{staticClass:"input-group--focused",attrs:{items:e.locationLevels,"item-value":e.locationLevels.value,"item-name":e.locationLevels.text,label:"Level",height:"1","full-width":"","single-line":""},on:{change:e.levelChanged},model:{value:e.recoLevel,callback:function(t){e.recoLevel=t},expression:"recoLevel"}})],1)],1)],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-tabs",{attrs:{"icons-and-text":"",centered:"",grow:"",dark:"",color:"cyan"}},[r("v-tabs-slider",{attrs:{color:"red"}}),e._v(" "),r("v-tab",{key:"match"},[e._v("\n          MATCHED ("+e._s(e.totalMapped)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("thumb_up")])],1),e._v(" "),r("v-tab",{key:"notMapped"},[e._v("\n          Source 1 Not Mapped ("+e._s(e.totalNotMapped)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("thumb_down")])],1),e._v(" "),r("v-tab",{key:"nomatch"},[e._v("\n          Source 1 NO MATCH ("+e._s(e.totalNoMatch)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("thumb_down")])],1),e._v(" "),r("v-tab",{key:"flagged"},[e._v("\n          FLAGGED ("+e._s(e.totalFlagged)+")\n          "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("notification_important")])],1),e._v(" "),r("v-tab-item",{key:"match"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.matchedHeaders,items:e.mappingData.mapped,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Id))])]}}])})],1),e._v(" "),r("v-tab-item",{key:"notMapped"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.notMappedHeaders,items:e.mappingData.notMapped,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))])]}}])})],1),e._v(" "),r("v-tab-item",{key:"nomatch"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.noMatchHeaders,items:e.mappingData.noMatch,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))])]}}])})],1),e._v(" "),r("v-tab-item",{key:"flagged"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.flaggedHeaders,items:e.mappingData.flagged,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source1Id))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Name))]),e._v(" "),r("td",[e._v(e._s(t.item.source2Id))])]}}])})],1)],1)],1)],1)],1)},staticRenderFns:[]},ee=r("VU/8")(J,Q,!1,null,null,null).exports,te={data:function(){return{dialog:!1,restoreDialog:!1,alertTitle:"",alertText:"",archives:[],selectedArchive:"",header:[{sortable:!1},{text:"Archive Name",value:"archiveName"}]}},methods:{getArchives:function(){var e=this,t=this.$store.state.orgUnit;l.a.get("/getArchives/"+t.OrgId).then(function(t){e.archives=t.data,0===e.archives.length?e.$store.state.showArchives=!1:e.$store.state.showArchives=!0})},restoreArchive:function(){var e=this;if(""===this.selectedArchive)this.alertTitle="Error",this.alertText="Select an archive to restored",this.dialog=!0;else{this.restoreDialog=!0;var t=this.$store.state.orgUnit,r=new FormData;r.append("archive",this.selectedArchive),l.a.post("/restoreArchive/"+t.OrgId,r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){e.restoreDialog=!1,ke.$emit("refreshApp"),e.getArchives(),e.selectedArchive=""}).catch(function(t){e.restoreDialog=!1,e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.response.data.error,console.log(t.response.data.error)})}}},created:function(){this.getArchives()}},re={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[e.$store.state.uploadRunning?[r("br"),r("br"),r("br"),e._v(" "),r("v-alert",{attrs:{type:"info",value:!0}},[r("b",[e._v("Wait for upload to finish ...")]),e._v(" "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)]:e._e(),e._v(" "),0==e.archives.length?[r("br"),r("br"),r("br"),e._v(" "),r("v-alert",{attrs:{type:"info",value:!0}},[r("b",[e._v("No archived upload ...")])])]:e._e(),e._v(" "),[r("v-container",{attrs:{"grid-list-lg":""}},[r("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.restoreDialog,callback:function(t){e.restoreDialog=t},expression:"restoreDialog"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v("\n            Restoring\n            "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",width:"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-card-title",[e._v("\n            "+e._s(e.alertTitle)+"\n          ")]),e._v(" "),r("v-card-text",[e._v("\n            "+e._s(e.alertText)+"\n          ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"success"},on:{click:function(t){e.dialog=!1}}},[e._v("OK")])],1)],1)],1),e._v(" "),e.archives.length>0?r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",sm12:"",md12:"","child-flex":""}},[r("v-card",{attrs:{color:"green lighten-4"}},[r("v-card-title",{staticStyle:{color:"black"},attrs:{"primary-title":""}},[e._v("\n              Archived Uploads\n            ")]),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",staticStyle:{color:"red"},attrs:{headers:e.header,items:e.archives,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[r("tr",[r("v-radio-group",{staticStyle:{height:"5px"},attrs:{color:"red"},model:{value:e.selectedArchive,callback:function(t){e.selectedArchive=t},expression:"selectedArchive"}},[r("td",[r("v-radio",{attrs:{value:t.item,color:"red"}})],1)]),e._v(" "),r("td",[e._v(e._s(t.item))])],1)]}}])})],1),e._v(" "),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-btn",{attrs:{color:"error",dark:""},nativeOn:{click:function(t){return e.restoreArchive(t)}}},[r("v-icon",{attrs:{left:""}},[e._v("cached")]),e._v("Restore")],1)],1)],1)],1)],1):e._e()],1)]],2)},staticRenderFns:[]};var ae=r("VU/8")(te,re,!1,function(e){r("VPxq")},null,null).exports,se={mixins:[b],validations:{host:{required:P.required},name:{required:P.required},sourceType:{required:P.required}},methods:{close:function(){ke.$emit("dataSourceSaved")}}},oe={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),e._v(" "),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",flat:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add New Remote Source")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.close()}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-select",{attrs:{items:e.$store.state.remoteDataSources,required:"",label:"Source Type"},model:{value:e.sourceType,callback:function(t){e.sourceType=t},expression:"sourceType"}}),e._v(" "),r("v-text-field",{attrs:{box:"",required:"",color:"deep-purple",label:"Source Name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),r("v-text-field",{attrs:{box:"",required:"",color:"deep-purple",label:"Base URL"},model:{value:e.host,callback:function(t){e.host=t},expression:"host"}}),e._v(" "),r("v-text-field",{attrs:{box:"",color:"deep-purple",label:"Username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),r("v-text-field",{staticStyle:{"min-height":"96px"},attrs:{box:"",color:"deep-purple",label:"Password",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{flat:""},on:{click:function(t){e.$refs.form.reset()}}},[e._v("\n            Clear\n          ")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){e.addDataSource("syncServer")}}},[e._v("Add")])],1)],1)],1),e._v(" "),r("v-spacer")],1)],1)},staticRenderFns:[]},ie={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.syncProgrIndeter,callback:function(t){e.syncProgrIndeter=t},expression:"syncProgrIndeter"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v("\n        "+e._s(e.syncStatus)+"\n        "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",width:"270"},model:{value:e.syncProgrPercent,callback:function(t){e.syncProgrPercent=t},expression:"syncProgrPercent"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.syncStatus))]),r("br"),e._v(" "),r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.syncPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.syncPercent)+"%")])])])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},ne={data:function(){return{helpDialog:!1,deleteConfirm:!1,editDialog:!1,server:{},syncServersHeader:[{sortable:!1},{text:"Source Name",value:"name"},{text:"Base URL",value:"host"},{text:"Source Type",value:"sourceType"},{text:"User Name",value:"username"},{text:"Password",value:"password"},{text:"Last Sync",value:"lastsync"}],uploadSourcesHeader:[{sortable:!1},{text:"Source Name",align:"left",value:"name"}],selectedComponent:"",dataSources:[{text:"Upload CSV",value:"upload"},{text:"Remote Source",value:"remote"}],dataSource:"",addDataSource:!0,syncProgrIndeter:!1,syncProgrPercent:!1,syncStatus:"Waiting for sync status",syncPercent:null,syncProgressTimer:"",syncRunning:!1,alertSuccess:!1,alertError:!1,alertMsg:""}},methods:{sourceSelected:function(e){this.addDataSource=!0,"upload"===e?this.selectedComponent="FacilityReconUpload":"remote"===e&&(this.selectedComponent="FacilityReconRemoteSources")},editDataSource:function(e){if(0===n()(this.server).length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source");"upload"!==this.server.source&&(this.editDialog=!0)},saveEdit:function(){var e=this,t=new FormData,r=this.$store.state.clientId;t.append("host",this.server.host),t.append("sourceType",this.server.sourceType),t.append("source",this.server.source),t.append("username",this.server.username),t.append("password",this.server.password),t.append("name",this.server.name),t.append("id",this.server._id),t.append("clientId",r),this.editDialog=!1,l.a.post("/editDataSource",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.server.password=t.data.password})},validateDelete:function(){if(0===n()(this.server).length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source");this.deleteConfirm=!0},deleteDataSource:function(){var e=this;this.deleteConfirm=!1;var t=this.$store.state.auth.userID;l.a.get("/deleteDataSource/"+this.server._id+"/"+this.server.name+"/"+t).then(function(t){e.server={},ke.$emit("getDataSources")})},sync:function(e){var t=this;if(0===n()(this.server).length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source");if("upload"!==this.server.source){e||(e="full");var r=void 0;"DHIS2"===this.server.sourceType?r="dhisSync":"FHIR"===this.server.sourceType&&(r="fhirSync");var a=new FormData,s=this.$store.state.clientId;a.append("host",this.server.host),a.append("username",this.server.username),a.append("password",this.server.password),a.append("name",this.server.name),a.append("userID",this.$store.state.auth.userID),a.append("clientId",s),a.append("mode",e),this.syncRunning=!0,this.syncProgrIndeter=!0,l.a.post("/"+r+"/",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.syncProgressTimer=setInterval(t.checkSyncProgress,1e3)}).catch(function(e){t.$store.state.dialogError=!0,t.$store.state.errorTitle="Error",t.$store.state.errorDescription=e.response.data.error+". cross check host,user and password",clearInterval(t.syncProgressTimer),console.log(e.response.data.error)})}},checkSyncProgress:function(){var e=this,t=this.$store.state.clientId,r=void 0;"DHIS2"===this.server.sourceType?r="dhisSyncRequest":"FHIR"===this.server.sourceType&&(r="fhirSyncRequest"),l.a.get("/progress/"+r+"/"+t).then(function(t){return null===t.data||void 0===t.data||!1===t.data?(e.$store.state.uploadRunning=!1,e.syncProgrIndeter=!1,e.syncProgrPercent=!1,void clearInterval(e.syncProgressTimer)):null!==t.data.error?(e.$store.state.uploadRunning=!1,e.syncProgrIndeter=!1,e.syncProgrPercent=!1,e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.data.error,clearInterval(e.syncProgressTimer),void console.log(t.data.error)):null===t.data.status?(e.$store.state.uploadRunning=!1,e.syncProgrIndeter=!1,e.syncProgrPercent=!1,void clearInterval(e.syncProgressTimer)):(e.syncStatus=t.data.status,t.data.percent&&(e.syncProgrPercent||(e.syncProgrIndeter=!1,e.syncProgrPercent=!0),e.syncPercent=t.data.percent),void("Done"===t.data.status&&(e.syncStatus="Waiting for sync status",clearInterval(e.syncProgressTimer),e.syncProgrPercent=!1,e.$store.state.uploadRunning=!1,ke.$emit("getDataSources"))))}).catch(function(t){e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",console.log(t.response.data.error+". cross check host,user and password"),e.$store.state.errorDescription=t.response.data.error+". cross check host,user and password",clearInterval(e.syncProgressTimer)})}},computed:{remoteServers:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var s,o=d()(this.$store.state.dataSources);!(t=(s=o.next()).done);t=!0){var i=s.value;"syncServer"===i.source&&e.push(i)}}catch(e){r=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw a}}return e},uploadedSources:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var s,o=d()(this.$store.state.dataSources);!(t=(s=o.next()).done);t=!0){var i=s.value;"upload"===i.source&&e.push(i)}}catch(e){r=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw a}}return e}},components:{FacilityReconUpload:k,FacilityReconRemoteSources:r("VU/8")(se,oe,!1,null,null,null).exports,appSyncProgress:r("VU/8")({props:["syncProgrIndeter","syncStatus","syncProgrPercent","syncPercent"]},ie,!1,null,null,null).exports},created:function(){var e=this;ke.$on("dataSourceSaved",function(){e.addDataSource=!1,e.dataSource=""}),ke.$on("dataSourceAddedSuccessfully",function(){e.alertSuccess=!0,e.alertMsg="Data Source Added Successfully",setTimeout(function(){e.alertSuccess=!1},3e3)}),ke.$on("remoteServerFailedAdd",function(){e.alertError=!0,e.alertMsg="Data Source Failed To Be Added"})}},ce={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("app-syncProgress",{attrs:{syncProgrIndeter:e.syncProgrIndeter,syncStatus:e.syncStatus,syncProgrPercent:e.syncProgrPercent,syncPercent:e.syncPercent}}),e._v(" "),r("v-dialog",{attrs:{width:"530px"},model:{value:e.deleteConfirm,callback:function(t){e.deleteConfirm=t},expression:"deleteConfirm"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n          Info\n        ")])],1),e._v(" "),r("v-card-text",[e._v("\n        Are you sure you want to delete "+e._s(e.server.name)+" "+e._s(e.server.host)+" "),r("br"),e._v(" This will also delete the Database\n      ")]),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},on:{click:function(t){e.deleteConfirm=!1}}},[e._v("Cancel")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"success"},on:{click:e.deleteDataSource}},[e._v("Yes")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",width:"530px"},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}},[r("v-card",{attrs:{width:"530px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n          Editing "+e._s(e.server.host)+"\n        ")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.editDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"Name",disabled:""},model:{value:e.server.name,callback:function(t){e.$set(e.server,"name",t)},expression:"server.name"}})],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"Host"},model:{value:e.server.host,callback:function(t){e.$set(e.server,"host",t)},expression:"server.host"}})],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-select",{attrs:{items:e.$store.state.remoteDataSources,label:"Source Type"},model:{value:e.server.sourceType,callback:function(t){e.$set(e.server,"sourceType",t)},expression:"server.sourceType"}})],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"User Name"},model:{value:e.server.username,callback:function(t){e.$set(e.server,"username",t)},expression:"server.username"}})],1),e._v(" "),r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"Password",type:"password"},model:{value:e.server.password,callback:function(t){e.$set(e.server,"password",t)},expression:"server.password"}})],1)],1)],1),e._v(" "),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-btn",{staticStyle:{color:"white"},attrs:{color:"error"},nativeOn:{click:function(t){e.editDialog=!1}}},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("cancel")]),e._v("Cancel\n        ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){e.saveEdit("match")}}},[r("v-icon",{attrs:{left:""}},[e._v("save")]),e._v("Save\n        ")],1)],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("info")]),e._v(" About this page\n        ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[e._v("\n        This page let you load data from various sources into the app for reconciliation\n        "),r("v-list",[e._v("1. Select to add remote source if you have a DHIS2 or FHIR server that you want to use its data on this app")]),e._v(" "),r("v-list",[e._v("2. Select Upload CSV if you have a CSV file and want to upload its data on the app")]),e._v(" "),r("v-list",[e._v("3. The system requires CSV data to have atleast 2 levels above facility")]),e._v(" "),r("v-list",[e._v("4. Level 1 is the highest level on the hierarchy i.e Country")]),e._v(" "),r("v-list",[e._v("\n          5. Base URL under remote sources section refer to the URL i.e http://localhost:3447/fhir and not http://localhost:3447/fhir/Location.\n          Same applies to DHIS2 base URL\n        ")]),e._v(" "),r("v-list",[e._v("6. Use Force Full Sync to fetch all data from the remote server and update the app")]),e._v(" "),r("v-list",[e._v("8. Use Sync (Update) to pull updated records from the remote server and update the app")]),e._v(" "),r("v-list",[e._v("9. You may proceed to the 'Data Source Pair' page after you have added atleast two data sources")]),e._v(" "),r("v-list",[e._v("10. You may come back to this page and add more sources at any time")])],1)],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs2:""}},[r("v-subheader",[e._v("Add Source")])],1),e._v(" "),r("v-flex",{attrs:{xs2:""}},[r("v-select",{attrs:{items:e.dataSources,"item-text":"text","item-value":"value"},on:{change:e.sourceSelected},model:{value:e.dataSource,callback:function(t){e.dataSource=t},expression:"dataSource"}})],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(t){e.helpDialog=!0}},slot:"activator"},[r("v-icon",[e._v("help")])],1),e._v(" "),r("span",[e._v("Help")])],1)],1)],1),e._v(" "),r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v("\n        "+e._s(e.alertMsg)+"\n      ")]),e._v(" "),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v("\n        "+e._s(e.alertMsg)+"\n      ")])],1),e._v(" "),r("v-flex",[e.addDataSource?r(e.selectedComponent,{tag:"component"}):e._e()],1)],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),e._v(" "),r("v-flex",[r("v-card",{attrs:{color:"cyan lighten-5"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v("\n            Remote Sources\n          ")]),e._v(" "),r("v-spacer")],1),e._v(" "),r("v-card-actions",[e.remoteServers.length>0?r("v-btn",{attrs:{color:"primary",round:""},on:{click:function(t){e.sync("full")}}},[r("v-icon",{attrs:{left:""}},[e._v("sync")]),e._v("Force Full Sync\n          ")],1):r("v-btn",{attrs:{color:"primary",round:"",disabled:""},on:{click:function(t){e.sync("full")}}},[r("v-icon",{attrs:{left:""}},[e._v("sync")]),e._v("Force Full Sync\n          ")],1),e._v(" "),e.remoteServers.length>0?r("v-btn",{attrs:{color:"primary lighten-1",round:""},on:{click:function(t){e.sync("update")}}},[r("v-icon",{attrs:{left:""}},[e._v("sync")]),e._v("Sync (Update)\n          ")],1):r("v-btn",{attrs:{color:"primary lighten-1",round:"",disabled:""},on:{click:function(t){e.sync("update")}}},[r("v-icon",{attrs:{left:""}},[e._v("sync")]),e._v("Sync (Update)\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),e.remoteServers.length>0?r("v-btn",{attrs:{color:"success",round:""},on:{click:e.editDataSource}},[r("v-icon",{attrs:{left:""}},[e._v("edit")]),e._v("Edit\n          ")],1):r("v-btn",{attrs:{color:"success",round:"",disabled:""},on:{click:e.editDataSource}},[r("v-icon",{attrs:{left:""}},[e._v("edit")]),e._v("Edit\n          ")],1),e._v(" "),e.remoteServers.length>0?r("v-btn",{attrs:{color:"error",round:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("Delete\n          ")],1):r("v-btn",{attrs:{color:"error",round:"",disabled:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("Delete\n          ")],1)],1),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.syncServersHeader,items:e.remoteServers,dark:"",loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"items",fn:function(t){return[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}},[r("td",[r("v-radio",{attrs:{value:t.item,color:"blue"}})],1)]),e._v(" "),r("td",[e._v(e._s(t.item.name))]),e._v(" "),r("td",[e._v(e._s(t.item.host))]),e._v(" "),r("td",[e._v(e._s(t.item.sourceType))]),e._v(" "),r("td",[e._v(e._s(t.item.username))]),e._v(" "),t.item.username?r("td",[e._v("*****")]):r("td"),e._v(" "),r("td",[e._v(e._s(t.item.lastUpdate))])]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),e._v(" "),r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v("\n            Uploaded Sources\n          ")])],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),e.uploadedSources.length>0?r("v-btn",{attrs:{color:"error",round:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("Delete\n          ")],1):r("v-btn",{attrs:{color:"error",round:"",disabled:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("Delete\n          ")],1)],1),e._v(" "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.uploadSourcesHeader,items:e.uploadedSources,dark:"",loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"items",fn:function(t){return[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}},[r("td",[r("v-radio",{attrs:{value:t.item,color:"blue"}})],1)]),e._v(" "),r("td",[e._v(e._s(t.item.name))])]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1),e._v(" "),r("v-spacer")],1)],1)},staticRenderFns:[]},le=r("VU/8")(ne,ce,!1,null,null,null).exports,ue={data:function(){return{helpDialog:!1,alertSuccess:!1,alertError:!1,alertMsg:"",shareDialog:!1,sharePair:{},source1:{},source2:{},searchPairs:"",searchSources:"",searchUsers:"",users:[],sharedUsers:[],activeDataSourcePair:{},source1Headers:[{sortable:!1},{text:"Source 1",value:"headerSource1",sortable:!1}],source2Headers:[{sortable:!1},{text:"Source 2",value:"headerSource2",sortable:!1}],sourcePairHeaders:[{text:"Pair",value:"pair"},{text:"Owner",value:"owner",sortable:!1},{text:"Active",value:"active"},{text:"Share Status",value:"shareStatus"}],usersHeader:[{text:"Username",value:"username",sortable:!0},{text:"Firstname",value:"fname",sortable:!0},{text:"Surname",value:"sname",sortable:!0}]}},methods:{reset:function(){var e=this;this.source1={},this.source2={},this.activeDataSourcePair={},this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Reseting Data Source Pairs";var t=this.$store.state.auth.userID;l.a.get("/resetDataSourcePair/"+t).then(function(t){ke.$emit("getDataSourcePair"),e.$store.state.dynamicProgress=!1,e.alertSuccess=!0,e.alertMsg="Data Source Pair Reseted Successfully"}).catch(function(t){e.alertError=!0,e.alertMsg="Something went wrong while reseting data source pairs",console.log(t)})},createPair:function(){var e=this;if(0===n()(this.source1).length||0===n()(this.source2).length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source");if(this.source1.name===this.source2.name&&this.source1.source===this.source2.source)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Data source pair of the same data source is not allowed, change one of the source");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Saving Data Sources";var t=new FormData;t.append("source1",o()(this.source1)),t.append("source2",o()(this.source2)),t.append("userID",this.$store.state.auth.userID),l.a.post("/addDataSourcePair",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.$store.state.levelMapping.source1=JSON.parse(t.data).levelMapping1,e.$store.state.levelMapping.source2=JSON.parse(t.data).levelMapping2,ke.$emit("getDataSourcePair"),e.alertSuccess=!0,e.alertMsg="Data Source Pair Saved Successfully",e.$store.state.dynamicProgress=!1}).catch(function(t){e.alertError=!0,e.alertMsg="Something went wrong while saving data source pairs",e.$store.state.dynamicProgress=!1,console.log(t)})},activateSharedPair:function(e){var t=this;this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Activating Shared Data Source Pair";var r=new FormData;r.append("pairID",e),r.append("userID",this.$store.state.auth.userID),l.a.post("/activateSharedPair",r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){ke.$emit("getDataSourcePair"),t.alertSuccess=!0,t.alertMsg="Data Source Pair Activated Successfully",t.$store.state.dynamicProgress=!1}).catch(function(e){t.alertError=!0,t.alertMsg="Something went wrong while activating data source pair",t.$store.state.dynamicProgress=!1,console.log(e)})},activatePair:function(){var e=this;this.source1=this.$store.state.dataSources.find(function(t){return t._id===e.activeDataSourcePair.source1._id}),this.source2=this.$store.state.dataSources.find(function(t){return t._id===e.activeDataSourcePair.source2._id}),this.source1&&this.source2?this.createPair():this.activateSharedPair(this.activeDataSourcePair._id)},share:function(e,t){var r=this;if("showDialog"===t)this.sharedUsers=[],this.sharePair=e,e.hasOwnProperty("shared")&&e.shared.users.length>0&&e.shared.users.forEach(function(e){r.sharedUsers.push(e._id)}),this.shareDialog=!0;else if("saveShare"===t){var a=new FormData;a.append("sharePair",this.sharePair._id),a.append("users",o()(this.sharedUsers)),a.append("userID",this.$store.state.auth.userID),this.$store.state.loadingServers=!0,this.shareDialog=!1,l.a.post("/shareSourcePair",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){r.$store.state.loadingServers=!1,r.$store.state.dataSourcePairs=e.data}).catch(function(e){console.log(e),r.$store.state.loadingServers=!1})}},getUsers:function(){var e=this;l.a.get("/getUsers").then(function(t){e.users=t.data})},getActivePair:function(){var e=this,t=void 0;this.activeDataSourcePair={},this.$store.state.dataSourcePairs.forEach(function(r){r.userID._id===e.$store.state.auth.userID&&"active"===r.status&&(e.activeDataSourcePair=r),n()(e.activeDataSourcePair).length>0?t=void 0:r.userID._id!==e.$store.state.auth.userID&&"active"===r.status&&(t=r)}),t&&(this.activeDataSourcePair=t)}},created:function(){var e=this;this.getUsers(),this.source1=this.$store.state.dataSources.find(function(t){return t._id===e.$store.state.activePair.source1.id}),this.source2=this.$store.state.dataSources.find(function(t){return t._id===e.$store.state.activePair.source2.id}),this.getActivePair(),this.source1||(this.source1={}),this.source2||(this.source2={})}},de={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("center",[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v("\n      "+e._s(e.alertMsg)+"\n    ")]),e._v(" "),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v("\n      "+e._s(e.alertMsg)+"\n    ")]),e._v(" "),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("info")]),e._v(" About this page\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[e._v("\n          This page let you choose a pair of data sources to use for reconciliation\n          "),r("v-list",[e._v("1. Source 1 is the source while source 2 is the target")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{persistent:"",width:"530px"},model:{value:e.shareDialog,callback:function(t){e.shareDialog=t},expression:"shareDialog"}},[r("v-card",{attrs:{width:"530px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v("\n            Sharing "),e.sharePair.hasOwnProperty("source1")?[e._v(e._s(e.sharePair.source1.name)+" - "+e._s(e.sharePair.source2.name))]:e._e()],2),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.shareDialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-card-text",[r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUsers,callback:function(t){e.searchUsers=t},expression:"searchUsers"}}),e._v(" "),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.usersHeader,items:e.users,search:e.searchUsers},scopedSlots:e._u([{key:"items",fn:function(t){return[t.item.userName!==e.$store.state.auth.username?r("tr",[r("td",[r("v-checkbox",{attrs:{value:t.item._id},model:{value:e.sharedUsers,callback:function(t){e.sharedUsers=t},expression:"sharedUsers"}})],1),r("td",[e._v(e._s(t.item.userName))]),e._v(" "),r("td",[e._v(e._s(t.item.firstName))]),e._v(" "),r("td",[e._v(e._s(t.item.surname))])]):e._e()]}}])})],1),e._v(" "),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-btn",{staticStyle:{color:"white"},attrs:{color:"error"},nativeOn:{click:function(t){e.shareDialog=!1}}},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("cancel")]),e._v("Cancel\n          ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){e.share("","saveShare")}}},[r("v-icon",{attrs:{left:""}},[e._v("share")]),e._v("Share\n          ")],1)],1)],1)],1),e._v(" "),r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"primary"},on:{click:function(t){e.helpDialog=!0}},slot:"activator"},[r("v-icon",[e._v("help")])],1),e._v(" "),r("span",[e._v("Help")])],1)],1)],1),e._v(" "),r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-card",{staticStyle:{width:"1000px"},attrs:{color:"cyan lighten-5"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white lighten-2"}},[e._v("\n              Choose Data Source Pair\n            ")])],1),e._v(" "),r("v-card-text",{staticStyle:{float:"center"}},[r("v-layout",{staticStyle:{float:"center"},attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-data-table",{attrs:{headers:e.source1Headers,items:e.$store.state.dataSources,loading:e.$store.state.loadingServers,dark:""},scopedSlots:e._u([{key:"items",fn:function(t){return[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.source1,callback:function(t){e.source1=t},expression:"source1"}},[r("td",[r("v-radio",{attrs:{value:t.item,color:"blue"}})],1)]),e._v(" "),r("td",[e._v(e._s(t.item.name))])]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),e._v(" "),r("v-flex",{attrs:{xs6:""}},[r("v-data-table",{attrs:{headers:e.source2Headers,items:e.$store.state.dataSources,"item-key":"id",loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"items",fn:function(t){return[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.source2,callback:function(t){e.source2=t},expression:"source2"}},[r("td",[r("v-radio",{attrs:{value:t.item,color:"blue"}})],1)]),e._v(" "),r("td",[e._v(e._s(t.item.name))])]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"error",round:""},on:{click:e.reset}},[r("v-icon",{attrs:{left:""}},[e._v("refresh")]),e._v(" Reset")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",round:""},on:{click:e.createPair}},[r("v-icon",{attrs:{left:""}},[e._v("save")]),e._v(" Save")],1)],1)],1)],1),e._v(" "),r("v-flex",[r("v-card",{staticStyle:{width:"1000px"},attrs:{color:"cyan lighten-4"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white lighten-2"}},[e._v("\n              Existing Data Source Pairs \n              "),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchPairs,callback:function(t){e.searchPairs=t},expression:"searchPairs"}})],1)],1),e._v(" "),r("v-card-text",{staticStyle:{float:"center"}},[r("v-data-table",{attrs:{headers:e.sourcePairHeaders,items:e.$store.state.dataSourcePairs,search:e.searchPairs,loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1.name)+" - "+e._s(t.item.source2.name))]),e._v(" "),r("td",[e._v(e._s(t.item.userID.userName))]),e._v(" "),r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.activeDataSourcePair,callback:function(t){e.activeDataSourcePair=t},expression:"activeDataSourcePair"}},[r("td",[r("v-radio",{attrs:{value:t.item,color:"blue"}})],1)]),e._v(" "),r("td",[e._l(t.item.shared.users,function(t){return[e._v("\n                  "+e._s(t.userName)+", \n                  ")]})],2),e._v(" "),t.item.userID._id===e.$store.state.auth.userID?r("td",[r("v-btn",{attrs:{flat:"",icon:"",color:"primary"},on:{click:function(r){e.share(t.item,"showDialog")}}},[r("v-icon",{attrs:{left:""}},[e._v("share")]),e._v("Share\n                  ")],1)],1):e._e()]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",round:""},on:{click:e.activatePair}},[r("v-icon",{attrs:{left:""}},[e._v("save")]),e._v("Activate Pair")],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},ve=r("VU/8")(ue,de,!1,null,null,null).exports,he=r("//Fk"),pe=r.n(he),ge=r("NYxO");a.a.use(ge.a);var me=new ge.a.Store({state:{auth:{username:"",userID:"",role:"",token:""},levelMapping:{source1:{},source2:{}},config:{reconciliation:{useCSVHeader:!0}},recoStatus:{status:"on-progress"},dialogError:!1,errorTitle:"",errorDescription:"",clientId:null,denyAccess:!0,source2Hierarchy:"",source1Hierarchy:"",uploadRunning:!1,orgUnit:{OrgId:"lZsCb6y0KDX",OrgName:"Malawi"},dataSourcePairs:[],activePair:{source1:{},source2:{}},source1TotalAllRecords:0,source2TotalAllRecords:0,totalAllMapped:0,totalAllFlagged:0,totalAllNoMatch:0,source1TotalAllNotMapped:0,source2TotalRecords:0,recoLevel:2,totalSource1Levels:"",totalSource2Levels:"",matchedContent:[],noMatchContent:[],flagged:[],source1Parents:[],source2UnMatched:[],source1UnMatched:[],scoreResults:[],levelArray:[],scoresProgressData:{},uploadProgressData:{},dataSources:[],remoteDataSources:["DHIS2","FHIR"],loadingServers:!1,dynamicProgress:!1,initializingApp:!1}});l.a.interceptors.request.use(function(e){var t=me.state.auth.token;return t&&(e.headers.Authorization="Bearer "+t),e},function(e){return pe.a.reject(e)}),l.a.interceptors.response.use(function(e){return e},function(e){return 401===e.response.status&&(me.state.auth.token="",m.a.remove("token"),_e.push("login")),pe.a.reject(e)}),a.a.use(S.a);var fe=new S.a({routes:[{path:"/",name:"FacilityReconHome",component:Z},{path:"/addUser",name:"AddUser",component:q},{path:"/UsersList",name:"UsersList",component:F},{path:"/ChangePassword",name:"ChangePassword",component:V},{path:"/login",name:"Login",component:M},{path:"/logout",name:"Logout",component:A},{path:"/upload",name:"FacilityReconUpload",component:k},{path:"/dataSync",name:"FacilityReconDataSync",component:le},{path:"/dataSourcePair",name:"FacilityReconDataSourcePair",component:ve},{path:"/view",name:"FacilityReconView",component:K},{path:"/scores",name:"FacilityReconScores",component:Z},{path:"/recoStatus",name:"FacilityRecoStatus",component:ee},{path:"/dbAdmin",name:"FacilityReconDbAdmin",component:ae}]});fe.beforeEach(function(e,t,r){me.state.auth.token||m.a.get("token")&&m.a.get("userID")?r():"/Login"!==e.path?r({path:"/Login"}):r()});var _e=fe,xe=r("3EgV"),Se=r.n(xe),$e=r("ESwS"),ye=r.n($e),be=(r("7zck"),r("TXmL"));a.a.use(be.a);var Pe,we,De=new be.a({locale:Object({NODE_ENV:"production",BACKEND_SERVER:""}).VUE_APP_I18N_LOCALE||"en",fallbackLocale:Object({NODE_ENV:"production",BACKEND_SERVER:""}).VUE_APP_I18N_FALLBACK_LOCALE||"en",messages:(Pe=r("hFeb"),we={},Pe.keys().forEach(function(e){var t=e.match(/([A-Za-z0-9-_]+)\./i);if(t&&t.length>1){var r=t[1];we[r]=Pe(e)}}),we)});r.d(t,"eventBus",function(){return ke}),a.a.use(ye.a),a.a.use(Se.a,{theme:{primary:"#3F51B5",secondary:"#7986CB",accent:"#9c27b0",error:"#f44336",warning:"#ffeb3b",info:"#2196f3",success:"#4caf50"}}),a.a.config.productionTip=!1;var ke=new a.a;new a.a({el:"#app",router:_e,store:me,components:{App:x},i18n:De,template:"<App/>"})},NuBg:function(e,t){e.exports={App:{title:"Facility Reconciliation",initApp:"Initializing App",source:"Source",menu:{createPair:{msg:"Create and Manage Data Source Pair",tooltip:"Select data sources to start mathing"},reconcile:{msg:"Reconcile",tooltip:"Perform location matching of your selected data sources"},recoStatus:{msg:"Reconciliation Status",tooltip:"Matching Status"},archive:{msg:"Archived Uploads",tooltip:"Access to backup data"},account:{msg:"Account"},addUser:{msg:"Add User",tooltip:"Create new user account"},usersList:{msg:"Users List",tooltip:"Enable and Disable user accounts"},changePassword:{msg:"Change Password"},logout:{msg:"Logout"},dataSources:{msg:"Data Sources",tooltip:"Upload CSV data or synhronize remote server data"},view:{msg:"View",tooltip:"Explore data sources contents"},recoParent:{msg:"Reconcile"}}}}},VPxq:function(e,t){},XV7c:function(e,t){},cLBk:function(e,t){},hFeb:function(e,t,r){var a={"./en.json":"NuBg","./fr.json":"oBab"};function s(e){return r(o(e))}function o(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}s.keys=function(){return Object.keys(a)},s.resolve=o,e.exports=s,s.id="hFeb"},oBab:function(e,t){e.exports={App:{title:"Facility Reconciliation",initApp:"Initialisation de l'App",source:"la source",menu:{createPair:{msg:"Créer et gérer une paire de sources de données",tooltip:"Select data sources to start mathing"},reconcile:{msg:"Réconcilier",tooltip:"Effectuer une correspondance d'emplacement de vos sources de données sélectionnées"},recoStatus:{msg:"État de rapprochement",tooltip:"Statut de correspondance"},archive:{msg:"Téléchargements archivés",tooltip:"Accès aux données de sauvegarde"},account:{msg:"Account"},addUser:{msg:"Add User",tooltip:"Create new user account"},usersList:{msg:"Users List",tooltip:"Enable and Disable user accounts"},changePassword:{msg:"Change Password"},logout:{msg:"Connectez - Out"},dataSources:{msg:"Les sources de données",tooltip:"Téléchargez des données CSV ou synchronisez des données de serveur distant"},view:{msg:"Vue",tooltip:"Explorer le contenu des sources de données"},recoParent:{msg:"Réconcilier"}}}}},zMXS:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.29b175ae45bb6852e7fb.js.map