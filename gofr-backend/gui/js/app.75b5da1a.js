(function(e){function t(t){for(var a,s,n=t[0],c=t[1],l=t[2],u=0,d=[];u<n.length;u++)s=n[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);h&&h(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,s=1;s<r.length;s++){var n=r[s];0!==o[n]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=r[0]))}return e}var a={},s={app:0},o={app:0},i=[];function n(e){return c.p+"js/"+({"fhir-outcome":"fhir-outcome"}[e]||e)+"."+{"chunk-07768e92":"33ca15e7","chunk-08ab496f":"37d6baf7","chunk-19a703d4":"24a0c6ce","chunk-1b3f2290":"71b0b924","chunk-1f82ee10":"e0d96be5","chunk-2d0afa68":"8c648a6f","chunk-2d0b8b5d":"4cda4fe6","chunk-2d0da301":"6430179a","chunk-2d0f083f":"45b2effa","chunk-2d216051":"c74fde99","chunk-2d21a389":"d55c3a4c","chunk-2d2245b0":"d5222980","chunk-2f5fab82":"11c23e74","chunk-4187d98a":"bd285c7c","chunk-2d0c17b7":"75c9dcee","chunk-2d0e2c53":"4b62641e","chunk-5368b584":"b7ddf58a","chunk-53787938":"e2fc6b7d","chunk-5474d9c5":"f2230737","chunk-5caeefd5":"b6ed5a55","chunk-5e70ac24":"757b1eea","chunk-5e719bed":"d1ada5f2","chunk-616686dc":"964cbfcf","chunk-63f87f9c":"a455a81d","chunk-67c19840":"47cf2ee0","chunk-fdbc1486":"dcd7be45","chunk-69078b64":"12d34ba4","chunk-69ce93ab":"c25d8fa1","chunk-69e25fe0":"fefd2a9f","chunk-6d62d473":"ca5712e9","chunk-748c7801":"91966156","chunk-77a2aa0c":"9c970fb6","chunk-789dd4ca":"65ef6a7f","chunk-ea42a9f0":"0ed6fdf1","fhir-outcome":"39c549cf","chunk-2d0c2116":"a12b99c1","chunk-2d0c2136":"b6963731","chunk-2d0c7697":"e5409bd1","chunk-2d22c892":"1ac9faab","chunk-573e074d":"9d21c029","chunk-d3e54200":"d016b9ec","chunk-2d21e6cc":"697ae363","chunk-69d01fe3":"c6508b85","chunk-69d059e4":"6b546925"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(e){var t=[],r={"chunk-4187d98a":1,"chunk-5474d9c5":1,"chunk-616686dc":1,"chunk-6d62d473":1,"chunk-748c7801":1,"chunk-ea42a9f0":1,"chunk-573e074d":1};s[e]?t.push(s[e]):0!==s[e]&&r[e]&&t.push(s[e]=new Promise((function(t,r){for(var a="css/"+({"fhir-outcome":"fhir-outcome"}[e]||e)+"."+{"chunk-07768e92":"31d6cfe0","chunk-08ab496f":"31d6cfe0","chunk-19a703d4":"31d6cfe0","chunk-1b3f2290":"31d6cfe0","chunk-1f82ee10":"31d6cfe0","chunk-2d0afa68":"31d6cfe0","chunk-2d0b8b5d":"31d6cfe0","chunk-2d0da301":"31d6cfe0","chunk-2d0f083f":"31d6cfe0","chunk-2d216051":"31d6cfe0","chunk-2d21a389":"31d6cfe0","chunk-2d2245b0":"31d6cfe0","chunk-2f5fab82":"31d6cfe0","chunk-4187d98a":"7cb64c1b","chunk-2d0c17b7":"31d6cfe0","chunk-2d0e2c53":"31d6cfe0","chunk-5368b584":"31d6cfe0","chunk-53787938":"31d6cfe0","chunk-5474d9c5":"2976e3dc","chunk-5caeefd5":"31d6cfe0","chunk-5e70ac24":"31d6cfe0","chunk-5e719bed":"31d6cfe0","chunk-616686dc":"76a811a3","chunk-63f87f9c":"31d6cfe0","chunk-67c19840":"31d6cfe0","chunk-fdbc1486":"31d6cfe0","chunk-69078b64":"31d6cfe0","chunk-69ce93ab":"31d6cfe0","chunk-69e25fe0":"31d6cfe0","chunk-6d62d473":"a5c908f7","chunk-748c7801":"50dbc238","chunk-77a2aa0c":"31d6cfe0","chunk-789dd4ca":"31d6cfe0","chunk-ea42a9f0":"2976e3dc","fhir-outcome":"31d6cfe0","chunk-2d0c2116":"31d6cfe0","chunk-2d0c2136":"31d6cfe0","chunk-2d0c7697":"31d6cfe0","chunk-2d22c892":"31d6cfe0","chunk-573e074d":"2976e3dc","chunk-d3e54200":"31d6cfe0","chunk-2d21e6cc":"31d6cfe0","chunk-69d01fe3":"31d6cfe0","chunk-69d059e4":"31d6cfe0"}[e]+".css",o=c.p+a,i=document.getElementsByTagName("link"),n=0;n<i.length;n++){var l=i[n],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===a||u===o))return t()}var d=document.getElementsByTagName("style");for(n=0;n<d.length;n++){l=d[n],u=l.getAttribute("data-href");if(u===a||u===o)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var a=t&&t.target&&t.target.src||o,i=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=a,delete s[e],h.parentNode.removeChild(h),r(i)},h.href=o;var v=document.getElementsByTagName("head")[0];v.appendChild(h)})).then((function(){s[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,r){a=o[e]=[t,r]}));t.push(a[2]=i);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=n(e);var d=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(h);var r=o[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",d.name="ChunkLoadError",d.type=a,d.request=s,r[1](d)}o[e]=void 0}};var h=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(r,a,function(t){return e[t]}.bind(null,a));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var h=u;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"087a":function(e,t,r){},"08bb":function(e,t,r){},"2a6c":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r("2b27"),s=r.n(a),o={hasPermissionByName:function(e,t,r){var a;try{a=s.a.get("userObj")}catch(o){return console.log(o),!1}return!(!a.permissions["*"]||!a.permissions["*"]["*"])||!!(a.permissions[e][t]||a.permissions["*"]&&a.permissions["*"][t])&&(!r||!!(a.permissions[e][t]["id"]||a.permissions["*"]&&a.permissions["*"][t]&&a.permissions["*"][t]["id"])&&(a.permissions[e][t]["id"][r]?a.permissions[e][t]["id"][r]:!!(a.permissions["*"]&&a.permissions["*"][t]&&a.permissions["*"][t]["id"]&&a.permissions["*"][t]["id"][r])&&a.permissions["*"][t]["id"][r]))}}},"49f8":function(e,t,r){var a={"./en.json":"edd4","./fr.json":"f693"};function s(e){var t=o(e);return r(t)}function o(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=o,e.exports=s,s.id="49f8"},"56d7":function(e,t,r){"use strict";r.r(t),r.d(t,"eventBus",(function(){return Oa}));r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("ac1f"),r("5319"),r("1276"),r("d3b7"),r("4c53"),r("b0c0");var a=r("a026"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{color:"primary",dark:"",app:"","clipped-left":"","clipped-right":""}},[a("v-toolbar-title",{domProps:{textContent:e._s(e.title)}}),a("v-spacer"),e.$keycloak&&e.$keycloak.authenticated||e.$store.state.auth.userID||e.$store.state.config.generalConfig.authDisabled?a("v-toolbar-items",[e.dhisLink?a("v-btn",{attrs:{flat:"",href:e.dhisLink}},[a("img",{attrs:{src:r("754f")}})]):e._e(),a("appMenu")],1):e._e(),a("v-spacer"),a("v-toolbar-items")],1),a("v-main",[a("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.$store.state.dynamicProgress,callback:function(t){e.$set(e.$store.state,"dynamicProgress",t)},expression:"$store.state.dynamicProgress"}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[e._v(" "+e._s(e.$store.state.progressTitle)+" "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.$store.state.dialogError,callback:function(t){e.$set(e.$store.state,"dialogError",t)},expression:"$store.state.dialogError"}},[a("v-card",[a("v-toolbar",{attrs:{color:e.$store.state.errorColor,dark:""}},[a("v-toolbar-title",[e._v(" "+e._s(e.$store.state.errorTitle)+" ")]),a("v-spacer"),a("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.$store.state.dialogError=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("v-card-text",[e._v(" "+e._s(e.$store.state.errorDescription)+" ")]),a("v-card-actions",[a("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){return e.closeDialogError(t)}}},[e._v("Ok")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.$store.state.initializingApp,callback:function(t){e.$set(e.$store.state,"initializingApp",t)},expression:"$store.state.initializingApp"}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[e._v(" "+e._s(e.$t("App.initApp"))+" "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),a("v-snackbar",{staticClass:"mt-12",attrs:{app:"",color:e.$store.state.message.type,timeout:e.$store.state.message.timeout,top:"","multi-line":""},model:{value:e.$store.state.message.active,callback:function(t){e.$set(e.$store.state.message,"active",t)},expression:"$store.state.message.active"}},[e._v(" "+e._s(e.$store.state.message.text)+" "),a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){return e.$store.commit("closeMessage")}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("v-row",[a("v-col",[Object.keys(e.$store.state.activePair.source1).length>0&&!e.$store.state.denyAccess?[e._v(" "+e._s(e.$t("App.source"))+" 1: "),a("b",[e._v(e._s(e.$store.state.activePair.source1.display))]),e._v(", "+e._s(e.$t("App.source"))+" 2: "),a("b",[e._v(e._s(e.$store.state.activePair.source2.display))]),e._v(", Recon Status: "),"in-progress"===e.$store.state.recoStatus?a("v-icon",{attrs:{small:""}},[e._v("mdi-lock-open-variant-outline")]):a("v-icon",{attrs:{small:""}},[e._v("mdi-lock-outline")]),e._v(" "),a("b",[e._v(e._s(e.$store.state.recoStatus))])]:e._e()],2),a("v-col",{attrs:{cols:"2"}},[a("v-select",{attrs:{items:e.locales},model:{value:e.locale,callback:function(t){e.locale=t},expression:"locale"}})],1)],1),a("center",[a("v-alert",{style:{width:e.$store.state.alert.width},attrs:{type:e.$store.state.alert.type,dismissible:e.$store.state.alert.dismisible,transition:e.$store.state.alert.transition},model:{value:e.$store.state.alert.show,callback:function(t){e.$set(e.$store.state.alert,"show",t)},expression:"$store.state.alert.show"}},[e._v(" "+e._s(e.$store.state.alert.msg)+" ")])],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}}),a("v-spacer"),a("v-flex",{attrs:{xs1:""}})],1),a("router-view",{key:e.$route.path})],1),a("v-footer",{attrs:{dark:"",color:"primary",fixed:e.fixed,app:""}})],1)},o=[],i=r("53ca"),n=r("b85c"),c=r("5530"),l=(r("99af"),r("b64b"),r("7db0"),r("bc3a")),u=r.n(l),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{attrs:{id:"menu"}},[r("li",{staticClass:"parent"},[r("a",{attrs:{href:"#"}},[r("v-icon",[e._v("mdi-spellcheck")]),e._v(" "+e._s(e.$t("App.menu.facilityRecon.msg"))+" ")],1),r("ul",{staticClass:"child"},[r("li",{staticClass:"parent"},[r("a",{staticStyle:{"margin-left":"15px"},attrs:{href:"#"}},[r("v-icon",{attrs:{color:"black",left:""}},[e._v("mdi-sync")]),e._v(e._s(e.$t("App.menu.dataSourcesParent.msg"))+" "),r("v-icon",{staticClass:"menuArrow",attrs:{color:"black",small:""}},[e._v("mdi-play")])],1),r("ul",{staticClass:"child"},[e.tasksVerification.hasPermissionByName("special","custom","add-data-source")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/AddDataSources"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-cloud-upload")]),e._v(" "+e._s(e.$t("App.menu.addDataSources.msg"))+" ")],1)],1)]}}],null,!1,687082157)},[r("span",[e._v(e._s(e.$t("App.menu.addDataSources.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-data-source")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/ViewDataSources"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-format-list-bulleted-square")]),e._v(e._s(e.$t("App.menu.viewDataSources.msg"))+" ")],1)],1)]}}],null,!1,2993043827)},[r("span",[e._v(e._s(e.$t("App.menu.viewDataSources.tooltip")))])])],1):e._e()],1)]),e.tasksVerification.hasPermissionByName("special","custom","data-source-reconciliation")?r("v-list",{class:{disabledMenu:0===Object.keys(e.$store.state.activePair.source1).length,lastMenu:!0}},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/view",color:"white",disabled:0===Object.keys(e.$store.state.activePair.source1).length}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-format-list-bulleted-square")]),e._v(e._s(e.$t("App.menu.view.msg"))+" ")],1)],1)]}}],null,!1,2044375888)},[r("span",[e._v(e._s(e.$t("App.menu.view.tooltip")))])])],1):e._e(),r("li",{staticClass:"parent"},[r("a",{staticStyle:{"margin-left":"15px"},attrs:{href:"#"}},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-compare-horizontal")]),e._v(e._s(e.$t("App.menu.reconcile.msg"))+" "),r("v-icon",{staticClass:"menuArrow",attrs:{color:"black",small:""}},[e._v("mdi-play")])],1),r("ul",{staticClass:"child"},[e.tasksVerification.hasPermissionByName("special","custom","view-source-pair")?r("v-list",{class:{disabledMenu:e.$store.state.dataSources.length<=1||e.$store.state.dataSourcePairs.length<=0,lastMenu:!0}},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/dataSourcesPair",disabled:e.$store.state.dataSources.length<=1&&0===e.$store.state.dataSourcePairs.length}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-numeric-2-box-multiple-outline")]),e._v(e._s(e.$t("App.menu.createPair.msg"))+" ")],1)],1)]}}],null,!1,3764437934)},[r("span",[e._v(e._s(e.$t("App.menu.createPair.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","data-source-reconciliation")?r("v-list",{class:{disabledMenu:0===Object.keys(e.$store.state.activePair.source1).length,lastMenu:!0}},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/scores",disabled:0===Object.keys(e.$store.state.activePair.source1).length}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-book-search")]),e._v(e._s(e.$t("App.menu.reconcile.msg"))+" ")],1)],1)]}}],null,!1,3226277521)},[r("span",[e._v(e._s(e.$t("App.menu.reconcile.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-matching-status")?r("v-list",{class:{disabledMenu:0===Object.keys(e.$store.state.activePair.source1).length,lastMenu:!0}},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/recoStatus",disabled:0===Object.keys(e.$store.state.activePair.source1).length}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-view-dashboard")]),e._v(" "+e._s(e.$t("App.menu.recoStatus.msg"))+" ")],1)],1)]}}],null,!1,109277401)},[r("span",[e._v(e._s(e.$t("App.menu.recoStatus.tooltip")))])])],1):e._e()],1)])],1)]),r("li",{staticClass:"parent"},[r("a",{attrs:{href:"#"}},[r("v-icon",[e._v("mdi-map-marker")]),e._v(e._s(e.$t("App.menu.facilityRegistry.msg"))+" ")],1),e.tasksVerification.hasPermissionByName("special","navigation","search-records")?r("ul",{staticClass:"child"},[r("li",{staticClass:"parent"},[r("a",{attrs:{href:"#"}},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(" "+e._s(e.$t("App.menu.search.msg"))+" "),r("v-icon",{staticClass:"menuArrow",attrs:{color:"black",small:""}},[e._v("mdi-play")])],1),r("ul",{staticClass:"child"},[e.tasksVerification.hasPermissionByName("special","custom","view-search-facility-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/facility"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(e._s(e.$t("App.menu.searchFacility.msg"))+" ")],1)],1)]}}],null,!1,2203957888)},[r("span",[e._v(e._s(e.$t("App.menu.searchFacility.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-search-jurisdiction-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/jurisdiction"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(e._s(e.$t("App.menu.searchJurisdiction.msg"))+" ")],1)],1)]}}],null,!1,1925631744)},[r("span",[e._v(e._s(e.$t("App.menu.searchJurisdiction.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-search-organization-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/mcsd-organization"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(e._s(e.$t("App.menu.searchOrganization.msg"))+" ")],1)],1)]}}],null,!1,2131843924)},[r("span",[e._v(e._s(e.$t("App.menu.searchOrganization.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-search-service-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/service"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(e._s(e.$t("App.menu.searchService.msg"))+" ")],1)],1)]}}],null,!1,1542065888)},[r("span",[e._v(e._s(e.$t("App.menu.searchService.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-add-facility-requests")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/facility-add-request/process-add-request"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(e._s(e.$t("App.menu.searchFacilityAddRequest.msg"))+" ")],1)],1)]}}],null,!1,3485559028)},[r("span",[e._v(e._s(e.$t("App.menu.searchFacilityAddRequest.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-update-facility-requests")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/facility-update-request/process-update-request"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-magnify")]),e._v(e._s(e.$t("App.menu.searchFacilityUpdateRequest.msg"))+" ")],1)],1)]}}],null,!1,933363556)},[r("span",[e._v(e._s(e.$t("App.menu.searchFacilityUpdateRequest.tooltip")))])])],1):e._e()],1)]),e.tasksVerification.hasPermissionByName("special","custom","view-add-jurisdiction-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Add/jurisdiction"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-home-city")]),e._v(e._s(e.$t("App.menu.addJurisdiction.msg"))+" ")],1)],1)]}}],null,!1,286617302)},[r("span",[e._v(e._s(e.$t("App.menu.addJurisdiction.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-add-facility-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/questionnaire/gofr-facility-questionnaire/facility"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-hospital-building")]),e._v(e._s(e.$t("App.menu.addFacility.msg"))+" ")],1)],1)]}}],null,!1,3656909710)},[r("span",[e._v(e._s(e.$t("App.menu.addFacility.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-add-organization-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/questionnaire/gofr-organization-questionnaire/mcsd-organization"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-home-city")]),e._v(e._s(e.$t("App.menu.addOrganization.msg"))+" ")],1)],1)]}}],null,!1,983812558)},[r("span",[e._v(e._s(e.$t("App.menu.addOrganization.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-add-healthcare-service-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Add/service"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-room-service")]),e._v(e._s(e.$t("App.menu.addService.msg"))+" ")],1)],1)]}}],null,!1,2194227548)},[r("span",[e._v(e._s(e.$t("App.menu.addService.tooltip")))])])],1):e._e(),r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/ViewMap"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-google-maps")]),e._v(e._s(e.$t("App.menu.viewMap.msg"))+" ")],1)],1)]}}],null,!1,3231254354)},[r("span",[e._v(e._s(e.$t("App.menu.viewMap.tooltip")))])])],1),r("li",{staticClass:"parent"},[r("a",{attrs:{href:"#"}},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-call-made")]),e._v(" "+e._s(e.$t("App.menu.facilityRequests.msg"))+" "),r("v-icon",{staticClass:"menuArrow",attrs:{color:"black",small:""}},[e._v("mdi-play")])],1),r("ul",{staticClass:"child"},[e.tasksVerification.hasPermissionByName("special","custom","view-request-add-facility-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/questionnaire/gofr-facility-add-request-questionnaire/facility-add-request"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-call-made")]),e._v(e._s(e.$t("App.menu.requestNewFacility.msg"))+" ")],1)],1)]}}],null,!1,2821237455)},[r("span",[e._v(e._s(e.$t("App.menu.requestNewFacility.tooltip")))])])],1):e._e(),e.tasksVerification.hasPermissionByName("special","custom","view-request-update-facility-page")?r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-list-item",e._g({attrs:{to:"/Resource/Search/facility?searchAction=send-update-request"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-call-made")]),e._v(e._s(e.$t("App.menu.requestUpdateFacility.msg"))+" ")],1)],1)]}}],null,!1,2328103313)},[r("span",[e._v(e._s(e.$t("App.menu.requestUpdateFacility.tooltip")))])])],1):e._e()],1)])],1):e._e()]),r("li",{staticClass:"parent"},[r("a",{attrs:{href:"#"}},[r("v-icon",[e._v("mdi-account-outline")]),e._v(e._s(e.$t("App.menu.account.msg"))+" ")],1),r("ul",{staticClass:"child"},[r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return["Admin"===e.$store.state.auth.role?r("v-list-item",e._g({attrs:{to:"/addUser"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-account-outline")]),e._v(e._s(e.$t("App.menu.addUser.msg"))+" ")],1)],1):e._e()]}}])},[r("span",[e._v(e._s(e.$t("App.menu.addUser.tooltip")))])])],1),r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return["Admin"===e.$store.state.auth.role?r("v-list-item",e._g({attrs:{to:"/usersList"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-account-outline")]),e._v(e._s(e.$t("App.menu.usersList.msg"))+" ")],1)],1):e._e()]}}])},[r("span",[e._v(e._s(e.$t("App.menu.usersList.tooltip")))])])],1),r("v-list",{staticClass:"lastMenu"},[r("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return["Admin"===e.$store.state.auth.role?r("v-list-item",e._g({attrs:{to:"/rolesManagement"}},a),[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-account-outline")]),e._v(e._s(e.$t("App.menu.rolesManagement.msg"))+" ")],1)],1):e._e()]}}])},[r("span",[e._v(e._s(e.$t("App.menu.rolesManagement.tooltip")))])])],1),r("v-list",{staticClass:"lastMenu"},[r("v-list-item",{attrs:{to:"/changePassword"}},[r("v-list-item-title",{staticClass:"menuText"},[r("v-icon",{attrs:{left:"",color:"black"}},[e._v("mdi-account-outline")]),e._v(e._s(e.$t("App.menu.changePassword.msg"))+" ")],1)],1)],1)],1)]),e.tasksVerification.hasPermissionByName("special","custom","view-config-page")?r("li",{staticClass:"parent"},[e.$store.state.denyAccess?e._e():r("v-list-item",{staticClass:"newClass",attrs:{to:"/configure"}},[r("v-list-item-title",[r("v-icon",[e._v("mdi-cog")]),e._v(" "+e._s(e.$t("App.menu.configure.msg"))+" ")],1)],1)],1):e._e(),r("li",{staticClass:"parent"},[e.$store.state.denyAccess||e.$store.state.config.generalConfig.authDisabled?e._e():r("v-list-item",{staticClass:"newClass",attrs:{to:"/logout"}},[r("v-list-item-title",[r("v-icon",[e._v("mdi-logout")]),e._v(" "+e._s(e.$t("App.menu.logout.msg"))+" ")],1)],1)],1)])},h=[],v=r("2a6c"),p={data:function(){return{tasksVerification:v["a"]}}},g=p,f=(r("56e8"),r("2877")),m=r("6544"),y=r.n(m),S=r("132d"),$=r("8860"),b=r("da13"),x=r("5d23"),_=r("3a2f"),w=Object(f["a"])(g,d,h,!1,null,"2bf63d11",null),k=w.exports;y()(w,{VIcon:S["a"],VList:$["a"],VListItem:b["a"],VListItemTitle:x["c"],VTooltip:_["a"]});r("fb6a"),r("a15b"),r("d81d"),r("159b");var P={data:function(){return{roles:[],tasks:[]}},computed:{canAddDataset:function(){var e=this;if(this.$store.state.config.generalConfig.reconciliation.singleDataSource){var t,r=0,a=Object(n["a"])(this.$store.state.dataSources);try{var s=function(){var a=t.value;if(a.id===e.$store.state.config.generalConfig.reconciliation.fixSource2To)return"continue";var s=e.$store.state.auth.userID,o=e.$store.state.dhis.user.orgId,i=a.shared.users.find((function(e){return e.id===s})),n=a.owner.id===s,c=!0===a.shareToAll.activated,l=!1;if(a.owner.orgId&&a.owner.orgId===o&&(l=!0),!n&&!i&&!c&&!l)return"continue";r++};for(a.s();!(t=a.n()).done;)s()}catch(o){a.e(o)}finally{a.f()}return!(r>=1)||(this.datasetLimitWarn=!0,!1)}return!0}},methods:{flattenExtension:function(e){var t,r={},a=Object(n["a"])(e);try{for(a.s();!(t=a.n()).done;){for(var s=t.value,o="",i=0,c=Object.keys(s);i<c.length;i++){var l=c[i];"url"!==l&&(o=s[l])}r[s.url]?Array.isArray(r[s.url])?r[s.url].push(o):r[s.url]=[r[s.url],o]:Array.isArray(o)?r[s.url]=[o]:r[s.url]=o}}catch(u){a.e(u)}finally{a.f()}return r},getCodeSystem:function(e,t){u.a.get("/FR/getCodeSystem",{params:{codeSystemType:e}}).then((function(e){return t(null,e.data)})).catch((function(e){return console.log(e),t(e,null)}))},getTree:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;u.a.get("/FR/getTree",{params:{includeBuilding:e,recursive:t}}).then((function(e){if(e.data){var t=!1;return r(t,e.data)}})).catch((function(e){return r(e,[])}))},clearProgress:function(e){u.a.get("/clearProgress/"+e+"/"+this.$store.state.clientId)},getGeneralConfig:function(e){var t=this,r=JSON.stringify(this.$store.state.config.generalConfig);u.a.get("/config/getGeneralConfig?defaultGenerConfig="+r).then((function(r){return r&&(t.$store.state.config.generalConfig=r.data.generalConfig),e()})).catch((function(){return e()}))},toTitleCase:function(e){return e.toLowerCase().split(" ").map((function(e){return e.replace(e[0],e[0].toUpperCase())})).join("").toLowerCase()},translateDataHeader:function(e,t){var r=this.$store.state.config.userConfig.reconciliation.useCSVHeader,a=this.$store.state.levelMapping;if(!r||r&&a[e]["level"+t]==="level"+t)return"Level "+t;if(Object.keys(this.$store.state.levelMapping[e]).length>0){var s,o=this.$store.state.levelMapping[e],i=1;for(var n in o)0===n.indexOf("level")&&i++;"source1"===e&&(s=this.$store.state.totalSource1Levels),"source2"===e&&(s=this.$store.state.totalSource2Levels),s--;var c=i-s;t+=c;var l=this.$store.state.levelMapping[e]["level"+t];return l&&"null"!==l&&"undefined"!==l&&"false"!==l?l:this.$store.state.levelMapping[e]["facility"]}return"Level "+t},getActiveDataSourcePair:function(){var e,t=this,r={};return this.$store.state.dataSourcePairs.forEach((function(a){a.user.id===t.$store.state.auth.userID&&"active"===a.status&&(r=a),Object.keys(r).length>0?e=void 0:a.user.id!==t.$store.state.auth.userID&&a.activeUsers.find((function(e){return e.id===t.$store.state.auth.userID}))&&(e=a)})),e&&(r=e),r},getDatasourceOwner:function(){var e={source1Owner:"",source2Owner:""};return this.$store.state.activePair.source1.hasOwnProperty("userID")&&(e.source1Owner=this.$store.state.activePair.source1.userID),this.$store.state.activePair.source2.hasOwnProperty("userID")&&(e.source2Owner=this.$store.state.activePair.source2.userID),e},getLimitOrgIdOnActivePair:function(){var e=this,t={source1LimitOrgId:[],source2LimitOrgId:[]},r=this.$store.state.dataSources.find((function(t){return t.id===e.$store.state.activePair.source1.id})),a=this.$store.state.dataSources.find((function(t){return t.id===e.$store.state.activePair.source2.id}));if(r&&r.hasOwnProperty("userID")&&r.userID!==this.$store.state.auth.userID){var s=r.sharedUsers.find((function(t){return t.id===e.$store.state.auth.userID}));s&&s.limits.length>0?t.source1LimitOrgId=s.limits:r.shareToAll.activated&&r.shareToAll.limitByUserLocation&&this.$store.state.dhis.user.orgId&&(t.source1LimitOrgId=[this.$store.state.dhis.user.orgId])}if(a&&a.hasOwnProperty("userID")&&a.userID!==this.$store.state.auth.userID){var o=a.sharedUsers.find((function(t){return t.id===e.$store.state.auth.userID}));o&&o.limits.length>0?t.source2LimitOrgId=o.limits:a.shareToAll.activated&&a.shareToAll.limitByUserLocation&&this.$store.state.dhis.user.orgId&&(t.source2LimitOrgId=[this.$store.state.dhis.user.orgId])}return t},getLimitOrgIdOnDataSource:function(e){var t=this,r=[];if(e&&e.hasOwnProperty("userID")&&e.userID!==this.$store.state.auth.userID){var a=e.sharedUsers.find((function(e){return e.id===t.$store.state.auth.userID}));a&&a.limits.length>0?r=a.limits:e.shareToAll.activated&&e.shareToAll.limitByUserLocation&&this.$store.state.dhis.user.orgId&&(r=[this.$store.state.dhis.user.orgId])}return r},getRoles:function(){var e=this;u.a.get("/getRoles").then((function(t){var r,a=Object(n["a"])(t.data);try{for(a.s();!(r=a.n()).done;){var s=r.value;e.roles.push({text:s.name,value:s.id,tasks:s.tasks})}}catch(o){a.e(o)}finally{a.f()}})).catch((function(e){console.log(e.response)}))},getTasks:function(){var e=this;u.a.get("/getTasks").then((function(t){e.tasks=t.data})).catch((function(e){console.log(e.response)}))},saveConfiguration:function(e,t){var r,a=this,s=this.$store.state.auth.userID,o=new FormData;o.append("config",JSON.stringify(this.$store.state.config)),o.append("userID",s),r="generalConfig"===e?"/config/updateGeneralConfig":"/config/updateUserConfig/".concat(this.$store.state.auth.userID),u.a.post(r,o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){"useCSVHeader"===t&&Oa.$emit("changeCSVHeaderNames"),"authDisabled"===t&&a.$router.push({name:"Logout"})}))},setDHIS2Credentials:function(){this.$store.state.auth.userID="";var e=location.href.split("api");return!(e.length<2)&&(this.$store.state.dhis.host=location.href.split("api").shift(),u.a.defaults.params={authDisabled:!0},!0)}}},D=u.a.CancelToken,C={mixins:[P],data:function(){return{loadingSource2Unmatched:!1,loadingSource1Unmatched:!1,topTree:""}},methods:{scoreProgressCheckTimeout:function(){this.$store.state.scoresProgressData.scoreProgressTitle="Server is busy with automatching, please be patient",clearInterval(this.$store.state.scoresProgressData.progressReqTimer);var e=parseInt(this.$store.state.scoresProgressData.scoreProgressPercent);100!==e||100===e&&"last"!==this.$store.state.scoresProgressData.stage?(this.$store.state.scoresProgressData.requestCancelled=!0,this.$store.state.scoresProgressData.cancelTokenSource.cancel("Cancelling request."),this.checkScoreProgress()):this.$store.state.scoresProgressData.scoreProgressTitle="Please be patient, waiting for server response"},scoreSavingProgressCheckTimeout:function(){clearInterval(this.$store.state.scoreSavingProgressData.progressReqTimer),this.$store.state.scoreSavingProgressData.requestCancelled=!0,this.$store.state.scoreSavingProgressData.cancelTokenSource.cancel("Cancelling request."),this.checkScoreSavingStatus(),this.saveProgressTimedout=!0},checkScoreProgress:function(){var e,t=this;this.$store.state.scoresProgressData.cancelTokenSource=D.source();var r=parseInt(this.$store.state.scoresProgressData.scoreProgressPercent);e=r>96?402382:1e4,this.$store.state.scoresProgressData.progressReqTimer=setInterval(this.scoreProgressCheckTimeout,e);var a=this.$store.state.clientId;u.a.get("/progress/scoreResults/"+a,{cancelToken:this.$store.state.scoresProgressData.cancelTokenSource.token}).then((function(e){if(clearInterval(t.$store.state.scoresProgressData.progressReqTimer),!e.data||!(e.data.status||e.data.percent||e.data.error||0!==t.$store.state.scoreResults.length))return t.$store.state.scoresProgressData.scoreDialog=!1,t.$store.state.scoresProgressData.scoreProgressTitle="Waiting for progress status",t.$store.state.errorTitle="An error has occured",t.$store.state.errorDescription="An error has occured while reaching out to server, please click recalculate scores to restart automatch",t.$store.state.errorColor="error",t.$store.state.dialogError=!0,t.clearProgress("scoreResults"),t.$store.state.scoreSavingProgressData.savingMatches=!0,void t.checkScoreSavingStatus();if(null===e.data.status&&null===e.data.percent&&null===e.data.error&&t.$store.state.scoreResults.length>0)return t.$store.state.scoresProgressData.scoreDialog=!1,t.$store.state.scoresProgressData.scoreProgressTitle="Waiting for progress status",t.clearProgress("scoreResults"),t.$store.state.scoreSavingProgressData.savingMatches=!0,void t.checkScoreSavingStatus();if(t.$store.state.scoresProgressData.scoreProgressTitle=e.data.status,e.data.percent&&("percent"!==t.$store.state.scoresProgressData.progressType&&(t.$store.state.scoresProgressData.progressType="percent"),t.$store.state.scoresProgressData.scoreProgressPercent=e.data.percent,t.$store.state.scoresProgressData.stage=e.data.stage),"Done"===e.data.status&&0===t.$store.state.scoreResults.length){t.clearProgress("scoreResults"),t.$store.state.scoreSavingProgressData.savingMatches=!0,t.checkScoreSavingStatus(),t.loadingSource1Unmatched=!1,t.loadingSource2Unmatched=!1;var r=e.data.responseData;t.$store.state.source2UnMatched=r.source2Unmatched,t.$store.state.source1UnMatched=[],t.$store.state.matchedContent=[],t.$store.state.noMatchContent=[],t.$store.state.ignoreContent=[],t.$store.state.flagged=[],t.$store.state.scoreResults=r.scoreResults,t.$store.state.source2TotalRecords=r.source2TotalRecords,t.$store.state.source2TotalAllRecords=r.source2TotalAllRecords,t.$store.state.totalAllMapped=r.totalAllMapped,t.$store.state.totalAllFlagged=r.totalAllFlagged,t.$store.state.totalAllNoMatch=r.totalAllNoMatch,t.$store.state.totalAllIgnore=r.totalAllIgnore,t.$store.state.source1TotalAllNotMapped=r.source1TotalAllNotMapped,t.$store.state.source1TotalAllRecords=r.source1TotalAllRecords;var a,s=Object(n["a"])(t.$store.state.scoreResults);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.source1.hasOwnProperty("tag")&&"flagged"===o.source1.tag)t.$store.state.flagged.push({source1Name:o.source1.name,source1Id:o.source1.id,source1IdHierarchy:o.source1.source1IdHierarchy,source1Parents:o.source1.parents,source2Name:o.exactMatch.name,source2Id:o.exactMatch.id,source2IdHierarchy:o.exactMatch.source2IdHierarchy,mappedParentName:o.exactMatch.mappedParentName,source2Parents:o.exactMatch.parents,flagComment:o.source1.flagComment});else if(o.source1.hasOwnProperty("tag")&&"noMatch"===o.source1.tag){var i=o.source1.parents;t.$store.state.noMatchContent.push({source1Name:o.source1.name,source1Id:o.source1.id,parents:i})}else if(o.source1.hasOwnProperty("tag")&&"ignore"===o.source1.tag){var c=o.source1.parents;t.$store.state.ignoreContent.push({source1Name:o.source1.name,source1Id:o.source1.id,parents:c})}else if(Object.keys(o.exactMatch).length>0)t.$store.state.matchedContent.push({source1Name:o.source1.name,source1Id:o.source1.id,source1Parents:o.source1.parents,source2Name:o.exactMatch.name,source2Id:o.exactMatch.id,source2IdHierarchy:o.exactMatch.source2IdHierarchy,mappedParentName:o.exactMatch.mappedParentName,source2Parents:o.exactMatch.parents,matchComments:o.exactMatch.matchComments});else{for(var l=t.topTree,u=o.source1.parents.length-1;u>=0;u--)l[o.source1.parents[u]]||(l[o.source1.parents[u]]={}),l=l[o.source1.parents[u]];t.$store.state.source1UnMatched.push({name:o.source1.name,id:o.source1.id,parents:o.source1.parents})}}}catch(d){s.e(d)}finally{s.f()}t.$store.state.source1Parents=t.topTree,t.$store.state.scoresProgressData.scoreDialog=!1,t.$store.state.scoresProgressData.scoreProgressTitle="Waiting for progress status"}else t.checkScoreProgress()})).catch((function(){t.$store.state.scoresProgressData.requestCancelled?t.$store.state.scoresProgressData.requestCancelled=!1:(clearInterval(t.$store.state.scoresProgressData.progressReqTimer),t.checkScoreProgress())}))},checkScoreSavingStatus:function(){var e=this;this.$store.state.scoreSavingProgressData.cancelTokenSource=D.source(),this.$store.state.scoreSavingProgressData.progressReqTimer=setInterval(this.scoreSavingProgressCheckTimeout,1e4);var t=this.$store.state.clientId;u.a.get("/progress/scoreSavingStatus/"+t,{cancelToken:this.$store.state.scoreSavingProgressData.cancelTokenSource.token}).then((function(t){return clearInterval(e.$store.state.scoreSavingProgressData.progressReqTimer),t.data&&(t.data.status||t.data.percent||t.data.error||!e.$store.state.scoreSavingProgressData.savingMatches)?t.data.status||t.data.percent||t.data.error||e.$store.state.scoreSavingProgressData.savingMatches?(t.data.percent&&(e.$store.state.scoreSavingProgressData.percent=t.data.percent),void(100===t.data.percent?(e.$store.state.scoreSavingProgressData.savingMatches=!1,e.$store.state.scoreSavingProgressData.percent=0,e.clearProgress("scoreSavingStatus")):e.checkScoreSavingStatus())):(e.$store.state.scoreSavingProgressData.savingMatches=!1,e.$store.state.scoreSavingProgressData.percent=0,void e.clearProgress("scoreSavingStatus")):(e.$store.state.errorTitle="An error has occured",e.$store.state.errorDescription="An error has occured while checking saving status",e.$store.state.errorColor="error",e.$store.state.dialogError=!0,e.$store.state.scoreSavingProgressData.savingMatches=!1,e.$store.state.scoreSavingProgressData.percent=0,void e.clearProgress("scoreSavingStatus"))})).catch((function(){e.$store.state.scoreSavingProgressData.requestCancelled?e.$store.state.scoreSavingProgressData.requestCancelled=!1:(clearInterval(e.$store.state.scoreSavingProgressData.progressReqTimer),e.checkScoreSavingStatus())}))},getScores:function(e){var t=this;e||(e=!1);var r=this.getSource1(),a=this.getSource2(),s=this.getDatasourceOwner();if(this.$store.state.source1UnMatched=[],this.$store.state.source2UnMatched=[],this.$store.state.matchedContent=[],this.$store.state.noMatchContent=[],this.$store.state.ignoreContent=[],this.$store.state.flagged=[],this.$store.state.source1TotalAllRecords=0,this.$store.state.totalAllMapped=0,this.$store.state.totalAllFlagged=0,this.$store.state.totalAllNoMatch=0,this.$store.state.totalAllIgnore=0,this.$store.state.source2TotalRecords=0,this.$store.state.scoreResults=[],r&&a){this.loadingSource1Unmatched=!0,this.loadingSource2Unmatched=!0,this.$store.state.scoresProgressData.scoreDialog=!0,this.$store.state.scoresProgressData.scoreProgressTitle="Waiting for progress status",this.$store.state.scoresProgressData.progressType="indeterminate";var o=this.$store.state.recoLevel,i=this.$store.state.totalSource1Levels,n=this.$store.state.totalSource2Levels,c=this.$store.state.clientId;this.topTree=this.$store.state.source1Parents.slice(0,this.$store.state.source1Parents.length),this.$store.state.levelArray=[];for(var l=1;l<this.$store.state.totalSource1Levels;l++){var d=void 0;l+1>this.$store.state.recoLevel||(d=this.translateDataHeader("source1",l),this.$store.state.levelArray.push({text:d,value:l+1}))}var h=this.$store.state.activePair.userID,v=s.source1Owner,p=s.source2Owner,g=this.getLimitOrgIdOnActivePair().source1LimitOrgId,f=this.getLimitOrgIdOnActivePair().source2LimitOrgId,m=JSON.stringify(this.$store.state.config.generalConfig.reconciliation.parentConstraint),y="source1=".concat(r,"&source2=").concat(a,"&source1Owner=").concat(v,"&source2Owner=").concat(p,"&source1LimitOrgId=").concat(g,"&source2LimitOrgId=").concat(f,"&totalSource1Levels=").concat(i,"&totalSource2Levels=").concat(n);y+="&recoLevel=".concat(o,"&clientId=").concat(c,"&userID=").concat(h,"&parentConstraint=")+m+"&getPotential="+e,u.a.get("/match/reconcile/?"+y).then((function(){t.checkScoreProgress()}))}},getSource1:function(){var e=this.$store.state.activePair.source1.display;return e&&(e=this.toTitleCase(e)),e},getSource2:function(){var e=this.$store.state.activePair.source2.display;return e&&(e=this.toTitleCase(e)),e},getSource1Name:function(){return this.$store.state.activePair.source1.display},getSource2Name:function(){return this.$store.state.activePair.source2.display}},created:function(){var e=this;Oa.$on("changeCSVHeaderNames",(function(){e.$store.state.levelArray=[];for(var t=1;t<e.$store.state.totalSource1Levels;t++){var r=void 0;t+1>e.$store.state.recoLevel||(r=e.translateDataHeader("source1",t),e.$store.state.levelArray.push({text:r,value:t+1}))}}))}},T={methods:{createDatasourcePair:function(e,t){var r=this;if(0===Object.keys(e).length||0===Object.keys(t).length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source");if(e.name===t.name&&e.source===t.source)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Data source pair of the same data source is not allowed, change one of the source");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Creating Data Source Pair";var a=null;this.$store.state.activePair.hasOwnProperty("shared")&&-1!==this.$store.state.activePair.activeUsers.indexOf(this.$store.state.auth.userID)&&(a=this.$store.state.activePair.id);var s=!1;this.$store.state.dhis.user.orgId&&this.$store.state.config.generalConfig.reconciliation.singlePair&&(s=!0),a||(a=!1);var o=new FormData;o.append("source1",JSON.stringify(e)),o.append("source2",JSON.stringify(t)),o.append("userID",this.$store.state.auth.userID),o.append("orgId",this.$store.state.dhis.user.orgId),o.append("singlePair",s),o.append("activePairID",a),u.a.post("/datasource/createSourcePair",o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){r.$store.state.levelMapping.source1=JSON.parse(e.data.levelMapping1),r.$store.state.levelMapping.source2=JSON.parse(e.data.levelMapping2),Oa.$emit("getDataSourcePair"),r.$store.state.dynamicProgress=!1})).catch((function(e){r.alertError=!0,r.$store.state.dialogError=!0,e.response&&e.response.data&&e.response.data.error?(r.$store.state.errorDescription=e.response.data.error,r.$store.state.errorTitle="Pair was not created",r.alertMsg=e.response.data.error):r.alertMsg="Something went wrong while saving data source pairs.",r.$store.state.dynamicProgress=!1,console.log(e)}))},activateSharedPair:function(e){var t=this;this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Activating Shared Data Source Pair";var r=new FormData;r.append("pairID",e),r.append("userID",this.$store.state.auth.userID),u.a.post("/datasource/activateSharedPair",r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){Oa.$emit("getDataSourcePair"),t.$store.state.dynamicProgress=!1})).catch((function(e){t.alertError=!0,t.alertMsg="Something went wrong while activating data source pair",t.$store.state.dynamicProgress=!1,console.log(e.response.data)}))},activatePair:function(){var e=this;this.activeDataSourcePair.userID!==this.$store.state.auth.userID?this.activateSharedPair(this.activeDataSourcePair.id):(this.source1=this.$store.state.dataSources.find((function(t){return t.id===e.activeDataSourcePair.source1.id})),this.source2=this.$store.state.dataSources.find((function(t){return t.id===e.activeDataSourcePair.source2.id})),this.createDatasourcePair(this.source1,this.source2))}}},I=r("9612"),A=r("2b27"),L=r.n(A),O={mixins:[T,C,P],props:["generalConfig"],data:function(){return{items:[{title:"Click Me"},{title:"Click Me"},{title:"Click Me"},{title:"Click Me 2"}],fixed:!1,title:this.$t("App.title"),locale:"en",locales:[{text:"English",value:"en"},{text:"French",value:"fr"}],activeDataSourcePair:{},tasksVerification:v["a"]}},watch:{locale:function(e){this.$i18n.locale=e}},methods:{closeDialogError:function(){this.$store.state.errorColor="primary",this.$store.state.dialogError=!1},renderInitialPage:function(){var e=this,t=this.$store.state.activePair.source1.name,r=this.$store.state.activePair.source2.name;t&&r||!(this.$store.state.dataSources.length>1||this.$store.state.dataSourcePairs.length>0)?t&&r?u.a.get("/uploadAvailable/"+t+"/"+r).then((function(t){e.$store.state.initializingApp=!1,t.data.dataUploaded?(e.$store.state.recalculateScores=!0,e.$router.push({name:"FacilityReconScores"})):e.$router.push({name:"AddDataSources"})})).catch((function(t){console.log(t),e.$router.push({name:"AddDataSources"})})):this.$router.push({name:"AddDataSources"}):this.$router.push({name:"DataSourcesPair"})},getTotalLevels:function(){var e=this,t=this.$store.state.activePair.source1.name,r=this.$store.state.activePair.source2.name,a=this.$store.state.activePair.source1.id,s=this.$store.state.activePair.source2.id;if(!t||!r)return this.$store.state.totalSource1Levels=5,this.$store.state.totalSource2Levels=5,this.$store.state.initializingApp=!1,this.renderInitialPage(),this.$store.state.recoLevel=2,void this.getRecoStatus();var o=JSON.stringify(this.getLimitOrgIdOnActivePair());u.a.get("/datasource/countLevels?source1Id=".concat(a,"&source1DB=").concat(t,"&source2Id=").concat(s,"&source2DB=").concat(r,"&sourcesLimitOrgId=").concat(o)).then((function(t){e.$store.state.levelMapping.source1=t.data.levelMapping.levelMapping1,e.$store.state.levelMapping.source2=t.data.levelMapping.levelMapping2,e.$store.state.totalSource1Levels=t.data.totalSource1Levels,e.$store.state.totalSource2Levels=t.data.totalSource2Levels,e.$store.state.recoLevel=2,e.renderInitialPage(),e.getRecoStatus()})).catch((function(t){console.log(t),e.$store.state.recoLevel=2,e.renderInitialPage(),e.getRecoStatus()}))},getRecoStatus:function(){var e=this;if(0!==Object.keys(this.$store.state.activePair.source1).length&&0!==Object.keys(this.$store.state.activePair.source2).length){var t=this.toTitleCase(this.$store.state.activePair.source1.name),r=this.toTitleCase(this.$store.state.activePair.source2.name),a=this.$store.state.activePair.userID;u.a.get("/match/recoStatus/"+t+"/"+r+"/"+a).then((function(s){s.data.status?e.$store.state.recoStatus=s.data.status:u.a.get("/match/markRecoUnDone/"+t+"/"+r+"/"+a).then((function(t){t.data.status&&(e.$store.state.recoStatus=t.data.status)})).catch((function(e){console.log(e.response.data.error)}))})).catch((function(e){console.log(e.response.data.error)}))}},getDataSources:function(){var e=this;this.$store.state.loadingServers=!0,this.$store.state.dataSources=[];var t=this.$store.state.auth.userID,r=this.$store.state.auth.role,a=this.$store.state.dhis.user.orgId;u.a.get("/datasource/getSource/"+t+"/"+r+"/"+a).then((function(t){e.$store.state.loadingServers=!1,e.$store.state.dataSources=t.data.sources,e.getDataSourcePair()})).catch((function(t){e.$store.state.loadingServers=!1,console.log(JSON.stringify(t))}))},getUserConfig:function(){var e=this,t=this.$store.state.auth.userID;u.a.get("/config/getUserConfig/"+t).then((function(t){t.data&&(e.$store.state.config.userConfig=Object(c["a"])(Object(c["a"])({},e.$store.state.config.userConfig),t.data)),e.getDataSources()})).catch((function(){e.getDataSources()}))},getDataSourcePair:function(){var e=this;this.$store.state.activePair.source1={},this.$store.state.activePair.source2={};var t=this.$store.state.auth.userID;this.$store.state.initializingApp||(this.$store.state.initializingApp=!0),u.a.get("/datasource/getSourcePair/"+t+"/"+this.$store.state.dhis.user.orgId).then((function(t){e.$store.state.dataSourcePairs=t.data;var r=e.getActiveDataSourcePair();Object.keys(r).length>0&&(e.$store.state.activePair.source1.id=r.source1.id,e.$store.state.activePair.source1.name=r.source1.name,e.$store.state.activePair.source1.display=r.source1.display,e.$store.state.activePair.source1.userID=r.source1.user.id,e.$store.state.activePair.source2.id=r.source2.id,e.$store.state.activePair.source2.name=r.source2.name,e.$store.state.activePair.source2.display=r.source2.display,e.$store.state.activePair.source2.userID=r.source2.user.id,e.$store.state.activePair.id=r.id,e.$store.state.activePair.shared=r.sharedUsers,e.$store.state.activePair.activeUsers=r.activeUsers,e.$store.state.activePair.userID=r.user.id),e.autoActivateDatasourcePair((function(t){t||e.autoCreateDatasourcePair()})),e.getTotalLevels()})).catch((function(t){console.log(JSON.stringify(t)),e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription="An error occured while getting data source pairs, reload the app to retry",e.getTotalLevels()}))},autoCreateDatasourcePair:function(){var e=this;if(this.$store.state.config.generalConfig.reconciliation.singleDataSource){var t=function(){if(Object.keys(e.$store.state.activePair.source1).length>0)return{v:!1};var t,r=e.$store.state.config.generalConfig.reconciliation.fixSource2To,a={},s={},o=e.$store.state.auth.userID,i=e.$store.state.dhis.user.orgId,c=[],l=Object(n["a"])(e.$store.state.dataSources);try{for(l.s();!(t=l.n()).done;){var u=t.value,d=u.shared.users.find((function(e){return e.id===o})),h=u.owner.id===o,v=!0===u.shareToAll.activated,p=!1;u.owner.orgId&&u.owner.orgId===i&&(p=!0),(h||d||v||p)&&(u.id===r?s=u:a=u,c.push(u))}}catch(g){l.e(g)}finally{l.f()}if(c.length>2||0===Object.keys(a).length||0===Object.keys(s).length)return{v:!1};e.createDatasourcePair(a,s)}();if("object"===Object(i["a"])(t))return t.v}},autoActivateDatasourcePair:function(e){if(Object.keys(this.$store.state.activePair.source1).length>0){var t=!1;return e(t)}if(this.$store.state.dataSourcePairs.length>1||0===this.$store.state.dataSourcePairs.length){var r=!1;return e(r)}if(this.$store.state.dhis.user.orgId&&this.$store.state.config.generalConfig.reconciliation.singlePair){this.$store.state.dataSourcePairs.status="active",this.activeDataSourcePair=this.$store.state.dataSourcePairs[0];var a=!0;e(a),this.activatePair()}else{var s=!1;e(s)}}},computed:{dhisLink:function(){return!!this.$store.state.dhis.user.orgId&&window.location.protocol+"//"+window.location.hostname}},components:{appMenu:k},created:function(){var e=this;this.$store.state.auth.role="Admin",this.$router.push({name:"AddDataSources"}),this.$store.state.config.generalConfig=this.generalConfig,"keycloak"===this.$store.state.idp?(this.$store.state.clientId=I["a"].v4(),this.$store.state.initializingApp=!0,this.$store.state.denyAccess=!1,this.getUserConfig()):L.a.get("userID")&&(this.$store.state.auth.userID=L.a.get("userID"),this.$store.state.auth.username=L.a.get("username"),this.$store.state.auth.role=L.a.get("role"),this.$store.state.auth.tasks=JSON.parse(L.a.get("tasks")),this.$store.state.config.generalConfig.authDisabled?this.$router.push("login"):u.a.get("/isSessionActive/").then((function(){e.$store.state.clientId=I["a"].v4(),e.$store.state.initializingApp=!0,e.$store.state.denyAccess=!1,e.getUserConfig()}))),Oa.$on("refreshApp",(function(){e.getDataSources()})),Oa.$on("recalculateScores",(function(){e.$store.state.recalculateScores=!0,e.$router.push({name:"FacilityReconScores"})})),Oa.$on("getDataSources",(function(){e.getDataSources()})),Oa.$on("getUserConfig",(function(){e.getUserConfig()})),Oa.$on("getGeneralConfig",(function(){e.getGeneralConfig()})),Oa.$on("getDataSourcePair",(function(){e.getDataSourcePair()}))},mounted:function(){var e=document.getElementsByTagName("html")[0];e.style.overflowY="auto"},destroyed:function(){var e=document.getElementsByTagName("html")[0];e.style.overflowY=null},name:"App"},N=O,V=r("0798"),R=r("7496"),M=r("40dc"),U=r("8336"),E=r("b0af"),F=r("99d9"),q=r("62ad"),H=r("169a"),j=r("0e8f"),B=r("553a"),W=r("a722"),G=r("f6c4"),z=r("8e36"),J=r("0fd9"),Y=r("b974"),K=r("2db4"),X=r("2fa4"),Z=r("71d9"),Q=r("2a7f"),ee=Object(f["a"])(N,s,o,!1,null,null,null),te=ee.exports;y()(ee,{VAlert:V["a"],VApp:R["a"],VAppBar:M["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCol:q["a"],VDialog:H["a"],VFlex:j["a"],VFooter:B["a"],VIcon:S["a"],VLayout:W["a"],VMain:G["a"],VProgressLinear:z["a"],VRow:J["a"],VSelect:Y["a"],VSnackbar:K["a"],VSpacer:X["a"],VToolbar:Z["a"],VToolbarItems:Q["a"],VToolbarTitle:Q["b"]});r("3ca3"),r("ddb0");var re=r("8c4f"),ae=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("center",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}}),r("v-flex",{attrs:{xs6:""}},[r("v-alert",{attrs:{type:"error",value:e.authStatus}},[e._v(" Authentication Failed ")])],1)],1),r("v-card",{attrs:{width:"430px",hover:""}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{color:"white"},attrs:{color:"primary"}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs2:"","text-xs-left":""}},[r("v-icon",{attrs:{"x-large":"",color:"white"}},[e._v("mdi-lock")])],1),r("v-flex",{attrs:{xs9:"","text-xs-right":""}},[r("b",[e._v("Login")])])],1)],1)],1),r("v-card-text",[r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,filled:"",color:"deep-purple",label:"Username"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()},blur:function(t){return e.$v.username.$touch()},change:function(t){return e.$v.username.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,filled:"",type:"password",color:"deep-purple",label:"Password"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()},blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),r("v-card-actions",[r("v-toolbar",[e.$store.state.config.generalConfig.selfRegistration.enabled?r("v-btn",{attrs:{color:"primary"},on:{click:e.displaySignup}},[e._v("Signup")]):e._e(),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"primary",depressed:""},on:{click:function(t){return e.authenticate()}}},[e._v("Login")])],1)],1)],1)],1)],1)},se=[],oe=r("b5ae"),ie={validations:{username:{required:oe["required"]},password:{required:oe["required"]}},data:function(){return{username:"",password:"",authStatus:!1,signupEnabled:!1}},methods:{authenticate:function(){var e=this;u.a.post("/auth/login/",{username:this.username,password:this.password}).then((function(t){e.$store.state.auth.username=e.username,e.$store.state.auth.userID=t.data.userID,e.$store.state.auth.role=t.data.role,e.$store.state.auth.tasks=t.data.tasks,L.a.config("30d"),L.a.set("userID",e.$store.state.auth.userID,"infinity"),L.a.set("role",e.$store.state.auth.role,"infinity"),L.a.set("tasks",JSON.stringify(e.$store.state.auth.tasks),"infinity"),L.a.set("username",e.$store.state.auth.username,"infinity"),e.$store.state.auth.role=t.data.role,t.data.userID?(e.$store.state.clientId=I["a"].v4(),e.$store.state.initializingApp=!0,e.$store.state.denyAccess=!1,Oa.$emit("getUserConfig")):e.authStatus=!0})).catch((function(t){t.hasOwnProperty("response")&&console.log(t.response.data.error),e.authStatus=!0}))},displaySignup:function(){this.$router.push({name:"Signup"})}},computed:{usernameErrors:function(){var e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e}},beforeCreate:function(){this.$store.state.config.generalConfig.authDisabled&&(this.$store.state.clientId=I["a"].v4(),this.$store.state.initializingApp=!0,this.$store.state.denyAccess=!1,this.$router.push({name:"DHIS2Auth"}))}},ne=ie,ce=r("a523"),le=r("4bd4"),ue=r("8654"),de=Object(f["a"])(ne,ae,se,!1,null,null,null),he=de.exports;y()(de,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VContainer:ce["a"],VFlex:j["a"],VForm:le["a"],VIcon:S["a"],VLayout:W["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbar:Z["a"]});var ve=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-xs":""}})},pe=[],ge={mounted:function(){L.a.remove("userID"),L.a.remove("role"),L.a.remove("username"),L.a.remove("userObj"),L.a.remove("tasks"),"keycloak"===this.$store.state.idp?this.$keycloak.logout():this.$router.push("login")}},fe=ge,me=Object(f["a"])(fe,ve,pe,!1,null,null,null),ye=me.exports;y()(me,{VContainer:ce["a"]});var Se=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-alert",{staticStyle:{width:"900px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-alert",{staticStyle:{width:"900px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertFail,callback:function(t){e.alertFail=t},expression:"alertFail"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"1500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",text:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Create Account")])],1),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-layout",{attrs:{column:"",wrap:""}},[r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.firstnameErrors,filled:"",color:"deep-purple",label:"First Name"},on:{blur:function(t){return e.$v.firstname.$touch()},change:function(t){return e.$v.firstname.$touch()}},model:{value:e.firstname,callback:function(t){e.firstname=t},expression:"firstname"}})],1),r("v-spacer"),r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.surnameErrors,filled:"",color:"deep-purple",label:"Surname"},on:{blur:function(t){return e.$v.surname.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.surname,callback:function(t){e.surname=t},expression:"surname"}})],1)],1)],1),r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{filled:"",color:"deep-purple",label:"Middle Names"},model:{value:e.othername,callback:function(t){e.othername=t},expression:"othername"}})],1),r("v-spacer"),r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.phoneErrors,filled:"",color:"deep-purple",label:"Phone"},on:{blur:e.validatePhone,change:e.validatePhone,input:e.validatePhone},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1)],1)],1),r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.emailErrors,filled:"",color:"deep-purple",label:"Email*"},on:{blur:e.validateEmail,change:e.validateEmail,input:e.validateEmail},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),r("v-spacer"),r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,filled:"",color:"deep-purple",label:"Username"},on:{blur:function(t){return e.$v.username.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1)],1),r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Password"},on:{blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),r("v-spacer"),r("v-flex",{attrs:{xs5:""}},[r("v-text-field",{attrs:{required:"","error-messages":e.retype_passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Re-type Password"},on:{blur:function(t){return e.$v.retype_password.$touch()},change:function(t){return e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}})],1)],1)],1)],1)],1),r("v-divider"),r("v-card-actions",[r("v-btn",{attrs:{text:""},on:{click:function(t){return e.$refs.form.reset()}}},[r("v-icon",[e._v("mdi-close")]),e._v("Clear ")],1),r("v-spacer"),r("v-btn",{attrs:{text:""},on:{click:e.displayLogin}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-lock")]),e._v("Back To Login ")],1),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){return e.signup()}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v("Add ")],1)],1)],1)],1),r("v-spacer")],1)],1)},$e=[],be={validations:{username:{required:oe["required"]},retype_password:{required:oe["required"]},password:{required:oe["required"]},firstname:{required:oe["required"]},surname:{required:oe["required"]},phone:{required:oe["required"]},email:{required:oe["required"]}},data:function(){return{firstname:"",othername:"",surname:"",phone:"",email:"",username:"",password:"",retype_password:"",customFields:[],phoneErrors:[],emailErrors:[],alertFail:!1,alertSuccess:!1,alertMsg:""}},methods:{validateEmail:function(){if(this.emailErrors=[],!this.email)return this.emailErrors.push("Email is required"),!1;var e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return e.test(this.email)?void 0:(this.emailErrors.push("Invalid Email"),!1)},validatePhone:function(){if(this.phoneErrors=[],!this.phone)return this.phoneErrors.push("Phone is required");var e=/^[+]?[\s./0-9]*[(]?[0-9]{1,4}[)]?[-\s./0-9]*$/g;return e.test(this.phone)?void 0:this.phoneErrors.push("Invalid phone number")},signup:function(){var e=this;this.password!==this.retype_password&&(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",this.$store.state.errorDescription="Password mismatch"),this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Creating Account";var t=new FormData;for(var r in t.append("firstName",this.firstname),t.append("otherName",this.othername),t.append("surname",this.surname),t.append("phone",this.phone),t.append("email",this.email),t.append("password",this.password),t.append("userName",this.username),this.$store.state.config.generalConfig.selfRegistration.requiresApproval&&t.append("status","Pending"),this.customFields)t.append(r,this.customFields[r]);u.a.post("/addUser/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){for(var t=Object.keys(e.$v.$params),r=0,a=t;r<a.length;r++){var s=a[r];e.$v[s].$reset()}e.$refs.form.reset(),e.$store.state.dynamicProgress=!1,e.alertSuccess=!0,e.$store.state.config.generalConfig.selfRegistration.requiresApproval?e.alertMsg="Account created and waiting for approval, you will receive an email once approved":e.alertMsg="Account created successfully"})).catch((function(t){e.$store.state.dynamicProgress=!1,e.alertFail=!0,e.alertMsg="This account was not added, try different username",console.log(t.response.data.error)}))},displayLogin:function(){this.$router.push({name:"Login"})}},computed:{codeErrors:function(){var e=[];return this.$v.code.$dirty?(!this.$v.code.required&&e.push("Code is required"),e):e},firstnameErrors:function(){var e=[];return this.$v.firstname.$dirty?(!this.$v.firstname.required&&e.push("First Name is required"),e):e},surnameErrors:function(){var e=[];return this.$v.surname.$dirty?(!this.$v.surname.required&&e.push("Surname is required"),e):e},usernameErrors:function(){var e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e}}},xe=be,_e=r("ce7e"),we=r("afd9"),ke=Object(f["a"])(xe,Se,$e,!1,null,null,null),Pe=ke.exports;y()(ke,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardTitle:F["d"],VContainer:ce["a"],VDivider:_e["a"],VFlex:j["a"],VForm:le["a"],VIcon:S["a"],VLayout:W["a"],VSpacer:X["a"],VSystemBar:we["a"],VTextField:ue["a"],VToolbar:Z["a"]});var De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.autoDisableSingleDatasourceDialog,callback:function(t){e.autoDisableSingleDatasourceDialog=t},expression:"autoDisableSingleDatasourceDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[e._v(" Disabling Single Data Source Limit ")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.autoDisableSingleDatasource("cancel")}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" Disabling limiting reconciliation to be done against one choosen data source will also disable the single data source limit, click OK to proceed ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){return e.autoDisableSingleDatasource("cancel")}}},[e._v("Cancel")]),r("v-spacer"),r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){return e.autoDisableSingleDatasource("ok")}}},[e._v("Ok")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"620px"},model:{value:e.defineSuperuserRole,callback:function(t){e.defineSuperuserRole=t},expression:"defineSuperuserRole"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" DHIS2 superuser role that can be an administrator of GOFR ")])],1),r("v-card-text",[r("v-select",{attrs:{label:"Superuser Role Name","item-text":"displayName","item-value":"id",loading:e.loadingDhis2Roles,required:"",items:e.dhis2Roles},on:{change:function(t){return e.saveConfiguration("generalConfig","externalAuth")}},model:{value:e.$store.state.config.generalConfig.externalAuth.adminRole,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"adminRole",t)},expression:"$store.state.config.generalConfig.externalAuth.adminRole"}})],1),r("v-card-actions",[r("v-btn",{attrs:{color:"primary",disabled:!e.$store.state.config.generalConfig.externalAuth.adminRole||0===e.dhis2Roles.length},on:{click:function(t){return e.saveConfiguration("generalConfig","authDisabled")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" Save ")],1)],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"800px"},model:{value:e.selectDatasourceDialog,callback:function(t){e.selectDatasourceDialog=t},expression:"selectDatasourceDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Select datasource to fix source 2 ")]),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.searchDatasource,callback:function(t){e.searchDatasource=t},expression:"searchDatasource"}}),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.closeDatasourceDialog(t)}}},[r("v-icon",[e._v("mdi-close")])],1)],1),e._v(" This lists only those datasets that have been shared to all users "),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.dataSourceHeaders,items:e.sharedToAllDatasets,dark:"",search:e.searchDatasource},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.fixSource2To,callback:function(t){e.fixSource2To=t},expression:"fixSource2To"}},[r("td",[r("v-radio",{attrs:{value:a.id,color:"blue"}})],1)]),r("td",[e._v(e._s(a.name))]),r("td",[e._v(e._s(a.userID.userName))]),r("td",[e._v(" "+e._s(a.createdTime)+" ")])],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},on:{click:e.closeDatasourceDialog}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-cancel")]),e._v(" Cancel ")],1),r("v-spacer"),r("v-btn",{attrs:{color:"primary",disabled:!e.fixSource2To||0===e.sharedToAllDatasets.length},on:{click:e.savefixSource2To}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" Save ")],1)],1)],1)],1),r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("b",[e._v("System Configurations")])]),r("v-card-text",[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" User Configurations ")]),r("v-card-text",[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-switch",{attrs:{color:"primary",label:"Apply user defined headers when reconciling"},on:{change:function(t){return e.saveConfiguration("userConfig","useCSVHeader")}},model:{value:e.$store.state.config.userConfig.reconciliation.useCSVHeader,callback:function(t){e.$set(e.$store.state.config.userConfig.reconciliation,"useCSVHeader",t)},expression:"$store.state.config.userConfig.reconciliation.useCSVHeader"}})],1),r("v-flex",[r("v-autocomplete",{attrs:{items:e.$store.state.dataSources,"item-text":"display","item-value":"name",label:"Facility Registry Datasource"},on:{change:function(t){return e.saveConfiguration("userConfig","useCSVHeader")}},model:{value:e.$store.state.config.userConfig.FRDatasource,callback:function(t){e.$set(e.$store.state.config.userConfig,"FRDatasource",t)},expression:"$store.state.config.userConfig.FRDatasource"}})],1)],1)],1)],1),r("v-divider"),r("v-divider"),r("v-divider"),"Admin"==e.$store.state.auth.role?r("v-card",[r("v-card-title",[e._v(" Admin Configurations ")]),r("v-card-text",[r("v-layout",{attrs:{column:""}},[r("v-flex",{scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.$store.state.config.generalConfig.reconciliation.fixSource2?[e._v(" Source2 Limited To: "),r("v-chip",[e._v(e._s(e.fixedSource2To))]),r("v-tooltip",{attrs:{top:""}},[r("v-btn",e._g({attrs:{fab:"",dark:"",color:"primary",small:""},on:{click:e.displayDatasourceDialog}},a),[r("v-icon",{attrs:{dark:""}},[e._v("mdi-format-list-bulleted")])],1),r("span",[e._v("Change dataset")])],1)]:e._e()]}}],null,!1,1188442032)},[r("v-switch",{attrs:{color:"primary",label:"Perform match based on parent constraint"},on:{change:function(t){return e.saveConfiguration("generalConfig","parentConstraint")}},model:{value:e.$store.state.config.generalConfig.reconciliation.parentConstraint.enabled,callback:function(t){e.$set(e.$store.state.config.generalConfig.reconciliation.parentConstraint,"enabled",t)},expression:"$store.state.config.generalConfig.reconciliation.parentConstraint.enabled"}}),e.$store.state.config.generalConfig.reconciliation.parentConstraint.enabled?e._e():r("v-card",{staticStyle:{"margin-left":"100px"},attrs:{color:"grey lighten-3"}},[r("v-checkbox",{attrs:{color:"primary",label:"Automatch By ID",disabled:""},on:{change:function(t){return e.saveConfiguration("generalConfig","parConstrIdAuto")}},model:{value:e.$store.state.config.generalConfig.reconciliation.parentConstraint.idAutoMatch,callback:function(t){e.$set(e.$store.state.config.generalConfig.reconciliation.parentConstraint,"idAutoMatch",t)},expression:"$store.state.config.generalConfig.reconciliation.parentConstraint.idAutoMatch"}}),r("v-checkbox",{attrs:{color:"primary",label:"Automatch By Name (when parents differ)"},on:{change:function(t){return e.saveConfiguration("generalConfig","parConstrNameAuto")}},model:{value:e.$store.state.config.generalConfig.reconciliation.parentConstraint.nameAutoMatch,callback:function(t){e.$set(e.$store.state.config.generalConfig.reconciliation.parentConstraint,"nameAutoMatch",t)},expression:"$store.state.config.generalConfig.reconciliation.parentConstraint.nameAutoMatch"}})],1),r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Choose ways datasets can be added ")]),r("v-card-text",[r("v-checkbox",{attrs:{label:"CSV Upload",value:"CSV Upload"},on:{change:function(t){return e.checkDatasetsAdditionWays("upload")}},model:{value:e.$store.state.config.generalConfig.datasetsAdditionWays,callback:function(t){e.$set(e.$store.state.config.generalConfig,"datasetsAdditionWays",t)},expression:"$store.state.config.generalConfig.datasetsAdditionWays"}}),r("v-checkbox",{attrs:{label:"Remote Servers Sync",value:"Remote Servers Sync"},on:{change:function(t){return e.checkDatasetsAdditionWays("remote")}},model:{value:e.$store.state.config.generalConfig.datasetsAdditionWays,callback:function(t){e.$set(e.$store.state.config.generalConfig,"datasetsAdditionWays",t)},expression:"$store.state.config.generalConfig.datasetsAdditionWays"}}),r("v-checkbox",{attrs:{label:"Blank Datasource",value:"Blank Datasource"},on:{change:function(t){return e.checkDatasetsAdditionWays("blank")}},model:{value:e.$store.state.config.generalConfig.datasetsAdditionWays,callback:function(t){e.$set(e.$store.state.config.generalConfig,"datasetsAdditionWays",t)},expression:"$store.state.config.generalConfig.datasetsAdditionWays"}})],1)],1),r("v-switch",{attrs:{color:"primary",label:"Allow non admin users to share datasets will all users"},on:{change:function(t){return e.saveConfiguration("generalConfig","allowShareToAllForNonAdmin")}},model:{value:e.$store.state.config.generalConfig.allowShareToAllForNonAdmin,callback:function(t){e.$set(e.$store.state.config.generalConfig,"allowShareToAllForNonAdmin",t)},expression:"$store.state.config.generalConfig.allowShareToAllForNonAdmin"}}),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-switch",e._g({attrs:{color:"primary",label:"Select a data source to serve as Source 2 for all reconciliation"},on:{change:e.displayDatasourceDialog},model:{value:e.$store.state.config.generalConfig.reconciliation.fixSource2,callback:function(t){e.$set(e.$store.state.config.generalConfig.reconciliation,"fixSource2",t)},expression:"$store.state.config.generalConfig.reconciliation.fixSource2"}},a))]}}],null,!1,2609954683)},[r("span",[e._v("This will limit users to perform reconciliations against the chosen data source")])]),r("v-switch",{attrs:{color:"primary",label:"Single data source per user"},on:{change:e.singleDatasource},model:{value:e.$store.state.config.generalConfig.reconciliation.singleDataSource,callback:function(t){e.$set(e.$store.state.config.generalConfig.reconciliation,"singleDataSource",t)},expression:"$store.state.config.generalConfig.reconciliation.singleDataSource"}}),e.$store.state.dhis.user.orgId?r("v-switch",{attrs:{color:"primary",label:"Single data source pair per org unit"},on:{change:function(t){return e.saveConfiguration("generalConfig","singlePair")}},model:{value:e.$store.state.config.generalConfig.reconciliation.singlePair,callback:function(t){e.$set(e.$store.state.config.generalConfig.reconciliation,"singlePair",t)},expression:"$store.state.config.generalConfig.reconciliation.singlePair"}}):e._e()],1),r("v-flex",[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" GOFR Authentication ")]),r("v-card-text",[r("v-switch",{attrs:{color:"primary",label:"Disable Authentication"},on:{change:e.disableGOFRAuth},model:{value:e.$store.state.config.generalConfig.authDisabled,callback:function(t){e.$set(e.$store.state.config.generalConfig,"authDisabled",t)},expression:"$store.state.config.generalConfig.authDisabled"}}),e.$store.state.config.generalConfig.authDisabled?r("v-card",{staticStyle:{"margin-left":"100px"},attrs:{color:"grey lighten-3"}},[e._v(" External Authentication Method "),r("v-radio-group",{on:{change:function(t){return e.saveConfiguration("generalConfig","useDhis2Auth")}},model:{value:e.$store.state.config.generalConfig.authMethod,callback:function(t){e.$set(e.$store.state.config.generalConfig,"authMethod",t)},expression:"$store.state.config.generalConfig.authMethod"}},[r("v-radio",{attrs:{label:"dhis2",value:"dhis2",disabled:""}}),r("v-radio",{attrs:{label:"iHRIS",value:"iHRIS",disabled:""}})],1),r("v-select",{staticStyle:{width:"350px"},attrs:{label:"Superuser Role Name","item-text":"displayName","item-value":"id",loading:e.loadingDhis2Roles,required:"",items:e.dhis2Roles},on:{change:function(t){return e.saveConfiguration("generalConfig","externalAuth")}},model:{value:e.$store.state.config.generalConfig.externalAuth.adminRole,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"adminRole",t)},expression:"$store.state.config.generalConfig.externalAuth.adminRole"}}),e.$store.state.config.generalConfig.authMethod?r("v-checkbox",{attrs:{label:"Pull org units"},on:{change:function(t){return e.saveConfiguration("generalConfig","externalAuth")}},model:{value:e.$store.state.config.generalConfig.externalAuth.pullOrgUnits,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"pullOrgUnits",t)},expression:"$store.state.config.generalConfig.externalAuth.pullOrgUnits"}}):e._e(),e.$store.state.config.generalConfig.externalAuth.pullOrgUnits?r("v-checkbox",{attrs:{label:"Share orgs with other users"},on:{change:function(t){return e.saveConfiguration("generalConfig","externalAuth")}},model:{value:e.$store.state.config.generalConfig.externalAuth.shareOrgUnits,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"shareOrgUnits",t)},expression:"$store.state.config.generalConfig.externalAuth.shareOrgUnits"}}):e._e(),e.$store.state.config.generalConfig.externalAuth.shareOrgUnits&&e.$store.state.config.generalConfig.externalAuth.pullOrgUnits?r("v-checkbox",{attrs:{label:"Limit orgs sharing by user orgid"},on:{change:function(t){return e.saveConfiguration("generalConfig","externalAuth")}},model:{value:e.$store.state.config.generalConfig.externalAuth.shareByOrgId,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"shareByOrgId",t)},expression:"$store.state.config.generalConfig.externalAuth.shareByOrgId"}}):e._e(),e.$store.state.config.generalConfig.externalAuth.pullOrgUnits?r("v-text-field",{staticStyle:{width:"350px"},attrs:{outline:"",label:"Dataset Name","error-messages":e.datasetNameErrors,required:""},on:{blur:e.ensureNameUnique,input:e.ensureNameUnique},model:{value:e.$store.state.config.generalConfig.externalAuth.datasetName,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"datasetName",t)},expression:"$store.state.config.generalConfig.externalAuth.datasetName"}}):e._e(),e.$store.state.config.generalConfig.externalAuth.pullOrgUnits?r("v-text-field",{staticStyle:{width:"350px"},attrs:{outline:"",label:"Username",required:""},model:{value:e.$store.state.config.generalConfig.externalAuth.userName,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"userName",t)},expression:"$store.state.config.generalConfig.externalAuth.userName"}}):e._e(),e.$store.state.config.generalConfig.externalAuth.pullOrgUnits?r("v-text-field",{staticStyle:{width:"350px"},attrs:{outline:"",label:"Password",type:"password",required:""},model:{value:e.$store.state.config.generalConfig.externalAuth.password,callback:function(t){e.$set(e.$store.state.config.generalConfig.externalAuth,"password",t)},expression:"$store.state.config.generalConfig.externalAuth.password"}}):e._e(),r("v-flex",{attrs:{xs3:""}},[e.$store.state.config.generalConfig.externalAuth.pullOrgUnits?r("v-btn",{attrs:{color:"primary",disabled:e.datasetNameErrors.length>0||!e.$store.state.config.generalConfig.externalAuth.datasetName,small:"",round:""},on:{click:e.pullOrgUnits}},[e._v("start pulling")]):e._e()],1)],1):e._e()],1)],1)],1),r("v-divider"),r("v-flex",[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Self Registration ")]),r("v-card-text",[r("v-switch",{attrs:{color:"primary",label:"Enable self registration"},on:{change:function(t){return e.saveConfiguration("generalConfig","selfRegistration")}},model:{value:e.$store.state.config.generalConfig.selfRegistration.enabled,callback:function(t){e.$set(e.$store.state.config.generalConfig.selfRegistration,"enabled",t)},expression:"$store.state.config.generalConfig.selfRegistration.enabled"}}),r("v-switch",{attrs:{color:"primary",label:"Requires Admin Approval Of Self Registration"},on:{change:function(t){return e.saveConfiguration("generalConfig","selfRegistration")}},model:{value:e.$store.state.config.generalConfig.selfRegistration.requiresApproval,callback:function(t){e.$set(e.$store.state.config.generalConfig.selfRegistration,"requiresApproval",t)},expression:"$store.state.config.generalConfig.selfRegistration.requiresApproval"}})],1)],1)],1),r("v-divider"),r("v-flex",{attrs:{xs1:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Cron Jobs ")]),r("v-card-text",[e._v(" Autosync Below Remote Datasets "),r("v-text-field",{staticStyle:{width:"350px"},attrs:{outline:"",name:"cron_time",label:"Cron Time"},on:{blur:function(t){return e.saveConfiguration("generalConfig","datasetsAutosyncTime")}},model:{value:e.$store.state.config.generalConfig.datasetsAutosyncTime,callback:function(t){e.$set(e.$store.state.config.generalConfig,"datasetsAutosyncTime",t)},expression:"$store.state.config.generalConfig.datasetsAutosyncTime"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.cronDataSourceHeaders,items:e.remoteDatasets,"hide-default-footer":"","pagination.sync":"pagination"},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.name))]),r("td",[e._v(e._s(a.userID.userName))]),r("td",[e._v(" "+e._s(a.createdTime)+" ")]),r("td",[r("v-switch",{attrs:{color:"primary"},on:{change:function(t){return e.controlDatasetsCronjobs(a)}},model:{value:e.datasetsAutosyncState[a.id],callback:function(t){e.$set(e.datasetsAutosyncState,a.id,t)},expression:"datasetsAutosyncState[item.id]"}})],1)])]}}],null,!1,2259662748)})],1)],1)],1),r("v-flex",{attrs:{xs1:""}},[r("v-card",{attrs:{color:"grey lighten-3"}},[r("v-card-text",[e._v(" SMTP Configuration For Email Notifications ")]),r("v-card-actions",[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-text-field",{attrs:{label:"SMTP Host",filled:""},model:{value:e.smtp.host,callback:function(t){e.$set(e.smtp,"host",t)},expression:"smtp.host"}})],1),r("v-flex",[r("v-text-field",{attrs:{label:"SMTP Port",filled:""},model:{value:e.smtp.port,callback:function(t){e.$set(e.smtp,"port",t)},expression:"smtp.port"}})],1),r("v-flex",[r("v-text-field",{attrs:{label:"SMTP Username",filled:""},model:{value:e.smtp.username,callback:function(t){e.$set(e.smtp,"username",t)},expression:"smtp.username"}})],1),r("v-flex",[r("v-text-field",{attrs:{type:"password",label:"SMTP Password",autocomplete:"new-password",filled:""},model:{value:e.smtp.password,callback:function(t){e.$set(e.smtp,"password",t)},expression:"smtp.password"}})],1),r("v-flex",[r("v-switch",{attrs:{color:"primary",label:"SMTP Secured"},model:{value:e.smtp.secured,callback:function(t){e.$set(e.smtp,"secured",t)},expression:"smtp.secured"}})],1),r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{color:"primary"},on:{click:e.saveSMTP}},[r("v-icon",[e._v("mdi-content-save")]),e._v("Save ")],1)],1)],1)],1)],1)],1)],1)],1),r("v-flex",{attrs:{xs1:""}},[r("v-switch",{attrs:{color:"primary",label:"Enable Endpoint Notification when reconciliation is done"},on:{change:function(t){return e.saveConfiguration("generalConfig","recoProgressNotification")}},model:{value:e.$store.state.config.generalConfig.recoProgressNotification.enabled,callback:function(t){e.$set(e.$store.state.config.generalConfig.recoProgressNotification,"enabled",t)},expression:"$store.state.config.generalConfig.recoProgressNotification.enabled"}}),e.$store.state.config.generalConfig.recoProgressNotification.enabled?r("v-card",{staticStyle:{"margin-left":"100px"},attrs:{color:"grey lighten-3"}},[r("v-card-text",[e._v(" End point to send notification when reconciliation is done ")]),r("v-card-actions",[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-text-field",{attrs:{label:"End point URL",filled:""},model:{value:e.notification_endpoint,callback:function(t){e.notification_endpoint=t},expression:"notification_endpoint"}})],1),r("v-flex",[r("v-text-field",{attrs:{label:"End point Username",filled:""},model:{value:e.notification_username,callback:function(t){e.notification_username=t},expression:"notification_username"}})],1),r("v-flex",[r("v-text-field",{attrs:{label:"End point Password",filled:""},model:{value:e.notification_password,callback:function(t){e.notification_password=t},expression:"notification_password"}})],1),r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{color:"primary"},on:{click:e.recoProgressNotificationChanged}},[r("v-icon",[e._v("mdi-content-save")]),e._v("Save ")],1)],1)],1)],1)],1)],1)],1):e._e()],1)],1)],1)],1):e._e()],1)],1),r("appRemoteSync",{attrs:{syncType:"dhisSync",serverName:e.$store.state.config.generalConfig.externalAuth.datasetName,userID:e.$store.state.auth.userID,sourceOwner:e.$store.state.auth.userID,mode:"full"}})],1)},Ce=[],Te=r("2909"),Ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("app-syncProgress",{attrs:{syncProgrIndeter:e.syncProgrIndeter,syncStatus:e.syncStatus,syncProgrPercent:e.syncProgrPercent,syncPercent:e.syncPercent}})],1)},Ae=[],Le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.syncProgrIndeter,callback:function(t){e.syncProgrIndeter=t},expression:"syncProgrIndeter"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v(" "+e._s(e.syncStatus)+" "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"270"},model:{value:e.syncProgrPercent,callback:function(t){e.syncProgrPercent=t},expression:"syncProgrPercent"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.syncStatus))]),r("br"),r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.syncPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.syncPercent)+"%")])])])],1)],1)],1)],1)],1)],1)},Oe=[],Ne={props:["syncProgrIndeter","syncStatus","syncProgrPercent","syncPercent"]},Ve=Ne,Re=r("8212"),Me=r("490a"),Ue=Object(f["a"])(Ve,Le,Oe,!1,null,null,null),Ee=Ue.exports;y()(Ue,{VAvatar:Re["a"],VCard:E["a"],VCardText:F["c"],VContainer:ce["a"],VDialog:H["a"],VProgressCircular:Me["a"],VProgressLinear:z["a"]});var Fe=Object({NODE_ENV:"production",VUE_APP_BACKEND_SERVER:".",VUE_APP_I18N_LOCALE:"en",VUE_APP_I18N_FALLBACK_LOCALE:"en",BASE_URL:"/"}).BACKEND_SERVER,qe={props:["syncType","serverName","userID","sourceOwner","mode"],data:function(){return{syncProgrIndeter:!1,syncStatus:"Waiting for sync status",syncPercent:null,syncProgrPercent:!1,syncProgressTimer:"",syncRunning:!1}},methods:{sync:function(){var e=this,t=this.mode;t||(t="full");var r=new FormData,a=this.$store.state.clientId;r.append("name",this.serverName),r.append("userID",this.userID),r.append("sourceOwner",this.sourceOwner),r.append("clientId",a),r.append("mode",t),this.syncRunning=!0,this.syncProgrIndeter=!0,u.a.post(Fe+"/"+this.syncType+"/",r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.syncProgressTimer=setInterval(e.checkSyncProgress,1e3)})).catch((function(t){e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.response.data.error+". cross check host,user and password",clearInterval(e.syncProgressTimer),console.log(t.response.data.error)}))},checkSyncProgress:function(){var e,t=this,r=this.$store.state.clientId;"dhisSync"===this.syncType?e="dhisSyncRequest":"fhirSync"===this.syncType&&(e="fhirSyncRequest"),u.a.get(Fe+"/progress/"+e+"/"+r).then((function(e){return null===e.data||void 0===e.data||!1===e.data?(t.$store.state.uploadRunning=!1,t.syncProgrIndeter=!1,t.syncProgrPercent=!1,void clearInterval(t.syncProgressTimer)):null!==e.data.error?(t.$store.state.uploadRunning=!1,t.syncProgrIndeter=!1,t.syncProgrPercent=!1,t.$store.state.dialogError=!0,t.$store.state.errorTitle="Error",t.$store.state.errorDescription=e.data.error,clearInterval(t.syncProgressTimer),void console.log(e.data.error)):null===e.data.status?(t.$store.state.uploadRunning=!1,t.syncProgrIndeter=!1,t.syncProgrPercent=!1,void clearInterval(t.syncProgressTimer)):(t.syncStatus=e.data.status,e.data.percent&&(t.syncProgrPercent||(t.syncProgrIndeter=!1,t.syncProgrPercent=!0),t.syncPercent=e.data.percent),void("Done"===e.data.status&&(t.syncStatus="Waiting for sync status",clearInterval(t.syncProgressTimer),t.syncProgrPercent=!1,t.$store.state.uploadRunning=!1,Oa.$emit("getDataSources"))))})).catch((function(e){t.$store.state.dialogError=!0,t.$store.state.errorTitle="Error",console.log(e.response.data.error+". cross check host,user and password"),t.$store.state.errorDescription=e.response.data.error+". cross check host,user and password",clearInterval(t.syncProgressTimer)}))}},created:function(){Oa.$on("runRemoteSync",this.sync)},beforeDestroy:function(){Oa.$off("runRemoteSync",this.sync)},components:{appSyncProgress:Ee}},He=qe,je=Object(f["a"])(He,Ie,Ae,!1,null,null,null),Be=je.exports;y()(je,{VContainer:ce["a"]});var We={mixins:[P],validations:{facility:{required:oe["required"]},code:{required:oe["required"]},uploadName:{required:oe["required"]}},data:function(){return{smtp:{host:"",port:"",username:"",password:"",secured:!0},autoDisableSingleDatasourceDialog:!1,selectDatasourceDialog:!1,fixSource2To:"",searchDatasource:"",dataSourceHeaders:[{sortable:!1},{text:"Source Name",align:"left",value:"name"},{text:"Owner",value:"owner",sortable:!1},{text:"Created Time",value:"createdTime"}],cronDataSourceHeaders:[{text:"Source Name",align:"left",value:"name"},{text:"Owner",value:"owner",sortable:!1},{text:"Created Time",value:"createdTime"},{text:"Enabled",value:"enabled"}],datasetsAutosyncState:{},useCSVHeader:!1,moreFields:!1,fieldLabel:"",fieldName:"",required:"No",requiredText:["Yes","No"],notification_endpoint:"",notification_username:"",notification_password:"",dhis2Roles:[],loadingDhis2Roles:!1,datasetNameErrors:[],defineSuperuserRole:!1}},methods:{controlDatasetsCronjobs:function(e){var t=new FormData;t.append("id",e.id),t.append("enabled",this.datasetsAutosyncState[e.id]),u.a.post("/updateDatasetAutosync",t)},checkDatasetsAdditionWays:function(e){var t;0===this.$store.state.config.generalConfig.datasetsAdditionWays.length?(this.$store.state.errorTitle="Cant disable both ways",this.$store.state.errorDescription="There must be atleast one way of adding a dataset",this.$store.state.dialogError=!0,"remote"===e?t="Remote Servers Sync":"upload"===e?t="CSV Upload":"blank"===e&&(t="Blank Datasource"),this.$store.state.config.generalConfig.datasetsAdditionWays.push(t)):this.saveConfiguration("generalConfig","datasetsAdditionWays")},autoDisableSingleDatasource:function(e){"ok"===e?(this.$store.state.config.generalConfig.reconciliation.singleDataSource=!1,this.saveConfiguration("generalConfig","fixSource2"),this.saveConfiguration("generalConfig","singleDataSource")):"cancel"===e&&(this.$store.state.config.generalConfig.reconciliation.fixSource2=!0),this.autoDisableSingleDatasourceDialog=!1},singleDatasource:function(){var e=this;this.$store.state.config.generalConfig.reconciliation.singleDataSource?this.$store.state.config.generalConfig.reconciliation.fixSource2To&&this.$store.state.config.generalConfig.reconciliation.fixSource2?this.saveConfiguration("generalConfig","singleDataSource"):(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",this.$store.state.errorColor="error",this.$store.state.errorDescription="This feature can only be enabled if there is a defined datasource to serve as Source 2 for all reconciliation",setTimeout((function(){e.$store.state.config.generalConfig.reconciliation.singleDataSource=!1}))):this.saveConfiguration("generalConfig","singleDataSource")},displayDatasourceDialog:function(){!0===this.$store.state.config.generalConfig.reconciliation.fixSource2?(this.fixSource2To=this.$store.state.config.generalConfig.reconciliation.fixSource2To,this.selectDatasourceDialog=!0,this.saveConfiguration("generalConfig","fixSource2")):this.$store.state.config.generalConfig.reconciliation.singleDataSource?this.autoDisableSingleDatasourceDialog=!0:this.saveConfiguration("generalConfig","fixSource2")},closeDatasourceDialog:function(){this.selectDatasourceDialog=!1,this.$store.state.config.generalConfig.reconciliation.fixSource2To||(this.$store.state.config.generalConfig.reconciliation.fixSource2=!1,this.saveConfiguration("generalConfig","fixSource2"))},savefixSource2To:function(){this.$store.state.config.generalConfig.reconciliation.fixSource2To=this.fixSource2To,this.saveConfiguration("generalConfig","fixSource2To"),this.selectDatasourceDialog=!1},disableGOFRAuth:function(){var e=this;if(this.$store.state.config.generalConfig.authDisabled){if(this.$store.state.config.generalConfig.authDisabled){var t=this.setDHIS2Credentials();if(!t)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",this.$store.state.errorColor="error",this.$store.state.errorDescription="App doesnt appear to be running inside DHIS2, cant disable authentication",void setTimeout((function(){e.$store.state.config.generalConfig.authDisabled=!1}));this.loadingDhis2Roles=!0,this.getDHIS2Roles((function(t){e.loadingDhis2Roles=!1,e.dhis2Roles=Object(Te["a"])(t.data.userRoles)})),this.defineSuperuserRole=!0}}else this.saveConfiguration("generalConfig","authDisabled")},recoProgressNotificationChanged:function(){this.$store.state.config.generalConfig.hasOwnProperty("recoProgressNotification")||(this.$store.state.config.generalConfig.recoProgressNotification={}),this.$store.state.config.generalConfig.recoProgressNotification.url=this.notification_endpoint,this.$store.state.config.generalConfig.recoProgressNotification.username=this.notification_username,this.$store.state.config.generalConfig.recoProgressNotification.password=this.notification_password,this.saveConfiguration("generalConfig")},saveSMTP:function(){var e=this,t=new FormData;this.$store.state.progressTitle="Saving SMTP",this.$store.state.dynamicProgress=!0,t.append("host",this.smtp.host),t.append("port",this.smtp.port),t.append("username",this.smtp.username),t.append("password",this.smtp.password),t.append("secured",this.smtp.secured),u.a.post("/saveSMTP",t,t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.state.dynamicProgress=!1,e.$store.state.dialogError=!0,e.$store.state.errorColor="primary",e.$store.state.errorTitle="Info",e.$store.state.errorDescription="SMTP saved successfully"})).catch((function(t){console.log(t),e.$store.state.dynamicProgress=!1,e.$store.state.dialogError=!0,e.$store.state.errorColor="error",e.$store.state.errorTitle="Error",e.$store.state.errorDescription="SMTP failed to be saved"}))},pullOrgUnits:function(){this.saveConfiguration("generalConfig","externalAuth");var e=new FormData;e.append("host",this.$store.state.dhis.host),e.append("sourceType","DHIS2"),e.append("source","syncServer"),e.append("shareToAll",this.$store.state.config.generalConfig.externalAuth.shareOrgUnits),e.append("limitByUserLocation",this.$store.state.config.generalConfig.externalAuth.shareByOrgId),e.append("username",this.$store.state.config.generalConfig.externalAuth.userName),e.append("password",this.$store.state.config.generalConfig.externalAuth.password),e.append("name",this.$store.state.config.generalConfig.externalAuth.datasetName),e.append("userID",this.$store.state.auth.userID),u.a.post("/addDataSource",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){Oa.$emit("runRemoteSync")}))},getDHIS2Roles:function(e){var t=this.$store.state.dhis.dev.auth;""===t.username&&(t=""),u.a.get(this.$store.state.dhis.host+"api/userRoles",{auth:t}).then((function(t){e(t)}))},ensureNameUnique:function(){if(this.datasetNameErrors=[],""===this.$store.state.config.generalConfig.externalAuth.datasetName)return this.datasetNameErrors.push("Dataset name is required");var e,t=Object(n["a"])(this.$store.state.dataSources);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.name===this.uploadName)return this.datasetNameErrors.push("This Name Exists"),!1}}catch(a){t.e(a)}finally{t.f()}}},created:function(){var e=this;u.a.get("/getSMTP").then((function(t){t&&t.data&&(e.smtp.host=t.data.host,e.smtp.port=t.data.port,e.smtp.username=t.data.username,e.smtp.password=t.data.password,e.smtp.secured=t.data.secured)})).catch((function(t){console.log(t),e.$store.state.dialogError=!0,e.$store.state.errorColor="error",e.$store.state.errorTitle="Error",e.$store.state.errorDescription="An error occured while getting SMTP config"})),this.$store.state.config.generalConfig.authDisabled&&"dhis2"===this.$store.state.config.generalConfig.authMethod&&(this.loadingDhis2Roles=!0,this.getDHIS2Roles((function(t){e.loadingDhis2Roles=!1,e.dhis2Roles=Object(Te["a"])(t.data.userRoles)}))),this.$store.state.config.generalConfig.hasOwnProperty("recoProgressNotification")&&(this.notification_endpoint=this.$store.state.config.generalConfig.recoProgressNotification.url,this.notification_username=this.$store.state.config.generalConfig.recoProgressNotification.username,this.notification_password=this.$store.state.config.generalConfig.recoProgressNotification.password);var t,r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(t=r.n()).done;){var a=t.value;"syncServer"===a.source&&(a.enableAutosync?this.datasetsAutosyncState[a.id]=!0:this.datasetsAutosyncState[a.id]=!1)}}catch(s){r.e(s)}finally{r.f()}},computed:{fixedSource2To:function(){var e,t="",r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(e=r.n()).done;){var a=e.value;a.id===this.$store.state.config.generalConfig.reconciliation.fixSource2To&&(t=a)}}catch(s){r.e(s)}finally{r.f()}return t.name},sharedToAllDatasets:function(){var e,t=[],r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(e=r.n()).done;){var a=e.value;a.shareToAll&&a.shareToAll.activated,t.push(a)}}catch(s){r.e(s)}finally{r.f()}return t},remoteDatasets:function(){var e,t=[],r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(e=r.n()).done;){var a=e.value;"syncServer"===a.source&&t.push(a)}}catch(s){r.e(s)}finally{r.f()}return t}},beforeCreate:function(){if(this.$store.state.config.generalConfig.hasOwnProperty("authMethod")||this.$set(this.$store.state.config.generalConfig,"authMethod","dhis2"),!this.$store.state.config.generalConfig.hasOwnProperty("externalAuth")){var e={pullOrgUnits:!0,shareOrgUnits:!1,shareByOrgId:!1,datasetName:"",adminRole:""};this.$set(this.$store.state.config.generalConfig,"externalAuth",e)}},components:{appRemoteSync:Be}},Ge=We,ze=r("c6a6"),Je=r("ac7c"),Ye=r("cc20"),Ke=r("8fea"),Xe=r("67b6"),Ze=r("43a6"),Qe=r("b73d"),et=Object(f["a"])(Ge,De,Ce,!1,null,null,null),tt=et.exports;y()(et,{VAutocomplete:ze["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VCheckbox:Je["a"],VChip:Ye["a"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VDivider:_e["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VProgressLinear:z["a"],VRadio:Xe["a"],VRadioGroup:Ze["a"],VSelect:Y["a"],VSpacer:X["a"],VSwitch:Qe["a"],VTextField:ue["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var rt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{persistent:"",overlay:!1,"max-width":"500px",transition:"dialog-transition"},model:{value:e.approveUserDialog,callback:function(t){e.approveUserDialog=t},expression:"approveUserDialog"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-spacer"),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.approveUserDialog=!1}}},[e._v("mdi-close")])],1),r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" User "+e._s(e.user.userName)+" ")]),r("v-card-text",[r("v-layout",{attrs:{column:"",wrap:""}},[r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{x5:""}},[e._v(" "+e._s(e.user.firstName)+" ")]),r("v-spacer"),r("v-flex",{attrs:{xs5:""}},[e._v(" "+e._s(e.user.surname)+" ")])],1)],1),r("v-flex",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{x5:""}},[e._v(" "+e._s(e.user.phone)+" ")]),r("v-spacer"),r("v-flex",{attrs:{xs5:""}},[e._v(" "+e._s(e.user.email)+" ")])],1)],1),r("v-flex",[r("v-select",{attrs:{required:"",items:e.roles,"single-line":"",clearable:"","error-messages":e.roleErrors,filled:"",label:"Role"},on:{blur:function(t){return e.$v.role.$touch()},change:function(t){return e.$v.role.$touch()}},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}})],1)],1)],1),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},on:{click:function(t){return e.changeStatus("Rejected")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-cancel")]),e._v("Reject ")],1),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){return e.changeStatus("Active")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-check-circle")]),e._v("Approve ")],1)],1)],1)],1),r("center",[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertFail,callback:function(t){e.alertFail=t},expression:"alertFail"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),r("v-card",{staticClass:"mx-auto",attrs:{color:"cyan lighten-5",width:"1500px"}},[r("v-card-title",{attrs:{"primary-title":"",width:"1000"}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v(" Users List "),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUsers,callback:function(t){e.searchUsers=t},expression:"searchUsers"}})],1)],1),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.usersHeader,items:e.users,search:e.searchUsers,dark:"",loading:e.$store.state.loadingusers},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("td",[e._v(e._s(a.firstName))]),r("td",[e._v(e._s(a.surname))]),r("td",[e._v(e._s(a.otherName))]),r("td",[e._v(e._s(a.phone))]),r("td",[e._v(e._s(a.email))]),r("td",[e._v(e._s(a.userName))]),a.role?r("td",[e._v(e._s(a.role.name))]):r("td"),r("td",[e._v(e._s(a.status))]),"Pending"===a.status||"Rejected"===a.status?r("td",[r("v-btn",{attrs:{color:"success",small:""},on:{click:function(t){return e.displayApprovalDialog(a)}}},[e._v("Approve/Reject")])],1):r("td",["Active"===a.status?r("v-btn",{attrs:{small:"",color:"error"},on:{click:function(t){return e.accountAction("Inactive",a)}}},[e._v("Deactivate")]):r("v-btn",{attrs:{small:"",color:"success"},on:{click:function(t){return e.accountAction("Active",a)}}},[e._v("Activate")]),e._v(" | "),r("v-btn",{attrs:{small:"",color:"error"},on:{click:function(t){return e.accountAction("reset",a)}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-refresh")]),e._v(" Reset Password ")],1)],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1)},at=[],st={mixins:[P],validations:{role:{required:oe["required"]}},data:function(){return{usersHeader:[{text:"Firstname",value:"firstName"},{text:"Surname",value:"surname"},{text:"Othername",value:"otherName"},{text:"Phone",value:"phone"},{text:"Email",value:"email"},{text:"User Name",value:"username"},{text:"Role",value:"role"},{text:"Status",value:"status"}],users:[],user:{},role:"",approveUserDialog:!1,loadingUsers:!1,searchUsers:"",alertSuccess:!1,alertFail:!1,alertMsg:""}},methods:{displayApprovalDialog:function(e){this.user=e,this.approveUserDialog=!0},changeStatus:function(e){var t=this,r=new FormData;r.append("role",this.role),r.append("status",e),r.append("id",this.user.id),u.a.post("/processUserAccoutRequest/",r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){t.approveUserDialog=!1,t.$store.state.errorTitle="Info",t.$store.state.errorDescription="This request was processed successfully",t.$store.state.dialogError=!0,t.getUsers()})).catch((function(e){t.approveUserDialog=!1,t.$store.state.errorTitle="Error",t.$store.state.errorDescription="An error occured while processing this request, please retry",t.$store.state.dialogError=!0,console.log(e.response.data.error)}))},getUsers:function(){var e=this,t=new FormData;t.append("username",this.username),t.append("password",this.password),this.users=[],this.loadingUsers=!0,u.a.get("/users/getUsers/").then((function(t){e.loadingUsers=!1,e.users=t.data})).catch((function(t){e.loadingUsers=!1,t.hasOwnProperty("response")&&console.log(t.response.data.error)}))},accountAction:function(e,t){var r=this,a=t.id,s=new FormData;s.append("id",a),"Active"===e||"Inactive"===e?(s.append("status",e),u.a.post("/changeAccountStatus",s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){r.alertSuccess=!0,"Active"===e?r.alertMsg="Account activated successfully":"Inactive"===e&&(r.alertMsg="Account deactivated successfully"),r.getUsers()})).catch((function(e){console.log(JSON.stringify(e)),r.alertFail=!0,r.alertMsg="Action failed"}))):"reset"===e&&(s.append("surname",t.surname),u.a.post("/resetPassword",s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){r.alertSuccess=!0,r.alertMsg="Password reseted successfully",r.getUsers()})).catch((function(e){console.log(JSON.stringify(e)),r.alertFail=!0,r.alertMsg="Action failed"})))}},computed:{roleErrors:function(){var e=[];return this.$v.role.$dirty?(!this.$v.role.required&&e.push("Role is required"),e):e}},created:function(){this.getUsers(),this.getRoles()}},ot=st,it=Object(f["a"])(ot,rt,at,!1,null,null,null),nt=it.exports;y()(it,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VProgressLinear:z["a"],VSelect:Y["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbar:Z["a"]});var ct=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",flat:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add New User")])],1),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.firstnameErrors,filled:"",color:"deep-purple",label:"First Name*"},on:{blur:function(t){return e.$v.firstName.$touch()},change:function(t){return e.$v.firstName.$touch()}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),r("v-text-field",{attrs:{filled:"",color:"deep-purple",label:"Middle Names"},model:{value:e.otherName,callback:function(t){e.otherName=t},expression:"otherName"}}),r("v-text-field",{attrs:{required:"","error-messages":e.surnameErrors,filled:"",color:"deep-purple",label:"Surname*"},on:{blur:function(t){return e.$v.surname.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.surname,callback:function(t){e.surname=t},expression:"surname"}}),r("v-text-field",{attrs:{required:"","error-messages":e.phoneErrors,filled:"",color:"deep-purple",label:"Phone*"},on:{blur:e.validatePhone,change:e.validatePhone,input:e.validatePhone},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),r("v-text-field",{attrs:{required:"","error-messages":e.emailErrors,filled:"",color:"deep-purple",label:"Email*"},on:{blur:e.validateEmail,change:e.validateEmail,input:e.validateEmail},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),r("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,filled:"",color:"deep-purple",label:"Username*"},on:{blur:function(t){return e.$v.userName.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Password*"},on:{blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("v-text-field",{attrs:{required:"","error-messages":e.retype_passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Re-type Password*"},on:{blur:function(t){return e.$v.retype_password.$touch()},change:function(t){return e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}}),r("v-select",{attrs:{required:"",items:e.roles,"single-line":"",clearable:"","error-messages":e.roleErrors,filled:"",label:"Role*"},on:{blur:function(t){return e.$v.role.$touch()},change:function(t){return e.$v.role.$touch()}},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}})],1),r("v-divider"),r("v-card-actions",[r("v-btn",{attrs:{text:""},on:{click:function(t){e.$store.state.baseRouterViewKey++}}},[r("v-icon",[e._v("mdi-close")]),e._v("Clear ")],1),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){return e.addUser()}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-web")]),e._v("Add ")],1)],1)],1)],1),r("v-spacer")],1)],1)},lt=[],ut={mixins:[P],validations:{userName:{required:oe["required"]},retype_password:{required:oe["required"]},password:{required:oe["required"]},role:{required:oe["required"]},firstName:{required:oe["required"]},surname:{required:oe["required"]},phone:{required:oe["required"]},email:{required:oe["required"]}},data:function(){return{firstName:"",otherName:"",surname:"",phone:"",email:"",userName:"",password:"",retype_password:"",role:"",customFields:[],phoneErrors:[],emailErrors:[]}},methods:{validateEmail:function(){if(this.emailErrors=[],!this.email)return this.emailErrors.push("Email is required"),!1;var e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return e.test(this.email)?void 0:(this.emailErrors.push("Invalid Email"),!1)},validatePhone:function(){if(this.phoneErrors=[],!this.phone)return this.phoneErrors.push("Phone is required");var e=/^[+]?[\s./0-9]*[(]?[0-9]{1,4}[)]?[-\s./0-9]*$/g;return e.test(this.phone)?void 0:this.phoneErrors.push("Invalid phone number")},addUser:function(){var e=this;if(this.password!==this.retype_password)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Password mismatch");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Saving User";var t=new FormData;t.append("firstName",this.firstName),t.append("otherName",this.otherName),t.append("password",this.password),t.append("userName",this.userName),t.append("surname",this.surname),t.append("phone",this.phone),t.append("email",this.email),t.append("role",this.role),u.a.post("/addUser/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="User added successfully",e.$store.state.alert.type="success",e.$store.state.baseRouterViewKey+=1})).catch((function(t){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="This user was not added, ensure userName is not used",e.$store.state.alert.type="error",e.$store.state.baseRouterViewKey+=1,console.log(t.response.data.error)}))}},computed:{codeErrors:function(){var e=[];return this.$v.code.$dirty?(!this.$v.code.required&&e.push("Code is required"),e):e},firstnameErrors:function(){var e=[];return this.$v.firstName.$dirty?(!this.$v.firstName.required&&e.push("First Name is required"),e):e},surnameErrors:function(){var e=[];return this.$v.surname.$dirty?(!this.$v.surname.required&&e.push("Surname is required"),e):e},usernameErrors:function(){var e=[];return this.$v.userName.$dirty?(!this.$v.userName.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e},roleErrors:function(){var e=[];return this.$v.role.$dirty?(!this.$v.role.required&&e.push("Role is required"),e):e}},created:function(){this.getRoles()}},dt=ut,ht=Object(f["a"])(dt,ct,lt,!1,null,null,null),vt=ht.exports;y()(ht,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardTitle:F["d"],VContainer:ce["a"],VDivider:_e["a"],VFlex:j["a"],VForm:le["a"],VIcon:S["a"],VLayout:W["a"],VSelect:Y["a"],VSpacer:X["a"],VSystemBar:we["a"],VTextField:ue["a"],VToolbar:Z["a"]});var pt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e._v(" Select role to edit tasks "),r("v-select",{attrs:{required:"",items:e.roles,"single-line":"",filled:"",label:"Select Role"},on:{change:e.roleSelected}}),e.role.value?r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Tasks assigned to role "+e._s(e.role.text)+" ")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.tasks,height:"10px","hide-default-footer":""},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[r("v-checkbox",{attrs:{value:a.id},model:{value:e.role.tasks,callback:function(t){e.$set(e.role,"tasks",t)},expression:"role.tasks"}})],1),r("td",[e._v(e._s(a.display))])])]}}],null,!1,1175055491)})],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"primary"},on:{click:e.saveRole}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" Save ")],1)],1)],1):e._e()],1)},gt=[],ft={mixins:[P],data:function(){return{role:{},task:""}},methods:{roleSelected:function(e){this.role=this.roles.find((function(t){return t.value===e}))},saveRole:function(){var e=this;this.$store.state.progressTitle="Updating role",this.$store.state.dynamicProgress=!0;var t=new FormData;t.append("role",JSON.stringify(this.role)),u.a.post("/updateRole",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.state.dynamicProgress=!1,e.$store.state.dialogError=!0,e.$store.state.errorTitle="Info",e.$store.state.errorColor="primary",e.$store.state.errorDescription="Role ".concat(e.role.text," updated successfully"),e.getRoles()})).catch((function(t){e.$store.state.dynamicProgress=!1,e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorColor="error",e.$store.state.errorDescription="An error has occured while updating role ".concat(e.role.text),console.log(t)}))}},created:function(){this.getRoles(),this.getTasks()}},mt=ft,yt=Object(f["a"])(mt,pt,gt,!1,null,null,null),St=yt.exports;y()(yt,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VCheckbox:Je["a"],VContainer:ce["a"],VDataTable:Ke["a"],VIcon:S["a"],VSelect:Y["a"],VSpacer:X["a"]});var $t=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",filled:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Change Password")])],1),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.oldPasswordErrors,type:"password",filled:"",color:"deep-purple",label:"Old Password"},on:{blur:function(t){return e.$v.oldPassword.$touch()},change:function(t){return e.$v.oldPassword.$touch()}},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}}),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Password"},on:{blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("v-text-field",{attrs:{required:"","error-messages":e.retype_passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Re-type Password"},on:{blur:function(t){return e.$v.retype_password.$touch()},change:function(t){return e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}})],1),r("v-divider"),r("v-card-actions",[r("v-btn",{attrs:{filled:""},on:{click:function(t){e.$store.state.baseRouterViewKey++}}},[r("v-icon",[e._v("mdi-close")]),e._v("Clear ")],1),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:function(t){return e.verifyPassword()}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-find-replace")]),e._v("Change ")],1)],1)],1)],1),r("v-spacer")],1)],1)},bt=[],xt={validations:{retype_password:{required:oe["required"]},password:{required:oe["required"]},oldPassword:{required:oe["required"]}},data:function(){return{oldPassword:"",password:"",retype_password:""}},methods:{changePassword:function(){var e=this;if(this.password!==this.retype_password)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Password mismatch");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Changing Password";var t=new FormData;t.append("password",this.password),t.append("id",this.$store.state.auth.userID),u.a.post("/changePassword/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="Password changed successfully!",e.$store.state.alert.type="success",e.$store.state.baseRouterViewKey+=1})).catch((function(t){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="Password change failed!",e.$store.state.alert.type="error",e.$store.state.baseRouterViewKey+=1,console.log(t.response.data.error)}))},verifyPassword:function(){var e=this,t=new FormData;t.append("username",this.$store.state.auth.username),t.append("password",this.oldPassword),u.a.post("/authenticate/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){t.data.userID?e.changePassword():(e.alertFail=!0,e.alertMsg="Wrong Old Password")})).catch((function(e){console.log(JSON.stringify(e))}))}},computed:{oldPasswordErrors:function(){var e=[];return this.$v.oldPassword.$dirty?(!this.$v.oldPassword.required&&e.push("Old Password is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e}}},_t=xt,wt=Object(f["a"])(_t,$t,bt,!1,null,null,null),kt=wt.exports;y()(wt,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardTitle:F["d"],VContainer:ce["a"],VDivider:_e["a"],VFlex:j["a"],VForm:le["a"],VIcon:S["a"],VLayout:W["a"],VSpacer:X["a"],VSystemBar:we["a"],VTextField:ue["a"],VToolbar:Z["a"]});var Pt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" About this page ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" This page let you load data from various sources into the app for reconciliation "),r("v-list",[e._v("1. Select to add remote source if you have a DHIS2 or FHIR server that you want to use its data on this app")]),r("v-list",[e._v("2. Select Upload CSV if you have a CSV file and want to upload its data on the app")]),r("v-list",[e._v("3. The system requires CSV data to have atleast 2 levels above facility")]),r("v-list",[e._v("4. Level 1 is the highest level on the hierarchy i.e Country")]),r("v-list",[e._v(" 5. Base URL under remote sources section refer to the URL i.e http://localhost:3447/fhir and not http://localhost:3447/fhir/Location. Same applies to DHIS2 base URL ")])],1)],1)],1),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v(" Choose way to add data source ")]),r("v-spacer")],1),r("v-card-text",[r("v-radio-group",{attrs:{row:""},on:{change:e.sourceSelected},model:{value:e.dataSource,callback:function(t){e.dataSource=t},expression:"dataSource"}},[e.canUseUploadWay?r("v-radio",{attrs:{disabled:!e.canAddDataset,color:"primary",label:"Upload CSV",value:"upload"}}):e._e(),e.canUseRemoteWay?r("v-radio",{attrs:{disabled:!e.canAddDataset,color:"primary",label:"Remote Source",value:"remote"}}):e._e(),e.canUseBlankWay?r("v-radio",{attrs:{disabled:!e.canAddDataset,color:"primary",label:"Blank Source",value:"blank"}}):e._e()],1)],1)],1)],1),r("v-spacer"),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticClass:"mx-1",attrs:{fab:"",dark:"","x-small":"",color:"primary"},on:{click:function(t){e.helpDialog=!0}}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}])},[r("span",[e._v("Help")])])],1),r("v-flex",{attrs:{xs12:""}},[e.addDataSource?r(e.selectedComponent,{tag:"component"}):e._e()],1)],1),r("appDialogs",{attrs:{datasetLimitWarn:e.datasetLimitWarn},on:{limitWarnStateChange:e.limitWarnStateChange}})],1)},Dt=[],Ct=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Information ")])],1),r("v-card-text",[e._v(" Data uploaded successfully ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.closeDialog("FacilityReconView")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-format-list-bulleted-square")]),e._v(" View Data ")],1)],1)],1)],1),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"1050px"},model:{value:e.invalidRows,callback:function(t){e.invalidRows=t},expression:"invalidRows"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-close-circle")]),e._v("Data Upload was not successful,review below invalid rows in your CSV ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.closeInvalidRows()}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.invalidRowsHeader,items:e.invalidRowsContent,light:""},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.invalidRowsHeader,(function(a){return r("td",{key:a.value},[e._v(e._s(t.item[a.value]))])}))}}])})],1)],1)],1),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.confirmUpload,callback:function(t){e.confirmUpload=t},expression:"confirmUpload"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Warning ")])],1),r("v-card-text",[e._v(" You are about to upload CSV data into the app, click proceed to upload ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.confirmUpload=!1}}},[e._v("Cancel")]),r("v-spacer"),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.performExtraCheck(t)}}},[e._v("Proceed")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.errorDialog,callback:function(t){e.errorDialog=t},expression:"errorDialog"}},[r("v-card",[r("v-card-title",[e._v(" "+e._s(e.errorTitle)+" ")]),r("v-card-text",[e._v(" "+e._s(e.errorContent)+" ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.errorDialog=!1}}},[e._v("Ok")])],1)],1)],1),r("v-dialog",{attrs:{transition:"scale-transition",persistent:"",width:"300"},model:{value:e.uploadPrepaProgr,callback:function(t){e.uploadPrepaProgr=t},expression:"uploadPrepaProgr"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v(" "+e._s(e.uploadStatus)+" "),e.fileUploadPercentage?r("v-progress-linear",{staticClass:"mb-0",attrs:{color:"white"},model:{value:e.fileUploadPercentage,callback:function(t){e.fileUploadPercentage=t},expression:"fileUploadPercentage"}}):r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),r("v-dialog",{attrs:{transition:"scale-transition",persistent:"",width:"270"},model:{value:e.percentDialog,callback:function(t){e.percentDialog=t},expression:"percentDialog"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.uploadStatus))]),r("br"),r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.uploadPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.uploadPercent)+"%")])])])],1)],1)],1)],1)],1),e.$store.state.denyAccess?e._e():r("v-slide-y-transition",{attrs:{mode:"out-in"}},[r("v-stepper",{model:{value:e.e1,callback:function(t){e.e1=t},expression:"e1"}},[r("v-stepper-header",[r("v-stepper-step",{attrs:{step:"1",complete:e.e1>1}},[e._v("Upload CSV")]),r("v-divider"),r("v-stepper-step",{attrs:{step:"2",complete:e.e1>2}},[e._v("Map Headers")]),r("v-btn",{attrs:{icon:""},nativeOn:{click:function(t){return e.closeUploadWindow()}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-stepper-items",[r("v-stepper-content",{attrs:{step:"1"}},[r("v-card",{staticClass:"mb-5"},[r("v-card-title",[e._v("Upload CSV (utf-8 only) - "),r("b",[e._v("Select a CSV file and upload")])]),r("v-card-text",[r("v-text-field",{attrs:{label:"Enter Unique Name For Your Data","error-messages":e.uploadNameErrors,required:""},on:{blur:e.ensureNameUnique,input:e.ensureNameUnique},model:{value:e.uploadName,callback:function(t){e.uploadName=t},expression:"uploadName"}}),r("input",{attrs:{type:"file"},on:{change:e.fileSelected}}),r("br"),r("br"),r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Advanced Options ")]),r("v-card-text",[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.$store.state.dhis.user.orgId?r("v-checkbox",e._g({attrs:{disabled:e.shareWithAll,color:"primary",label:"Share with other users of the same org unit as yours"},model:{value:e.shareToSameOrgid,callback:function(t){e.shareToSameOrgid=t},expression:"shareToSameOrgid"}},a)):e._e()]}}],null,!1,1162473824)},[r("span",[e._v(" Share this dataset with all other users that are on the same org unit as you ")])]),e.$store.state.config.generalConfig.allowShareToAllForNonAdmin||"Admin"===e.$store.state.auth.role?r("v-checkbox",{attrs:{color:"primary",label:"Share with all other users"},on:{change:e.sharingOptions},model:{value:e.shareWithAll,callback:function(t){e.shareWithAll=t},expression:"shareWithAll"}}):e._e(),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.shareWithAll&&e.$store.state.dhis.user.orgId?r("v-checkbox",e._g({attrs:{color:"primary",label:"Limit orgs sharing by user orgid"},model:{value:e.limitShareByOrgId,callback:function(t){e.limitShareByOrgId=t},expression:"limitShareByOrgId"}},a)):e._e()]}}],null,!1,1150100143)},[r("span",[e._v(" if activated, other users will see locations (including location children) that has the same location id as their location id ")])])],1)],1)],1)],1),e.uploadedFileName&&e.uploadName&&0===e.uploadNameErrors.length?r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){e.e1=2}}},[e._v("Continue")]):r("v-btn",{attrs:{color:"primary",disabled:""},nativeOn:{click:function(t){e.e1=2}}},[e._v("Continue")])],1),r("v-stepper-content",{attrs:{step:"2"}},[r("b",[e._v("Map an appropriate CSV header against those on the app.")]),r("v-layout",{ref:"form",attrs:{row:"",wrap:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Facility*")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemFacility,"error-messages":e.facilityErrors,label:"Select",required:"","single-line":"",clearable:""},on:{blur:function(t){return e.$v.facility.$touch()},change:function(t){return e.$v.facility.$touch()}},model:{value:e.facility,callback:function(t){e.facility=t},expression:"facility"}})],1),r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Code*")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemCode,"error-messages":e.codeErrors,label:"Select",required:"","single-line":"",clearable:""},on:{blur:function(t){return e.$v.code.$touch()},change:function(t){return e.$v.code.$touch()}},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Latitude")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLat,label:"Select","single-line":"",clearable:""},model:{value:e.lat,callback:function(t){e.lat=t},expression:"lat"}})],1),r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Longitude")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLong,label:"Select","single-line":"",clearable:""},model:{value:e.long,callback:function(t){e.long=t},expression:"long"}})],1),[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 1")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel1,label:"Select","single-line":"",clearable:""},model:{value:e.level1,callback:function(t){e.level1=t},expression:"level1"}})],1)],[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 2")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel2,label:"Select","single-line":"",clearable:""},model:{value:e.level2,callback:function(t){e.level2=t},expression:"level2"}})],1)],e.showLevel3?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 3")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel3,label:"Select","single-line":"",clearable:""},model:{value:e.level3,callback:function(t){e.level3=t},expression:"level3"}})],1)]:e._e(),e.showLevel4?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 4")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel4,label:"Select","single-line":"",clearable:""},model:{value:e.level4,callback:function(t){e.level4=t},expression:"level4"}})],1)]:e._e(),e.showLevel5?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 5")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel5,label:"Select","single-line":"",clearable:""},model:{value:e.level5,callback:function(t){e.level5=t},expression:"level5"}})],1)]:e._e(),e.showLevel6?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 6")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel6,label:"Select","single-line":"",clearable:""},model:{value:e.level6,callback:function(t){e.level6=t},expression:"level6"}})],1)]:e._e(),e.showLevel7?[r("v-flex",{attrs:{xs6:""}},[r("v-subheader",[e._v("Level 7")])],1),r("v-flex",{attrs:{xs6:""}},[r("v-select",{attrs:{items:e.filteredItemLevel7,label:"Select","single-line":"",clearable:""},model:{value:e.level7,callback:function(t){e.level7=t},expression:"level7"}})],1)]:e._e()],2),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs1:""}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.showLevel7?e._e():r("v-btn",e._g({staticClass:"mx-14",attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:e.showMoreLevel}},a),[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-plus ")])],1)]}}],null,!1,1697189859)},[r("span",[e._v("Add More Level")])])],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.e1=1}}},[e._v("Go Back")])],1),r("v-spacer"),r("v-flex",{attrs:{xs1:""}},[r("v-btn",{attrs:{color:"primary",disabled:e.$v.$invalid},nativeOn:{click:function(t){e.confirmUpload=!0}}},[e._v("Upload")])],1)],1)],1)],1)],1)],1)],1)},Tt=[],It=(r("07ac"),r("4de4"),{data:function(){return{name:"",host:"",username:"",password:"",sourceType:"",limitShareByOrgId:!1,shareWithAll:!1,shareToSameOrgid:!0,invalidCharacters:['"',"/","\\","."]}},methods:{sharingOptions:function(){this.shareWithAll&&(this.shareToSameOrgid=!1)},addDataSource:function(e,t,r){var a=this,s=new FormData,o=this.$store.state.clientId;s.append("host",this.host),s.append("sourceType",this.sourceType),s.append("source",e),s.append("orgId",this.$store.state.dhis.user.orgId),s.append("shareToSameOrgid",this.shareToSameOrgid),s.append("shareToAll",this.shareWithAll),s.append("limitByUserLocation",this.limitShareByOrgId),s.append("username",this.username),s.append("password",this.password),s.append("name",this.name),s.append("clientId",o),s.append("partitionID",t),s.append("levelData",r),s.append("userID",this.$store.state.auth.userID);var i=this.$store.state.dataSources.find((function(e){return e.host===a.host}));u.a.post("/datasource/addSource",s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){Oa.$emit("dataSourceSaved"),Oa.$emit("dataSourceAddedSuccessfully"),Oa.$emit("getDataSources"),i?(i.name=a.name,i.username=a.username,i.password=e.data.password,i.sourceType=a.sourceType):a.$store.state.dataSources.push({name:a.name,host:a.host,sourceType:a.sourceType,source:"syncServer",username:a.username,password:e.data.password})})).catch((function(e){console.log(e),Oa.$emit("remoteServerFailedAdd")}))}}}),At={mixins:[It,P],data:function(){return{partitionID:"",levelData:"",datasetLimitWarn:!1,errorDialog:!1,errorTitle:"",errorContent:"",dialog:!1,fileUploadPercentage:"",percentDialog:!1,uploadPrepaProgr:!1,UploadProgressTimer:"",uploadStatus:"1/3 Uploading CSV to the server",uploadPercent:null,uploadName:"",uploadNameErrors:[],confirmUpload:!1,confirmTitle:"",confirmMsg:"",file:"",uploadedFileName:"",e1:1,facility:null,code:null,lat:null,long:null,level1:null,level2:null,level3:null,level4:null,level5:null,level6:null,level7:null,showLevel3:!1,showLevel4:!1,showLevel5:!1,showLevel6:!1,showLevel7:!1,uploadedHeaders:[],mappedHeaders:[],invalidRowsHeader:[],invalidRowsContent:[],invalidRows:!1,valid:!1}},validations:{facility:{required:oe["required"]},code:{required:oe["required"]},uploadName:{required:oe["required"]}},methods:{fileSelected:function(e){this.uploadedFileName=e.target.files[0]["name"],"text/csv"===e.target.files[0]["type"]||"application/vnd.ms-excel"===e.target.files[0]["type"]&&"csv"===e.target.files[0].name.slice(-3).toLowerCase()||(this.errorDialog=!0,this.errorTitle="Error",this.errorContent="Wrong file type uploaded,Only CSV format is supported",this.uploadedFileName=""),this.file=e.target.files[0];var t=new FileReader;t.addEventListener("load",function(){var e=t.result,r=e.split(/\r\n|\n/),a=r[0];this.uploadedHeaders=a.split(",")}.bind(this),!1),t.readAsText(e.target.files[0],"utf-8")},ensureNameUnique:function(){if(this.uploadNameErrors=[],""===this.uploadName)return this.uploadNameErrors.push("Upload name is required");if(this.uploadName.length>35)return this.uploadNameErrors.push("Name must not exceed 35 characters");var e,t=Object(n["a"])(this.invalidCharacters);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(-1!==this.uploadName.indexOf(r))return this.uploadNameErrors.push("Name is invalid")}}catch(i){t.e(i)}finally{t.f()}var a,s=Object(n["a"])(this.$store.state.dataSources);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.display.toLowerCase()===this.uploadName.toLowerCase())return this.uploadNameErrors.push("This Name Exists"),!1}}catch(i){s.e(i)}finally{s.f()}},confirmSubmit:function(){this.confirmUpload=!0},checkUploadProgress:function(){var e=this,t=this.$store.state.clientId;u.a.get("/progress/uploadProgress/"+t).then((function(t){return t.data&&(t.data.status||t.data.percent||t.data.error)?null!==t.data.error?(e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.data.error,void console.log(t.data.error)):(e.uploadStatus=t.data.status,t.data.percent&&(e.percentDialog||(e.uploadPrepaProgr=!1,e.percentDialog=!0),e.uploadPercent=t.data.percent),void("Done"===t.data.status||t.data.status>=100?(e.clearProgress("uploadProgress"),e.addDataSource("upload",e.partitionID,e.levelData),clearInterval(e.UploadProgressTimer),e.$store.state.recoLevel=2,e.percentDialog=!1,e.dialog=!0,e.$store.state.uploadRunning=!1):e.checkUploadProgress())):(e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,e.$store.state.errorTitle="An error has occured",e.$store.state.errorDescription="You should delete this data source from view data source page then re-upload",e.$store.state.errorColor="error",void(e.$store.state.dialogError=!0))})).catch((function(t){console.log(t),e.checkUploadProgress()}))},performExtraCheck:function(){var e=this;this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Performing extra validations",this.getGeneralConfig((function(){e.datasetLimitWarn=!1,e.$store.state.dynamicProgress=!1,e.canAddDataset?e.submitCSV():(e.confirmUpload=!1,e.datasetLimitWarn=!0)}))},submitCSV:function(){var e=this,t=new FormData;t.append("file",this.file),t.append("csvName",this.uploadName),t.append("facility",this.facility),t.append("code",this.code),t.append("lat",this.lat),t.append("long",this.long),t.append("level1",this.level1),t.append("level2",this.level2),t.append("level3",this.level3),t.append("level4",this.level4),t.append("level5",this.level5),t.append("level6",this.level6),t.append("level7",this.level7),t.append("clientId",this.$store.state.clientId),t.append("userID",this.$store.state.auth.userID),this.confirmUpload=!1,this.$store.state.uploadRunning=!0,this.uploadPrepaProgr=!0,this.host="",this.sourceType="upload",this.username="",this.password="",this.name=this.uploadName,u.a.post("/uploadCSV",t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){this.fileUploadPercentage=parseInt(Math.round(100*e.loaded/e.total)),100===this.fileUploadPercentage&&(this.fileUploadPercentage="",this.uploadStatus="2/3 Validating CSV Data")}.bind(this)}).then((function(t){var r=t.data.partitionID,a=t.data.levelData;e.partitionID=r,e.levelData=a,e.checkUploadProgress()})).catch((function(t){if(Array.isArray(t.response.data.error)){e.invalidRows=!0;for(var r=0;r<t.response.data.error.length;r++){if(0===r){for(var a=Object.keys(t.response.data.error[r].data),s=0,o=a;s<o.length;s++){var i=o[s];e.invalidRowsHeader.push({text:i,value:i})}e.invalidRowsHeader.push({text:"Reason",value:"reason"})}var n=Object.values(t.response.data.error[r].data),c={};for(var l in n)c[e.invalidRowsHeader[l].value]=n[l];c["reason"]=t.response.data.error[r].reason,e.invalidRowsContent.push(c)}}else e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.response.data.error+". Reload page and retry";e.$store.state.uploadRunning=!1,e.uploadPrepaProgr=!1,e.percentDialog=!1,clearInterval(e.UploadProgressTimer)}))},closeInvalidRows:function(){this.invalidRows=!1,this.invalidRowsHeader=[],this.invalidRowsContent=[],this.e1=1},closeDialog:function(e){this.$router.push({name:e}),this.dialog=!1},closeUploadWindow:function(){Oa.$emit("dataSourceSaved")},showMoreLevel:function(){this.showLevel3?this.showLevel4?this.showLevel5?this.showLevel6?this.showLevel7||(this.showLevel7=!0):this.showLevel6=!0:this.showLevel5=!0:this.showLevel4=!0:this.showLevel3=!0}},computed:{facilityErrors:function(){var e=[];return this.$v.facility.$dirty?(!this.$v.facility.required&&e.push("Facility is required"),e):e},codeErrors:function(){var e=[];return this.$v.code.$dirty?(!this.$v.code.required&&e.push("Code is required"),e):e},filteredItemFacility:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemCode:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLat:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLong:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLevel1:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLevel2:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLevel3:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level4&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLevel4:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level5&&t!==e.level6&&t!==e.level7}))},filteredItemLevel5:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level6&&t!==e.level7}))},filteredItemLevel6:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level7}))},filteredItemLevel7:function(){var e=this,t=this.uploadedHeaders;return t.filter((function(t){return t!==e.facility&&t!==e.code&&t!==e.lat&&t!==e.long&&t!==e.level1&&t!==e.level2&&t!==e.level3&&t!==e.level4&&t!==e.level5&&t!==e.level6}))}},created:function(){this.$store.state.uploadProgressData.percentDialog&&(this.percentDialog=this.$store.state.uploadProgressData.percentDialog),this.$store.state.uploadProgressData.uploadPrepaProgr&&(this.uploadPrepaProgr=this.$store.state.uploadProgressData.uploadPrepaProgr),this.$store.state.uploadProgressData.UploadProgressTimer&&(this.UploadProgressTimer=this.$store.state.uploadProgressData.UploadProgressTimer),this.$store.state.uploadProgressData.uploadStatus&&(this.uploadStatus=this.$store.state.uploadProgressData.uploadStatus),this.$store.state.uploadProgressData.uploadPercent&&(this.uploadPercent=this.$store.state.uploadProgressData.uploadPercent)},destroyed:function(){this.$store.state.uploadProgressData.dialog=this.dialog,this.$store.state.uploadProgressData.percentDialog=this.percentDialog,this.$store.state.uploadProgressData.uploadPrepaProgr=this.uploadPrepaProgr,this.$store.state.uploadProgressData.UploadProgressTimer=this.UploadProgressTimer,this.$store.state.uploadProgressData.uploadStatus=this.uploadStatus,this.$store.state.uploadProgressData.uploadPercent=this.uploadPercent}},Lt=At,Ot=(r("d13b"),r("0789")),Nt=r("7e85"),Vt=r("e516"),Rt=r("9c54"),Mt=r("56a4"),Ut=r("e0c7"),Et=Object(f["a"])(Lt,Ct,Tt,!1,null,"047941a7",null),Ft=Et.exports;y()(Et,{VAvatar:Re["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VCheckbox:Je["a"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VDivider:_e["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VProgressCircular:Me["a"],VProgressLinear:z["a"],VSelect:Y["a"],VSlideYTransition:Ot["f"],VSpacer:X["a"],VStepper:Nt["a"],VStepperContent:Vt["a"],VStepperHeader:Rt["a"],VStepperItems:Rt["b"],VStepperStep:Mt["a"],VSubheader:Ut["a"],VTextField:ue["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var qt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"deep-purple darken-4",dark:""}}),r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",text:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add New Remote Source")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.close()}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-select",{attrs:{items:e.$store.state.remoteDataSources,required:"",label:"Source Type"},model:{value:e.sourceType,callback:function(t){e.sourceType=t},expression:"sourceType"}}),r("v-text-field",{attrs:{filled:"",required:"","error-messages":e.nameErrors,color:"deep-purple",label:"Source Name"},on:{blur:e.ensureNameUnique,input:e.ensureNameUnique},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),r("v-text-field",{attrs:{filled:"",required:"",color:"deep-purple",label:"Base URL"},model:{value:e.host,callback:function(t){e.host=t},expression:"host"}}),r("v-text-field",{attrs:{filled:"",color:"deep-purple",label:"Username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),r("v-text-field",{staticStyle:{"min-height":"96px"},attrs:{filled:"",color:"deep-purple",label:"Password",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),[r("v-tooltip",{attrs:{top:""}},[e.$store.state.dhis.user.orgId?r("v-checkbox",{attrs:{slot:"activator",disabled:e.shareWithAll,color:"primary",label:"Share with other users of the same org unit as yours"},slot:"activator",model:{value:e.shareToSameOrgid,callback:function(t){e.shareToSameOrgid=t},expression:"shareToSameOrgid"}}):e._e(),r("span",[e._v(" Share this dataset with all other users that are on the same org unit as you ")])],1),e.$store.state.config.generalConfig.allowShareToAllForNonAdmin||"Admin"===e.$store.state.auth.role?r("v-checkbox",{attrs:{color:"primary",label:"Share with all other users"},on:{change:e.sharingOptions},model:{value:e.shareWithAll,callback:function(t){e.shareWithAll=t},expression:"shareWithAll"}}):e._e(),r("v-tooltip",{attrs:{top:""}},[e.shareWithAll&&e.$store.state.dhis.user.orgId?r("v-checkbox",{attrs:{slot:"activator",color:"primary",label:"Limit orgs sharing by user orgid"},slot:"activator",model:{value:e.limitShareByOrgId,callback:function(t){e.limitShareByOrgId=t},expression:"limitShareByOrgId"}}):e._e(),r("span",[e._v(" if activated, other users will see locations (including location children) that has the same location id as their location id ")])],1)]],2),r("v-divider"),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:e.performExtraCheck}},[e._v(" Add ")])],1)],1)],1),r("v-spacer")],1)],1)},Ht=[],jt={mixins:[It,P],validations:{host:{required:oe["required"]},name:{required:oe["required"]},sourceType:{required:oe["required"]}},data:function(){return{datasetLimitWarn:!1,nameErrors:[]}},methods:{close:function(){Oa.$emit("dataSourceSaved")},performExtraCheck:function(){var e=this;this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Performing extra validations",this.getGeneralConfig((function(){e.datasetLimitWarn=!1,e.$store.state.dynamicProgress=!1,e.canAddDataset?e.addDataSource("syncServer",""):e.datasetLimitWarn=!0}))},ensureNameUnique:function(){if(this.nameErrors=[],""===this.name)return this.nameErrors.push("Name is required");if(this.name.length>35)return this.nameErrors.push("Name must not exceed 35 characters");var e,t=Object(n["a"])(this.invalidCharacters);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(-1!==this.name.indexOf(r))return this.nameErrors.push("Name is invalid")}}catch(i){t.e(i)}finally{t.f()}var a,s=Object(n["a"])(this.$store.state.dataSources);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.display===this.name)return this.nameErrors.push("This Name Exists"),!1}}catch(i){s.e(i)}finally{s.f()}}}},Bt=jt,Wt=Object(f["a"])(Bt,qt,Ht,!1,null,null,null),Gt=Wt.exports;y()(Wt,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardTitle:F["d"],VCheckbox:Je["a"],VContainer:ce["a"],VDivider:_e["a"],VFlex:j["a"],VForm:le["a"],VIcon:S["a"],VLayout:W["a"],VSelect:Y["a"],VSpacer:X["a"],VSystemBar:we["a"],VTextField:ue["a"],VToolbar:Z["a"],VTooltip:_["a"]});var zt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",dark:"",text:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add Blank Source")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.close()}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-layout",{attrs:{column:"",wrap:""}},[r("v-flex",[r("v-text-field",{attrs:{filled:"",required:"","error-messages":e.nameErrors,color:"deep-purple",label:"Source Name"},on:{blur:e.ensureNameUnique,input:e.ensureNameUnique},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),r("v-flex",[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.$store.state.dhis.user.orgId?r("v-checkbox",e._g({attrs:{disabled:e.shareWithAll,color:"primary",label:"Share with other users of the same org unit as yours"},model:{value:e.shareToSameOrgid,callback:function(t){e.shareToSameOrgid=t},expression:"shareToSameOrgid"}},a)):e._e()]}}])},[r("span",[e._v(" Share this dataset with all other users that are on the same org unit as you ")])])],1),r("v-flex",[e.$store.state.config.generalConfig.allowShareToAllForNonAdmin||"Admin"===e.$store.state.auth.role?r("v-checkbox",{attrs:{color:"primary",label:"Share with all other users"},on:{change:e.sharingOptions},model:{value:e.shareWithAll,callback:function(t){e.shareWithAll=t},expression:"shareWithAll"}}):e._e()],1),r("v-flex",[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.shareWithAll&&e.$store.state.dhis.user.orgId?r("v-checkbox",e._g({attrs:{color:"primary",label:"Limit orgs sharing by user orgid"},model:{value:e.limitShareByOrgId,callback:function(t){e.limitShareByOrgId=t},expression:"limitShareByOrgId"}},a)):e._e()]}}])},[r("span",[e._v(" if activated, other users will see locations (including location children) that has the same location id as their location id ")])])],1)],1)],1),r("v-divider"),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:e.$v.$invalid,color:"deep-purple accent-4",depressed:""},on:{click:e.performExtraCheck}},[e._v(" Add ")])],1)],1)],1),r("v-spacer")],1)],1)},Jt=[],Yt={mixins:[It,P],validations:{name:{required:oe["required"]}},data:function(){return{datasetLimitWarn:!1,nameErrors:[]}},methods:{close:function(){Oa.$emit("dataSourceSaved")},performExtraCheck:function(){var e=this;this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Performing extra validations",this.getGeneralConfig((function(){e.datasetLimitWarn=!1,e.$store.state.dynamicProgress=!1,e.canAddDataset?e.addDataSource("blank",""):e.datasetLimitWarn=!0}))},ensureNameUnique:function(){if(this.nameErrors=[],""===this.name)return this.nameErrors.push("Name is required");if(this.name.length>35)return this.nameErrors.push("Name must not exceed 35 characters");var e,t=Object(n["a"])(this.invalidCharacters);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(-1!==this.name.indexOf(r))return this.nameErrors.push("Name is invalid")}}catch(i){t.e(i)}finally{t.f()}var a,s=Object(n["a"])(this.$store.state.dataSources);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.display===this.name)return this.nameErrors.push("This Name Exists"),!1}}catch(i){s.e(i)}finally{s.f()}}}},Kt=Yt,Xt=Object(f["a"])(Kt,zt,Jt,!1,null,null,null),Zt=Xt.exports;y()(Xt,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardTitle:F["d"],VCheckbox:Je["a"],VContainer:ce["a"],VDivider:_e["a"],VFlex:j["a"],VForm:le["a"],VIcon:S["a"],VLayout:W["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbar:Z["a"],VTooltip:_["a"]});var Qt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-xs":""}},[r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"770px",transition:"dialog-transition"},model:{value:e.datasetLimit,callback:function(t){e.datasetLimit=t},expression:"datasetLimit"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("info")]),e._v(" Datasets limit Warning ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.datasetLimit=!1}}},[r("v-icon",[e._v("close")])],1)],1),r("v-card-text",[e._v(" You cant add more datasets as you have reached the datasets limit, contact system administrator for help ")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){e.datasetLimit=!1}}},[e._v("Ok")])],1)],1)],1)],1)},er=[],tr={props:["datasetLimitWarn"],computed:{datasetLimit:{get:function(){return this.datasetLimitWarn},set:function(e){this.$emit("limitWarnStateChange",e)}}}},rr=tr,ar=Object(f["a"])(rr,Qt,er,!1,null,null,null),sr=ar.exports;y()(ar,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VContainer:ce["a"],VDialog:H["a"],VIcon:S["a"],VSpacer:X["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"]});var or={mixins:[P],data:function(){return{helpDialog:!1,datasetLimitWarn:!1,selectedComponent:"",dataSources:[{text:"Upload CSV",value:"upload"},{text:"Remote Source",value:"remote"}],dataSource:"",addDataSource:!0,alertSuccess:!1,alertError:!1,alertMsg:"",blankName:""}},methods:{limitWarnStateChange:function(e){this.datasetLimitWarn=e},sourceSelected:function(e){this.addDataSource=!0,"upload"===e?this.selectedComponent="FacilityReconUpload":"remote"===e?this.selectedComponent="FacilityReconRemoteSources":"blank"===e&&(this.selectedComponent="AddBlankSource")}},computed:{canUseUploadWay:function(){return-1!==this.$store.state.config.generalConfig.datasetsAdditionWays.indexOf("CSV Upload")},canUseRemoteWay:function(){return-1!==this.$store.state.config.generalConfig.datasetsAdditionWays.indexOf("Remote Servers Sync")},canUseBlankWay:function(){return-1!==this.$store.state.config.generalConfig.datasetsAdditionWays.indexOf("Blank Datasource")}},components:{FacilityReconUpload:Ft,FacilityReconRemoteSources:Gt,AddBlankSource:Zt,appDialogs:sr},created:function(){var e=this;Oa.$on("dataSourceSaved",(function(){e.addDataSource=!1,e.dataSource=""})),Oa.$on("dataSourceAddedSuccessfully",(function(){e.alertSuccess=!0,e.alertMsg="Data Source Added Successfully",setTimeout((function(){e.alertSuccess=!1}),3e3)})),Oa.$on("remoteServerFailedAdd",(function(){e.alertError=!0,e.alertMsg="Data Source Failed To Be Added"}))}},ir=or,nr=Object(f["a"])(ir,Pt,Dt,!1,null,null,null),cr=nr.exports;y()(nr,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardText:F["c"],VCardTitle:F["d"],VContainer:ce["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VList:$["a"],VRadio:Xe["a"],VRadioGroup:Ze["a"],VSpacer:X["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var lr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{width:"630px"},model:{value:e.deleteConfirm,callback:function(t){e.deleteConfirm=t},expression:"deleteConfirm"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[e._v(" This will delete the datasource "+e._s(e.server.name)+" from the database ")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.deleteConfirm=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e.loadingPairs||e.pairs.length>0?r("label",[e._v(" Below data source pairs (mapping) will also be deleted "),r("v-data-table",{attrs:{headers:e.pairsHeaders,items:e.pairs,"hide-default-footer":"",loading:e.loadingPairs},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name)+" - "+e._s(t.item.source2Name))]),r("td",[e._v(e._s(t.item.owner))])]}}],null,!1,815489092)})],1):r("label",[e._v(" There is no any data source pair (mapping) associated with this data source"),r("br")]),r("br"),r("b",[e._v("Do you want to proceed and delete?")])]),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},on:{click:function(t){e.deleteConfirm=!1}}},[e._v("Cancel")]),r("v-spacer"),r("v-btn",{attrs:{color:"success"},on:{click:e.deleteDataSource}},[e._v("Yes")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"530px"},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}},[r("v-card",{attrs:{width:"530px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Editing "+e._s(e.server.host)+" ")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.editDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"Name",disabled:""},model:{value:e.server.name,callback:function(t){e.$set(e.server,"name",t)},expression:"server.name"}})],1),r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"Host"},model:{value:e.server.host,callback:function(t){e.$set(e.server,"host",t)},expression:"server.host"}})],1),r("v-flex",{attrs:{xs1:""}},[r("v-select",{attrs:{items:e.$store.state.remoteDataSources,label:"Source Type"},model:{value:e.server.sourceType,callback:function(t){e.$set(e.server,"sourceType",t)},expression:"server.sourceType"}})],1),r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"User Name"},model:{value:e.server.username,callback:function(t){e.$set(e.server,"username",t)},expression:"server.username"}})],1),r("v-flex",{attrs:{xs1:""}},[r("v-text-field",{attrs:{label:"Password",type:"password"},model:{value:e.server.password,callback:function(t){e.$set(e.server,"password",t)},expression:"server.password"}})],1)],1)],1),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-btn",{staticStyle:{color:"white"},attrs:{color:"error"},nativeOn:{click:function(t){e.editDialog=!1}}},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("cancel")]),e._v("Cancel ")],1),r("v-spacer"),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.saveEdit("match")}}},[r("v-icon",{attrs:{left:""}},[e._v("save")]),e._v("Save ")],1)],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"530px"},model:{value:e.shareDialog,callback:function(t){e.shareDialog=t},expression:"shareDialog"}},[r("v-card",{attrs:{width:"530px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Sharing "+e._s(e.shareSource.display)+" ")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.shareDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e.loadingLocationTree?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("p",[r("liquor-tree",{ref:"locationTree",attrs:{data:e.locationTree,options:{}},on:{"node:selected":e.locationSelected}})],1)])],r("v-icon",{attrs:{small:""}},[e._v("mdi-lock")]),e._v(" Limiting Sharing to: "),r("b",[e._v(e._s(e.limitLocationName))]),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUsers,callback:function(t){e.searchUsers=t},expression:"searchUsers"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.usersHeader,items:e.users,search:e.searchUsers,"item-key":"id"},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[a.userName!==e.$store.state.auth.username?r("tr",[r("td",[r("v-checkbox",{attrs:{value:a.id},model:{value:e.sharedUsers,callback:function(t){e.sharedUsers=t},expression:"sharedUsers"}})],1),r("td",[e._v(e._s(a.userName))]),r("td",[e._v(e._s(a.fullName))])]):e._e()]}}])})],2),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-btn",{staticStyle:{color:"white"},attrs:{color:"error",disabled:e.loadingLocationTree},nativeOn:{click:function(t){e.shareDialog=!1}}},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("mdi-cancel")]),e._v("Cancel ")],1),r("v-spacer"),r("v-btn",{attrs:{color:"primary",disabled:e.loadingLocationTree},nativeOn:{click:function(t){return e.share("","saveShare")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-share")]),e._v("Share ")],1)],1)],1)],1),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" About this page ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" This page let you visualize various data sets you have added into the app as well as synchronize remote servers with the app "),r("v-list",[e._v("1. Use Force Full Sync to fetch all data from the remote server and update the app")]),r("v-list",[e._v("2. Use Sync (Update) to pull updated records from the remote server and update the app")]),r("v-list",[e._v("3. You may proceed to the 'Data Source Pair' page after you have added atleast two data sources")]),r("v-list",[e._v("4. You may come back to this page and add more sources at any time")])],1)],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticClass:"mx-1",attrs:{fab:"",dark:"","x-small":"",color:"primary"},on:{click:function(t){e.helpDialog=!0}}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}])},[r("span",[e._v("Help")])])],1)],1),r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-alert",{staticStyle:{width:"500px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",[r("v-card",{attrs:{color:"cyan lighten-5"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v(" Remote Sources ")])],1),r("v-card-actions",[e.remoteServers.length>0?r("v-btn",{attrs:{color:"primary",rounded:""},on:{click:function(t){return e.sync("full")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-sync")]),e._v("Force Full Sync ")],1):r("v-btn",{attrs:{color:"primary",rounded:"",disabled:""},on:{click:function(t){return e.sync("full")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-sync")]),e._v("Force Full Sync ")],1),e.remoteServers.length>0?r("v-btn",{attrs:{color:"primary lighten-1",rounded:""},on:{click:function(t){return e.sync("update")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-sync")]),e._v("Sync (Update) ")],1):r("v-btn",{attrs:{color:"primary lighten-1",rounded:"",disabled:""},on:{click:function(t){return e.sync("update")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-sync")]),e._v("Sync (Update) ")],1),r("v-spacer"),e.remoteServers.length>0?r("v-btn",{attrs:{color:"success",rounded:""},on:{click:e.editDataSource}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-pencil")]),e._v("Edit ")],1):r("v-btn",{attrs:{color:"success",rounded:"",disabled:""},on:{click:e.editDataSource}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-pencil")]),e._v("Edit ")],1),e.remoteServers.length>0?r("v-btn",{attrs:{color:"error",rounded:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v("Delete ")],1):r("v-btn",{attrs:{color:"error",rounded:"",disabled:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v("Delete ")],1)],1),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.syncServersHeader,items:e.remoteServers,dark:"",loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}},[r("td",[r("v-radio",{attrs:{value:a,color:"blue"}})],1)]),r("td",[e._v(e._s(a.resource.flatExtension.name))]),r("td",[e._v(e._s(a.resource.flatExtension.host))]),r("td",[e._v(e._s(a.resource.flatExtension.sourceType))]),r("td",[e._v(e._s(a.resource.flatExtension.username))]),a.resource.flatExtension.username?r("td",[e._v("*****")]):r("td"),r("td",[e._v(e._s(a.lastUpdate))]),r("td",[e._v(e._s(a.resource.flatExtension.userID.reference))]),r("td",[e._v(" "+e._s(e._f("mergeUsers")(a.resource.flatExtension.sharedUsers))+" ")]),r("td",[e._v(" "+e._s(a.resource.flatExtension.createdTime)+" ")]),a.resource.flatExtension.userID.reference===e.$store.state.auth.userID?r("td",[r("v-btn",{attrs:{color:"success",flat:""},on:{click:function(t){return e.share(a,"showDialog")}}},[r("v-icon",[e._v("mdi-share-variant-outline")]),e._v(" Share ")],1)],1):e._e()],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white"}},[e._v(" Uploaded Sources ")])],1),r("v-card-actions",[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.uploadedSources.length>0?r("v-btn",e._g({attrs:{color:"success",rounded:""},on:{click:e.exportCSV}},a),[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-document-multiple")]),e._v("Export ")],1):r("v-btn",e._g({attrs:{color:"success",rounded:"",disabled:""},on:{click:e.exportCSV}},a),[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-document-multiple")]),e._v("Export ")],1)]}}])},[r("span",[e._v("Export Original CSV")])]),r("v-spacer"),e.uploadedSources.length>0?r("v-btn",{attrs:{color:"error",rounded:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v("Delete ")],1):r("v-btn",{attrs:{color:"error",rounded:"",disabled:""},on:{click:e.validateDelete}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v("Delete ")],1)],1),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.uploadSourcesHeader,items:e.uploadedSources,dark:"",loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}},[r("td",[r("v-radio",{attrs:{value:a,color:"blue"}})],1)]),r("td",[e._v(e._s(a.display))]),r("td",[e._v(e._s(a.owner))]),r("td",[e._v(" "+e._s(e._f("mergeUsers")(a.sharedUsers))+" ")]),r("td",[e._v(" "+e._s(a.createdTime)+" ")]),a.userID===e.$store.state.auth.userID?r("td",[r("v-btn",{attrs:{color:"success",text:""},on:{click:function(t){return e.share(a,"showDialog")}}},[r("v-icon",[e._v("mdi-share-variant-outline")]),e._v(" Share ")],1)],1):e._e()],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1),r("v-spacer")],1),e.server.name?r("appRemoteSync",{attrs:{syncType:e.syncType,serverName:e.server.name,userID:e.$store.state.auth.userID,sourceOwner:e.server.userID,mode:e.mode}}):e._e()],1)},ur=[],dr=(r("2b3d"),r("25ea")),hr={mixins:[P],data:function(){return{syncType:"",mode:"",loadingPairs:!1,pairs:[],pairsHeaders:[{text:"Pair Name",value:"name"},{text:"Owner",value:"owner"}],helpDialog:!1,deleteConfirm:!1,editDialog:!1,server:{name:"",userID:{}},shareDialog:!1,shareSource:{},users:[],sharedUsers:[],limitLocationId:"",limitLocationName:"No limit",locationTree:[],loadingLocationTree:!1,searchUsers:"",syncServersHeader:[{sortable:!1},{text:"Source Name",value:"name"},{text:"Base URL",value:"host"},{text:"Source Type",value:"sourceType"},{text:"User Name",value:"username"},{text:"Password",value:"password"},{text:"Last Sync",value:"lastsync"},{text:"Owner",value:"owner",sortable:!1},{text:"Shared To",value:"shareStatus"},{text:"Created Time",value:"createdTime"}],uploadSourcesHeader:[{sortable:!1},{text:"Source Name",align:"left",value:"name"},{text:"Owner",value:"owner",sortable:!1},{text:"Shared To",value:"shareStatus"},{text:"Created Time",value:"createdTime"}],dataSources:[{text:"Upload CSV",value:"upload"},{text:"Remote Source",value:"remote"}],usersHeader:[{sortable:!1},{text:"Username",value:"userName",sortable:!0},{text:"Fullname",value:"fullName",sortable:!0}],dataSource:"",addDataSource:!0,syncProgrIndeter:!1,syncProgrPercent:!1,syncStatus:"Waiting for sync status",syncPercent:null,syncProgressTimer:"",syncRunning:!1,alertSuccess:!1,alertError:!1,alertMsg:""}},filters:{mergeUsers:function(e){if(!e||0===e.length)return"";var t,r="",a=0,s=Object(n["a"])(e);try{for(s.s();!(t=s.n()).done;){var o=t.value;if(a++,a>5){r+="...";break}r?r+=","+o.name:r=o.name}}catch(i){s.e(i)}finally{s.f()}return r}},methods:{sourceSelected:function(e){this.addDataSource=!0,"upload"===e?this.selectedComponent="FacilityReconUpload":"remote"===e&&(this.selectedComponent="FacilityReconRemoteSources")},editDataSource:function(){return this.server.name?this.server.userID!==this.$store.state.auth.userID?(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="You are not the owner of this data source, ask the owner to edit any details")):void("upload"!==this.server.source&&(this.editDialog=!0)):(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source"))},saveEdit:function(){var e=this,t=new FormData,r=this.$store.state.clientId;t.append("host",this.server.host),t.append("sourceType",this.server.sourceType),t.append("source",this.server.source),t.append("username",this.server.username),t.append("password",this.server.password),t.append("userID",this.server.userID),t.append("name",this.server.name),t.append("id",this.server.id),t.append("clientId",r),this.editDialog=!1,u.a.post("/datasource/editSource",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){e.server.password=t.data.password}))},validateDelete:function(){return this.server.name?this.server.userID!==this.$store.state.auth.userID&&"Admin"!==this.$store.state.auth.role?(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="You are not the owner of this data source, ask the owner to remove you from the share")):(this.getPairsToDelete(),void(this.deleteConfirm=!0)):(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source"))},deleteDataSource:function(){var e=this;this.deleteConfirm=!1,u.a.delete("/datasource/deleteDataSource/".concat(this.server.id)).then((function(){e.server={},Oa.$emit("getDataSources")}))},getPairsToDelete:function(){var e=this;this.loadingPairs=!0,u.a.get("/datasource/getPairForSource/"+this.server.id).then((function(t){e.loadingPairs=!1,e.pairs=t.data})).catch((function(e){e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message),console.log(e.config)}))},share:function(e,t){var r=this;if("showDialog"===t)this.limitLocationId="",this.limitLocationName="No limit",this.sharedUsers=[],this.shareSource=e,this.getLocationTree(),e.hasOwnProperty("shared")&&e.shared.users.length>0&&e.shared.users.forEach((function(e){r.sharedUsers.push(e.id)})),this.shareDialog=!0;else if("saveShare"===t){if(0===this.sharedUsers.length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select atleast one user");var a=new FormData;a.append("shareSource",this.shareSource.id),a.append("users",JSON.stringify(this.sharedUsers)),a.append("userID",this.$store.state.auth.userID),a.append("role",this.$store.state.auth.role),a.append("orgId",this.$store.state.dhis.user.orgId),a.append("limitLocationId",this.limitLocationId),this.$store.state.loadingServers=!0,this.shareDialog=!1,u.a.post("/datasource/shareSource",a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){r.$store.state.loadingServers=!1,Oa.$emit("getDataSources")})).catch((function(e){console.log(e),r.$store.state.loadingServers=!1}))}},locationSelected:function(e){this.limitLocationId=e.id,"parent"!==e.id?this.limitLocationName=e.data.text:(this.limitLocationName="No limit",this.limitLocationId="")},getLocationTree:function(){var e=this,t=this.shareSource.userID;this.loadingLocationTree=!0;var r=this.toTitleCase(this.shareSource.name);u.a.get("/getTree/"+r+"/"+t).then((function(t){t.data&&(e.locationTree=[{text:"Select location to limit sharing",id:"parent",children:t.data}]),e.loadingLocationTree=!1}))},getUsers:function(){var e=this;u.a.get("/users/getUsers").then((function(t){e.users=t.data}))},exportCSV:function(){var e=this;if(!this.server.name)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source");var t=this.server.userID;u.a.get("/getUploadedCSV/"+t+"/"+this.server.name).then((function(t){var r=new Blob([t.data]);if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(r,"".concat(e.server.name,".csv"));else{var a=window.document.createElement("a");a.href=window.URL.createObjectURL(r,{type:"text/plain"}),a.download="".concat(e.server.name,".csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}})).catch((function(t){e.$store.state.dialogError=!0,e.$store.state.errorTitle="Error",e.$store.state.errorDescription=t.response.data}))},sync:function(e){return this.server.name?this.server.userID!==this.$store.state.auth.userID?(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Only data source owner can run the sync")):void("upload"!==this.server.source&&(this.mode=e,"DHIS2"===this.server.sourceType?this.syncType="dhisSync":"FHIR"===this.server.sourceType&&(this.syncType="fhirSync"),setTimeout((function(){Oa.$emit("runRemoteSync")}),100))):(this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select data source"))}},computed:{remoteServers:function(){var e,t=[],r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(e=r.n()).done;){var a=e.value;"syncServer"===a.source&&t.push(a)}}catch(s){r.e(s)}finally{r.f()}return t},uploadedSources:function(){var e,t=[],r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(e=r.n()).done;){var a=e.value;"upload"!==a.source&&"blank"!==a.source||t.push(a)}}catch(s){r.e(s)}finally{r.f()}return t}},components:{appRemoteSync:Be,"liquor-tree":dr["a"]},created:function(){var e=this;this.getUsers(),Oa.$on("dataSourceSaved",(function(){e.addDataSource=!1,e.dataSource=""})),Oa.$on("dataSourceAddedSuccessfully",(function(){e.alertSuccess=!0,e.alertMsg="Data Source Added Successfully",setTimeout((function(){e.alertSuccess=!1}),3e3)})),Oa.$on("remoteServerFailedAdd",(function(){e.alertError=!0,e.alertMsg="Data Source Failed To Be Added"}))}},vr=hr,pr=Object(f["a"])(vr,lr,ur,!1,null,null,null),gr=pr.exports;y()(pr,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VCheckbox:Je["a"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VList:$["a"],VProgressLinear:z["a"],VRadio:Xe["a"],VRadioGroup:Ze["a"],VSelect:Y["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var fr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("center",[r("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.confirmPairDeleteDialog,callback:function(t){e.confirmPairDeleteDialog=t},expression:"confirmPairDeleteDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[e._v(" Confirm deleting ")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.confirmPairDeleteDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" Are you sure you want to delete this data source pair ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){e.confirmPairDeleteDialog=!1}}},[e._v("Cancel")]),r("v-spacer"),r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){return e.deletePair(t)}}},[e._v("Ok")])],1)],1)],1),r("v-alert",{staticStyle:{width:"1000px"},attrs:{type:"success",dismissible:"",transition:"scale-transition"},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-alert",{staticStyle:{width:"1000px"},attrs:{type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")]),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"770px",transition:"dialog-transition"},model:{value:e.pairLimitWarn,callback:function(t){e.pairLimitWarn=t},expression:"pairLimitWarn"}},[r("v-card",[r("v-toolbar",{attrs:{color:"error",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" Pair creation limit ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.pairLimitWarn=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" You cant create more pairs as this account is limited to one pair only at a time. ")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(t){e.pairLimitWarn=!1}}},[e._v("Ok")])],1)],1)],1),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"770px",transition:"dialog-transition"},model:{value:e.mapSourcePairLevels,callback:function(t){e.mapSourcePairLevels=t},expression:"mapSourcePairLevels"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" Data sources has different level counts, please map Levels to proceed ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.closeLevelMappingDialog(t)}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[r("v-data-table",{attrs:{headers:e.pairLevelsMappingHeader,items:e.source1Levels},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.text))]),r("td",[e.pairLevelsMapping[a.value]?[e._v(" "+e._s(e.$store.state.levelMapping.source2[e.pairLevelsMapping[a.value]])+" "),r("v-icon",{attrs:{small:""},on:{click:function(t){return e.clearMappingSelection(a.value)}}},[e._v("mdi-close")])]:r("v-select",{attrs:{items:e.source2Levels,clearable:""},on:{change:function(t){return e.mappingSelected(a.value)}},model:{value:e.pairLevelsMapping[a.value],callback:function(t){e.$set(e.pairLevelsMapping,a.value,t)},expression:"pairLevelsMapping[item.value]"}})],2)])]}}])})],1),r("v-card-actions",[r("v-btn",{attrs:{color:"error",rounded:""},on:{click:e.closeLevelMappingDialog}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-cancel")]),e._v(" Cancel ")],1),r("v-spacer"),r("v-btn",{attrs:{color:"primary",rounded:""}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v("Save Mapping ")],1)],1)],1)],1),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" About this page ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" This page let you choose a pair of data sources to use for reconciliation "),r("v-list",[e._v("1. Source 1 is the source while source 2 is the target")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"530px"},model:{value:e.shareDialog,callback:function(t){e.shareDialog=t},expression:"shareDialog"}},[r("v-card",{attrs:{width:"530px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Sharing "),e.sharePair.hasOwnProperty("source1")?[e._v(e._s(e.sharePair.source1.display)+" - "+e._s(e.sharePair.source2.display))]:e._e()],2),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.shareDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUsers,callback:function(t){e.searchUsers=t},expression:"searchUsers"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.usersHeader,items:e.users,search:e.searchUsers},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[a.userName!==e.$store.state.auth.username?r("tr",[r("td",[r("v-checkbox",{attrs:{value:a.id},model:{value:e.sharedUsers,callback:function(t){e.sharedUsers=t},expression:"sharedUsers"}})],1),r("td",[e._v(e._s(a.userName))]),r("td",[e._v(e._s(a.fullName))])]):e._e()]}}])})],1),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-btn",{staticStyle:{color:"white"},attrs:{color:"error"},nativeOn:{click:function(t){e.shareDialog=!1}}},[r("v-icon",{attrs:{dark:"",left:""}},[e._v("mdi-cancel")]),e._v("Cancel ")],1),r("v-spacer"),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.share("","saveShare")}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-share-variant-outline")]),e._v("Share ")],1)],1)],1)],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs11:""}},[e._v(" Create/Choose a pair of data sources to use for reconciliation. Source 1 is the source while source 2 is the target ")]),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticClass:"mx-1",attrs:{fab:"",dark:"","x-small":"",color:"primary"},on:{click:function(t){e.helpDialog=!0}}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}])},[r("span",[e._v("Help")])])],1)],1),r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-card",{staticStyle:{width:"1000px"},attrs:{color:"cyan lighten-5"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white lighten-2"}},[e._v(" Create Data Source Pair ")])],1),r("v-card-text",{staticStyle:{float:"center"}},[r("v-row",[r("v-col",[r("v-data-table",{attrs:{headers:e.source1Headers,items:e.$store.state.dataSources,loading:e.$store.state.loadingServers,dark:""},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.source1,callback:function(t){e.source1=t},expression:"source1"}},[r("td",[r("v-radio",{attrs:{value:a,color:"blue"}})],1)]),r("td",[e._v(e._s(a.display))])],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),r("v-col",[r("v-data-table",{attrs:{headers:e.source2Headers,items:e.dataSources2,"item-key":"id",loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.source2,callback:function(t){e.source2=t},expression:"source2"}},[r("td",[r("v-radio",{attrs:{value:a,color:"blue"}})],1)]),r("td",[e._v(e._s(a.display))])],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1),r("v-card-actions",[r("v-btn",{attrs:{disabled:!e.pairSelected,color:"error",rounded:""},on:{click:e.reset}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-refresh")]),e._v(" Reset ")],1),r("v-spacer"),r("v-btn",{attrs:{disabled:!e.canCreatePair||!e.pairSelected,color:"primary",rounded:""},on:{click:e.checkLevels}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" Save ")],1)],1)],1)],1),r("v-flex",[r("v-card",{staticStyle:{width:"1000px"},attrs:{color:"cyan lighten-4"}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{"font-weight":"bold","font-size":"18px"},attrs:{color:"white lighten-2"}},[e._v(" Existing Data Source Pairs "),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchPairs,callback:function(t){e.searchPairs=t},expression:"searchPairs"}})],1)],1),r("v-card-text",{staticStyle:{float:"center"}},[r("v-data-table",{attrs:{headers:e.sourcePairHeaders,items:e.$store.state.dataSourcePairs,search:e.searchPairs,loading:e.$store.state.loadingServers},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.source1.display)+" - "+e._s(a.source2.display))]),r("td",[e._v(e._s(a.user.name))]),r("v-radio-group",{staticStyle:{height:"5px"},model:{value:e.activeDataSourcePair,callback:function(t){e.activeDataSourcePair=t},expression:"activeDataSourcePair"}},[r("td",[r("v-radio",{attrs:{value:a,color:"blue"}})],1)]),r("td",[e._v(" "+e._s(e._f("mergeUsers")(a.sharedUsers))+" ")]),a.user.id===e.$store.state.auth.userID?r("td",[r("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.share(a,"showDialog")}}},[r("v-icon",[e._v("mdi-share-variant-outline")]),e._v("Share ")],1)],1):e._e()],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1),r("v-card-actions",[r("v-btn",{attrs:{disabled:!e.canDeletePair,color:"error",rounded:""},on:{click:e.confirmDeletePair}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-delete")]),e._v("Delete Pair ")],1),r("v-spacer"),r("v-btn",{attrs:{disabled:!e.canActivatePair,color:"primary",rounded:""},on:{click:e.activatePair}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v("Activate Pair ")],1)],1)],1)],1)],1)],1)],1)},mr=[],yr={mixins:[P,T],data:function(){return{confirmPairDeleteDialog:!1,helpDialog:!1,alertSuccess:!1,alertError:!1,alertMsg:"",pairLimitWarn:!1,shareDialog:!1,mapSourcePairLevels:!1,pairLevelsMapping:{},sharePair:{},source1:{},source2:{},searchPairs:"",searchSources:"",searchUsers:"",users:[],sharedUsers:[],activeDataSourcePair:{},pairLevelsMappingHeader:[{text:"Source 1 Levels",value:"headerSource1Levels",sortable:!1},{text:"Source 2 Levels",value:"headerSource1Levels",sortable:!1}],source1Headers:[{sortable:!1},{text:"Source 1",value:"headerSource1",sortable:!1}],source2Headers:[{sortable:!1},{text:"Source 2",value:"headerSource2",sortable:!1}],sourcePairHeaders:[{text:"Pair",value:"pair"},{text:"Owner",value:"owner",sortable:!1},{text:"Active",value:"active"},{text:"Shared To",value:"shareStatus"}],usersHeader:[{},{text:"Username",value:"username",sortable:!0},{text:"Full Name",value:"fname",sortable:!0}],source1Levels:[],source2Levels:[]}},filters:{mergeUsers:function(e){if(!e||0===e.length)return"";var t,r="",a=0,s=Object(n["a"])(e);try{for(s.s();!(t=s.n()).done;){var o=t.value;if(a++,a>5){r+="...";break}r?r+=","+o.name:r=o.name}}catch(i){s.e(i)}finally{s.f()}return r}},methods:{confirmDeletePair:function(){this.confirmPairDeleteDialog=!0},deletePair:function(){var e=this;this.confirmPairDeleteDialog=!1;var t="pairId=".concat(this.activeDataSourcePair.id,"&userID=").concat(this.$store.state.auth.userID,"&pairOwner=").concat(this.activeDataSourcePair.user.id,"&source1Name=").concat(this.activeDataSourcePair.source1.name,"&source2Name=").concat(this.activeDataSourcePair.source2.name);u.a.delete("/datasource/deleteSourcePair?"+t).then((function(){e.$store.state.errorTitle="Pair Deletion",e.$store.state.errorDescription="Pair deleted successfully",e.$store.state.dialogError=!0,setTimeout((function(){Oa.$emit("getDataSourcePair")}),500)})).catch((function(t){e.$store.state.errorTitle="Pair Deletion",e.$store.state.errorDescription="An error occured while deleting pair, please retry",e.$store.state.errorColor="error",e.$store.state.dialogError=!0,console.log(JSON.stringify(t))}))},reset:function(){var e=this;this.source1={},this.source2={},this.activeDataSourcePair={},this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Reseting Data Source Pairs";var t=this.$store.state.auth.userID;u.a.get("/datasource/resetDataSourcePair/"+t).then((function(){Oa.$emit("getDataSourcePair"),e.$store.state.dynamicProgress=!1,e.alertSuccess=!0,e.alertMsg="Data Source Pair Reseted Successfully"})).catch((function(t){e.alertError=!0,e.alertMsg="Something went wrong while reseting data source pairs",console.log(t)}))},checkLevels:function(){var e=this;this.pairLevelsMapping={};var t=JSON.stringify({source1LimitOrgId:this.getLimitOrgIdOnDataSource(this.source1),source2LimitOrgId:this.getLimitOrgIdOnDataSource(this.source2)});u.a.get("/datasource/countLevels?source1Id=".concat(this.source1.id,"&source1DB=").concat(this.source1.name,"&source2Id=").concat(this.source2.id,"&source2DB=").concat(this.source2.name,"&sourcesLimitOrgId=").concat(t)).then((function(t){return 1===t.data.totalSource1Levels?(e.$store.state.errorTitle="No data for you",e.$store.state.errorDescription="Cant create this pair, "+e.source1.name+" has no data for you",void(e.$store.state.dialogError=!0)):1===t.data.totalSource2Levels?(e.$store.state.errorTitle="No data for you",e.$store.state.errorDescription="Cant create this pair, "+e.source2.name+" has no data for you",void(e.$store.state.dialogError=!0)):void(t.data.totalSource1Levels>t.data.totalSource2Levels?(e.$store.state.errorTitle="Levels mismatch",e.$store.state.errorDescription="Make sure source1 has the same or less levels as source2",e.$store.state.dialogError=!0):e.createDatasourcePair(e.source1,e.source2))}))},mappingSelected:function(e){var t=this;this.source2Levels=this.source2Levels.filter((function(r){return r.value!==t.pairLevelsMapping[e]}))},clearMappingSelection:function(e){this.source2Levels.push({text:this.$store.state.levelMapping.source2[this.pairLevelsMapping[e]],value:this.pairLevelsMapping[e]});var t,r=Object.keys(this.pairLevelsMapping),a=r.filter((function(t){return t!==e})),s={},o=Object(n["a"])(a);try{for(o.s();!(t=o.n()).done;){var i=t.value;s[i]=this.pairLevelsMapping[i]}}catch(c){o.e(c)}finally{o.f()}this.pairLevelsMapping=s},closeLevelMappingDialog:function(){for(var e in this.pairLevelsMapping)this.source2Levels.push({text:this.$store.state.levelMapping.source2[this.pairLevelsMapping[e]],value:this.pairLevelsMapping[e]});this.mapSourcePairLevels=!1},share:function(e,t){var r=this;if("showDialog"===t)this.sharedUsers=[],this.sharePair=e,e.hasOwnProperty("sharedUsers")&&e.sharedUsers.length>0&&e.sharedUsers.forEach((function(e){r.sharedUsers.push(e.id)})),this.shareDialog=!0;else if("saveShare"===t){if(0===this.sharedUsers.length)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Info",void(this.$store.state.errorDescription="Please select atleast one user");var a=new FormData;a.append("sharePair",this.sharePair.id),a.append("users",JSON.stringify(this.sharedUsers)),a.append("userID",this.$store.state.auth.userID),a.append("orgId",this.$store.state.dhis.user.orgId),this.$store.state.loadingServers=!0,this.shareDialog=!1,u.a.post("/datasource/shareSourcePair",a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){r.$store.state.loadingServers=!1,r.$store.state.dataSourcePairs=e.data})).catch((function(e){console.log(e),r.$store.state.loadingServers=!1}))}},getUsers:function(){var e=this;u.a.get("/users/getUsers").then((function(t){e.users=t.data}))}},computed:{dataSources2:function(){if(this.$store.state.config.generalConfig.reconciliation.fixSource2){var e,t="",r=Object(n["a"])(this.$store.state.dataSources);try{for(r.s();!(e=r.n()).done;){var a=e.value;a.id===this.$store.state.config.generalConfig.reconciliation.fixSource2To&&(t=a)}}catch(s){r.e(s)}finally{r.f()}return[t]}return this.$store.state.dataSources},canCreatePair:function(){return!this.$store.state.dhis.user.orgId||!this.$store.state.config.generalConfig.reconciliation.singlePair||0===this.$store.state.dataSourcePairs.length},pairSelected:function(){return!(!this.source1.id||!this.source2.id)},canDeletePair:function(){return!!this.activeDataSourcePair.id&&this.activeDataSourcePair.user.id===this.$store.state.auth.userID},canActivatePair:function(){return!(0===this.$store.state.dataSourcePairs.length||!this.activeDataSourcePair.id)}},created:function(){var e=this;for(var t in this.canCreatePair||(this.pairLimitWarn=!0),this.getUsers(),this.source1=this.$store.state.dataSources.find((function(t){return t.id===e.$store.state.activePair.source1.id})),this.source2=this.$store.state.dataSources.find((function(t){return t.id===e.$store.state.activePair.source2.id})),this.activeDataSourcePair=this.getActiveDataSourcePair(),this.source1||(this.source1={}),this.source2||(this.source2={}),this.$store.state.levelMapping.source2)"code"!==t&&this.source2Levels.push({text:this.$store.state.levelMapping.source2[t],value:t});for(var r in this.$store.state.levelMapping.source1)"code"!==r&&this.source1Levels.push({text:this.$store.state.levelMapping.source1[r],value:r})}},Sr=yr,$r=Object(f["a"])(Sr,fr,mr,!1,null,null,null),br=$r.exports;y()($r,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VCheckbox:Je["a"],VCol:q["a"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VList:$["a"],VProgressLinear:z["a"],VRadio:Xe["a"],VRadioGroup:Ze["a"],VRow:J["a"],VSelect:Y["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var xr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[e.$store.state.uploadRunning?[r("br"),r("br"),r("br"),r("v-alert",{attrs:{type:"info",value:!0}},[r("b",[e._v("Wait for upload to finish ...")]),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)]:e._e(),!e.$store.state.denyAccess&!e.$store.state.uploadRunning?[r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" About this page ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" This page let you view dat you have uploaded or synchronized from a remote server "),r("v-list",[e._v("1. Use the tree to filter grid data")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Warning ")])],1),r("v-card-text",[e._v(" Are you sure that you want to delete "+e._s(e.deleteLocationData.facility)+" ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.confirmDelete=!1}}},[e._v("Cancel")]),r("v-spacer"),r("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.deleteLocation()}}},[e._v("Proceed")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition","max-width":"500px"},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}},[r("v-card",{attrs:{height:"500px"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Edit Location ")]),r("v-spacer"),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.editDialog=!1}}},[e._v("close")])],1),r("v-card-text",[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-text-field",{attrs:{"error-messages":e.editLocationNameErrors,required:"",label:"Facility"},on:{blur:function(t){return e.$v.editLocationName.$touch()},change:function(t){return e.$v.editLocationName.$touch()}},model:{value:e.editLocationName,callback:function(t){e.editLocationName=t},expression:"editLocationName"}})],1),r("v-flex",[r("v-select",{attrs:{items:e.editParents,box:"",label:"Parent"},model:{value:e.editLocationParent,callback:function(t){e.editLocationParent=t},expression:"editLocationParent"}})],1)],1)],1)],1),r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-toolbar",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:"","text-sm-left":""}},[r("v-btn",{attrs:{color:"error"},nativeOn:{click:function(t){e.editDialog=!1}}},[r("v-icon",{attrs:{left:""}},[e._v("cancel")]),e._v(" Cancel ")],1)],1),r("v-flex",{attrs:{xs6:"","text-sm-right":""}},[r("v-btn",{attrs:{color:"primary",disabled:e.$v.$invalid,dark:""},on:{click:function(t){return e.saveEdit()}}},[r("v-icon",{attrs:{left:""}},[e._v("save")]),e._v("Save ")],1)],1)],1)],1)],1)],1)],1),r("v-row",[r("v-spacer"),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticClass:"mx-1",attrs:{fab:"",dark:"","x-small":"",color:"primary"},on:{click:function(t){e.helpDialog=!0}}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}],null,!1,3148663098)},[r("span",[e._v("Help")])])],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 1 Data Tree")])]),e.loadingSource1Tree?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("p",[r("liquor-tree",{ref:"source1Tree",attrs:{data:e.source1Tree,options:{}},on:{"node:selected":e.source1NodeSelected}})],1)])]],2)],1),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 2 Data Tree")])]),e.loadingSource2Tree?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("p",[r("liquor-tree",{ref:"source2Tree",attrs:{data:e.source2Tree,options:{}},on:{"node:selected":e.source2NodeSelected}})],1)])]],2)],1),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 1 Data Grid")])]),e.loadingSource1Grid?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source1GridHeader,items:e.source1Grid,search:e.searchSource1,options:e.source1Pagination,"server-items-length":e.totalSource1Records,loading:e.loadingSource1,"hide-default-footer":""},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.source1GridHeader,(function(a,s){return r("td",{key:a.value+1,staticStyle:{"white-space":"nowrap",overflow:"hidden"}},[0===s&&e.isDataset1Owner?[r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){return e.edit(t.item,"source1")}}},[e._v("edit")]),e._v(" | "),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){return e.deleteLocation(t.item,"source1","requestConfirmation")}}},[e._v("delete")])]:[e._v(" "+e._s(t.item[a.value])+" ")]],2)}))}}],null,!1,1855409753)})],1),r("div",{staticClass:"text-xs-center pt-2"},[r("v-pagination",{attrs:{length:e.source1Pages},model:{value:e.source1Pagination.page,callback:function(t){e.$set(e.source1Pagination,"page",t)},expression:"source1Pagination.page"}})],1)]],2)],1),r("v-flex",{attrs:{xs6:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v("Source 2 Data Grid")])]),e.loadingSource2Grid?[r("v-progress-linear",{attrs:{indeterminate:!0}})]:[r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source2GridHeader,items:e.source2Grid,search:e.searchSource2,options:e.source2Pagination,"server-items-length":e.totalSource2Records,loading:e.loadingSource2,"hide-default-footer":""},scopedSlots:e._u([{key:"items",fn:function(t){return e._l(e.source2GridHeader,(function(a,s){return r("td",{key:a.value+2,staticStyle:{"white-space":"nowrap",overflow:"hidden"}},[0===s&&e.isDataset2Owner?[r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){return e.edit(t.item,"source2")}}},[e._v("edit")]),e._v(" | "),r("v-icon",{staticStyle:{cursor:"pointer"},on:{click:function(r){return e.deleteLocation(t.item,"source2","requestConfirmation")}}},[e._v("delete")])]:[e._v(" "+e._s(t.item[a.value])+" ")]],2)}))}}],null,!1,592712922)})],1),r("div",{staticClass:"text-xs-center pt-2"},[r("v-pagination",{attrs:{length:e.source2Pages},model:{value:e.source2Pagination.page,callback:function(t){e.$set(e.source2Pagination,"page",t)},expression:"source2Pagination.page"}})],1)]],2)],1)],1),r("br"),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs1:"",xl10:""}},[r("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){return e.$router.push({name:"FacilityReconScores"})}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-find")]),e._v(" Reconcile ")],1)],1)],1)]:e._e()],2)},_r=[],wr={validations:{editLocationName:{required:oe["required"]}},mixins:[C,P],data:function(){return{confirmDelete:!1,deleteLocationData:"",deleteSource:{name:"",value:""},editDialog:!1,editLocationName:"",editLocationId:"",editParents:[],editLocationParent:"",editSource:"",helpDialog:!1,lastLevel:[],headerText:{level2:"Level 1",level3:"Level 2",level4:"Level 3",level5:"Level 4",level6:"Level 5",level7:"Level 6",level8:"Level 7",level9:"Level 8",level10:"Level 9",facility:"Facility",latitude:"Latitude",longitude:"Longitude"},headers:[{text:"Level 1",value:"level1"},{text:"Level 2",value:"level2"},{text:"Level 3",value:"level3"},{text:"Level 4",value:"level4"},{text:"Facility",value:"facility"},{text:"Latitude",value:"latitude"},{text:"Longitude",value:"longitude"}],searchSource1:"",searchSource2:"",filterSource1:{text:"",level:""},filterSource2:{text:"",level:""},source2Pagination:{rowsPerPage:20},source1Pagination:{rowsPerPage:20},loadingSource1:!1,loadingSource2:!1,totalSource1Records:0,totalSource2Records:0,source2Grid:[],source1Grid:[],source1Tree:[],source2Tree:[],source1Start:1,source2Start:1,source1Count:10,source2Count:10,loadingSource1Tree:!1,loadingSource2Tree:!1,loadingSource1Grid:!1,loadingSource2Grid:!1,currentSource2Pagination:{},currentSource1Pagination:{},source1SelNodeId:!1,source2SelNodeId:!1,sourceOwner:""}},methods:{edit:function(e,t){var r=this.getDatasourceOwner();"source1"===t?(this.sourceOwner=r.source1Owner,this.editSource=this.source1):"source2"===t&&(this.sourceOwner=r.source1Owner,this.editSource=this.source2),this.editLocationName=e.facility,this.editLocationId=e.id,this.editDialog=!0;var a=Object.keys(this.source2GridHeader).length,s=this.source2GridHeader[a-1].value;this.editLocationParent=e[s+"id"];var o=s.replace("level","");this.getLevelData(o)},saveEdit:function(){var e=this,t=new FormData;t.append("sourceOwner",this.sourceOwner),t.append("source",this.editSource),t.append("locationId",this.editLocationId),t.append("locationName",this.editLocationName),t.append("locationParent",this.editLocationParent),u.a.post("/editLocation",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.editDialog=!1,e.getSource1Grid(!1),e.getSource2Grid(!1),e.getTree()})).catch((function(e){console.log(JSON.stringify(e))}))},deleteLocation:function(e,t,r){var a=this;if("requestConfirmation"===r){var s=this.getDatasourceOwner();"source1"===t?(this.sourceOwner=s.source1Owner,this.deleteSource={name:"source1",sourceId:this.$store.state.activePair.source1.id,sourceName:this.source1}):"source2"===t&&(this.sourceOwner=s.source2Owner,this.deleteSource={name:"source2",sourceId:this.$store.state.activePair.source2.id,sourceName:this.source2}),this.deleteLocationData=e,this.confirmDelete=!0}else{this.confirmDelete=!1;var o=this.$store.state.activePair.userID,i="id=".concat(this.deleteLocationData.id,"&sourceId=").concat(this.deleteSource.sourceId,"&sourceName=").concat(this.deleteSource.sourceName,"&userID=").concat(o,"&sourceOwner=").concat(this.sourceOwner);u.a.delete("/deleteLocation?".concat(i)).then((function(){"source1"===a.deleteSource.name?a.getSource1Grid(!1):a.getSource2Grid(!1)}))}},getLevelData:function(e){var t=this;u.a.get("/getLevelData/"+this.editSource+"/"+this.sourceOwner+"/"+e).then((function(e){t.editParents=e.data}))},getSource1Grid:function(e){var t=this;if(this.source1){this.loadingSource1=!0,e||(e=""),this.loadingSource1Grid=!0;var r=this.getDatasourceOwner().source1Owner,a=this.getLimitOrgIdOnActivePair().source1LimitOrgId,s=this.$store.state.activePair.userID,o="/hierarchy?source=".concat(this.source1,"&start=").concat(this.source1Start,"&count=").concat(this.source1Count,"&id=").concat(e,"&userID=").concat(s,"&sourceOwner=").concat(r,"&sourceLimitOrgId=").concat(a);u.a.get(o).then((function(e){if(t.loadingSource1Grid=!1,e.data){var r=t.source1Pagination,a=r.sortBy,s=r.descending;t.source1Pagination.sortBy&&(e.data.tree=e.data.grid.sort((function(e,t){var r=e[a],o=t[a];return s?r<o?1:r>o?-1:0:r<o?-1:r>o?1:0}))),t.source1Grid=e.data.grid,t.totalSource1Records=e.data.total,t.source1Pagination.totalItems=e.data.total,t.currentSource1Pagination=Object.assign({},t.source1Pagination),t.currentSource1Pagination.hasOwnProperty("descending")||(t.currentSource1Pagination.descending=!1),t.currentSource1Pagination.hasOwnProperty("page")||(t.currentSource1Pagination.page=1),t.currentSource1Pagination.hasOwnProperty("sortBy")||(t.currentSource1Pagination.sortBy="facility"),t.currentSource1Pagination.hasOwnProperty("totalItems")||(t.currentSource1Pagination.totalItems=e.data.total)}t.loadingSource1=!1}))}},getSource2Grid:function(e){var t=this;if(this.source2){e||(e=""),this.loadingSource2=!0,this.loadingSource2Grid=!0;var r=this.getDatasourceOwner().source2Owner,a=this.getLimitOrgIdOnActivePair().source2LimitOrgId,s=this.$store.state.activePair.userID,o="/hierarchy?source=".concat(this.source2,"&start=").concat(this.source2Start,"&count=").concat(this.source2Count,"&id=").concat(e,"&userID=").concat(s,"&sourceOwner=").concat(r,"&sourceLimitOrgId=").concat(a);u.a.get(o).then((function(e){if(t.loadingSource2Grid=!1,e.data){var r=t.source2Pagination,a=r.sortBy,s=r.descending;t.source2Pagination.sortBy&&(e.data.tree=e.data.grid.sort((function(e,t){var r=e[a],o=t[a];return s?r<o?1:r>o?-1:0:r<o?-1:r>o?1:0}))),t.source2Grid=e.data.grid,t.totalSource2Records=e.data.total,t.source2Pagination.totalItems=e.data.total,t.currentSource2Pagination=Object.assign({},t.source2Pagination),t.currentSource2Pagination.hasOwnProperty("descending")||(t.currentSource2Pagination.descending=!1),t.currentSource2Pagination.hasOwnProperty("page")||(t.currentSource2Pagination.page=1),t.currentSource2Pagination.hasOwnProperty("sortBy")||(t.currentSource2Pagination.sortBy="facility"),t.currentSource2Pagination.hasOwnProperty("totalItems")||(t.currentSource2Pagination.totalItems=e.data.total)}t.loadingSource2=!1}))}},getTree:function(){var e=this;if(this.source1&&this.source2){var t=this.getDatasourceOwner().source2Owner,r=this.getLimitOrgIdOnActivePair().source2LimitOrgId;this.loadingSource2Tree=!0,u.a.get("/getTree/"+this.source2+"/"+t+"/"+r).then((function(t){e.loadingSource2Tree=!1,t.data&&(e.source2Tree=t.data)}));var a=this.getDatasourceOwner().source1Owner,s=this.getLimitOrgIdOnActivePair().source1LimitOrgId;this.loadingSource1Tree=!0,u.a.get("/getTree/"+this.source1+"/"+a+"/"+s).then((function(t){e.loadingSource1Tree=!1,t.data&&(e.source1Tree=t.data)}))}},source1NodeSelected:function(e){this.source1SelNodeId=e.id,this.getSource1Grid(e.id)},source2NodeSelected:function(e){this.source2SelNodeId=e.id,this.getSource2Grid(e.id)}},computed:{isDataset1Owner:function(){var e=this.getDatasourceOwner().source1Owner,t=this.$store.state.auth.userID;return e===t},isDataset2Owner:function(){var e=this.getDatasourceOwner().source2Owner,t=this.$store.state.auth.userID;return e===t},source2GridHeader:function(){var e=[];this.isDataset2Owner&&e.push({text:"",value:"",sortable:!1});var t={};if(this.source2Grid&&this.source2Grid.length>0)for(var r in this.source2Grid)(t.length>0&&this.source2Grid[r].length>Object.keys(t).length||0===Object.keys(t).length)&&(t=this.source2Grid[r]);for(var a in t)this.headerText[a]&&e.push({text:this.headerText[a],value:a});return e},source1GridHeader:function(){var e=[];this.isDataset1Owner&&e.push({text:"",value:"",sortable:!1});var t={};if(this.source1Grid&&this.source1Grid.length>0)for(var r in this.source1Grid)(t.length>0&&this.source1Grid[r].length>Object.keys(t).length||0===Object.keys(t).length)&&(t=this.source1Grid[r]);if(this.source1Grid&&this.source1Grid.length>0)for(var a in this.source1Grid[0])this.headerText[a]&&e.push({text:this.headerText[a],value:a});return e},source2Pages:function(){return null==this.source2Pagination.rowsPerPage||null==this.source2Pagination.totalItems?0:Math.ceil(this.source2Pagination.totalItems/this.source2Count)},source1Pages:function(){return null==this.source1Pagination.rowsPerPage||null==this.source1Pagination.totalItems?0:Math.ceil(this.source1Pagination.totalItems/this.source1Count)},source1:function(){var e=this.$store.state.activePair.source1.name;return e&&(e=this.toTitleCase(e)),e},source2:function(){var e=this.$store.state.activePair.source2.name;return e&&(e=this.toTitleCase(e)),e},editLocationNameErrors:function(){var e=[];return this.$v.editLocationName.$dirty?(!this.$v.editLocationName.required&&e.push("Facility Name is required"),e):e}},watch:{source1Pagination:{handler:function(){if(this.currentSource1Pagination.sortBy!==this.source1Pagination.sortBy||this.currentSource1Pagination.descending!==this.source1Pagination.descending||this.currentSource1Pagination.page!==this.source1Pagination.page){var e=this.source1Pagination.page-1;this.source1Start=e*this.source1Count+1,this.getSource1Grid(this.source1SelNodeId)}},deep:!0},source2Pagination:{handler:function(){if(this.currentSource2Pagination.sortBy!==this.source2Pagination.sortBy||this.currentSource2Pagination.descending!==this.source2Pagination.descending||this.currentSource2Pagination.page!==this.source2Pagination.page){var e=this.source2Pagination.page-1;this.source2Start=e*this.source2Count+1,this.getSource2Grid(this.source2SelNodeId)}},deep:!0}},mounted:function(){this.getSource1Grid(!1),this.getSource2Grid(!1),this.getTree()},components:{"liquor-tree":dr["a"]}},kr=wr,Pr=(r("6a56"),r("891e")),Dr=Object(f["a"])(kr,xr,_r,!1,null,"56b98ccd",null),Cr=Dr.exports;y()(Dr,{VAlert:V["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VList:$["a"],VPagination:Pr["a"],VProgressLinear:z["a"],VRow:J["a"],VSelect:Y["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var Tr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[e.$store.state.uploadRunning?[r("br"),r("br"),r("br"),r("v-alert",{attrs:{type:"info",value:!0}},[r("b",[e._v("Wait for upload to finish ...")]),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)]:e._e(),!e.$store.state.denyAccess&!e.$store.state.uploadRunning?r("v-container",{attrs:{fluid:"","grid-list-lg":""}},[r("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"350"},model:{value:e.$store.state.scoresProgressData.scoreDialog,callback:function(t){e.$set(e.$store.state.scoresProgressData,"scoreDialog",t)},expression:"$store.state.scoresProgressData.scoreDialog"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.$store.state.scoresProgressData.scoreProgressTitle))]),r("br"),"percent"==e.$store.state.scoresProgressData.progressType?r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.$store.state.scoresProgressData.scoreProgressPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.$store.state.scoresProgressData.scoreProgressPercent)+"%")])])])],1):e._e(),"indeterminate"==e.$store.state.scoresProgressData.progressType?r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"red"}}):e._e()],1)],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"500px"},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" "+e._s(e.alertTitle)+" ")])],1),r("v-card-text",[e._v(" "+e._s(e.alertText)+" ")]),r("v-card-actions",[r("v-btn",{attrs:{color:"success"},on:{click:function(t){e.alert=!1}}},[e._v("OK")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",width:"500px"},model:{value:e.flagCommentDialog,callback:function(t){e.flagCommentDialog=t},expression:"flagCommentDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Add comment for this flag if any ")])],1),r("v-card-text",[r("v-textarea",{attrs:{"auto-grow":"",box:"",color:"deep-purple",label:"Flag Comment",rows:"1"},model:{value:e.flagComment,callback:function(t){e.flagComment=t},expression:"flagComment"}})],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"success"},on:{click:e.saveMatch}},[e._v("Continue")])],1)],1)],1),r("v-dialog",{attrs:{persistent:"",transition:"scale-transition",width:e.dialogWidth,height:"auto"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",{attrs:{width:e.dialogWidth,height:"auto"}},[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Matching "+e._s(e.selectedSource1Name)+" "+e._s(e.dialogWidth)+" ")]),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",color:"yellow"},model:{value:e.searchPotential,callback:function(t){e.searchPotential=t},expression:"searchPotential"}}),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.back(t)}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-title",[e._v(" Parents: "),r("b",[e._v(e._s(e._f("joinParentsAndReverse")(e.selectedSource1Parents)))]),r("v-spacer"),e.$store.state.recoLevel==e.$store.state.totalSource1Levels?[e._v(" Latitude: "),r("b",[e._v(e._s(e.selectedSource1Lat))]),r("v-spacer"),e._v(" Longitude: "),r("b",[e._v(e._s(e.selectedSource1Long))]),r("v-spacer")]:e._e()],2),r("v-card-text",[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.potentialHeaders,items:e.allPotentialMatches,search:e.searchPotential},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[r("v-row",[r("v-col",{attrs:{md:"4"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[r("v-btn",e._g({attrs:{color:"error",small:""},nativeOn:{click:function(t){return e.match("flag",a.id,a.name,a.source2IdHierarchy,a.mappedParentName)}}},s),[r("v-icon",{attrs:{dark:"",left:""}},[e._v("mdi-bell")]),e._v("Flag ")],1)]}}],null,!0)},[r("span",[e._v("Mark the selected item as a match to be reviewed")])])],1),r("v-col",{attrs:{md:"4"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[r("v-btn",e._g({attrs:{color:"primary",small:"",dark:""},nativeOn:{click:function(t){return e.match("match",a.id,a.name,a.source2IdHierarchy)}}},s),[r("v-icon",{attrs:{left:""}},[e._v("mdi-thumb-up")]),e._v("Save Match ")],1)]}}],null,!0)},[r("span",[e._v("Save the selected item as a match")])])],1)],1)],1),r("td",[e._v(e._s(a.name))]),r("td",[e._v(e._s(a.id))]),r("td",[e._v(e._s(e._f("joinParentsAndReverse")(a.parents)))]),e.$store.state.recoLevel==e.$store.state.totalSource1Levels?r("td",[e._v(e._s(a.geoDistance))]):e._e(),r("td",[e._v(e._s(a.score))]),r("td",[e._v(e._s(e.potentialMatchComment(a)))])])]}}],null,!1,357144023)},[r("template",{slot:"headers"},[r("tr",[e._l(e.potentialHeaders,(function(t){return["Score"==t.text?r("th",{key:t.text,staticClass:"column sortable active",attrs:{align:"left"},on:{click:function(r){return e.changeSort(t.value)}}},["up"==e.sort_arrow?r("v-icon",{attrs:{small:""}},[e._v("mdi-arrow-up")]):r("v-icon",{attrs:{small:""}},[e._v("mdi-arrow-down")]),e._v(" "+e._s(t.text)+" "),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({attrs:{icon:""}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}],null,!0)},[r("span",[e._v("The lower the score, the better the match")])])],1):r("th",{key:t.text,attrs:{align:"left"}},[e._v(" "+e._s(t.text)+" ")])]}))],2)])],2)],1),r("v-card-actions",{staticStyle:{float:"center"}},[r("v-row",[r("v-col",{attrs:{justify:"1"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({attrs:{color:"green",dark:""},nativeOn:{click:function(t){return e.noMatch("nomatch")}}},a),[r("v-icon",{attrs:{left:""}},[e._v("mdi-thumb-down")]),e._v("No Match ")],1)]}}],null,!1,3434304218)},[r("span",[e._v("Save this Source 1 location as having no match")])])],1),r("v-col",{attrs:{justify:"1"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({attrs:{color:"error",dark:""},nativeOn:{click:function(t){return e.noMatch("ignore")}}},a),[r("v-icon",{attrs:{left:""}},[e._v("mdi-thumb-down")]),e._v("Ignore ")],1)]}}],null,!1,577440601)},[r("span",[e._v("Mark this source 1 location as being ignored")])])],1),r("v-col",{attrs:{justify:"5"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.potentialAvailable?r("v-btn",e._g({staticStyle:{color:"white"},attrs:{color:"teal darken-6"},on:{click:function(t){e.showAllPotential=!e.showAllPotential}}},a),[e.showAllPotential?[e._v("Show Scored Suggestions")]:[r("v-icon",{attrs:{left:""}},[e._v("mdi-eye")]),e._v(" Show All Suggestions ")]],2):e._e()]}}],null,!1,2440108326)},[e.showAllPotential?r("span",[e._v("Limit to only scored suggestions")]):r("span",[e._v("See all possible choices ignoring the score")])])],1),r("v-col",{attrs:{justify:"7"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticStyle:{color:"white"},attrs:{color:"orange darken-2"},nativeOn:{click:function(t){return e.back(t)}}},a),[r("v-icon",{attrs:{dark:"",left:""}},[e._v("mdi-arrow-left")]),e._v("Back ")],1)]}}],null,!1,2568067178)},[r("span",[e._v("Return without saving")])])],1)],1)],1)],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}},[r("appRecoExport")],1),r("v-spacer"),r("v-flex",{attrs:{xs2:""}},[r("b",[e._v("Reconciling "+e._s(e.currentLevelText))])]),r("v-spacer"),r("v-flex",{attrs:{xs1:"",sm2:"",md2:"",right:""}},[r("v-select",{attrs:{items:e.$store.state.levelArray,"item-value":e.$store.state.levelArray.value,"item-name":e.$store.state.levelArray.text,label:"Level","single-line":""},on:{change:e.levelChanged},model:{value:e.$store.state.recoLevel,callback:function(t){e.$set(e.$store.state,"recoLevel",t)},expression:"$store.state.recoLevel"}})],1),r("v-flex",{attrs:{xs2:""}},[e.$store.state.scoreSavingProgressData.savingMatches?[e._v(" Saving matches for "+e._s(e.translateDataHeader("source1",e.$store.state.recoLevel-1))+" "),e.saveProgressTimedout?r("v-progress-linear",{attrs:{indeterminate:"",color:"red"}}):r("v-progress-linear",{attrs:{color:"error",width:"20",height:"20",value:e.$store.state.scoreSavingProgressData.percent}},[r("center",[r("span",{staticClass:"green--text"},[r("b",[e._v(e._s(e.$store.state.scoreSavingProgressData.percent)+"%")])])])],1)]:[[r("v-btn",{attrs:{color:"primary",dark:"",rounded:""},on:{click:function(t){return e.getScores(!1)}}},[r("v-icon",[e._v("mdi-repeat-once")]),e._v(" Recalculate Scores ")],1)]]],2),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticClass:"mx-1",attrs:{fab:"",dark:"","x-small":"",color:"primary"},on:{click:function(t){e.helpDialog=!0}}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}],null,!1,3148663098)},[r("span",[e._v("Help")])])],1)],1),r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" About this page ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" This page let you map source 1 data with those in source2 "),r("v-list",[e._v(" 1. Source 1 refer to the data source name selected as source 1 under data source pair section ")]),r("v-list",[e._v(" 2. Source 2 refer to the data source name selected as source 2 under data source pair section ")]),r("v-list",[e._v(" 3. After breaking a match, you will need to recalculate scores for the app to load potential matches of the broken location ")]),r("v-list",[e._v(" 4. FLAGGED Locations are the locations that will need to be reviewed before they are saved as matches ")]),r("v-list",[e._v(" 5. NO MATCHES - these are locations that do not matches anything from source 2 ")])],1)],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs2:"",right:""}},[r("div",{staticStyle:{"border-style":"solid","border-color":"green","text-align":"center"}},[r("b",[e._v("Source 1 Reconciliation Status")]),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("b",[e._v("Matched")])]),r("v-flex",{attrs:{"align-center":""}},[r("center",[r("b",[e._v(e._s(e.source1TotalMatched)+"/"+e._s(e.source1TotalRecords))])])],1),r("v-flex",[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentMatched,color:"green"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentMatched)+"%")])])],1)],1)],1)],1)],1),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Unmatched")])]),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source1TotalUnMatched)+"/"+e._s(e.source1TotalRecords))])])],1),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentUnMatched,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentUnMatched)+"%")])])],1)],1)],1)],1)],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Flagged")])]),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.totalFlagged)+"/"+e._s(e.source1TotalRecords))])])],1),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentFlagged,color:"orange"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentFlagged)+"%")])])],1)],1)],1)],1)],1),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("No Match")])]),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source1TotalNoMatch)+"/"+e._s(e.source1TotalRecords))])])],1),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentNoMatch,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentNoMatch)+"%")])])],1)],1)],1)],1)],1)],1)],1)]),r("v-flex",{attrs:{xs4:"","child-flex":""}},[r("v-card",{attrs:{color:"green lighten-2"}},[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Source 1 Unmatched "),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUnmatchedSource1,callback:function(t){e.searchUnmatchedSource1=t},expression:"searchUnmatchedSource1"}})],1),e.loadingSource1Unmatched?[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]:[r("liquor-tree",{key:e.source1TreeUpdate,ref:"source1Tree",attrs:{data:e.source1Tree}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source1GridHeaders,items:e.source1Grid,search:e.searchUnmatchedSource1,light:""},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",["Done"===e.$store.state.recoStatus?r("td",{key:a.id},[e._v(e._s(a.name))]):r("td",{key:a.id,staticStyle:{cursor:"pointer"},on:{click:function(t){return e.getPotentialMatch(a.id)}}},[e._v(e._s(a.name))]),e._l(a.parents,(function(t,s){return r("td",{key:a.id+s},[s!=a.parents.length-1?[e._v(" "+e._s(t)+" ")]:e._e()],2)}))],2)]}}],null,!1,4039369149)})]],2)],1),r("v-flex",{attrs:{xs4:""}},[r("v-card",{attrs:{color:"blue lighten-2",dark:""}},[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Source 2 Unmatched "),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchUnmatchedSource2,callback:function(t){e.searchUnmatchedSource2=t},expression:"searchUnmatchedSource2"}})],1),e.loadingSource2Unmatched?[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]:[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.source1UnmatchedHeaders,items:e.$store.state.source2UnMatched,search:e.searchUnmatchedSource2,light:""},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.name)+" "),r("br"),e._v(" "+e._s(e._f("joinParentsAndReverse")(a.parents)))])])]}}],null,!1,2780787155)})]],2)],1),r("v-flex",{attrs:{xs2:"",right:""}},[r("div",{staticStyle:{"border-style":"solid","border-color":"green","text-align":"center"}},[r("b",[e._v("Source 2 Reconciliation Status")]),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Matched")])]),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source2TotalMatched)+"/"+e._s(e.source2TotalRecords))])])],1),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentMatched,color:"green"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentMatched)+"%")])])],1)],1)],1)],1)],1),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Unmatched")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.source2TotalUnmatched)+"/"+e._s(e.source2TotalRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentUnmatched,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentUnmatched)+"%")])])],1)],1)],1)],1)],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Flagged")])]),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.totalFlagged)+"/"+e._s(e.source2TotalRecords))])])],1),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentFlagged,color:"orange"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentFlagged)+"%")])])],1)],1)],1)],1)],1),r("v-flex",{attrs:{xs6:""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{"align-center":""}},[r("b",[e._v("Not in Source 1")])]),r("v-flex",{attrs:{xs1:""}},[r("center",[r("b",[e._v(e._s(e.source2NotInSource1))])])],1),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentNotInSource1,color:"red"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source2PercentNotInSource1)+"%")])])],1)],1)],1)],1)],1)],1)],1)])],1),r("v-layout",{attrs:{column:"",wrap:""}},[r("v-tabs",{attrs:{"icons-and-text":"",centered:"",grow:"",dark:"","background-color":"cyan"}},[r("v-tabs-slider",{attrs:{color:"red"}}),r("v-tab",{key:"match"},[e._v(" MATCHED ("+e._s(e.source1TotalMatched)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-up")])],1),r("v-tab",{key:"nomatch"},[e._v(" NO MATCH ("+e._s(e.source1TotalNoMatch)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-down")])],1),r("v-tab",{key:"ignore"},[e._v(" IGNORED ("+e._s(e.source1TotalIgnore)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-down")])],1),r("v-tab",{key:"flagged"},[e._v(" FLAGGED ("+e._s(e.totalFlagged)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-bell")])],1),r("v-tab-item",{key:"match"},[null!=e.$store.state.matchedContent?[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchMatched,callback:function(t){e.searchMatched=t},expression:"searchMatched"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.matchedHeaders,items:e.$store.state.matchedContent,search:e.searchMatched},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.source1Name))]),r("td",[e._v(e._s(a.source1Id))]),r("td",[e._v(e._s(a.source2Name))]),r("td",[r("v-treeview",{attrs:{items:a.source2IdHierarchy}})],1),a.matchComments?r("td",[e._v(e._s(a.matchComments.join(", ")))]):r("td"),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(t){return e.breakMatch(a.source1Id)}}},[r("v-icon",[e._v("mdi-undo")]),e._v("Break Match ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(t){return e.breakMatch(a.source1Id)}}},[r("v-icon",[e._v("mdi-undo")]),e._v("Break Match ")],1)],1)])]}}],null,!1,1712484571)})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2),r("v-tab-item",{key:"nomatch"},[null!=e.$store.state.noMatchContent?[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchNotMatched,callback:function(t){e.searchNotMatched=t},expression:"searchNotMatched"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.noMatchHeaders,items:e.$store.state.noMatchContent,search:e.searchNotMatched},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.source1Name))]),r("td",[e._v(e._s(a.source1Id))]),r("td",[e._v(e._s(a.parents.join("->")))]),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(t){return e.breakNoMatch(a.source1Id,"nomatch")}}},[r("v-icon",[e._v("mdi-cached")]),e._v("Break No Match ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(t){return e.breakNoMatch(a.source1Id,"nomatch")}}},[r("v-icon",[e._v("mdi-cached")]),e._v("Break No Match ")],1)],1)])]}}],null,!1,1597245691)})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2),r("v-tab-item",{key:"ignore"},[null!=e.$store.state.ignoreContent?[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchIgnore,callback:function(t){e.searchIgnore=t},expression:"searchIgnore"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.noMatchHeaders,items:e.$store.state.ignoreContent,search:e.searchIgnore},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("td",[e._v(e._s(a.source1Name))]),r("td",[e._v(e._s(a.source1Id))]),r("td",[e._v(e._s(a.parents.join("->")))]),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(t){return e.breakNoMatch(a.source1Id,"ignore")}}},[r("v-icon",[e._v("mdi-cached")]),e._v("Break Ignore ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(t){return e.breakNoMatch(a.source1Id,"ignore")}}},[r("v-icon",[e._v("mdi-cached")]),e._v("Break Ignore ")],1)],1)]}}],null,!1,1076527946)})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2),r("v-tab-item",{key:"flagged"},[null!=e.$store.state.flagged?[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchFlagged,callback:function(t){e.searchFlagged=t},expression:"searchFlagged"}}),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.flaggedHeaders,items:e.$store.state.flagged,search:e.searchFlagged},scopedSlots:e._u([{key:"item",fn:function(t){var a=t.item;return[r("tr",[r("td",[e._v(e._s(a.source1Name))]),r("td",[e._v(e._s(a.source1Id))]),r("td",[e._v(e._s(a.source2Name))]),r("td",[r("v-treeview",{attrs:{items:a.source2IdHierarchy}})],1),r("td",[e._v(e._s(a.flagComment))]),r("td",["Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"primary",small:""},on:{click:function(t){return e.acceptFlag(a.source1Id)}}},[r("v-icon",[e._v("mdi-thumb-up")]),e._v("Confirm Match ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"primary",small:""},on:{click:function(t){return e.acceptFlag(a.source1Id)}}},[r("v-icon",[e._v("mdi-thumb-up")]),e._v("Confirm Match ")],1),"Done"==e.$store.state.recoStatus?r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{disabled:"",color:"error",small:""},on:{click:function(t){return e.unFlag(a.source1Id)}}},[r("v-icon",[e._v("mdi-cached")]),e._v("Release ")],1):r("v-btn",{staticStyle:{"text-transform":"none"},attrs:{color:"error",small:""},on:{click:function(t){return e.unFlag(a.source1Id)}}},[r("v-icon",[e._v("mdi-cached")]),e._v("Release ")],1)],1)])]}}],null,!1,2054694266)})]:[r("v-progress-linear",{attrs:{size:70,indeterminate:"",color:"amber"}})]],2)],1)],1),r("v-layout",["yes"!=e.goNextLevel||e.$store.state.scoreSavingProgressData.savingMatches?e._e():r("v-flex",{attrs:{xs1:"",sm4:"",md2:""}},[r("v-btn",{attrs:{color:"primary",rounded:""},on:{click:function(t){return e.levelChanged(e.$store.state.recoLevel+1)}}},[r("v-icon",[e._v("mdi-forward")]),e._v("Proceed to "+e._s(e.nextLevelText)+" ")],1)],1),"yes"==e.lastLevelDone?r("v-flex",{attrs:{xs1:"",sm4:"",md2:""}},[r("v-btn",{attrs:{color:"primary",rounded:""},on:{click:function(t){return e.$router.push({name:"FacilityRecoStatus"})}}},[r("v-icon",[e._v("mdi-view-dashboard")]),e._v("Reconciliation Status ")],1)],1):e._e()],1)],1):e._e()],2)},Ir=[],Ar=(r("a434"),r("b680"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-xs":""}},[r("v-dialog",{attrs:{persistent:"",width:"620px"},model:{value:e.downloadDialog,callback:function(t){e.downloadDialog=t},expression:"downloadDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[e._v(" Select file type to download ")]),r("v-spacer"),r("v-icon",{on:{click:e.closeDownloadDialog}},[e._v("mdi-close")])],1),r("v-card-text"),r("v-card-actions",[r("v-btn",{attrs:{rounded:"",color:"info"},on:{click:e.downloadMatched}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-multiple-outline")]),e._v(" Matched ")],1),r("v-spacer"),r("v-btn",{attrs:{rounded:"",color:"info"},on:{click:e.downloadSource1Unmatched}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-multiple-outline")]),e._v(" Source1 Unmatched ")],1),r("v-spacer"),r("v-btn",{attrs:{rounded:"",color:"info"},on:{click:e.downloadSource2Unmatched}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-multiple-outline")]),e._v(" Source2 Unmatched ")],1)],1)],1)],1),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs6:""}},[r("v-btn",{attrs:{color:"success",rounded:"",small:""},on:{click:e.csvExport}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-multiple-outline")]),e.loadingCSV?r("v-progress-circular",{attrs:{indeterminate:"",color:"red"}}):e._e(),e._v(" CSV Export ")],1)],1),r("v-flex",{attrs:{xs6:""}},[r("v-btn",{attrs:{color:"success",rounded:"",small:""},on:{click:e.fhirExport}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-file-multiple-outline")]),e.loadingFHIR?r("v-progress-circular",{attrs:{indeterminate:"",color:"red"}}):e._e(),e._v(" FHIR Export ")],1)],1)],1)],1)}),Lr=[],Or={mixins:[C,P],data:function(){return{loadingCSV:!1,loadingFHIR:!1,downloadDialog:!1,matchedDownloadData:"",unmatchedSource1DownloadData:"",unmatchedSource2DownloadData:"",downloadType:""}},methods:{closeDownloadDialog:function(){this.downloadDialog=!1,this.matchedDownloadData="",this.unmatchedSource1DownloadData="",this.unmatchedSource2DownloadData=""},matchedLocations:function(e){var t=this.$store.state.activePair.userID,r=this.getSource1(),a=this.getSource2(),s=this.getDatasourceOwner(),o=s.source1Owner,i=s.source2Owner,n=JSON.stringify(this.$store.state.levelMapping.source1),c=JSON.stringify(this.$store.state.levelMapping.source2),l=this.getLimitOrgIdOnActivePair().source1LimitOrgId,d=this.getLimitOrgIdOnActivePair().source2LimitOrgId,h={source1:r,source2:a,source1Owner:o,source2Owner:i,type:e,userID:t,source1LimitOrgId:l,source2LimitOrgId:d,levelMapping1:n,levelMapping2:c};return u.a.get("/match/matchedLocations",{params:h})},unMatchedLocations:function(e){var t=this.$store.state.activePair.userID,r=this.getDatasourceOwner(),a=r.source1Owner,s=r.source2Owner,o=this.$store.state.levelMapping.source1,i=this.$store.state.levelMapping.source2,n=this.getLimitOrgIdOnActivePair().source1LimitOrgId,c=this.getLimitOrgIdOnActivePair().source2LimitOrgId,l=this.getSource1(),d=this.getSource2(),h={source1:l,source2:d,source1Owner:a,source2Owner:s,type:e,userID:t,source1LimitOrgId:n,source2LimitOrgId:c,levelMapping1:o,levelMapping2:i};return u.a.get("/match/unmatchedLocations",{params:h})},csvExport:function(){this.loadingCSV=!0;var e=this;u.a.all([this.matchedLocations("CSV"),this.unMatchedLocations("CSV")]).then(u.a.spread((function(t,r){e.loadingCSV=!1,e.downloadDialog=!0,e.downloadType="csv",e.matchedDownloadData=t.data,e.unmatchedSource1DownloadData=r.data.unmatchedSource1CSV,e.unmatchedSource2DownloadData=r.data.unmatchedSource2CSV})))},fhirExport:function(){this.loadingFHIR=!0;var e=this;u.a.all([this.matchedLocations("FHIR"),this.unMatchedLocations("FHIR")]).then(u.a.spread((function(t,r){e.loadingFHIR=!1,e.downloadDialog=!0,e.downloadType="fhir",e.matchedDownloadData=t.data,e.unmatchedSource1DownloadData=r.data.unmatchedSource1mCSD,e.unmatchedSource2DownloadData=r.data.unmatchedSource2mCSD})))},downloadMatched:function(){var e,t;"fhir"===this.downloadType?(e="json",t="data:text/json;charset=utf-8,",this.matchedDownloadData=JSON.stringify(this.matchedDownloadData)):(e="csv",t="data:text/csv;charset=utf-8,");var r=t+escape(this.matchedDownloadData),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download","matched".concat(this.getSource1()).concat(this.getSource2(),".").concat(e)),a.click()},downloadSource1Unmatched:function(){var e,t;"fhir"===this.downloadType?(e="json",t="data:text/json;charset=utf-8,",this.unmatchedSource1DownloadData=JSON.stringify(this.unmatchedSource1DownloadData)):(e="csv",t="data:text/csv;charset=utf-8,");var r=t+escape(this.unmatchedSource1DownloadData),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download","unmatched".concat(this.getSource1(),".").concat(e)),a.click()},downloadSource2Unmatched:function(){var e,t;"fhir"===this.downloadType?(e="json",t="data:text/json;charset=utf-8,",this.unmatchedSource2DownloadData=JSON.stringify(this.unmatchedSource2DownloadData)):(e="csv",t="data:text/csv;charset=utf-8,");var r=t+escape(this.unmatchedSource2DownloadData),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download","unmatched".concat(this.getSource2(),".").concat(e)),a.click()}}},Nr=Or,Vr=Object(f["a"])(Nr,Ar,Lr,!1,null,null,null),Rr=Vr.exports;y()(Vr,{VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VContainer:ce["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VProgressCircular:Me["a"],VSpacer:X["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"]});var Mr={mixins:[C,P],data:function(){return{clientId:"",flagCommentDialog:!1,flagComment:"",helpDialog:!1,type:"",source2Id:"",source2Name:"",sort_arrow:"up",pagination:{sortBy:"score"},recoLevel:0,searchUnmatchedSource2:"",searchUnmatchedSource1:"",searchPotential:"",searchMatched:"",searchNotMatched:"",searchIgnore:"",searchFlagged:"",potentialMatches:[],showAllPotential:!1,alertText:"",alertTitle:"",alert:!1,saveProgressTimedout:!1,source1Parents:{},source1Filter:{text:"",level:""},source1TreeUpdate:0,selectedSource1:{},selectedSource1Name:null,selectedSource1Id:null,selectedSource1Lat:null,selectedSource1Long:null,selectedSource1Parents:[],dialog:!1,dialogWidth:"",source1UnmatchedHeaders:[{text:"Location",value:"name"}],noMatchHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Parents",value:"parents"}],flaggedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Source 2 Location",value:"source2Name"},{text:"Source 2 ID",value:"source2Id"},{text:"Comment",value:"flagComment"}]}},filters:{removeCountry:function(e){var t=e.slice(0);return t.splice(t.length-1,1),t},joinParents:function(e){return e.join("->")},joinParentsAndReverse:function(e){return Object(Te["a"])(e).reverse().join("->")}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1),this.pagination.descending?this.sort_arrow="mdi-down":this.sort_arrow="mdi-up"},addListener:function(){var e=this,t=function t(){e.$refs&&e.$refs.source1Tree?e.$refs.source1Tree.$on("node:selected",(function(t){e.source1Filter.text=t.data.text;var r=1;while(t.parent)t=t.parent,r++;e.source1Filter.level=r})):setTimeout((function(){t()}),500)};t()},levelChanged:function(e){this.$store.state.recoLevel!==e&&(this.$store.state.recoLevel=e,this.getScores(!1),this.$store.state.recoLevel===this.$store.state.totalSource1Levels?this.dialogWidth="1460px":this.dialogWidth="1190px")},getBuildingPotentialMatches:function(e){var t=this;this.potentialMatches=[];var r=this.getSource1(),a=this.getSource2(),s=this.$store.state.recoLevel,o=this.$store.state.totalSource1Levels,i=this.$store.state.totalSource2Levels;if(this.clientId){var n=this.clientId[this.clientId.length-1];n=parseInt(n),n+=1,this.clientId+=n}else{var c=this.$store.state.clientId[this.$store.state.clientId.length-1];c=parseInt(c),c+=1,this.clientId=this.$store.state.clientId+c}var l=this.getDatasourceOwner(),d=this.$store.state.activePair.userID,h=l.source1Owner,v=l.source2Owner,p=this.getLimitOrgIdOnActivePair().source1LimitOrgId,g=this.getLimitOrgIdOnActivePair().source2LimitOrgId,f=JSON.stringify(this.$store.state.config.generalConfig.reconciliation.parentConstraint),m="id=".concat(e,"&source1=").concat(r,"&source2=").concat(a,"&source1Owner=").concat(h,"&source2Owner=").concat(v,"&source1LimitOrgId=").concat(p,"&source2LimitOrgId=").concat(g,"&totalSource1Levels=").concat(o,"&totalSource2Levels=").concat(i);m+="&recoLevel=".concat(s,"&clientId=").concat(this.clientId,"&userID=").concat(d,"&parentConstraint=")+f+"&getPotential="+!0,this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Getting potential matches from server",u.a.get("/match/reconcile/?"+m).then((function(e){if(t.$store.state.dynamicProgress=!1,e.data){var r=JSON.parse(e.data).responseData.scoreResults;if(r.length>0){var a=r[0],s=a.exactMatch;if(Object.keys(s).length>0)return t.$store.state.dialogError=!0,t.$store.state.errorDescription="This location is already mapped, please recalculate scores to get changes",t.$store.state.errorTitle="Info",void(t.$store.state.errorColor="error");for(var o in t.selectedSource1=a.source1,t.selectedSource1Name=a.source1.name,t.selectedSource1Parents=a.source1.parents,t.selectedSource1Lat=a.source1.lat,t.selectedSource1Long=a.source1.long,t.selectedSource1Id=a.source1.id,a.potentialMatches){var i=function(e){var r=a.potentialMatches[o][e];return c=t.$store.state.matchedContent.find((function(e){return e.source2Id===r.id})),l=t.$store.state.flagged.find((function(e){return e.source2Id===r.id})),c||l?"continue":void t.potentialMatches.push({score:o,name:r.name,id:r.id,source2IdHierarchy:r.source2IdHierarchy,lat:r.lat,long:r.long,geoDistance:r.geoDistance,parents:r.parents,mappedParentName:r.mappedParentName})};for(var n in a.potentialMatches[o]){var c,l;i(n)}}}t.dialog=!0}else t.dialog=!0})).catch((function(e){console.log(e)}))},getJurisdictionPotentialMatches:function(e){var t=this;this.potentialMatches=[],this.showAllPotential=!1;var r,a=Object(n["a"])(this.$store.state.scoreResults);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.source1.id===e)for(var o in this.selectedSource1=s.source1,this.selectedSource1Name=s.source1.name,this.selectedSource1Parents=s.source1.parents,this.selectedSource1Lat=s.source1.lat,this.selectedSource1Long=s.source1.long,this.selectedSource1Id=s.source1.id,s.potentialMatches){var i=function(e){var r=s.potentialMatches[o][e];return l=t.$store.state.matchedContent.find((function(e){return e.source2Id===r.id})),u=t.$store.state.flagged.find((function(e){return e.source2Id===r.id})),l||u?"continue":void t.potentialMatches.push({score:o,name:r.name,id:r.id,source2IdHierarchy:r.source2IdHierarchy,lat:r.lat,long:r.long,geoDistance:r.geoDistance,parents:r.parents,mappedParentName:r.mappedParentName})};for(var c in s.potentialMatches[o]){var l,u;i(c)}}}}catch(d){a.e(d)}finally{a.f()}this.dialog=!0},getPotentialMatch:function(e){this.getBuildingPotentialMatches(e)},potentialMatchComment:function(e){var t="";if(this.$store.state.recoLevel===this.$store.state.totalSource1Levels){var r=[],a=[];if(this.selectedSource1.source1IdHierarchy){r.push(this.selectedSource1.source1IdHierarchy[0].id);var s,o=Object(n["a"])(this.selectedSource1.source1IdHierarchy[0].children);try{for(o.s();!(s=o.n()).done;){var i=s.value;r.push(i.id)}}catch(p){o.e(p)}finally{o.f()}}if(e.source2IdHierarchy){a.push(e.source2IdHierarchy[0].id);var c,l=Object(n["a"])(e.source2IdHierarchy[0].children);try{for(l.s();!(c=l.n()).done;){var u=c.value;a.push(u.id)}}catch(p){l.e(p)}finally{l.f()}}var d=r.some((function(e){return a.indexOf(e)>=0}));d||(t&&(t+=", "),t+="ID differ")}e.name.toLowerCase()!==this.selectedSource1.name.toLowerCase()&&(t&&(t+=", "),t+="Names differ");var h=e.mappedParentName,v=this.selectedSource1.parents[0];return v!==h&&(t&&(t+=", "),t+="Parents differ"),t},match:function(e,t,r,a,s){if(this.matchType=e,this.source2Id=t,this.source2Name=r,this.source2IdHierarchy=a,this.mappedParentName=s,null===t)return this.alert=!0,this.alertTitle="Information",void(this.alertText="Select Source 2 Location to match against Source 1 Location");"flag"===e?this.flagCommentDialog=!0:this.saveMatch()},saveMatch:function(){var e=this;this.flagCommentDialog=!1,this.$store.state.progressTitle="Saving match",this.$store.state.dynamicProgress=!0;var t=this.getDatasourceOwner(),r=new FormData;r.append("source1Id",this.selectedSource1Id),r.append("source2Id",this.source2Id),r.append("source1Owner",t.source1Owner),r.append("source2Owner",t.source2Owner),r.append("flagComment",this.flagComment),r.append("source1DB",this.getSource1()),r.append("source2DB",this.getSource2()),r.append("recoLevel",this.$store.state.recoLevel),r.append("totalLevels",this.$store.state.totalSource1Levels),r.append("userID",this.$store.state.activePair.userID),u.a.post("/match/performMatch/"+this.matchType,r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){e.$store.state.dynamicProgress=!1;var r=null;for(var a in e.$store.state.source2UnMatched)e.$store.state.source2UnMatched[a].id===e.source2Id&&(r=e.$store.state.source2UnMatched[a].parents,e.$store.state.source2UnMatched.splice(a,1));for(var s in e.$store.state.source1UnMatched)e.$store.state.source1UnMatched[s].id===e.selectedSource1Id&&("match"===e.matchType?(++e.$store.state.totalAllMapped,e.$store.state.matchedContent.push({source1Name:e.selectedSource1Name,source1Id:e.selectedSource1Id,source1Parents:e.$store.state.source1UnMatched[s].parents,source2Name:e.source2Name,source2Id:e.source2Id,source2IdHierarchy:e.source2IdHierarchy,mappedParentName:e.mappedParentName,source2Parents:r,matchComments:t.data.matchComments})):"flag"===e.matchType&&(++e.$store.state.totalAllFlagged,e.$store.state.flagged.push({source1Name:e.selectedSource1Name,source1Id:e.selectedSource1Id,source1Parents:e.$store.state.source1UnMatched[s].parents,source2Name:e.source2Name,source2Id:e.source2Id,source2IdHierarchy:e.source2IdHierarchy,mappedParentName:e.mappedParentName,source2Parents:r,flagComment:e.flagComment})),e.$store.state.source1UnMatched.splice(s,1));e.flagComment="",e.selectedSource1Id=null,e.selectedSource1Name=null,e.dialog=!1})).catch((function(t){e.flagComment="",e.$store.state.dynamicProgress=!1,e.alert=!0,e.alertTitle="Error",e.alertText=t.response.data.error,e.selectedSource1Id=null,e.selectedSource1Name=null,e.dialog=!1}))},acceptFlag:function(e){var t=this;this.$store.state.progressTitle="Accepting flag",this.$store.state.dynamicProgress=!0;var r=new FormData;r.append("source1Id",e);var a=this.$store.state.activePair.userID;u.a.post("/match/acceptFlag/"+this.getSource1()+"/"+this.getSource2()+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){for(var r in t.$store.state.dynamicProgress=!1,t.$store.state.flagged)t.$store.state.flagged[r].source1Id===e&&(t.$store.state.matchedContent.push({source1Name:t.$store.state.flagged[r].source1Name,source1Id:t.$store.state.flagged[r].source1Id,source1Parents:t.$store.state.flagged[r].source1Parents,source2Name:t.$store.state.flagged[r].source2Name,source2Id:t.$store.state.flagged[r].source2Id,source2IdHierarchy:t.$store.state.flagged[r].source2IdHierarchy,mappedParentName:t.$store.state.flagged[r].mappedParentName,source2Parents:t.$store.state.flagged[r].source2Parents}),t.$store.state.flagged.splice(r,1),++t.$store.state.totalAllMapped,--t.$store.state.totalAllFlagged)})).catch((function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)}))},breakMatch:function(e){var t=this;this.$store.state.progressTitle="Breaking match",this.$store.state.dynamicProgress=!0;var r=new FormData,a=this.$store.state.activePair.userID,s=this.getDatasourceOwner();r.append("source1Id",e),u.a.post("/match/breakMatch/"+this.getSource1()+"/"+this.getSource2()+"/"+s.source1Owner+"/"+s.source2Owner+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){for(var r in t.$store.state.dynamicProgress=!1,t.$store.state.matchedContent)t.$store.state.matchedContent[r].source1Id===e&&(t.$store.state.source1UnMatched.push({name:t.$store.state.matchedContent[r].source1Name,id:t.$store.state.matchedContent[r].source1Id,parents:t.$store.state.matchedContent[r].source1Parents}),t.$store.state.source2UnMatched.push({name:t.$store.state.matchedContent[r].source2Name,id:t.$store.state.matchedContent[r].source2Id,source2IdHierarchy:t.$store.state.matchedContent[r].source2IdHierarchy,mappedParentName:t.$store.state.matchedContent[r].mappedParentName,parents:t.$store.state.matchedContent[r].source2Parents}),t.$store.state.matchedContent.splice(r,1),--t.$store.state.totalAllMapped)})).catch((function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)}))},unFlag:function(e){var t=this;this.$store.state.progressTitle="Unflagging match",this.$store.state.dynamicProgress=!0;var r=new FormData,a=this.$store.state.activePair.userID,s=this.getDatasourceOwner();r.append("source1Id",e),u.a.post("/match/breakMatch/"+this.getSource1()+"/"+this.getSource2()+"/"+s.source1Owner+"/"+s.source2Owner+"/"+a,r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){for(var r in t.$store.state.dynamicProgress=!1,t.$store.state.flagged)t.$store.state.flagged[r].source1Id===e&&(t.$store.state.source1UnMatched.push({name:t.$store.state.flagged[r].source1Name,id:t.$store.state.flagged[r].source1Id,parents:t.$store.state.flagged[r].source1Parents}),t.$store.state.source2UnMatched.push({name:t.$store.state.flagged[r].source2Name,id:t.$store.state.flagged[r].source2Id,source2IdHierarchy:t.$store.state.flagged[r].source2IdHierarchy,mappedParentName:t.$store.state.flagged[r].mappedParentName,parents:t.$store.state.flagged[r].source2Parents}),t.$store.state.flagged.splice(r,1),--t.$store.state.totalAllFlagged)})).catch((function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.selectedSource1Id=null,t.selectedSource1Name=null,t.dialog=!1,console.log(e)}))},breakNoMatch:function(e,t){var r=this;this.$store.state.progressTitle="Breaking no match",this.$store.state.dynamicProgress=!0;var a=new FormData;a.append("source1Id",e),a.append("recoLevel",this.$store.state.recoLevel),a.append("totalLevels",this.$store.state.totalSource1Levels);var s=this.$store.state.activePair.userID;u.a.post("/match/breakNoMatch/"+t+"/"+this.getSource1()+"/"+this.getSource2()+"/"+s,a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){if(r.$store.state.dynamicProgress=!1,"nomatch"===t)for(var a in r.$store.state.noMatchContent)r.$store.state.noMatchContent[a].source1Id===e&&(r.$store.state.source1UnMatched.push({name:r.$store.state.noMatchContent[a].source1Name,id:r.$store.state.noMatchContent[a].source1Id,parents:r.$store.state.noMatchContent[a].parents}),r.$store.state.noMatchContent.splice(a,1),--r.$store.state.totalAllNoMatch);else if("ignore"===t)for(var s in r.$store.state.ignoreContent)r.$store.state.ignoreContent[s].source1Id===e&&(r.$store.state.source1UnMatched.push({name:r.$store.state.ignoreContent[s].source1Name,id:r.$store.state.ignoreContent[s].source1Id,parents:r.$store.state.ignoreContent[s].parents}),r.$store.state.ignoreContent.splice(s,1),--r.$store.state.totalAllIgnore)})).catch((function(e){r.$store.state.dynamicProgress=!1,r.alert=!0,r.alertTitle="Error",r.alertText=e.response.data.error,r.selectedSource1Id=null,r.selectedSource1Name=null,r.dialog=!1,console.log(e)}))},noMatch:function(e){var t=this;this.$store.state.progressTitle="Saving as no match",this.$store.state.dynamicProgress=!0;var r=this.$store.state.activePair.userID,a=this.getDatasourceOwner(),s=a.source1Owner,o=a.source2Owner,i=new FormData;i.append("source1Id",this.selectedSource1Id),i.append("recoLevel",this.$store.state.recoLevel),i.append("totalLevels",this.$store.state.totalSource1Levels),u.a.post("/match/noMatch/".concat(e,"/").concat(this.getSource1(),"/").concat(this.getSource2(),"/").concat(s,"/").concat(o,"/").concat(r),i,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){if(t.$store.state.dynamicProgress=!1,"nomatch"===e)for(var r in t.$store.state.source1UnMatched)t.$store.state.source1UnMatched[r].id===t.selectedSource1Id&&(t.$store.state.noMatchContent.push({source1Name:t.selectedSource1Name,source1Id:t.selectedSource1Id,parents:t.$store.state.source1UnMatched[r].parents}),++t.$store.state.totalAllNoMatch,t.$store.state.source1UnMatched.splice(r,1));else if("ignore"===e)for(var a in t.$store.state.source1UnMatched)t.$store.state.source1UnMatched[a].id===t.selectedSource1Id&&(t.$store.state.ignoreContent.push({source1Name:t.selectedSource1Name,source1Id:t.selectedSource1Id,parents:t.$store.state.source1UnMatched[a].parents}),++t.$store.state.totalAllIgnore,t.$store.state.source1UnMatched.splice(a,1));t.dialog=!1,t.selectedSource1Id=null,t.selectedSource1Name=null})).catch((function(e){t.$store.state.dynamicProgress=!1,t.alert=!0,t.alertTitle="Error",t.alertText=e.response.data.error,t.dialog=!1,t.selectedSource1Id=null,t.selectedSource1Name=null}))},back:function(){this.searchPotential="",this.dialog=!1}},computed:{nextLevelText:{get:function(){return this.translateDataHeader("source1",this.$store.state.recoLevel)},set:function(){}},currentLevelText:{get:function(){return this.translateDataHeader("source1",this.$store.state.recoLevel-1)},set:function(){}},matchedHeaders:function(){var e=[{text:"Source1 Location",value:"source1Name"},{text:"Source1 ID",value:"source1Id"},{text:"Source2 Location",value:"source2Name"},{text:"Source2 ID",value:"source2Id"},{text:"Match Comment",value:"matchComments"}];return e},source1GridHeaders:function(){var e=[{text:"Location",value:"name"}];if(this.$store.state.source1UnMatched.length>0)for(var t=this.$store.state.source1UnMatched[0].parents.length;t>0;t--)e.push({text:"Level "+t,value:"level"+(t+1)});return e.splice(1,1),e},potentialHeaders:function(){var e=[];return e.push({sortable:!1},{text:"Source 2 Location",value:"name",sortable:!1},{text:"ID",value:"id",sortable:!1},{text:"Parent",value:"source2Parent",sortable:!1}),this.$store.state.recoLevel===this.$store.state.totalSource1Levels&&e.push({text:"Geo Dist (Miles)",value:"geodist",sortable:!1}),e.push({text:"Score",value:"score"}),e.push({text:"Comment",value:"comment",sortable:!1}),e},potentialAvailable:function(){return null!==this.$store.state.source2UnMatched&&this.$store.state.source2UnMatched.length>this.potentialMatches.length},allPotentialMatches:function(){var e=this;if(null!==this.$store.state.source2UnMatched&&this.$store.state.source2UnMatched.length>this.potentialMatches.length&&this.showAllPotential){var t,r=[],a=Object(n["a"])(this.$store.state.source2UnMatched);try{var s=function(){var a=t.value,s=e.potentialMatches.find((function(e){return e.id===a.id}));s||(a.score="N/A",r.push(a))};for(a.s();!(t=a.n()).done;)s()}catch(o){a.e(o)}finally{a.f()}return this.potentialMatches.concat(r)}return this.potentialMatches},source1Tree:function(){this.addListener();var e=function e(t,r){for(var a in t){var s={text:a,children:[]};e(t[a],s.children),0===s.children.length&&delete s.children,r.push(s)}},t=[];return 1===Object.keys(this.$store.state.source1Parents).length&&"null"===Object.keys(this.$store.state.source1Parents)[0]||e(this.$store.state.source1Parents,t),t},source1Grid:function(){var e=this;if(this.$store.state.source1UnMatched.length>0&&""!==this.source1Filter.level){var t=this.$store.state.source1UnMatched[0].parents.length-this.source1Filter.level;return this.$store.state.source1UnMatched.filter((function(r){return r.parents[t]===e.source1Filter.text}))}return this.$store.state.source1UnMatched},goNextLevel:function(){return this.$store.state.recoLevel<this.$store.state.totalSource1Levels&&null!==this.$store.state.source1UnMatched&&0===this.$store.state.source1UnMatched.length&&null!==this.$store.state.flagged&&0===this.$store.state.flagged.length&&null!==this.$store.state.matchedContent&&0!==this.$store.state.matchedContent.length?"yes":"no"},lastLevelDone:function(){return this.$store.state.recoLevel===this.$store.state.totalSource1Levels&&null!==this.$store.state.source1UnMatched&&0===this.$store.state.source1UnMatched.length&&null!==this.$store.state.flagged&&0===this.$store.state.flagged.length?"yes":"no"},source1TotalRecords:function(){return this.$store.state.scoreResults?this.$store.state.scoreResults.length:0},source1TotalMatched:function(){return this.$store.state.matchedContent?this.$store.state.matchedContent.length:0},source1PercentMatched:function(){return 0===this.source1TotalRecords?0:parseFloat((100*this.source1TotalMatched/this.source1TotalRecords).toFixed(1))},source1TotalUnMatched:function(){return this.source1TotalRecords-this.source1TotalMatched},source1PercentUnMatched:function(){return 0===this.source1TotalRecords?0:parseFloat((100*this.source1TotalUnMatched/this.source1TotalRecords).toFixed(1))},totalFlagged:function(){return this.$store.state.flagged?this.$store.state.flagged.length:0},source1PercentFlagged:function(){return 0===this.$store.state.scoreResults.length?0:this.$store.state.flagged?parseFloat((100*this.$store.state.flagged.length/this.$store.state.scoreResults.length).toFixed(1)):0},source1TotalNoMatch:function(){return this.$store.state.noMatchContent?this.$store.state.noMatchContent.length:0},source1TotalIgnore:function(){return this.$store.state.ignoreContent?this.$store.state.ignoreContent.length:0},source1PercentNoMatch:function(){return 0===this.$store.state.scoreResults.length?0:this.$store.state.noMatchContent?parseFloat((100*this.$store.state.noMatchContent.length/this.$store.state.scoreResults.length).toFixed(1)):0},source1PercentIgnore:function(){return 0===this.$store.state.scoreResults.length?0:this.$store.state.ignoreContent?parseFloat((100*this.$store.state.ignoreContent.length/this.$store.state.scoreResults.length).toFixed(1)):0},source2TotalRecords:function(){return this.$store.state.source2TotalRecords?this.$store.state.source2TotalRecords:0},source2TotalUnmatched:function(){return this.source2TotalRecords>0&&this.$store.state.matchedContent?parseInt(this.source2TotalRecords)-parseInt(this.$store.state.matchedContent.length):0},source2PercentUnmatched:function(){return 0===this.$store.state.source2TotalRecords?0:parseFloat((100*this.source2TotalUnmatched/this.$store.state.source2TotalRecords).toFixed(1))},source2PercentFlagged:function(){return 0===this.$store.state.source2TotalRecords?0:this.$store.state.flagged?parseFloat((100*this.$store.state.flagged.length/this.$store.state.source2TotalRecords).toFixed(1)):0},source2TotalMatched:function(){return this.source1TotalMatched},source2PercentMatched:function(){return 0===this.$store.state.source2TotalRecords?0:parseFloat((100*this.source2TotalMatched/this.$store.state.source2TotalRecords).toFixed(1))},source2NotInSource1:function(){var e=this.source2TotalRecords-this.source1TotalRecords;return e<0?0:e},source2PercentNotInSource1:function(){if(0===this.source2NotInSource1)return 0;var e=parseFloat((100*this.source2NotInSource1/this.source2TotalRecords).toFixed(1));return parseFloat(e)}},created:function(){var e=this;this.$store.state.recalculateScores&&(this.$store.state.recalculateScores=!1,this.getScores(!1)),Oa.$on("changeCSVHeaderNames",(function(){var t=e.translateDataHeader("source1",e.$store.state.recoLevel);e.nextLevelText=t,e.currentLevelText=t})),this.addListener(),this.$store.state.recoLevel===this.$store.state.totalSource1Levels?this.dialogWidth="auto":this.dialogWidth="1500px",this.source1TreeUpdate++},components:{"liquor-tree":dr["a"],appRecoExport:Rr}},Ur=Mr,Er=r("71a3"),Fr=r("c671"),qr=r("fe57"),Hr=r("9a96"),jr=r("a844"),Br=r("eb2a"),Wr=Object(f["a"])(Ur,Tr,Ir,!1,null,null,null),Gr=Wr.exports;y()(Wr,{VAlert:V["a"],VAvatar:Re["a"],VBtn:U["a"],VCard:E["a"],VCardActions:F["a"],VCardText:F["c"],VCardTitle:F["d"],VCol:q["a"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VList:$["a"],VProgressCircular:Me["a"],VProgressLinear:z["a"],VRow:J["a"],VSelect:Y["a"],VSpacer:X["a"],VTab:Er["a"],VTabItem:Fr["a"],VTabs:qr["a"],VTabsSlider:Hr["a"],VTextField:ue["a"],VTextarea:jr["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"],VTreeview:Br["a"]});var zr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-dialog",{attrs:{transition:"scale-transition","hide-overlay":"",persistent:"",width:"350"},model:{value:e.mappingStatusDialog,callback:function(t){e.mappingStatusDialog=t},expression:"mappingStatusDialog"}},[r("v-card",{attrs:{color:"white",dark:""}},[r("v-card-text",[r("center",[r("font",{staticStyle:{color:"blue"}},[e._v(e._s(e.mappingStatusProgressTitle))]),r("br"),"percent"==e.progressType?r("v-progress-circular",{attrs:{rotate:-90,size:100,width:15,value:e.mappingStatusProgressPercent,color:"primary"}},[r("v-avatar",{attrs:{color:"indigo",size:"50px"}},[r("span",{staticClass:"white--text"},[r("b",[e._v(e._s(e.mappingStatusProgressPercent)+"%")])])])],1):e._e(),"indeterminate"==e.progressType?r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"red"}}):e._e()],1)],1)],1)],1),r("v-layout",{attrs:{column:""}},[r("v-dialog",{attrs:{scrollable:"",persistent:"",overlay:!1,"max-width":"700px",transition:"dialog-transition"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[r("v-card",[r("v-toolbar",{attrs:{color:"primary",dark:""}},[r("v-toolbar-title",[r("v-icon",[e._v("mdi-information")]),e._v(" About this page ")],1),r("v-spacer"),r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.helpDialog=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v(" This page let you visualize the mapping status for various levels "),r("v-list",[e._v(" 1. Right boxes shows reconciliation status for a selected level ")]),r("v-list",[e._v(" 2. Left boxes shows reconciliation status for a all levels ")]),r("v-list",[e._v(" 3. The search box let you search locations for a selected level only ")])],1)],1)],1),r("v-flex",{attrs:{xs1:"","text-xs-right":""}},[r("v-row",[r("v-col",{attrs:{cols:"3"}},[r("appRecoExport")],1),r("v-spacer"),r("v-col",{attrs:{cols:"1"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({staticClass:"mx-1",attrs:{fab:"",dark:"","x-small":"",color:"primary"},on:{click:function(t){e.helpDialog=!0}}},a),[r("v-icon",[e._v("mdi-help")])],1)]}}])},[r("span",[e._v("Help")])])],1)],1)],1)],1),r("v-row",[r("v-col",{attrs:{cols:"1"}},[r("b",[e._v("All Levels")])]),r("v-spacer"),r("v-col",{attrs:{cols:"1"}},[r("b",[e._v(e._s(e.currentLevelText)+" Only")])])],1),r("v-row",[r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Matched")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllMapped)+"/"+e._s(e.$store.state.source1TotalAllRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentMapped,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source1PercentMapped)+"%")])])],1)],1)],1)],1)],1)],1),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 No Match")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllNoMatch)+"/"+e._s(e.$store.state.source1TotalAllRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentNoMatch,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source1PercentNoMatch)+"%")])])],1)],1)],1)],1)],1)],1),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Flagged")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllFlagged)+"/"+e._s(e.$store.state.source1TotalAllRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentFlagged,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source1PercentFlagged)+"%")])])],1)],1)],1)],1)],1)],1),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 2 Matched")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllMapped)+"/"+e._s(e.$store.state.source2TotalAllRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentMapped,color:"green"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source2PercentMapped)+"%")])])],1)],1)],1)],1)],1)],1),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"green","text-color":"white"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 2 Flagged")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.$store.state.totalAllFlagged)+"/"+e._s(e.$store.state.source2TotalAllRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source2PercentFlagged,color:"yellow"}},[r("font",{attrs:{color:"white"}},[r("b",[e._v(e._s(e.source2PercentFlagged)+"%")])])],1)],1)],1)],1)],1)],1),r("v-spacer"),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"cyan","text-color":"black"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Matched")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.totalMapped)+"/"+e._s(e.totalRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentMappedLevel,color:"yellow"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentMappedLevel)+"%")])])],1)],1)],1)],1)],1)],1),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"cyan","text-color":"black"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 No Match")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.totalNoMatch)+"/"+e._s(e.totalRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentNoMatchLevel,color:"yellow"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentNoMatchLevel)+"%")])])],1)],1)],1)],1)],1)],1),r("v-col",[r("v-chip",{staticStyle:{height:"138px",width:"137px"},attrs:{color:"cyan","text-color":"black"}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("b",[e._v("Source 1 Flagged")])]),r("v-flex",{attrs:{xs1:"","align-center":""}},[r("center",[r("b",[e._v(e._s(e.totalFlagged)+"/"+e._s(e.totalRecords))])])],1),r("v-flex",{attrs:{xs1:""}},[r("center",[r("v-progress-circular",{attrs:{rotate:-90,size:65,width:8,value:e.source1PercentFlagged,color:"yellow"}},[r("font",{attrs:{color:"black"}},[r("b",[e._v(e._s(e.source1PercentFlagged)+"%")])])],1)],1)],1)],1)],1)],1)],1),r("v-row",[r("v-col",{attrs:{cols:"3"}},[r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchMatched,callback:function(t){e.searchMatched=t},expression:"searchMatched"}})],1),r("v-spacer"),r("v-col",{attrs:{cols:"3"}},[e.$store.state.activePair.userID===e.$store.state.auth.userID||"Admin"==e.$store.state.auth.role?["Done"!==e.$store.state.recoStatus?r("v-btn",{attrs:{color:"success",rounded:""},on:{click:e.markRecoDone}},[r("v-icon",[e._v("mdi-lock")]),e._v("Mark Reconciliation As Done ")],1):e._e(),"Done"===e.$store.state.recoStatus&&"Admin"==e.$store.state.auth.role?r("v-btn",{attrs:{color:"success",rounded:""},on:{click:e.markRecoUnDone}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-lock-open-variant")]),e._v("Mark Reconciliation As UnDone ")],1):e._e()]:e._e()],2),r("v-spacer"),r("v-col",[r("v-select",{staticClass:"input-group--focused",attrs:{items:e.locationLevels,"item-value":e.locationLevels.value,"item-name":e.locationLevels.text,label:"Level",height:"1","full-width":"","single-line":""},on:{change:e.levelChanged},model:{value:e.recoLevel,callback:function(t){e.recoLevel=t},expression:"recoLevel"}})],1)],1),r("v-layout",{attrs:{column:""}},[r("v-flex",{attrs:{xs1:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}}),r("v-spacer"),r("v-flex",{attrs:{xs2:""}}),r("v-spacer"),r("v-flex",{attrs:{xs1:"",sm2:"",md2:"",right:""}})],1)],1),r("v-flex",{attrs:{xs1:""}},[r("v-tabs",{attrs:{"icons-and-text":"",centered:"",grow:"",dark:"","background-color":"cyan"}},[r("v-tabs-slider",{attrs:{color:"red"}}),r("v-tab",{key:"match"},[e._v(" MATCHED ("+e._s(e.totalMapped)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-up")])],1),r("v-tab",{key:"notMapped"},[e._v(" Source 1 Not Mapped ("+e._s(e.totalNotMapped)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-down")])],1),r("v-tab",{key:"nomatch"},[e._v(" Source 1 NO MATCH ("+e._s(e.totalNoMatch)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-down")])],1),r("v-tab",{key:"ignore"},[e._v(" Source 1 IGNORED ("+e._s(e.totalIgnore)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-thumb-down")])],1),r("v-tab",{key:"flagged"},[e._v(" FLAGGED ("+e._s(e.totalFlagged)+") "),r("v-icon",{attrs:{color:"white",right:""}},[e._v("mdi-bell")])],1),r("v-tab-item",{key:"match"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.matchedHeaders,items:e.mappingData.mapped,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),r("td",[e._v(e._s(t.item.source1Id))]),r("td",[e._v(e._s(t.item.source2Name))]),r("td",[e._v(e._s(t.item.source2Id))])]}}])})],1),r("v-tab-item",{key:"notMapped"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.notMappedHeaders,items:e.mappingData.notMapped,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),r("td",[e._v(e._s(t.item.source1Id))])]}}])})],1),r("v-tab-item",{key:"nomatch"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.noMatchHeaders,items:e.mappingData.noMatch,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),r("td",[e._v(e._s(t.item.source1Id))])]}}])})],1),r("v-tab-item",{key:"ignore"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.noMatchHeaders,items:e.mappingData.ignore,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),r("td",[e._v(e._s(t.item.source1Id))])]}}])})],1),r("v-tab-item",{key:"flagged"},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.flaggedHeaders,items:e.mappingData.flagged,search:e.searchMatched},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.source1Name))]),r("td",[e._v(e._s(t.item.source1Id))]),r("td",[e._v(e._s(t.item.source2Name))]),r("td",[e._v(e._s(t.item.source2Id))])]}}])})],1)],1)],1)],1)],1)},Jr=[],Yr={mixins:[C],data:function(){return{helpDialog:!1,matchedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Source 2 Location",value:"source2Name"},{text:"Source 2 ID",value:"source2Id"}],noMatchHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"}],notMappedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"}],flaggedHeaders:[{text:"Source 1 Location",value:"source1Name"},{text:"Source 1 ID",value:"source1Id"},{text:"Source 2 Location",value:"source2Name"},{text:"Source 2 ID",value:"source2Id"}],searchMatched:"",mappingData:{},recoLevel:2,mappingStatusDialog:!1,mappingStatusProgressTitle:"Waiting for progress status",mappingStatusProgressPercent:0,locationLevels:[]}},methods:{checkMappingStatusProgress:function(){var e=this,t=this.$store.state.clientId;u.a.get("/progress/mappingStatus/"+t).then((function(t){return null===t.data||void 0===t.data||!1===t.data?(e.mappingStatusDialog=!1,e.mappingStatusProgressTitle="Waiting for progress status",void clearInterval(e.mappingStatusProgressTimer)):null===t.data.status&&null===t.data.error&&null===t.data.percent?(e.mappingStatusDialog=!1,clearInterval(e.mappingStatusProgressTimer),void(e.mappingStatusProgressTitle="Waiting for progress status")):(e.mappingStatusProgressTitle=t.data.status,t.data.percent&&("percent"!==e.progressType&&(e.progressType="percent"),e.mappingStatusProgressPercent=t.data.percent),void("Done"===t.data.status&&(e.clearProgress("mappingStatus"),clearInterval(e.mappingStatusProgressTimer),e.mappingStatusDialog=!1,e.mappingStatusProgressTitle="Waiting for progress status")))})).catch((function(e){console.log(e)}))},mappingStatus:function(){var e=this;if(this.source1&&this.source2){this.mappingData={};var t=this.$store.state.clientId,r=this.$store.state.totalSource2Levels,a=this.$store.state.totalSource1Levels,s=this.$store.state.activePair.userID,o=this.getDatasourceOwner(),i=o.source1Owner,n=o.source2Owner,c=this.getLimitOrgIdOnActivePair().source1LimitOrgId,l=this.getLimitOrgIdOnActivePair().source2LimitOrgId;this.mappingStatusDialog=!0,this.progressType="indeterminate";var d="/mappingStatus/".concat(this.source1,"/").concat(this.source2,"/").concat(i,"/").concat(n,"/").concat(this.recoLevel,"/").concat(r,"/").concat(a,"/").concat(t,"/").concat(s,"?source1LimitOrgId=").concat(c,"&source2LimitOrgId=").concat(l);u.a.get(d).then((function(t){e.mappingData=t.data})),this.mappingStatusProgressTimer=setInterval(this.checkMappingStatusProgress,500)}},levelChanged:function(e){this.recoLevel=e,this.mappingStatus()},markRecoDone:function(){var e=this;this.$store.state.progressTitle="Marking reconciliation as Done",this.$store.state.dynamicProgress=!0;var t=this.$store.state.activePair.userID;u.a.get("/match/markRecoDone/"+this.source1+"/"+this.source2+"/"+t).then((function(t){e.$store.state.dynamicProgress=!1,t.data.status&&(e.$store.state.recoStatus=t.data.status),e.$store.state.errorTitle="Reconciliation Done",e.$store.state.errorDescription="Reconciliation is complete, no more changes can be done",e.$store.state.errorColor="primary",e.$store.state.dialogError=!0})).catch((function(t){e.$store.state.dynamicProgress=!1,console.log(t.response.data.error)}))},markRecoUnDone:function(){var e=this,t=this.$store.state.activePair.userID;this.$store.state.progressTitle="Marking reconciliation as Un Done",this.$store.state.dynamicProgress=!0,u.a.get("/markRecoUnDone/"+this.source1+"/"+this.source2+"/"+t).then((function(t){e.$store.state.dynamicProgress=!1,t.data.status&&(e.$store.state.recoStatus=t.data.status),e.$store.state.errorTitle="Reconciliation on progress",e.$store.state.errorDescription="You may continue doing reconciliation now",e.$store.state.errorColor="primary",e.$store.state.dialogError=!0})).catch((function(t){e.$store.state.dynamicProgress=!1,console.log(t.response.data.error)}))}},computed:{currentLevelText:function(){return this.translateDataHeader("source1",this.recoLevel-1)},source1:function(){var e=this.$store.state.activePair.source1.name;return e&&(e=this.toTitleCase(e)),e},source2:function(){var e=this.$store.state.activePair.source2.name;return e&&(e=this.toTitleCase(e)),e},source1PercentMapped:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllMapped/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentMappedLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalMapped/this.totalRecords).toFixed(2))},source1PercentNoMatch:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllNoMatch/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentIgnore:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllIgnore/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentNoMatchLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalNoMatch/this.totalRecords).toFixed(2))},source1PercentIgnoreLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalIgnore/this.totalRecords).toFixed(2))},source1PercentFlagged:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllFlagged/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentFlaggedLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalFlagged/this.totalRecords).toFixed(2))},source1PercentNotMapped:function(){return 0===this.$store.state.source1TotalAllRecords?0:parseFloat((100*this.$store.state.source1TotalAllNotMapped/this.$store.state.source1TotalAllRecords).toFixed(2))},source1PercentNotMappedLevel:function(){return 0===this.totalRecords?0:parseFloat((100*this.totalNotMapped/this.totalRecords).toFixed(2))},source2PercentFlagged:function(){return 0===this.$store.state.source2TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllFlagged/this.$store.state.source2TotalAllRecords).toFixed(2))},source2PercentMapped:function(){return 0===this.$store.state.source2TotalAllRecords?0:parseFloat((100*this.$store.state.totalAllMapped/this.$store.state.source2TotalAllRecords).toFixed(2))},totalMapped:function(){return this.mappingData&&this.mappingData.hasOwnProperty("mapped")?this.mappingData.mapped.length:0},totalNotMapped:function(){return this.mappingData&&this.mappingData.hasOwnProperty("notMapped")?this.mappingData.notMapped.length:0},totalNoMatch:function(){return this.mappingData&&this.mappingData.hasOwnProperty("noMatch")?this.mappingData.noMatch.length:0},totalIgnore:function(){return this.mappingData&&this.mappingData.hasOwnProperty("ignore")?this.mappingData.ignore.length:0},totalFlagged:function(){return this.mappingData&&this.mappingData.hasOwnProperty("flagged")?this.mappingData.flagged.length:0},totalRecords:function(){return this.totalMapped+this.totalNotMapped+this.totalNoMatch+this.totalIgnore+this.totalFlagged}},components:{appRecoExport:Rr},created:function(){this.mappingStatus();for(var e=1;e<this.$store.state.totalSource1Levels;e++){var t=this.translateDataHeader("source1",e);this.locationLevels.push({text:t,value:e+1})}}},Kr=Yr,Xr=Object(f["a"])(Kr,zr,Jr,!1,null,null,null),Zr=Xr.exports;y()(Xr,{VAvatar:Re["a"],VBtn:U["a"],VCard:E["a"],VCardText:F["c"],VChip:Ye["a"],VCol:q["a"],VContainer:ce["a"],VDataTable:Ke["a"],VDialog:H["a"],VFlex:j["a"],VIcon:S["a"],VLayout:W["a"],VList:$["a"],VProgressCircular:Me["a"],VProgressLinear:z["a"],VRow:J["a"],VSelect:Y["a"],VSpacer:X["a"],VTab:Er["a"],VTabItem:Fr["a"],VTabs:qr["a"],VTabsSlider:Hr["a"],VTextField:ue["a"],VToolbar:Z["a"],VToolbarTitle:Q["b"],VTooltip:_["a"]});var Qr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-xs":""}})},ea=[],ta={mixins:[P],methods:{getDHIS2UserData:function(e){var t=this,r=this.$store.state.dhis.dev.auth;""===r.username&&(r=""),u.a.get(this.$store.state.dhis.host+"api/me",{auth:r}).then((function(a){var s=a.data.organisationUnits;s.length>0&&(t.$store.state.dhis.user.orgId=s.shift().id,u.a.get(t.$store.state.dhis.host+"api/organisationUnits/"+t.$store.state.dhis.user.orgId,{auth:r}).then((function(r){return t.$store.state.dhis.user.orgName=r.data.displayName,e(a)})))})).catch((function(e){t.$store.state.dialogError=!0,t.$store.state.errorTitle="Error",e.response&&e.response.data&&401===e.response.data.httpStatusCode?(t.$store.state.errorDescription="Unauthorized, ensure that your DHIS2 login is active",t.$router.push({name:"Logout"})):t.$store.state.errorDescription="Unauthorized, please reload the app"}))}},created:function(){var e=this;this.setDHIS2Credentials(),this.getRoles(),this.getDHIS2UserData((function(t){var r,a,s=t.data.userCredentials.userRoles.find((function(t){return t.id===e.$store.state.config.generalConfig.externalAuth.adminRole}));if(s){var o=e.roles.find((function(e){return"Admin"===e.text}));r=o.value,a=o.text}else{var i=e.roles.find((function(e){return"Data Manager"===e.text}));r=i.value,a=i.text}u.a.get("/getUser/"+t.data.userCredentials.username).then((function(s){if(s.data.userID)e.$store.state.auth.username=t.data.userCredentials.username,e.$store.state.auth.userID=s.data.userID,e.$store.state.auth.role=a,e.$store.state.initializingApp=!0,e.$store.state.denyAccess=!1,Oa.$emit("getUserConfig");else{var o=new FormData;o.append("firstName",t.data.firstName),o.append("otherName",""),o.append("password",t.data.surname),o.append("userName",t.data.userCredentials.username),o.append("surname",t.data.surname),o.append("role",r),u.a.post("/addUser",o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){u.a.get("/getUser/"+t.data.userCredentials.username).then((function(r){r.data.userID&&(e.$store.state.auth.username=t.data.userCredentials.username,e.$store.state.auth.userID=r.data.userID,e.$store.state.auth.role=r.data.role,e.$store.state.initializingApp=!0,e.$store.state.denyAccess=!1,Oa.$emit("getUserConfig"))}))}))}}))}))}},ra=ta,aa=Object(f["a"])(ra,Qr,ea,!1,null,null,null),sa=aa.exports;y()(aa,{VContainer:ce["a"]});var oa,ia=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ihris-template",{key:e.$route.path},[e._v(" Loading... ")])},na=[],ca={name:"fhir-page-view",props:["page","pageId"],data:function(){return{}},created:function(){this.getTemplate(),oa=this.pageId},methods:{getTemplate:function(){var e=this;u.a.get("/config/page/"+this.page).then((function(t){var s=t.data;"OperationOutcome"===s.resourceType?a["a"].component("ihris-template",{name:"ihris-template",data:function(){return{issues:s.issue}},components:{"ihris-outcome":function(){return r.e("fhir-outcome").then(r.bind(null,"adbd"))}},template:'<div><ihris-outcome :issues="issues"></ihris-outcome></div>'}):a["a"].component("ihris-template",{name:"ihris-template",data:function(){return{fhirId:oa,isEdit:!1,sectionMenu:s.data.sectionMenu,subFields:s.data.subFields,columns:s.data.columns,actions:s.data.actions,links:s.data.links,constraints:s.data.constraints}},components:{"ihris-resource":function(){return r.e("chunk-ea42a9f0").then(r.bind(null,"7372"))},"ihris-codesystem":function(){return r.e("chunk-5474d9c5").then(r.bind(null,"2d9b"))},"ihris-section":function(){return r.e("chunk-2d2245b0").then(r.bind(null,"e07f"))},"ihris-secondary":function(){return r.e("chunk-69ce93ab").then(r.bind(null,"39e1"))},"ihris-array":function(){return r.e("chunk-2d21a389").then(r.bind(null,"bb1d"))},"fhir-extension":function(){return r.e("chunk-2d0da301").then(r.bind(null,"6b10"))},"fhir-reference":function(){return Promise.all([r.e("chunk-67c19840"),r.e("chunk-fdbc1486")]).then(r.bind(null,"99fa"))},"fhir-backbone-element":function(){return r.e("chunk-08ab496f").then(r.bind(null,"8142"))},"fhir-string":function(){return r.e("chunk-1b3f2290").then(r.bind(null,"b78c"))},"fhir-attachment":function(){return r.e("chunk-616686dc").then(r.bind(null,"ca33"))},"fhir-human-name":function(){return r.e("chunk-07768e92").then(r.bind(null,"89c1"))},"fhir-code":function(){return r.e("chunk-77a2aa0c").then(r.bind(null,"1131"))},"fhir-date":function(){return Promise.all([r.e("chunk-4187d98a"),r.e("chunk-2d0e2c53")]).then(r.bind(null,"7fb0"))},"fhir-time":function(){return r.e("chunk-6d62d473").then(r.bind(null,"1286"))},"fhir-date-time":function(){return Promise.all([r.e("chunk-4187d98a"),r.e("chunk-2d0c17b7")]).then(r.bind(null,"45dd"))},"fhir-period":function(){return r.e("chunk-789dd4ca").then(r.bind(null,"4807"))},"fhir-identifier":function(){return r.e("chunk-5e719bed").then(r.bind(null,"c408"))},"fhir-contact-point":function(){return r.e("chunk-69e25fe0").then(r.bind(null,"4b80"))},"fhir-address":function(){return r.e("chunk-63f87f9c").then(r.bind(null,"b248"))},"fhir-codeable-concept":function(){return r.e("chunk-2d0b8b5d").then(r.bind(null,"309c"))},"fhir-uri":function(){return r.e("chunk-69078b64").then(r.bind(null,"6d39"))},"fhir-boolean":function(){return r.e("chunk-5caeefd5").then(r.bind(null,"ff03"))},"fhir-positive-int":function(){return r.e("chunk-19a703d4").then(r.bind(null,"b750"))},"fhir-unsigned-int":function(){return r.e("chunk-53787938").then(r.bind(null,"4c52"))},"fhir-integer":function(){return r.e("chunk-5368b584").then(r.bind(null,"eaae"))},"fhir-coding":function(){return r.e("chunk-5e70ac24").then(r.bind(null,"eee9"))},"fhir-money":function(){return r.e("chunk-1f82ee10").then(r.bind(null,"a6ba"))},"fhir-decimal":function(){return r.e("chunk-2f5fab82").then(r.bind(null,"8892"))}},template:s.template,methods:{setEdit:function(e){this.isEdit=e}}}),e.$forceUpdate()})).catch((function(t){console.log(t),a["a"].component("ihris-template",{template:"<div><h1>Error</h1><p>An error occurred trying to load this page</p>.</div>"}),e.$forceUpdate()}))}},components:{},beforeCreate:function(){a["a"].component("ihris-template",{template:"<div>Loading...</div>"})}},la=ca,ua=Object(f["a"])(la,ia,na,!1,null,null,null),da=ua.exports,ha=r("2f62");a["a"].use(ha["a"]);var va=new ha["a"].Store({state:{baseRouterViewKey:0,idp:"",keycloak:{},alert:{width:"800px",show:!1,msg:"",type:"success",dismisible:!0,transition:"scale-transition"},auth:{username:"",userID:"",role:""},levelMapping:{source1:{},source2:{}},config:{userConfig:{reconciliation:{useCSVHeader:!0},FRDatasource:"DEFAULT"},generalConfig:{reconciliation:{parentConstraint:{enabled:!0,idAutoMatch:!0,nameAutoMatch:!1},singlePair:!1,singleDataSource:!1,fixSource2To:null,fixSource2:!1},recoProgressNotification:{enabled:!1},allowShareToAllForNonAdmin:!1,selfRegistration:{enabled:!1,requiresApproval:!1},datasetsAdditionWays:["CSV Upload","Remote Servers Sync"],datasetsAutosyncTime:"*/15 * * * *",authDisabled:!1,authMethod:"dhis2",externalAuth:{pullOrgUnits:!0,shareOrgUnits:!0,shareByOrgId:!0,datasetName:null,adminRole:null}}},recoStatus:{status:"in-progress"},recalculateScores:!1,dialogError:!1,errorTitle:"",errorDescription:"",errorColor:"primary",clientId:null,denyAccess:!0,source2Hierarchy:"",source1Hierarchy:"",uploadRunning:!1,dhis:{user:{orgId:"",orgName:""},host:"",dev:{auth:{username:"",password:""}}},dataSourcePairs:[],activePair:{source1:{},source2:{}},source1TotalAllRecords:0,source2TotalAllRecords:0,totalAllMapped:0,totalAllFlagged:0,totalAllNoMatch:0,totalAllIgnore:0,source1TotalAllNotMapped:0,source2TotalRecords:0,recoLevel:2,totalSource1Levels:"",totalSource2Levels:"",matchedContent:[],noMatchContent:[],ignoreContent:[],flagged:[],source1Parents:[],source2UnMatched:[],source1UnMatched:[],scoreResults:[],levelArray:[],scoresProgressData:{scoreDialog:!1,scoreProgressTitle:"Waiting for progress status",stage:"not final",scoreProgressPercent:null,progressType:"",scoreProgressTimer:!1,progressReqTimer:"",requestCancelled:!1,cancelTokenSource:""},scoreSavingProgressData:{percent:null,savingMatches:!1,savingProgressTimer:!1,progressReqTimer:"",requestCancelled:!1,cancelTokenSource:""},uploadProgressData:{},dataSources:[],remoteDataSources:["DHIS2","FHIR"],loadingServers:!1,dynamicProgress:!1,initializingApp:!1,cols:{header:4,content:8},searchAction:"",requestResourceUpdateData:{requestType:"",requestUpdatingResource:""},message:{type:"info",text:null,timeout:5e3,active:!1}},mutations:{setMessage:function(e,t){"string"===typeof t?(e.message.type="info",e.message.timeout=5e3,e.message.text=t,e.message.active=!0):(e.message.type=t.type||"info",e.message.timeout=t.timeout||5e3,e.message.text=t.text,e.message.active=!0)},closeMessage:function(e){e.message.active=!1}}});u.a.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;return 401!==t&&403!==t||ga.push("logout"),Promise.reject(e)})),a["a"].use(re["a"]);var pa=new re["a"]({routes:[{path:"/UsersList",name:"UsersList",component:nt},{path:"/RolesManagement",name:"RolesManagement",component:St},{path:"/ChangePassword",name:"ChangePassword",component:kt},{path:"/login",name:"Login",component:he},{path:"/logout",name:"Logout",component:ye},{path:"/Signup",name:"Signup",component:Pe},{path:"/dhis2Auth",name:"DHIS2Auth",component:sa},{path:"/Configure",name:"Configure",component:tt,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","view-config-page");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/addUser",name:"AddUser",component:vt},{path:"/ViewDataSources",name:"ViewDataSources",component:gr,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","view-data-source");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/AddDataSources",name:"AddDataSources",component:cr,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","add-data-source");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/dataSourcesPair",name:"DataSourcesPair",component:br,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","view-source-pair");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/view",name:"FacilityReconView",component:Cr,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","data-source-reconciliation");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/scores",name:"FacilityReconScores",component:Gr,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","data-source-reconciliation");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/recoStatus",name:"FacilityRecoStatus",component:Zr,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","view-matching-status");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/",name:"FacilityReconHome",component:Gr,beforeEnter:function(e,t,r){var a=v["a"].hasPermissionByName("special","custom","data-source-reconciliation");if(a)return r();va.state.dialogError=!0,va.state.errorTitle="Info",va.state.errorColor="error",va.state.errorDescription="You dont have permission to access this page",r({path:t.path})}},{path:"/questionnaire/:questionnaire/:page",name:"questionnaire",component:function(){return r.e("chunk-2d0afa68").then(r.bind(null,"0eda"))}},{path:"/ViewMap",name:"ViewMap",component:function(){return r.e("chunk-748c7801").then(r.bind(null,"afb4"))}},{path:"/Resource/View/:page/:id",name:"ResourceView",component:da,props:function(e){return{page:e.params.page,pageId:e.params.id}}},{path:"/Resource/Add/:page",name:"ResourceAdd",component:function(){return r.e("chunk-2d216051").then(r.bind(null,"c14a"))},props:function(e){return{page:e.params.page}}},{path:"/Resource/Search/:page/:requestAction?",name:"ResourceSearch",component:function(){return r.e("chunk-2d0f083f").then(r.bind(null,"9d64"))},props:function(e){return{page:e.params.page,requestAction:e.params.requestAction}}}]});pa.beforeEach((function(e,t,r){if(va.state.alert.show=!1,"keycloak"===va.state.idp){if(a["a"].$keycloak.authenticated)return r();if("/Login"===e.path||"/Signup"===e.path||va.state.config.generalConfig.authDisabled)return r();a["a"].$keycloak.logout()}else if(L.a.get("userID")&&"null"!==L.a.get("userID"))r();else{if("/Login"===e.path||"/Signup"===e.path||va.state.config.generalConfig.authDisabled)return r();r({path:"/Login"})}}));var ga=pa,fa=(r("466d"),r("a925"));function ma(){var e=r("49f8"),t={};return e.keys().forEach((function(r){var a=r.match(/([A-Za-z0-9-_]+)\./i);if(a&&a.length>1){var s=a[1];t[s]=e(r)}})),t}a["a"].use(fa["a"]);var ya=new fa["a"]({locale:"en",fallbackLocale:"en",messages:ma()}),Sa=r("f309");a["a"].use(Sa["a"],{theme:{primary:"#3F51B5",secondary:"#7986CB",accent:"#9c27b0",error:"#f44336",warning:"#ffeb3b",info:"#2196f3",success:"#4caf50"}});var $a=new Sa["a"]({}),ba=r("1dce"),xa=r.n(ba),_a=r("2106"),wa=r.n(_a),ka=r("68ad"),Pa=(r("6d93"),r("0551")),Da=r.n(Pa),Ca=(r("2ca0"),r("caad"),r("2532"),r("0551")),Ta=r("bc3a"),Ia={_code_cache:{},_code_loading:{},_setCache:function(e,t){return Ia._code_cache[e]=t,Ia._code_loading[e]=!1,t},checkConstraints:function(e,t,r,a,s){return new Promise((function(o,i){var c,l=e.split(","),u=[],d=Object(n["a"])(l);try{var h=function(){var e=c.value;if(t[e]){var o=Ca.evaluate(r,t[e].expression);if(e.startsWith("ihris-search")){var i=o.shift(),n=["_elements=id"];while(o.length)n.push(o.shift()+"="+encodeURI(o.shift()));u.push(new Promise((function(r,o){Ta.get("/fhir/"+va.state.config.userConfig.FRDatasource+"/"+i+"?"+n.join("&")).then((function(o){var i=o.data;if(0===i.total)r(!0);else if(s){var n=Ca.evaluate(i.entry,"resource.id");n.includes(s)?r(!0):(a.push(t[e].human),r(!1))}else a.push(t[e].human),r(!1)})).catch((function(e){o(e)}))})))}else o.every(Boolean)?u.push(!0):(a.push(t[e].human),u.push(!1))}};for(d.s();!(c=d.n()).done;)h()}catch(v){d.e(v)}finally{d.f()}Promise.all(u).then((function(e){e.every(Boolean)?o(!0):o(!1)})).catch((function(e){i(e)}))}))},lookup:function(e,t){return e?t?Ia.codeLookup(t,e):e.system&&e.code?Ia.codeLookup(e.system,e.code):e.reference?Ia.resourceLookup(e.reference):/([A-Z]\w*)\/([A-Za-z0-9\-.]{1,64})/.test(e)?Ia.resourceLookup(e):new Promise((function(t){return t(e)})):new Promise((function(t){return t(e)}))},resourceLookup:function(e){return new Promise((function(t){var r=e;Ia._code_loading[r]?setTimeout((function(){t(Ia.resourceLookup(e))}),200):Ia._code_cache[r]?t(Ia._code_cache[r]):(Ia._code_loading[r]=!0,Ta.get("/fhir/"+va.state.config.userConfig.FRDatasource+"/$short-name?reference="+e).then((function(a){var s=a.data;s.display?t(Ia._setCache(r,s.display)):(console.log("No display data from reference found ",r,s),t(Ia._setCache(r,e)))})).catch((function(a){console.log(a),t(Ia._setCache(r,e))})))}))},codeLookup:function(e,t,r){return new Promise((function(a){var s=e+"#"+t;Ia._code_loading[s]?setTimeout((function(){a(Ia.codeLookup(e,t,r))}),200):Ia._code_cache[s]?a(Ia._code_cache[s]):(Ia._code_loading[s]=!0,Ta.get("/fhir/DEFAULT/$short-name?system="+e+"&code="+t+"&valuset="+r).then((function(e){var r=e.data;r.display?a(Ia._setCache(s,r.display)):(console.log("No display data from codesystem found ",s,r),a(Ia._setCache(s,t)))})).catch((function(e){console.log(e),a(Ia._setCache(s,t))})))}))},pathFieldExpression:function(e){var t=e.substring(e.indexOf(":")+1);return t.includes("-")||t.includes(".")?"`"+t+"`":t},expand:function(e){var t=function(e,t){return e.display===t.display?e.code===t.code?0:e.code<t.code?-1:1:e.display<t.display?-1:1},r=function(e,t){if(e.compose.include){var r,a=Object(n["a"])(e.compose.include);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.concept){var o,i=Object(n["a"])(s.concept);try{for(i.s();!(o=i.n()).done;){var c=o.value;c.system=s.system,t.push(c)}}catch(l){i.e(l)}finally{i.f()}}}}catch(l){a.e(l)}finally{a.f()}}};return new Promise((function(a,s){var o=e.lastIndexOf("/"),i=e.lastIndexOf("|"),n=e.slice(o+1,-1!==i?i:e.length),c=[];Ta.get("/fhir/DEFAULT/ValueSet/"+n+"/$expand").then((function(e){var o=e.data;try{o.expansion&&0!==o.expansion.total||!o.compose.include?c=o.expansion.contains:r(o,c),c.sort(t),a(c)}catch(i){console.log(i),s(new Error("Invalid response from server."))}})).catch((function(){Ta.get("/fhir/DEFAULT/ValueSet/"+n).then((function(e){var s=e.data;r(s,c),c.sort(t),a(c)})).catch((function(e){s(e)}))}))}))}},Aa=Ia,La=r("be6f");Object.defineProperty(a["a"].prototype,"$fhirpath",{value:Da.a}),Object.defineProperty(a["a"].prototype,"$fhirutils",{value:Aa}),u.a.defaults.withCredentials=!0,a["a"].use(xa.a),a["a"].use(wa.a,u.a),a["a"].config.productionTip=!1;var Oa=new a["a"];function Na(e){var t=location.href.split("api");if(!(t.length>=2)){var r=!1;return e(r)}var a=location.href.split("api").shift();u.a.get(a+"api/dataStore/GOFR/config").then((function(t){if(e(t.data),!t.data.BACKEND_SERVER){var r=".",a={BACKEND_SERVER:r};Va(a)}})).catch((function(t){console.log(JSON.stringify(t));var r=!1,a=".",s={BACKEND_SERVER:a};return Va(s),e(r)}))}function Va(e){var t=location.href.split("api").shift();u.a.post(t+"api/dataStore/GOFR/config",e)}"."===La.BACKEND_HOST&&(La.BACKEND_HOST=window.location.hostname,La.BACKEND_PROTOCOL=window.location.protocol.replace(":","")),La.BACKEND_SERVER=La.BACKEND_PROTOCOL+"://"+La.BACKEND_HOST+":"+La.BACKEND_PORT,Na((function(e){e&&e.BACKEND_SERVER,u.a.defaults.baseURL=".";var t=JSON.stringify(va.state.config.generalConfig);u.a.get("/config/getGeneralConfig?defaultGenerConfig="+t).then((function(e){var t=e.data.generalConfig;if(va.state.idp=e.data.otherConfig.idp,va.state.keycloak=e.data.otherConfig.keycloak,t||(t={}),e.data.generalConfig.authDisabled||"keycloak"!==va.state.idp)a["a"].prototype.$keycloak=null,new a["a"]({router:ga,store:va,i18n:ya,vuetify:$a,data:function(){return{config:t}},render:function(e){return e(te,{props:{generalConfig:this.config}})}}).$mount("#app");else{var r={realm:e.data.otherConfig.keycloak.realm,clientId:e.data.otherConfig.keycloak.UIClientId,url:e.data.otherConfig.keycloak.baseURL,onLoad:"login-required"},s=ka(r),o={install:function(e){e.$keycloak=s}};o.install=function(e){e.$keycloak=s,Object.defineProperties(e.prototype,{$keycloak:{get:function(){return s}}})},a["a"].use(o),s.init({onLoad:r.onLoad}).then((function(e){e?(u.a.interceptors.request.use((function(e){return e.headers["Authorization"]="Bearer ".concat(s.token),e}),(function(e){return Promise.reject(e)})),s.loadUserInfo().then((function(e){var r={resourceType:"Person",id:e.sub,meta:{profile:["http://gofr.org/fhir/StructureDefinition/gofr-person-user"]},name:[{text:e.name}],active:!0};u()({method:"POST",url:"/users/addUser",data:r}).then((function(r){L.a.set("userObj",JSON.stringify(r.data),"infinity"),va.state.auth.userID=e.sub,va.state.auth.username=e.preferred_username,new a["a"]({router:ga,store:va,i18n:ya,vuetify:$a,data:function(){return{config:t}},render:function(e){return e(te,{props:{generalConfig:this.config}})}}).$mount("#app")})).catch((function(e){console.error(e)}))})),setInterval((function(){s.updateToken(70)}),6e4)):window.location.reload()})).catch((function(){alert("Keycloak access failed")}))}}))}))},"56e8":function(e,t,r){"use strict";r("08bb")},"6a56":function(e,t,r){"use strict";r("087a")},"754f":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAAbCAYAAAAnFzLpAAAGGklEQVRYR+1YaVCTVxQ9BBLWEBYRGhAjFPetVRRoQVnFZRQtYq1Tl6kzij/q2k7dZtTSxW3sVGeqVtHOuLXQYnFBFscNFwqIYikKRRkpq2GRGJCEJJ37RV6SJhBQ63Qs59/7ct9795137vJi4bNktwa94Biw6CVDp4ReMvSiopeMXjJMJ8leZTyPMoQ2AhxePoNNzbx9H3vP5bPxByHD8V7gEDb++MA5VNbLelSnlkaPgf+bYtyrrMfe9Hw0t7T1aP6LGndbGc72NsjbuZjt92N2EdYducDGa2ICER89ho2jNh1FWU1jt/0LGOiJo6tmMvsvk7NxMOtWt+ebMrQSCOAt8YWnxAcOIhFsbe2gULShqaEeTVIp7v1+G0qFjvD/DBmerkJcTJgPnoUFd66l350Fqe954SXxwdtBwbC2sel0CfkTGa5lZaCpQdqzPuPfVgZ5493HEWO4MJHijwqtg88De6EQkTFx4POt2HSNRoMnzY9hLxSBx9MSTmh72obUYz8A0Jhuuuhy+rs5QWRnzcXvU2U7BFaWKN4T3+0wCV57GFWNT7ib9vVwhoOtAA8fPUa9rNXk+cjO3oavc1LZDkW72sjWVmAFD2cHuDnaQdGuwqPmFtQ2ytGuNrR18xAjZNJUtLbIUZh3AzUVFWhvV4LPFyAwLBLunl5s7Utpp1FXXWlMBsX9ssljYWetdUyl1iCnpBKrEjNwZuNcuAptue/mcsa4Tw6C8siMcYNgzbdkG9/9S4otP13h1tSHv58YJ1bPYp8SkrJx6LwuZ0j6irByegCiRvtwF6MPeZsSV4oeYn/GTdwur2U/iVxcIWtqglqtMrAXe0vwTsQk9u1WznWUFhUakrF1QThi9SqC/gq1TXLwrSzh4qCNQXNkFJbXYaSkr0kV0I1OSzhhkGC7IoMuIHX9+/Bwsu80ajQaYMrnx1BS1WA2siR+A+EfHMrsLpxNhbSmWkfGiP59cXJtHDMg2R2/XISymgYM8eqD2KChsNSLNXNk0EJ0S2fySiGys0Hcu0M5aXfgdF4plh9IZ+OuyKALoovqwL70m0i7+SccbARcCIaPHIBWhRLL9qWZJYJnyUPE9FiInJ052xa5HGnJx6FWqXRk7FwUiZjxg9hiaw5nIeXGXTaODRqCrfN1DpkjI7+sGnN3/sKFGYGcztg0j61HZZfKbwe6ImNR2ChsiAtmtt9nFmBHynWjPGGWCVhg/IRQePv6aU01wKX006ir0oYsK60pn8UxWVOSC/g0EWrS3jNY8Xi48+0SFq/myFh9KBMnc+4Z+Hf5iwWgEkqQPVVg9Ir93SKDVEv+Pau63BxpcwuSrhXjyMVC1DTJzfJgYUFEhKOfjy+zvZP3G+4WFrAxIyN3x2KWD0jes75OMtpA/zDmyIjb/jNIHfo4sjIGgYO0WbwnZJD9/NCR2DA72CBU6btSpcap3BJ8cyqn046Xx+MhYGIEPCUDtILQaJB/9TIelOiUb6AM6i6plyAU3K9B7LZkIzLOb/kQlNUJ5siI3nwMpdWGyexFyKA9vVwdsTjyLVDIUonVR1WDDLO3JRuphM/nIzA8Gu5iMWeuUqlw40IWqh6WG52PKSN1/RwM6+fGGVDtpjDRByXPot3x4FvyukWGqXb8Rcno8EdoK+CqXvzksazU02+7UnOw52wuc9va1g4hUVPg5OrKfWtrbUV25jk0SOuMiDBQxq6PojDdfyAzWnEwHadyS9l4ZsBg7FgYwcbmlPEyyXC0szb5aHN3skf2VwtZC085inIVwcHRESGTpoG6UQK9R65mpnHVozMwZQz3dsOv6+YwOyqtSVeL8aC2EX5vuCAmYDBTRXfC5GWSsXpGALd/RkEZiiukqGzQvoYnDu/PhU0HtqVcA5VdepSFTY0xeJfIZTIolYpOicg8mWzYdCXMC8Xc4GEmJ+SVVUPsIoTY2eGVhwmRQV1xVyive4y47clcu0+JMigsqkv7f/6YlLjPuB2nmq4fi7JWBahB2nziEuZNGIGNz+r9qwyT0BESjoxREnejakKHp34o8fwtUJdMeGlk9IjO18y42/9nvGbn7rqa/B8Oa+6MvcrQY+hvaNExIn99uskAAAAASUVORK5CYII="},"7de1":function(e,t,r){},be6f:function(e){e.exports=JSON.parse('{"BACKEND_HOST":".","BACKEND_PORT":"4000","BACKEND_PROTOCOL":"http"}')},d13b:function(e,t,r){"use strict";r("7de1")},edd4:function(e){e.exports=JSON.parse('{"App":{"title":"Global Open Facility Registry","initApp":"Initializing App","source":"Source","menu":{"facilityRecon":{"msg":"Facility Reconciliation","tooltip":"Facility Reconciliation"},"createPair":{"msg":"Create and Manage Data Source Pair","tooltip":"Select data sources to start mathing"},"reconcile":{"msg":"Reconcile","tooltip":"Perform location matching of your selected data sources"},"recoStatus":{"msg":"Reconciliation Status","tooltip":"Matching Status"},"facilityRegistry":{"msg":"Facility Registry","tooltip":"Facility Registry"},"createOrgHier":{"msg":"Create Hierarchy","tooltip":"Add Facility And Jurisdition"},"healthService":{"msg":"Healthcare Services","tooltip":"Add services and define service terminologies"},"healthServiceTerminologies":{"msg":"Add Terminologies","tooltip":"Add service based terminologies"},"facilityRegReports":{"msg":"Reports","tooltip":"View Reports"},"search":{"msg":"Search","tooltip":"Search"},"searchFacility":{"msg":"Search Facility","tooltip":"Search Facility"},"searchJurisdiction":{"msg":"Search Jurisdiction","tooltip":"Search Jurisdiction"},"searchOrganization":{"msg":"Search Organization","tooltip":"Search Organization"},"searchFacilityAddRequest":{"msg":"Search Facility Add Request","tooltip":"Search Facility Add Request"},"searchFacilityUpdateRequest":{"msg":"Search Facility Update Request","tooltip":"Search Facility Update Request"},"addJurisdiction":{"msg":"Add Jurisdiction","tooltip":"Add Counties/Districts"},"addOrganization":{"msg":"Add Organization","tooltip":"Add Organization"},"addFacility":{"msg":"Add Facility","tooltip":"Add Facility"},"searchService":{"msg":"Search Service","tooltip":"Search Service"},"facilitiesReport":{"msg":"Facilities","tooltip":"Facilities"},"servicesReport":{"msg":"Services","tooltip":"Services"},"newFacilitiesRequestsReport":{"msg":"New Facilities Requests","tooltip":"Report on requests made to create new facilities"},"facilitiesUpdateRequestsReport":{"msg":"Requested Facilities Updates","tooltip":"Report about requests to update details of facilities"},"facilityRequests":{"msg":"Requests","tooltip":"Send requests about addition of new facilities or update of facility details"},"requestNewFacility":{"msg":"Request Addition of New Facility","tooltip":"Request Addition of New Facility"},"requestUpdateFacility":{"msg":"Request Update of Facility Details","tooltip":"Request Update of Facility Details"},"addLanguage":{"msg":"Add Language","tooltip":"Add Language"},"addReferralMethod":{"msg":"Add Referral Methods","tooltip":"Add Referral Methods"},"addProgram":{"msg":"Add Programs","tooltip":"Add Programs"},"addCharacteristic":{"msg":"Add Characteristics","tooltip":"Add Characteristics"},"addService":{"msg":"Add Service","tooltip":"Add Service offered by health facilities"},"viewMap":{"msg":"View Map","tooltip":"View Map"},"services":{"msg":"Services","tooltip":"Services"},"archive":{"msg":"Archived Uploads","tooltip":"Access to backup data"},"account":{"msg":"Account"},"addUser":{"msg":"Add User","tooltip":"Create new user account"},"usersList":{"msg":"Users List","tooltip":"Manage user accounts"},"rolesManagement":{"msg":"Roles Management","tooltip":"Add or remove specific tasks on roles"},"changePassword":{"msg":"Change Password"},"logout":{"msg":"Logout"},"configure":{"msg":"configure System"},"dataSourcesParent":{"msg":"Data Sources","tooltip":"Upload CSV data and add remote DHIS2 or FHIR servers"},"viewDataSources":{"msg":"View Data Sources","tooltip":"View datasets that can be used for reconciliation"},"addDataSources":{"msg":"Add Data Sources","tooltip":"Add a new dataset that you want to reconcile"},"view":{"msg":"View","tooltip":"Explore data sources contents"},"recoParent":{"msg":"Reconcile"}}}}')},f693:function(e){e.exports=JSON.parse('{"App":{"title":"Facility Reconciliation","initApp":"Initialisation de l\'App","source":"la source","menu":{"facilityRecon":{"msg":"rapprochement des installations","tooltip":"rapprochement des installations"},"createPair":{"msg":"Créer et gérer une paire de sources de données","tooltip":"Select data sources to start mathing"},"reconcile":{"msg":"Réconcilier","tooltip":"Effectuer une correspondance d\'emplacement de vos sources de données sélectionnées"},"recoStatus":{"msg":"État de rapprochement","tooltip":"Statut de correspondance"},"facilityRegistry":{"msg":"registre des installations","tooltip":"registre des installations"},"search":{"msg":"Search","tooltip":"Search"},"searchFacility":{"msg":"Facilité de recherche","tooltip":"Facilité de recherche"},"searchJurisdiction":{"msg":"juridiction de recherche","tooltip":"juridiction de recherche"},"searchOrganization":{"msg":"Rechercher une organisation","tooltip":"Rechercher une organisation"},"searchFacilityAddRequest":{"msg":"Search Facility Add Request","tooltip":"Search Facility Add Request"},"searchFacilityUpdateRequest":{"msg":"Search Facility Update Request","tooltip":"Search Facility Update Request"},"createOrgHier":{"msg":"Créer une hiérarchie","tooltip":"Ajouter une installation et une édition"},"healthService":{"msg":"Services de santé","tooltip":"Ajouter des services et définir des terminologies de service"},"healthServiceTerminologies":{"msg":"Ajouter des terminologies","tooltip":"Ajouter des terminologies basées sur le service"},"facilityRegReports":{"msg":"Rapports","tooltip":"Voir les rapports"},"addJurisdiction":{"msg":"Ajouter une juridiction","tooltip":"Ajouter des comtés / districts"},"addOrganization":{"msg":"Ajouter une organisation","tooltip":"Ajouter une organisation"},"addFacility":{"msg":"Add Facility","tooltip":"Add Facility"},"searchService":{"msg":"Service de recherche","tooltip":"Service de recherche"},"facilitiesReport":{"msg":"Facilities Report","tooltip":"Facilities Report"},"servicesReport":{"msg":"Services Report","tooltip":"Services Report"},"facilitiesRequestsReport":{"msg":"Facilities Requests Report","tooltip":"Report on requests made to create new facilities"},"facilitiesUpdateRequestsReport":{"msg":"Facilities Updates Requests Report","tooltip":"Report about requests to update details of facilities"},"requestNewFacility":{"msg":"Request Addition of New Facility","tooltip":"Request Addition of New Facility"},"requestUpdateFacility":{"msg":"Request Update of Facility Details","tooltip":"Request Update of Facility Details"},"addLanguage":{"msg":"Add Language","tooltip":"Add Language"},"addReferralMethod":{"msg":"Add Referral Methods","tooltip":"Add Referral Methods"},"addProgram":{"msg":"Add Programs","tooltip":"Add Programs"},"addCharacteristic":{"msg":"Add Characteristics","tooltip":"Add Characteristics"},"addService":{"msg":"Ajouter un service","tooltip":"Ajouter le service offert par les établissements de santé"},"viewMap":{"msg":"voir la carte","tooltip":"voir la carte"},"services":{"msg":"Prestations de service","tooltip":"Prestations de service"},"archive":{"msg":"Téléchargements archivés","tooltip":"Accès aux données de sauvegarde"},"account":{"msg":"Compte"},"addUser":{"msg":"Ajouter un utilisateur","tooltip":"Créer un nouveau compte d\'utilisateur"},"usersList":{"msg":"Liste des utilisateurs","tooltip":"Gérer les comptes d\'utilisateurs"},"rolesManagement":{"msg":"Gestion des rôles","tooltip":"Ajouter ou supprimer des tâches spécifiques sur les rôles"},"changePassword":{"msg":"Changer le mot de passe"},"logout":{"msg":"Connectez - Out"},"configure":{"msg":"configurer le système"},"dataSourcesParent":{"msg":"Les sources de données","tooltip":"Télécharger des données CSV et ajouter des serveurs DHIS2 ou FHIR distants"},"viewDataSources":{"msg":"Afficher les sources de données","tooltip":"Afficher les jeux de données pouvant être utilisés pour la réconciliation"},"addDataSources":{"msg":"Ajouter des sources de données","tooltip":"Ajouter un nouveau jeu de données que vous souhaitez réconcilier"},"view":{"msg":"Vue","tooltip":"Explorer le contenu des sources de données"},"recoParent":{"msg":"Réconcilier"}}}}')}});
//# sourceMappingURL=app.75b5da1a.js.map